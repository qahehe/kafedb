20/04/25 22:01:59 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10834ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sat Apr 25 22:02:02 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sat Apr 25 22:02:04 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sat Apr 25 22:02:04 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sat Apr 25 22:02:04 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sat Apr 25 22:02:04 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sat Apr 25 22:02:08 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sat Apr 25 22:02:12 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sat Apr 25 22:02:12 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/25 22:02:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:02:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2102L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:02:14 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/25 22:02:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2102L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#2104 AS rid_0#2149, cpfk_orders_lineitem#2105 AS cpfk_orders_lineitem_0#2150, cpfk_supplier_lineitem#2106 AS cpfk_supplier_lineitem_0#2151, cfpk_lineitem_supplier#2107 AS cfpk_lineitem_supplier_0#2152, cfpk_lineitem_partsupp#2108 AS cfpk_lineitem_partsupp_0#2153, cpfk_part_lineitem#2109 AS cpfk_part_lineitem_0#2154, cfpk_lineitem_part#2110 AS cfpk_lineitem_part_0#2155, cpfk_partsupp_lineitem#2111 AS cpfk_partsupp_lineitem_0#2156, cfpk_lineitem_orders#2112 AS cfpk_lineitem_orders_0#2157, cval_lineitem_l_quantity#2113 AS cval_lineitem_l_quantity_0#2158, cval_lineitem_l_extendedprice#2114 AS cval_lineitem_l_extendedprice_0#2159, cval_lineitem_l_discount#2115 AS cval_lineitem_l_discount_0#2160, cval_lineitem_l_tax#2116 AS cval_lineitem_l_tax_0#2161, cval_lineitem_l_returnflag#2117 AS cval_lineitem_l_returnflag_0#2162, cval_lineitem_l_linestatus#2118 AS cval_lineitem_l_linestatus_0#2163, cval_lineitem_l_commitdate#2119 AS cval_lineitem_l_commitdate_0#2164, cval_lineitem_l_receiptdate#2120 AS cval_lineitem_l_receiptdate_0#2165, cval_lineitem_l_shipinstruct#2121 AS cval_lineitem_l_shipinstruct_0#2166, cval_lineitem_l_shipmode#2122 AS cval_lineitem_l_shipmode_0#2167, cval_lineitem_l_comment#2123 AS cval_lineitem_l_comment_0#2168, cval_lineitem_l_shipdate#2124 AS cval_lineitem_l_shipdate_0#2169, cdepval_lineitem_l_quantity#2125 AS cdepval_lineitem_l_quantity_0#2170, cdepval_lineitem_l_extendedprice#2126 AS cdepval_lineitem_l_extendedprice_0#2171, cdepval_lineitem_l_discount#2127 AS cdepval_lineitem_l_discount_0#2172, ... 21 more fields]
         :  +- Relation[rid#2104,cpfk_orders_lineitem#2105,cpfk_supplier_lineitem#2106,cfpk_lineitem_supplier#2107,cfpk_lineitem_partsupp#2108,cpfk_part_lineitem#2109,cfpk_lineitem_part#2110,cpfk_partsupp_lineitem#2111,cfpk_lineitem_orders#2112,cval_lineitem_l_quantity#2113,cval_lineitem_l_extendedprice#2114,cval_lineitem_l_discount#2115,cval_lineitem_l_tax#2116,cval_lineitem_l_returnflag#2117,cval_lineitem_l_linestatus#2118,cval_lineitem_l_commitdate#2119,cval_lineitem_l_receiptdate#2120,cval_lineitem_l_shipinstruct#2121,cval_lineitem_l_shipmode#2122,cval_lineitem_l_comment#2123,cval_lineitem_l_shipdate#2124,cdepval_lineitem_l_quantity#2125,cdepval_lineitem_l_extendedprice#2126,cdepval_lineitem_l_discount#2127,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2194 AS rid_1#2218, cpfk_customer_orders#2195 AS cpfk_customer_orders_1#2219, cfpk_orders_customer#2196 AS cfpk_orders_customer_1#2220, cval_orders_o_orderstatus#2197 AS cval_orders_o_orderstatus_1#2221, cval_orders_o_totalprice#2198 AS cval_orders_o_totalprice_1#2222, cval_orders_o_orderpriority#2199 AS cval_orders_o_orderpriority_1#2223, cval_orders_o_clerk#2200 AS cval_orders_o_clerk_1#2224, cval_orders_o_shippriority#2201 AS cval_orders_o_shippriority_1#2225, cval_orders_o_comment#2202 AS cval_orders_o_comment_1#2226, cval_orders_o_orderdate#2203 AS cval_orders_o_orderdate_1#2227, cdepval_orders_o_orderstatus#2204 AS cdepval_orders_o_orderstatus_1#2228, cdepval_orders_o_totalprice#2205 AS cdepval_orders_o_totalprice_1#2229, cdepval_orders_o_orderpriority#2206 AS cdepval_orders_o_orderpriority_1#2230, cdepval_orders_o_clerk#2207 AS cdepval_orders_o_clerk_1#2231, cdepval_orders_o_shippriority#2208 AS cdepval_orders_o_shippriority_1#2232, cdepval_orders_o_comment#2209 AS cdepval_orders_o_comment_1#2233, cdepval_orders_o_orderdate#2210 AS cdepval_orders_o_orderdate_1#2234, co_orderstatus#2211 AS co_orderstatus_1#2235, co_totalprice#2212 AS co_totalprice_1#2236, co_orderpriority#2213 AS co_orderpriority_1#2237, co_clerk#2214 AS co_clerk_1#2238, co_shippriority#2215 AS co_shippriority_1#2239, co_comment#2216 AS co_comment_1#2240, co_orderdate#2217 AS co_orderdate_1#2241]
            +- Relation[rid#2194,cpfk_customer_orders#2195,cfpk_orders_customer#2196,cval_orders_o_orderstatus#2197,cval_orders_o_totalprice#2198,cval_orders_o_orderpriority#2199,cval_orders_o_clerk#2200,cval_orders_o_shippriority#2201,cval_orders_o_comment#2202,cval_orders_o_orderdate#2203,cdepval_orders_o_orderstatus#2204,cdepval_orders_o_totalprice#2205,cdepval_orders_o_orderpriority#2206,cdepval_orders_o_clerk#2207,cdepval_orders_o_shippriority#2208,cdepval_orders_o_comment#2209,cdepval_orders_o_orderdate#2210,co_orderstatus#2211,co_totalprice#2212,co_orderpriority#2213,co_clerk#2214,co_shippriority#2215,co_comment#2216,co_orderdate#2217] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 19899ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/25 22:02:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:02:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2320L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:02:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2320L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2412 AS rid_2#2457, cpfk_orders_lineitem#2413 AS cpfk_orders_lineitem_2#2458, cpfk_supplier_lineitem#2414 AS cpfk_supplier_lineitem_2#2459, cfpk_lineitem_supplier#2415 AS cfpk_lineitem_supplier_2#2460, cfpk_lineitem_partsupp#2416 AS cfpk_lineitem_partsupp_2#2461, cpfk_part_lineitem#2417 AS cpfk_part_lineitem_2#2462, cfpk_lineitem_part#2418 AS cfpk_lineitem_part_2#2463, cpfk_partsupp_lineitem#2419 AS cpfk_partsupp_lineitem_2#2464, cfpk_lineitem_orders#2420 AS cfpk_lineitem_orders_2#2465, cval_lineitem_l_quantity#2421 AS cval_lineitem_l_quantity_2#2466, cval_lineitem_l_extendedprice#2422 AS cval_lineitem_l_extendedprice_2#2467, cval_lineitem_l_discount#2423 AS cval_lineitem_l_discount_2#2468, cval_lineitem_l_tax#2424 AS cval_lineitem_l_tax_2#2469, cval_lineitem_l_returnflag#2425 AS cval_lineitem_l_returnflag_2#2470, cval_lineitem_l_linestatus#2426 AS cval_lineitem_l_linestatus_2#2471, cval_lineitem_l_commitdate#2427 AS cval_lineitem_l_commitdate_2#2472, cval_lineitem_l_receiptdate#2428 AS cval_lineitem_l_receiptdate_2#2473, cval_lineitem_l_shipinstruct#2429 AS cval_lineitem_l_shipinstruct_2#2474, cval_lineitem_l_shipmode#2430 AS cval_lineitem_l_shipmode_2#2475, cval_lineitem_l_comment#2431 AS cval_lineitem_l_comment_2#2476, cval_lineitem_l_shipdate#2432 AS cval_lineitem_l_shipdate_2#2477, cdepval_lineitem_l_quantity#2433 AS cdepval_lineitem_l_quantity_2#2478, cdepval_lineitem_l_extendedprice#2434 AS cdepval_lineitem_l_extendedprice_2#2479, cdepval_lineitem_l_discount#2435 AS cdepval_lineitem_l_discount_2#2480, ... 21 more fields]
         :  +- Relation[rid#2412,cpfk_orders_lineitem#2413,cpfk_supplier_lineitem#2414,cfpk_lineitem_supplier#2415,cfpk_lineitem_partsupp#2416,cpfk_part_lineitem#2417,cfpk_lineitem_part#2418,cpfk_partsupp_lineitem#2419,cfpk_lineitem_orders#2420,cval_lineitem_l_quantity#2421,cval_lineitem_l_extendedprice#2422,cval_lineitem_l_discount#2423,cval_lineitem_l_tax#2424,cval_lineitem_l_returnflag#2425,cval_lineitem_l_linestatus#2426,cval_lineitem_l_commitdate#2427,cval_lineitem_l_receiptdate#2428,cval_lineitem_l_shipinstruct#2429,cval_lineitem_l_shipmode#2430,cval_lineitem_l_comment#2431,cval_lineitem_l_shipdate#2432,cdepval_lineitem_l_quantity#2433,cdepval_lineitem_l_extendedprice#2434,cdepval_lineitem_l_discount#2435,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#2364 AS rid_1#2388, cpfk_customer_orders#2365 AS cpfk_customer_orders_1#2389, cfpk_orders_customer#2366 AS cfpk_orders_customer_1#2390, cval_orders_o_orderstatus#2367 AS cval_orders_o_orderstatus_1#2391, cval_orders_o_totalprice#2368 AS cval_orders_o_totalprice_1#2392, cval_orders_o_orderpriority#2369 AS cval_orders_o_orderpriority_1#2393, cval_orders_o_clerk#2370 AS cval_orders_o_clerk_1#2394, cval_orders_o_shippriority#2371 AS cval_orders_o_shippriority_1#2395, cval_orders_o_comment#2372 AS cval_orders_o_comment_1#2396, cval_orders_o_orderdate#2373 AS cval_orders_o_orderdate_1#2397, cdepval_orders_o_orderstatus#2374 AS cdepval_orders_o_orderstatus_1#2398, cdepval_orders_o_totalprice#2375 AS cdepval_orders_o_totalprice_1#2399, cdepval_orders_o_orderpriority#2376 AS cdepval_orders_o_orderpriority_1#2400, cdepval_orders_o_clerk#2377 AS cdepval_orders_o_clerk_1#2401, cdepval_orders_o_shippriority#2378 AS cdepval_orders_o_shippriority_1#2402, cdepval_orders_o_comment#2379 AS cdepval_orders_o_comment_1#2403, cdepval_orders_o_orderdate#2380 AS cdepval_orders_o_orderdate_1#2404, co_orderstatus#2381 AS co_orderstatus_1#2405, co_totalprice#2382 AS co_totalprice_1#2406, co_orderpriority#2383 AS co_orderpriority_1#2407, co_clerk#2384 AS co_clerk_1#2408, co_shippriority#2385 AS co_shippriority_1#2409, co_comment#2386 AS co_comment_1#2410, co_orderdate#2387 AS co_orderdate_1#2411]
            :  +- Relation[rid#2364,cpfk_customer_orders#2365,cfpk_orders_customer#2366,cval_orders_o_orderstatus#2367,cval_orders_o_totalprice#2368,cval_orders_o_orderpriority#2369,cval_orders_o_clerk#2370,cval_orders_o_shippriority#2371,cval_orders_o_comment#2372,cval_orders_o_orderdate#2373,cdepval_orders_o_orderstatus#2374,cdepval_orders_o_totalprice#2375,cdepval_orders_o_orderpriority#2376,cdepval_orders_o_clerk#2377,cdepval_orders_o_shippriority#2378,cdepval_orders_o_comment#2379,cdepval_orders_o_orderdate#2380,co_orderstatus#2381,co_totalprice#2382,co_orderpriority#2383,co_clerk#2384,co_shippriority#2385,co_comment#2386,co_orderdate#2387] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2322 AS rid_0#2343, cpfk_nation_customer#2323 AS cpfk_nation_customer_0#2344, cfpk_customer_nation#2324 AS cfpk_customer_nation_0#2345, cval_customer_c_name#2325 AS cval_customer_c_name_0#2346, cval_customer_c_address#2326 AS cval_customer_c_address_0#2347, cval_customer_c_phone#2327 AS cval_customer_c_phone_0#2348, cval_customer_c_acctbal#2328 AS cval_customer_c_acctbal_0#2349, cval_customer_c_comment#2329 AS cval_customer_c_comment_0#2350, cval_customer_c_mktsegment#2330 AS cval_customer_c_mktsegment_0#2351, cdepval_customer_c_name#2331 AS cdepval_customer_c_name_0#2352, cdepval_customer_c_address#2332 AS cdepval_customer_c_address_0#2353, cdepval_customer_c_phone#2333 AS cdepval_customer_c_phone_0#2354, cdepval_customer_c_acctbal#2334 AS cdepval_customer_c_acctbal_0#2355, cdepval_customer_c_comment#2335 AS cdepval_customer_c_comment_0#2356, cdepval_customer_c_mktsegment#2336 AS cdepval_customer_c_mktsegment_0#2357, cc_name#2337 AS cc_name_0#2358, cc_address#2338 AS cc_address_0#2359, cc_phone#2339 AS cc_phone_0#2360, cc_acctbal#2340 AS cc_acctbal_0#2361, cc_comment#2341 AS cc_comment_0#2362, cc_mktsegment#2342 AS cc_mktsegment_0#2363]
               +- Relation[rid#2322,cpfk_nation_customer#2323,cfpk_customer_nation#2324,cval_customer_c_name#2325,cval_customer_c_address#2326,cval_customer_c_phone#2327,cval_customer_c_acctbal#2328,cval_customer_c_comment#2329,cval_customer_c_mktsegment#2330,cdepval_customer_c_name#2331,cdepval_customer_c_address#2332,cdepval_customer_c_phone#2333,cdepval_customer_c_acctbal#2334,cdepval_customer_c_comment#2335,cdepval_customer_c_mktsegment#2336,cc_name#2337,cc_address#2338,cc_phone#2339,cc_acctbal#2340,cc_comment#2341,cc_mktsegment#2342] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22073ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:02:55 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:02:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2601L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:02:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2601L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#2735 AS rid_4#2780, cpfk_orders_lineitem#2736 AS cpfk_orders_lineitem_4#2781, cpfk_supplier_lineitem#2737 AS cpfk_supplier_lineitem_4#2782, cfpk_lineitem_supplier#2738 AS cfpk_lineitem_supplier_4#2783, cfpk_lineitem_partsupp#2739 AS cfpk_lineitem_partsupp_4#2784, cpfk_part_lineitem#2740 AS cpfk_part_lineitem_4#2785, cfpk_lineitem_part#2741 AS cfpk_lineitem_part_4#2786, cpfk_partsupp_lineitem#2742 AS cpfk_partsupp_lineitem_4#2787, cfpk_lineitem_orders#2743 AS cfpk_lineitem_orders_4#2788, cval_lineitem_l_quantity#2744 AS cval_lineitem_l_quantity_4#2789, cval_lineitem_l_extendedprice#2745 AS cval_lineitem_l_extendedprice_4#2790, cval_lineitem_l_discount#2746 AS cval_lineitem_l_discount_4#2791, cval_lineitem_l_tax#2747 AS cval_lineitem_l_tax_4#2792, cval_lineitem_l_returnflag#2748 AS cval_lineitem_l_returnflag_4#2793, cval_lineitem_l_linestatus#2749 AS cval_lineitem_l_linestatus_4#2794, cval_lineitem_l_commitdate#2750 AS cval_lineitem_l_commitdate_4#2795, cval_lineitem_l_receiptdate#2751 AS cval_lineitem_l_receiptdate_4#2796, cval_lineitem_l_shipinstruct#2752 AS cval_lineitem_l_shipinstruct_4#2797, cval_lineitem_l_shipmode#2753 AS cval_lineitem_l_shipmode_4#2798, cval_lineitem_l_comment#2754 AS cval_lineitem_l_comment_4#2799, cval_lineitem_l_shipdate#2755 AS cval_lineitem_l_shipdate_4#2800, cdepval_lineitem_l_quantity#2756 AS cdepval_lineitem_l_quantity_4#2801, cdepval_lineitem_l_extendedprice#2757 AS cdepval_lineitem_l_extendedprice_4#2802, cdepval_lineitem_l_discount#2758 AS cdepval_lineitem_l_discount_4#2803, ... 21 more fields]
         :  :  +- Relation[rid#2735,cpfk_orders_lineitem#2736,cpfk_supplier_lineitem#2737,cfpk_lineitem_supplier#2738,cfpk_lineitem_partsupp#2739,cpfk_part_lineitem#2740,cfpk_lineitem_part#2741,cpfk_partsupp_lineitem#2742,cfpk_lineitem_orders#2743,cval_lineitem_l_quantity#2744,cval_lineitem_l_extendedprice#2745,cval_lineitem_l_discount#2746,cval_lineitem_l_tax#2747,cval_lineitem_l_returnflag#2748,cval_lineitem_l_linestatus#2749,cval_lineitem_l_commitdate#2750,cval_lineitem_l_receiptdate#2751,cval_lineitem_l_shipinstruct#2752,cval_lineitem_l_shipmode#2753,cval_lineitem_l_comment#2754,cval_lineitem_l_shipdate#2755,cdepval_lineitem_l_quantity#2756,cdepval_lineitem_l_extendedprice#2757,cdepval_lineitem_l_discount#2758,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#2657 AS rid_2#2671, cpfk_part_partsupp#2658 AS cpfk_part_partsupp_2#2672, cfpk_partsupp_part#2659 AS cfpk_partsupp_part_2#2673, cpfk_supplier_partsupp#2660 AS cpfk_supplier_partsupp_2#2674, cfpk_partsupp_supplier#2661 AS cfpk_partsupp_supplier_2#2675, cval_partsupp_ps_availqty#2662 AS cval_partsupp_ps_availqty_2#2676, cval_partsupp_ps_supplycost#2663 AS cval_partsupp_ps_supplycost_2#2677, cval_partsupp_ps_comment#2664 AS cval_partsupp_ps_comment_2#2678, cdepval_partsupp_ps_availqty#2665 AS cdepval_partsupp_ps_availqty_2#2679, cdepval_partsupp_ps_supplycost#2666 AS cdepval_partsupp_ps_supplycost_2#2680, cdepval_partsupp_ps_comment#2667 AS cdepval_partsupp_ps_comment_2#2681, cps_availqty#2668 AS cps_availqty_2#2682, cps_supplycost#2669 AS cps_supplycost_2#2683, cps_comment#2670 AS cps_comment_2#2684]
         :     :  :  +- Relation[rid#2657,cpfk_part_partsupp#2658,cfpk_partsupp_part#2659,cpfk_supplier_partsupp#2660,cfpk_partsupp_supplier#2661,cval_partsupp_ps_availqty#2662,cval_partsupp_ps_supplycost#2663,cval_partsupp_ps_comment#2664,cdepval_partsupp_ps_availqty#2665,cdepval_partsupp_ps_supplycost#2666,cdepval_partsupp_ps_comment#2667,cps_availqty#2668,cps_supplycost#2669,cps_comment#2670] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#2621 AS rid_1#2639, cpfk_nation_supplier#2622 AS cpfk_nation_supplier_1#2640, cfpk_supplier_nation#2623 AS cfpk_supplier_nation_1#2641, cval_supplier_s_name#2624 AS cval_supplier_s_name_1#2642, cval_supplier_s_address#2625 AS cval_supplier_s_address_1#2643, cval_supplier_s_phone#2626 AS cval_supplier_s_phone_1#2644, cval_supplier_s_acctbal#2627 AS cval_supplier_s_acctbal_1#2645, cval_supplier_s_comment#2628 AS cval_supplier_s_comment_1#2646, cdepval_supplier_s_name#2629 AS cdepval_supplier_s_name_1#2647, cdepval_supplier_s_address#2630 AS cdepval_supplier_s_address_1#2648, cdepval_supplier_s_phone#2631 AS cdepval_supplier_s_phone_1#2649, cdepval_supplier_s_acctbal#2632 AS cdepval_supplier_s_acctbal_1#2650, cdepval_supplier_s_comment#2633 AS cdepval_supplier_s_comment_1#2651, cs_name#2634 AS cs_name_1#2652, cs_address#2635 AS cs_address_1#2653, cs_phone#2636 AS cs_phone_1#2654, cs_acctbal#2637 AS cs_acctbal_1#2655, cs_comment#2638 AS cs_comment_1#2656]
         :     :     :  +- Relation[rid#2621,cpfk_nation_supplier#2622,cfpk_supplier_nation#2623,cval_supplier_s_name#2624,cval_supplier_s_address#2625,cval_supplier_s_phone#2626,cval_supplier_s_acctbal#2627,cval_supplier_s_comment#2628,cdepval_supplier_s_name#2629,cdepval_supplier_s_address#2630,cdepval_supplier_s_phone#2631,cdepval_supplier_s_acctbal#2632,cdepval_supplier_s_comment#2633,cs_name#2634,cs_address#2635,cs_phone#2636,cs_acctbal#2637,cs_comment#2638] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#2603 AS rid_0#2612, cpfk_region_nation#2604 AS cpfk_region_nation_0#2613, cfpk_nation_region#2605 AS cfpk_nation_region_0#2614, cval_nation_n_name#2606 AS cval_nation_n_name_0#2615, cval_nation_n_comment#2607 AS cval_nation_n_comment_0#2616, cdepval_nation_n_name#2608 AS cdepval_nation_n_name_0#2617, cdepval_nation_n_comment#2609 AS cdepval_nation_n_comment_0#2618, cn_name#2610 AS cn_name_0#2619, cn_comment#2611 AS cn_comment_0#2620]
         :     :        +- Relation[rid#2603,cpfk_region_nation#2604,cfpk_nation_region#2605,cval_nation_n_name#2606,cval_nation_n_comment#2607,cdepval_nation_n_name#2608,cdepval_nation_n_comment#2609,cn_name#2610,cn_comment#2611] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#2685 AS rid_3#2710, cval_part_p_name#2686 AS cval_part_p_name_3#2711, cval_part_p_mfgr#2687 AS cval_part_p_mfgr_3#2712, cval_part_p_type#2688 AS cval_part_p_type_3#2713, cval_part_p_size#2689 AS cval_part_p_size_3#2714, cval_part_p_container#2690 AS cval_part_p_container_3#2715, cval_part_p_retailprice#2691 AS cval_part_p_retailprice_3#2716, cval_part_p_comment#2692 AS cval_part_p_comment_3#2717, cval_part_p_brand#2693 AS cval_part_p_brand_3#2718, cdepval_part_p_name#2694 AS cdepval_part_p_name_3#2719, cdepval_part_p_mfgr#2695 AS cdepval_part_p_mfgr_3#2720, cdepval_part_p_type#2696 AS cdepval_part_p_type_3#2721, cdepval_part_p_size#2697 AS cdepval_part_p_size_3#2722, cdepval_part_p_container#2698 AS cdepval_part_p_container_3#2723, cdepval_part_p_retailprice#2699 AS cdepval_part_p_retailprice_3#2724, cdepval_part_p_comment#2700 AS cdepval_part_p_comment_3#2725, cdepval_part_p_brand#2701 AS cdepval_part_p_brand_3#2726, cp_name#2702 AS cp_name_3#2727, cp_mfgr#2703 AS cp_mfgr_3#2728, cp_type#2704 AS cp_type_3#2729, cp_size#2705 AS cp_size_3#2730, cp_container#2706 AS cp_container_3#2731, cp_retailprice#2707 AS cp_retailprice_3#2732, cp_comment#2708 AS cp_comment_3#2733, cp_brand#2709 AS cp_brand_3#2734]
         :        +- Relation[rid#2685,cval_part_p_name#2686,cval_part_p_mfgr#2687,cval_part_p_type#2688,cval_part_p_size#2689,cval_part_p_container#2690,cval_part_p_retailprice#2691,cval_part_p_comment#2692,cval_part_p_brand#2693,cdepval_part_p_name#2694,cdepval_part_p_mfgr#2695,cdepval_part_p_type#2696,cdepval_part_p_size#2697,cdepval_part_p_container#2698,cdepval_part_p_retailprice#2699,cdepval_part_p_comment#2700,cdepval_part_p_brand#2701,cp_name#2702,cp_mfgr#2703,cp_type#2704,cp_size#2705,cp_container#2706,cp_retailprice#2707,cp_comment#2708,cp_brand#2709] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#2825 AS rid_5#2849, cpfk_customer_orders#2826 AS cpfk_customer_orders_5#2850, cfpk_orders_customer#2827 AS cfpk_orders_customer_5#2851, cval_orders_o_orderstatus#2828 AS cval_orders_o_orderstatus_5#2852, cval_orders_o_totalprice#2829 AS cval_orders_o_totalprice_5#2853, cval_orders_o_orderpriority#2830 AS cval_orders_o_orderpriority_5#2854, cval_orders_o_clerk#2831 AS cval_orders_o_clerk_5#2855, cval_orders_o_shippriority#2832 AS cval_orders_o_shippriority_5#2856, cval_orders_o_comment#2833 AS cval_orders_o_comment_5#2857, cval_orders_o_orderdate#2834 AS cval_orders_o_orderdate_5#2858, cdepval_orders_o_orderstatus#2835 AS cdepval_orders_o_orderstatus_5#2859, cdepval_orders_o_totalprice#2836 AS cdepval_orders_o_totalprice_5#2860, cdepval_orders_o_orderpriority#2837 AS cdepval_orders_o_orderpriority_5#2861, cdepval_orders_o_clerk#2838 AS cdepval_orders_o_clerk_5#2862, cdepval_orders_o_shippriority#2839 AS cdepval_orders_o_shippriority_5#2863, cdepval_orders_o_comment#2840 AS cdepval_orders_o_comment_5#2864, cdepval_orders_o_orderdate#2841 AS cdepval_orders_o_orderdate_5#2865, co_orderstatus#2842 AS co_orderstatus_5#2866, co_totalprice#2843 AS co_totalprice_5#2867, co_orderpriority#2844 AS co_orderpriority_5#2868, co_clerk#2845 AS co_clerk_5#2869, co_shippriority#2846 AS co_shippriority_5#2870, co_comment#2847 AS co_comment_5#2871, co_orderdate#2848 AS co_orderdate_5#2872]
            +- Relation[rid#2825,cpfk_customer_orders#2826,cfpk_orders_customer#2827,cval_orders_o_orderstatus#2828,cval_orders_o_totalprice#2829,cval_orders_o_orderpriority#2830,cval_orders_o_clerk#2831,cval_orders_o_shippriority#2832,cval_orders_o_comment#2833,cval_orders_o_orderdate#2834,cdepval_orders_o_orderstatus#2835,cdepval_orders_o_totalprice#2836,cdepval_orders_o_orderpriority#2837,cdepval_orders_o_clerk#2838,cdepval_orders_o_shippriority#2839,cdepval_orders_o_comment#2840,cdepval_orders_o_orderdate#2841,co_orderstatus#2842,co_totalprice#2843,co_orderpriority#2844,co_clerk#2845,co_shippriority#2846,co_comment#2847,co_orderdate#2848] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37821ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/25 22:03:33 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:03:33 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3013L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:33 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3013L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3040, cval_part_p_name_0#3041, cval_part_p_mfgr_0#3042, cval_part_p_type_0#3043, cval_part_p_size_0#3044, cval_part_p_container_0#3045, cval_part_p_retailprice_0#3046, cval_part_p_comment_0#3047, cval_part_p_brand_0#3048, cdepval_part_p_name_0#3049, cdepval_part_p_mfgr_0#3050, cdepval_part_p_type_0#3051, cdepval_part_p_size_0#3052, cdepval_part_p_container_0#3053, cdepval_part_p_retailprice_0#3054, cdepval_part_p_comment_0#3055, cdepval_part_p_brand_0#3056, cp_name_0#3057, cp_mfgr_0#3058, cp_type_0#3059, cp_size_0#3060, cp_container_0#3061, cp_retailprice_0#3062, cp_comment_0#3063, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#3015 AS rid_0#3040, cval_part_p_name#3016 AS cval_part_p_name_0#3041, cval_part_p_mfgr#3017 AS cval_part_p_mfgr_0#3042, cval_part_p_type#3018 AS cval_part_p_type_0#3043, cval_part_p_size#3019 AS cval_part_p_size_0#3044, cval_part_p_container#3020 AS cval_part_p_container_0#3045, cval_part_p_retailprice#3021 AS cval_part_p_retailprice_0#3046, cval_part_p_comment#3022 AS cval_part_p_comment_0#3047, cval_part_p_brand#3023 AS cval_part_p_brand_0#3048, cdepval_part_p_name#3024 AS cdepval_part_p_name_0#3049, cdepval_part_p_mfgr#3025 AS cdepval_part_p_mfgr_0#3050, cdepval_part_p_type#3026 AS cdepval_part_p_type_0#3051, cdepval_part_p_size#3027 AS cdepval_part_p_size_0#3052, cdepval_part_p_container#3028 AS cdepval_part_p_container_0#3053, cdepval_part_p_retailprice#3029 AS cdepval_part_p_retailprice_0#3054, cdepval_part_p_comment#3030 AS cdepval_part_p_comment_0#3055, cdepval_part_p_brand#3031 AS cdepval_part_p_brand_0#3056, cp_name#3032 AS cp_name_0#3057, cp_mfgr#3033 AS cp_mfgr_0#3058, cp_type#3034 AS cp_type_0#3059, cp_size#3035 AS cp_size_0#3060, cp_container#3036 AS cp_container_0#3061, cp_retailprice#3037 AS cp_retailprice_0#3062, cp_comment#3038 AS cp_comment_0#3063, cp_brand#3039 AS cp_brand_0#3064]
         :  :        +- Relation[rid#3015,cval_part_p_name#3016,cval_part_p_mfgr#3017,cval_part_p_type#3018,cval_part_p_size#3019,cval_part_p_container#3020,cval_part_p_retailprice#3021,cval_part_p_comment#3022,cval_part_p_brand#3023,cdepval_part_p_name#3024,cdepval_part_p_mfgr#3025,cdepval_part_p_type#3026,cdepval_part_p_size#3027,cdepval_part_p_container#3028,cdepval_part_p_retailprice#3029,cdepval_part_p_comment#3030,cdepval_part_p_brand#3031,cp_name#3032,cp_mfgr#3033,cp_type#3034,cp_size#3035,cp_container#3036,cp_retailprice#3037,cp_comment#3038,cp_brand#3039] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#3485 AS rid_1#3530, cpfk_orders_lineitem#3486 AS cpfk_orders_lineitem_1#3531, cpfk_supplier_lineitem#3487 AS cpfk_supplier_lineitem_1#3532, cfpk_lineitem_supplier#3488 AS cfpk_lineitem_supplier_1#3533, cfpk_lineitem_partsupp#3489 AS cfpk_lineitem_partsupp_1#3534, cpfk_part_lineitem#3490 AS cpfk_part_lineitem_1#3535, cfpk_lineitem_part#3491 AS cfpk_lineitem_part_1#3536, cpfk_partsupp_lineitem#3492 AS cpfk_partsupp_lineitem_1#3537, cfpk_lineitem_orders#3493 AS cfpk_lineitem_orders_1#3538, cval_lineitem_l_quantity#3494 AS cval_lineitem_l_quantity_1#3539, cval_lineitem_l_extendedprice#3495 AS cval_lineitem_l_extendedprice_1#3540, cval_lineitem_l_discount#3496 AS cval_lineitem_l_discount_1#3541, cval_lineitem_l_tax#3497 AS cval_lineitem_l_tax_1#3542, cval_lineitem_l_returnflag#3498 AS cval_lineitem_l_returnflag_1#3543, cval_lineitem_l_linestatus#3499 AS cval_lineitem_l_linestatus_1#3544, cval_lineitem_l_commitdate#3500 AS cval_lineitem_l_commitdate_1#3545, cval_lineitem_l_receiptdate#3501 AS cval_lineitem_l_receiptdate_1#3546, cval_lineitem_l_shipinstruct#3502 AS cval_lineitem_l_shipinstruct_1#3547, cval_lineitem_l_shipmode#3503 AS cval_lineitem_l_shipmode_1#3548, cval_lineitem_l_comment#3504 AS cval_lineitem_l_comment_1#3549, cval_lineitem_l_shipdate#3505 AS cval_lineitem_l_shipdate_1#3550, cdepval_lineitem_l_quantity#3506 AS cdepval_lineitem_l_quantity_1#3551, cdepval_lineitem_l_extendedprice#3507 AS cdepval_lineitem_l_extendedprice_1#3552, cdepval_lineitem_l_discount#3508 AS cdepval_lineitem_l_discount_1#3553, ... 21 more fields]
         :        +- Relation[rid#3485,cpfk_orders_lineitem#3486,cpfk_supplier_lineitem#3487,cfpk_lineitem_supplier#3488,cfpk_lineitem_partsupp#3489,cpfk_part_lineitem#3490,cfpk_lineitem_part#3491,cpfk_partsupp_lineitem#3492,cfpk_lineitem_orders#3493,cval_lineitem_l_quantity#3494,cval_lineitem_l_extendedprice#3495,cval_lineitem_l_discount#3496,cval_lineitem_l_tax#3497,cval_lineitem_l_returnflag#3498,cval_lineitem_l_linestatus#3499,cval_lineitem_l_commitdate#3500,cval_lineitem_l_receiptdate#3501,cval_lineitem_l_shipinstruct#3502,cval_lineitem_l_shipmode#3503,cval_lineitem_l_comment#3504,cval_lineitem_l_shipdate#3505,cdepval_lineitem_l_quantity#3506,cdepval_lineitem_l_extendedprice#3507,cdepval_lineitem_l_discount#3508,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#3165 AS rid_1#3210, cpfk_orders_lineitem#3166 AS cpfk_orders_lineitem_1#3211, cpfk_supplier_lineitem#3167 AS cpfk_supplier_lineitem_1#3212, cfpk_lineitem_supplier#3168 AS cfpk_lineitem_supplier_1#3213, cfpk_lineitem_partsupp#3169 AS cfpk_lineitem_partsupp_1#3214, cpfk_part_lineitem#3170 AS cpfk_part_lineitem_1#3215, cfpk_lineitem_part#3171 AS cfpk_lineitem_part_1#3216, cpfk_partsupp_lineitem#3172 AS cpfk_partsupp_lineitem_1#3217, cfpk_lineitem_orders#3173 AS cfpk_lineitem_orders_1#3218, cval_lineitem_l_quantity#3174 AS cval_lineitem_l_quantity_1#3219, cval_lineitem_l_extendedprice#3175 AS cval_lineitem_l_extendedprice_1#3220, cval_lineitem_l_discount#3176 AS cval_lineitem_l_discount_1#3221, cval_lineitem_l_tax#3177 AS cval_lineitem_l_tax_1#3222, cval_lineitem_l_returnflag#3178 AS cval_lineitem_l_returnflag_1#3223, cval_lineitem_l_linestatus#3179 AS cval_lineitem_l_linestatus_1#3224, cval_lineitem_l_commitdate#3180 AS cval_lineitem_l_commitdate_1#3225, cval_lineitem_l_receiptdate#3181 AS cval_lineitem_l_receiptdate_1#3226, cval_lineitem_l_shipinstruct#3182 AS cval_lineitem_l_shipinstruct_1#3227, cval_lineitem_l_shipmode#3183 AS cval_lineitem_l_shipmode_1#3228, cval_lineitem_l_comment#3184 AS cval_lineitem_l_comment_1#3229, cval_lineitem_l_shipdate#3185 AS cval_lineitem_l_shipdate_1#3230, cdepval_lineitem_l_quantity#3186 AS cdepval_lineitem_l_quantity_1#3231, cdepval_lineitem_l_extendedprice#3187 AS cdepval_lineitem_l_extendedprice_1#3232, cdepval_lineitem_l_discount#3188 AS cdepval_lineitem_l_discount_1#3233, ... 21 more fields]
                  +- Relation[rid#3165,cpfk_orders_lineitem#3166,cpfk_supplier_lineitem#3167,cfpk_lineitem_supplier#3168,cfpk_lineitem_partsupp#3169,cpfk_part_lineitem#3170,cfpk_lineitem_part#3171,cpfk_partsupp_lineitem#3172,cfpk_lineitem_orders#3173,cval_lineitem_l_quantity#3174,cval_lineitem_l_extendedprice#3175,cval_lineitem_l_discount#3176,cval_lineitem_l_tax#3177,cval_lineitem_l_returnflag#3178,cval_lineitem_l_linestatus#3179,cval_lineitem_l_commitdate#3180,cval_lineitem_l_receiptdate#3181,cval_lineitem_l_shipinstruct#3182,cval_lineitem_l_shipmode#3183,cval_lineitem_l_comment#3184,cval_lineitem_l_shipdate#3185,cdepval_lineitem_l_quantity#3186,cdepval_lineitem_l_extendedprice#3187,cdepval_lineitem_l_discount#3188,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16173ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/25 22:03:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:03:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3649L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:03:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:49 WARN DexPlanner: InMemoryFileIndex=part
20/04/25 22:03:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3649L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#3801 AS rid_1#3846, cpfk_orders_lineitem#3802 AS cpfk_orders_lineitem_1#3847, cpfk_supplier_lineitem#3803 AS cpfk_supplier_lineitem_1#3848, cfpk_lineitem_supplier#3804 AS cfpk_lineitem_supplier_1#3849, cfpk_lineitem_partsupp#3805 AS cfpk_lineitem_partsupp_1#3850, cpfk_part_lineitem#3806 AS cpfk_part_lineitem_1#3851, cfpk_lineitem_part#3807 AS cfpk_lineitem_part_1#3852, cpfk_partsupp_lineitem#3808 AS cpfk_partsupp_lineitem_1#3853, cfpk_lineitem_orders#3809 AS cfpk_lineitem_orders_1#3854, cval_lineitem_l_quantity#3810 AS cval_lineitem_l_quantity_1#3855, cval_lineitem_l_extendedprice#3811 AS cval_lineitem_l_extendedprice_1#3856, cval_lineitem_l_discount#3812 AS cval_lineitem_l_discount_1#3857, cval_lineitem_l_tax#3813 AS cval_lineitem_l_tax_1#3858, cval_lineitem_l_returnflag#3814 AS cval_lineitem_l_returnflag_1#3859, cval_lineitem_l_linestatus#3815 AS cval_lineitem_l_linestatus_1#3860, cval_lineitem_l_commitdate#3816 AS cval_lineitem_l_commitdate_1#3861, cval_lineitem_l_receiptdate#3817 AS cval_lineitem_l_receiptdate_1#3862, cval_lineitem_l_shipinstruct#3818 AS cval_lineitem_l_shipinstruct_1#3863, cval_lineitem_l_shipmode#3819 AS cval_lineitem_l_shipmode_1#3864, cval_lineitem_l_comment#3820 AS cval_lineitem_l_comment_1#3865, cval_lineitem_l_shipdate#3821 AS cval_lineitem_l_shipdate_1#3866, cdepval_lineitem_l_quantity#3822 AS cdepval_lineitem_l_quantity_1#3867, cdepval_lineitem_l_extendedprice#3823 AS cdepval_lineitem_l_extendedprice_1#3868, cdepval_lineitem_l_discount#3824 AS cdepval_lineitem_l_discount_1#3869, ... 21 more fields]
         :  +- Relation[rid#3801,cpfk_orders_lineitem#3802,cpfk_supplier_lineitem#3803,cfpk_lineitem_supplier#3804,cfpk_lineitem_partsupp#3805,cpfk_part_lineitem#3806,cfpk_lineitem_part#3807,cpfk_partsupp_lineitem#3808,cfpk_lineitem_orders#3809,cval_lineitem_l_quantity#3810,cval_lineitem_l_extendedprice#3811,cval_lineitem_l_discount#3812,cval_lineitem_l_tax#3813,cval_lineitem_l_returnflag#3814,cval_lineitem_l_linestatus#3815,cval_lineitem_l_commitdate#3816,cval_lineitem_l_receiptdate#3817,cval_lineitem_l_shipinstruct#3818,cval_lineitem_l_shipmode#3819,cval_lineitem_l_comment#3820,cval_lineitem_l_shipdate#3821,cdepval_lineitem_l_quantity#3822,cdepval_lineitem_l_extendedprice#3823,cdepval_lineitem_l_discount#3824,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
               +- Project [rid#3651 AS rid_0#3676, cval_part_p_name#3652 AS cval_part_p_name_0#3677, cval_part_p_mfgr#3653 AS cval_part_p_mfgr_0#3678, cval_part_p_type#3654 AS cval_part_p_type_0#3679, cval_part_p_size#3655 AS cval_part_p_size_0#3680, cval_part_p_container#3656 AS cval_part_p_container_0#3681, cval_part_p_retailprice#3657 AS cval_part_p_retailprice_0#3682, cval_part_p_comment#3658 AS cval_part_p_comment_0#3683, cval_part_p_brand#3659 AS cval_part_p_brand_0#3684, cdepval_part_p_name#3660 AS cdepval_part_p_name_0#3685, cdepval_part_p_mfgr#3661 AS cdepval_part_p_mfgr_0#3686, cdepval_part_p_type#3662 AS cdepval_part_p_type_0#3687, cdepval_part_p_size#3663 AS cdepval_part_p_size_0#3688, cdepval_part_p_container#3664 AS cdepval_part_p_container_0#3689, cdepval_part_p_retailprice#3665 AS cdepval_part_p_retailprice_0#3690, cdepval_part_p_comment#3666 AS cdepval_part_p_comment_0#3691, cdepval_part_p_brand#3667 AS cdepval_part_p_brand_0#3692, cp_name#3668 AS cp_name_0#3693, cp_mfgr#3669 AS cp_mfgr_0#3694, cp_type#3670 AS cp_type_0#3695, cp_size#3671 AS cp_size_0#3696, cp_container#3672 AS cp_container_0#3697, cp_retailprice#3673 AS cp_retailprice_0#3698, cp_comment#3674 AS cp_comment_0#3699, cp_brand#3675 AS cp_brand_0#3700]
                  +- Relation[rid#3651,cval_part_p_name#3652,cval_part_p_mfgr#3653,cval_part_p_type#3654,cval_part_p_size#3655,cval_part_p_container#3656,cval_part_p_retailprice#3657,cval_part_p_comment#3658,cval_part_p_brand#3659,cdepval_part_p_name#3660,cdepval_part_p_mfgr#3661,cdepval_part_p_type#3662,cdepval_part_p_size#3663,cdepval_part_p_container#3664,cdepval_part_p_retailprice#3665,cdepval_part_p_comment#3666,cdepval_part_p_brand#3667,cp_name#3668,cp_mfgr#3669,cp_type#3670,cp_size#3671,cp_container#3672,cp_retailprice#3673,cp_comment#3674,cp_brand#3675] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 25759ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/25 22:04:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:04:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3970L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:04:15 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:04:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3970L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#4026 AS rid_2#4071, cpfk_orders_lineitem#4027 AS cpfk_orders_lineitem_2#4072, cpfk_supplier_lineitem#4028 AS cpfk_supplier_lineitem_2#4073, cfpk_lineitem_supplier#4029 AS cfpk_lineitem_supplier_2#4074, cfpk_lineitem_partsupp#4030 AS cfpk_lineitem_partsupp_2#4075, cpfk_part_lineitem#4031 AS cpfk_part_lineitem_2#4076, cfpk_lineitem_part#4032 AS cfpk_lineitem_part_2#4077, cpfk_partsupp_lineitem#4033 AS cpfk_partsupp_lineitem_2#4078, cfpk_lineitem_orders#4034 AS cfpk_lineitem_orders_2#4079, cval_lineitem_l_quantity#4035 AS cval_lineitem_l_quantity_2#4080, cval_lineitem_l_extendedprice#4036 AS cval_lineitem_l_extendedprice_2#4081, cval_lineitem_l_discount#4037 AS cval_lineitem_l_discount_2#4082, cval_lineitem_l_tax#4038 AS cval_lineitem_l_tax_2#4083, cval_lineitem_l_returnflag#4039 AS cval_lineitem_l_returnflag_2#4084, cval_lineitem_l_linestatus#4040 AS cval_lineitem_l_linestatus_2#4085, cval_lineitem_l_commitdate#4041 AS cval_lineitem_l_commitdate_2#4086, cval_lineitem_l_receiptdate#4042 AS cval_lineitem_l_receiptdate_2#4087, cval_lineitem_l_shipinstruct#4043 AS cval_lineitem_l_shipinstruct_2#4088, cval_lineitem_l_shipmode#4044 AS cval_lineitem_l_shipmode_2#4089, cval_lineitem_l_comment#4045 AS cval_lineitem_l_comment_2#4090, cval_lineitem_l_shipdate#4046 AS cval_lineitem_l_shipdate_2#4091, cdepval_lineitem_l_quantity#4047 AS cdepval_lineitem_l_quantity_2#4092, cdepval_lineitem_l_extendedprice#4048 AS cdepval_lineitem_l_extendedprice_2#4093, cdepval_lineitem_l_discount#4049 AS cdepval_lineitem_l_discount_2#4094, ... 21 more fields]
         :  :  :  :  +- Relation[rid#4026,cpfk_orders_lineitem#4027,cpfk_supplier_lineitem#4028,cfpk_lineitem_supplier#4029,cfpk_lineitem_partsupp#4030,cpfk_part_lineitem#4031,cfpk_lineitem_part#4032,cpfk_partsupp_lineitem#4033,cfpk_lineitem_orders#4034,cval_lineitem_l_quantity#4035,cval_lineitem_l_extendedprice#4036,cval_lineitem_l_discount#4037,cval_lineitem_l_tax#4038,cval_lineitem_l_returnflag#4039,cval_lineitem_l_linestatus#4040,cval_lineitem_l_commitdate#4041,cval_lineitem_l_receiptdate#4042,cval_lineitem_l_shipinstruct#4043,cval_lineitem_l_shipmode#4044,cval_lineitem_l_comment#4045,cval_lineitem_l_shipdate#4046,cdepval_lineitem_l_quantity#4047,cdepval_lineitem_l_extendedprice#4048,cdepval_lineitem_l_discount#4049,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#3990 AS rid_1#4008, cpfk_nation_supplier#3991 AS cpfk_nation_supplier_1#4009, cfpk_supplier_nation#3992 AS cfpk_supplier_nation_1#4010, cval_supplier_s_name#3993 AS cval_supplier_s_name_1#4011, cval_supplier_s_address#3994 AS cval_supplier_s_address_1#4012, cval_supplier_s_phone#3995 AS cval_supplier_s_phone_1#4013, cval_supplier_s_acctbal#3996 AS cval_supplier_s_acctbal_1#4014, cval_supplier_s_comment#3997 AS cval_supplier_s_comment_1#4015, cdepval_supplier_s_name#3998 AS cdepval_supplier_s_name_1#4016, cdepval_supplier_s_address#3999 AS cdepval_supplier_s_address_1#4017, cdepval_supplier_s_phone#4000 AS cdepval_supplier_s_phone_1#4018, cdepval_supplier_s_acctbal#4001 AS cdepval_supplier_s_acctbal_1#4019, cdepval_supplier_s_comment#4002 AS cdepval_supplier_s_comment_1#4020, cs_name#4003 AS cs_name_1#4021, cs_address#4004 AS cs_address_1#4022, cs_phone#4005 AS cs_phone_1#4023, cs_acctbal#4006 AS cs_acctbal_1#4024, cs_comment#4007 AS cs_comment_1#4025]
         :  :  :     :  +- Relation[rid#3990,cpfk_nation_supplier#3991,cfpk_supplier_nation#3992,cval_supplier_s_name#3993,cval_supplier_s_address#3994,cval_supplier_s_phone#3995,cval_supplier_s_acctbal#3996,cval_supplier_s_comment#3997,cdepval_supplier_s_name#3998,cdepval_supplier_s_address#3999,cdepval_supplier_s_phone#4000,cdepval_supplier_s_acctbal#4001,cdepval_supplier_s_comment#4002,cs_name#4003,cs_address#4004,cs_phone#4005,cs_acctbal#4006,cs_comment#4007] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#3972 AS rid_0#3981, cpfk_region_nation#3973 AS cpfk_region_nation_0#3982, cfpk_nation_region#3974 AS cfpk_nation_region_0#3983, cval_nation_n_name#3975 AS cval_nation_n_name_0#3984, cval_nation_n_comment#3976 AS cval_nation_n_comment_0#3985, cdepval_nation_n_name#3977 AS cdepval_nation_n_name_0#3986, cdepval_nation_n_comment#3978 AS cdepval_nation_n_comment_0#3987, cn_name#3979 AS cn_name_0#3988, cn_comment#3980 AS cn_comment_0#3989]
         :  :  :        +- Relation[rid#3972,cpfk_region_nation#3973,cfpk_nation_region#3974,cval_nation_n_name#3975,cval_nation_n_comment#3976,cdepval_nation_n_name#3977,cdepval_nation_n_comment#3978,cn_name#3979,cn_comment#3980] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#4116 AS rid_3#4141, cval_part_p_name#4117 AS cval_part_p_name_3#4142, cval_part_p_mfgr#4118 AS cval_part_p_mfgr_3#4143, cval_part_p_type#4119 AS cval_part_p_type_3#4144, cval_part_p_size#4120 AS cval_part_p_size_3#4145, cval_part_p_container#4121 AS cval_part_p_container_3#4146, cval_part_p_retailprice#4122 AS cval_part_p_retailprice_3#4147, cval_part_p_comment#4123 AS cval_part_p_comment_3#4148, cval_part_p_brand#4124 AS cval_part_p_brand_3#4149, cdepval_part_p_name#4125 AS cdepval_part_p_name_3#4150, cdepval_part_p_mfgr#4126 AS cdepval_part_p_mfgr_3#4151, cdepval_part_p_type#4127 AS cdepval_part_p_type_3#4152, cdepval_part_p_size#4128 AS cdepval_part_p_size_3#4153, cdepval_part_p_container#4129 AS cdepval_part_p_container_3#4154, cdepval_part_p_retailprice#4130 AS cdepval_part_p_retailprice_3#4155, cdepval_part_p_comment#4131 AS cdepval_part_p_comment_3#4156, cdepval_part_p_brand#4132 AS cdepval_part_p_brand_3#4157, cp_name#4133 AS cp_name_3#4158, cp_mfgr#4134 AS cp_mfgr_3#4159, cp_type#4135 AS cp_type_3#4160, cp_size#4136 AS cp_size_3#4161, cp_container#4137 AS cp_container_3#4162, cp_retailprice#4138 AS cp_retailprice_3#4163, cp_comment#4139 AS cp_comment_3#4164, cp_brand#4140 AS cp_brand_3#4165]
         :  :     +- Relation[rid#4116,cval_part_p_name#4117,cval_part_p_mfgr#4118,cval_part_p_type#4119,cval_part_p_size#4120,cval_part_p_container#4121,cval_part_p_retailprice#4122,cval_part_p_comment#4123,cval_part_p_brand#4124,cdepval_part_p_name#4125,cdepval_part_p_mfgr#4126,cdepval_part_p_type#4127,cdepval_part_p_size#4128,cdepval_part_p_container#4129,cdepval_part_p_retailprice#4130,cdepval_part_p_comment#4131,cdepval_part_p_brand#4132,cp_name#4133,cp_mfgr#4134,cp_type#4135,cp_size#4136,cp_container#4137,cp_retailprice#4138,cp_comment#4139,cp_brand#4140] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#4166 AS rid_4#4180, cpfk_part_partsupp#4167 AS cpfk_part_partsupp_4#4181, cfpk_partsupp_part#4168 AS cfpk_partsupp_part_4#4182, cpfk_supplier_partsupp#4169 AS cpfk_supplier_partsupp_4#4183, cfpk_partsupp_supplier#4170 AS cfpk_partsupp_supplier_4#4184, cval_partsupp_ps_availqty#4171 AS cval_partsupp_ps_availqty_4#4185, cval_partsupp_ps_supplycost#4172 AS cval_partsupp_ps_supplycost_4#4186, cval_partsupp_ps_comment#4173 AS cval_partsupp_ps_comment_4#4187, cdepval_partsupp_ps_availqty#4174 AS cdepval_partsupp_ps_availqty_4#4188, cdepval_partsupp_ps_supplycost#4175 AS cdepval_partsupp_ps_supplycost_4#4189, cdepval_partsupp_ps_comment#4176 AS cdepval_partsupp_ps_comment_4#4190, cps_availqty#4177 AS cps_availqty_4#4191, cps_supplycost#4178 AS cps_supplycost_4#4192, cps_comment#4179 AS cps_comment_4#4193]
         :     +- Relation[rid#4166,cpfk_part_partsupp#4167,cfpk_partsupp_part#4168,cpfk_supplier_partsupp#4169,cfpk_partsupp_supplier#4170,cval_partsupp_ps_availqty#4171,cval_partsupp_ps_supplycost#4172,cval_partsupp_ps_comment#4173,cdepval_partsupp_ps_availqty#4174,cdepval_partsupp_ps_supplycost#4175,cdepval_partsupp_ps_comment#4176,cps_availqty#4177,cps_supplycost#4178,cps_comment#4179] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#4194 AS rid_5#4218, cpfk_customer_orders#4195 AS cpfk_customer_orders_5#4219, cfpk_orders_customer#4196 AS cfpk_orders_customer_5#4220, cval_orders_o_orderstatus#4197 AS cval_orders_o_orderstatus_5#4221, cval_orders_o_totalprice#4198 AS cval_orders_o_totalprice_5#4222, cval_orders_o_orderpriority#4199 AS cval_orders_o_orderpriority_5#4223, cval_orders_o_clerk#4200 AS cval_orders_o_clerk_5#4224, cval_orders_o_shippriority#4201 AS cval_orders_o_shippriority_5#4225, cval_orders_o_comment#4202 AS cval_orders_o_comment_5#4226, cval_orders_o_orderdate#4203 AS cval_orders_o_orderdate_5#4227, cdepval_orders_o_orderstatus#4204 AS cdepval_orders_o_orderstatus_5#4228, cdepval_orders_o_totalprice#4205 AS cdepval_orders_o_totalprice_5#4229, cdepval_orders_o_orderpriority#4206 AS cdepval_orders_o_orderpriority_5#4230, cdepval_orders_o_clerk#4207 AS cdepval_orders_o_clerk_5#4231, cdepval_orders_o_shippriority#4208 AS cdepval_orders_o_shippriority_5#4232, cdepval_orders_o_comment#4209 AS cdepval_orders_o_comment_5#4233, cdepval_orders_o_orderdate#4210 AS cdepval_orders_o_orderdate_5#4234, co_orderstatus#4211 AS co_orderstatus_5#4235, co_totalprice#4212 AS co_totalprice_5#4236, co_orderpriority#4213 AS co_orderpriority_5#4237, co_clerk#4214 AS co_clerk_5#4238, co_shippriority#4215 AS co_shippriority_5#4239, co_comment#4216 AS co_comment_5#4240, co_orderdate#4217 AS co_orderdate_5#4241]
            +- Relation[rid#4194,cpfk_customer_orders#4195,cfpk_orders_customer#4196,cval_orders_o_orderstatus#4197,cval_orders_o_totalprice#4198,cval_orders_o_orderpriority#4199,cval_orders_o_clerk#4200,cval_orders_o_shippriority#4201,cval_orders_o_comment#4202,cval_orders_o_orderdate#4203,cdepval_orders_o_orderstatus#4204,cdepval_orders_o_totalprice#4205,cdepval_orders_o_orderpriority#4206,cdepval_orders_o_clerk#4207,cdepval_orders_o_shippriority#4208,cdepval_orders_o_comment#4209,cdepval_orders_o_orderdate#4210,co_orderstatus#4211,co_totalprice#4212,co_orderpriority#4213,co_clerk#4214,co_shippriority#4215,co_comment#4216,co_orderdate#4217] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63950ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/25 22:05:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:05:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4381L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:05:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:05:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4381L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_part_4) = 'rid_3)
         :  :- Project [rid#4565 AS rid_4#4579, cpfk_part_partsupp#4566 AS cpfk_part_partsupp_4#4580, cfpk_partsupp_part#4567 AS cfpk_partsupp_part_4#4581, cpfk_supplier_partsupp#4568 AS cpfk_supplier_partsupp_4#4582, cfpk_partsupp_supplier#4569 AS cfpk_partsupp_supplier_4#4583, cval_partsupp_ps_availqty#4570 AS cval_partsupp_ps_availqty_4#4584, cval_partsupp_ps_supplycost#4571 AS cval_partsupp_ps_supplycost_4#4585, cval_partsupp_ps_comment#4572 AS cval_partsupp_ps_comment_4#4586, cdepval_partsupp_ps_availqty#4573 AS cdepval_partsupp_ps_availqty_4#4587, cdepval_partsupp_ps_supplycost#4574 AS cdepval_partsupp_ps_supplycost_4#4588, cdepval_partsupp_ps_comment#4575 AS cdepval_partsupp_ps_comment_4#4589, cps_availqty#4576 AS cps_availqty_4#4590, cps_supplycost#4577 AS cps_supplycost_4#4591, cps_comment#4578 AS cps_comment_4#4592]
         :  :  +- Relation[rid#4565,cpfk_part_partsupp#4566,cfpk_partsupp_part#4567,cpfk_supplier_partsupp#4568,cfpk_partsupp_supplier#4569,cval_partsupp_ps_availqty#4570,cval_partsupp_ps_supplycost#4571,cval_partsupp_ps_comment#4572,cdepval_partsupp_ps_availqty#4573,cdepval_partsupp_ps_supplycost#4574,cdepval_partsupp_ps_comment#4575,cps_availqty#4576,cps_supplycost#4577,cps_comment#4578] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :     +- Project [rid#4465 AS rid_3#4490, cval_part_p_name#4466 AS cval_part_p_name_3#4491, cval_part_p_mfgr#4467 AS cval_part_p_mfgr_3#4492, cval_part_p_type#4468 AS cval_part_p_type_3#4493, cval_part_p_size#4469 AS cval_part_p_size_3#4494, cval_part_p_container#4470 AS cval_part_p_container_3#4495, cval_part_p_retailprice#4471 AS cval_part_p_retailprice_3#4496, cval_part_p_comment#4472 AS cval_part_p_comment_3#4497, cval_part_p_brand#4473 AS cval_part_p_brand_3#4498, cdepval_part_p_name#4474 AS cdepval_part_p_name_3#4499, cdepval_part_p_mfgr#4475 AS cdepval_part_p_mfgr_3#4500, cdepval_part_p_type#4476 AS cdepval_part_p_type_3#4501, cdepval_part_p_size#4477 AS cdepval_part_p_size_3#4502, cdepval_part_p_container#4478 AS cdepval_part_p_container_3#4503, cdepval_part_p_retailprice#4479 AS cdepval_part_p_retailprice_3#4504, cdepval_part_p_comment#4480 AS cdepval_part_p_comment_3#4505, cdepval_part_p_brand#4481 AS cdepval_part_p_brand_3#4506, cp_name#4482 AS cp_name_3#4507, cp_mfgr#4483 AS cp_mfgr_3#4508, cp_type#4484 AS cp_type_3#4509, cp_size#4485 AS cp_size_3#4510, cp_container#4486 AS cp_container_3#4511, cp_retailprice#4487 AS cp_retailprice_3#4512, cp_comment#4488 AS cp_comment_3#4513, cp_brand#4489 AS cp_brand_3#4514]
         :        +- Relation[rid#4465,cval_part_p_name#4466,cval_part_p_mfgr#4467,cval_part_p_type#4468,cval_part_p_size#4469,cval_part_p_container#4470,cval_part_p_retailprice#4471,cval_part_p_comment#4472,cval_part_p_brand#4473,cdepval_part_p_name#4474,cdepval_part_p_mfgr#4475,cdepval_part_p_type#4476,cdepval_part_p_size#4477,cdepval_part_p_container#4478,cdepval_part_p_retailprice#4479,cdepval_part_p_comment#4480,cdepval_part_p_brand#4481,cp_name#4482,cp_mfgr#4483,cp_type#4484,cp_size#4485,cp_container#4486,cp_retailprice#4487,cp_comment#4488,cp_brand#4489] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#4429 AS rid_2#4447, cpfk_nation_supplier#4430 AS cpfk_nation_supplier_2#4448, cfpk_supplier_nation#4431 AS cfpk_supplier_nation_2#4449, cval_supplier_s_name#4432 AS cval_supplier_s_name_2#4450, cval_supplier_s_address#4433 AS cval_supplier_s_address_2#4451, cval_supplier_s_phone#4434 AS cval_supplier_s_phone_2#4452, cval_supplier_s_acctbal#4435 AS cval_supplier_s_acctbal_2#4453, cval_supplier_s_comment#4436 AS cval_supplier_s_comment_2#4454, cdepval_supplier_s_name#4437 AS cdepval_supplier_s_name_2#4455, cdepval_supplier_s_address#4438 AS cdepval_supplier_s_address_2#4456, cdepval_supplier_s_phone#4439 AS cdepval_supplier_s_phone_2#4457, cdepval_supplier_s_acctbal#4440 AS cdepval_supplier_s_acctbal_2#4458, cdepval_supplier_s_comment#4441 AS cdepval_supplier_s_comment_2#4459, cs_name#4442 AS cs_name_2#4460, cs_address#4443 AS cs_address_2#4461, cs_phone#4444 AS cs_phone_2#4462, cs_acctbal#4445 AS cs_acctbal_2#4463, cs_comment#4446 AS cs_comment_2#4464]
            :  +- Relation[rid#4429,cpfk_nation_supplier#4430,cfpk_supplier_nation#4431,cval_supplier_s_name#4432,cval_supplier_s_address#4433,cval_supplier_s_phone#4434,cval_supplier_s_acctbal#4435,cval_supplier_s_comment#4436,cdepval_supplier_s_name#4437,cdepval_supplier_s_address#4438,cdepval_supplier_s_phone#4439,cdepval_supplier_s_acctbal#4440,cdepval_supplier_s_comment#4441,cs_name#4442,cs_address#4443,cs_phone#4444,cs_acctbal#4445,cs_comment#4446] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
               :- Project [rid#4411 AS rid_1#4420, cpfk_region_nation#4412 AS cpfk_region_nation_1#4421, cfpk_nation_region#4413 AS cfpk_nation_region_1#4422, cval_nation_n_name#4414 AS cval_nation_n_name_1#4423, cval_nation_n_comment#4415 AS cval_nation_n_comment_1#4424, cdepval_nation_n_name#4416 AS cdepval_nation_n_name_1#4425, cdepval_nation_n_comment#4417 AS cdepval_nation_n_comment_1#4426, cn_name#4418 AS cn_name_1#4427, cn_comment#4419 AS cn_comment_1#4428]
               :  +- Relation[rid#4411,cpfk_region_nation#4412,cfpk_nation_region#4413,cval_nation_n_name#4414,cval_nation_n_comment#4415,cdepval_nation_n_name#4416,cdepval_nation_n_comment#4417,cn_name#4418,cn_comment#4419] JDBCRelation(tnation) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
                  +- Project [rid#4383 AS rid_0#4390, cval_region_r_name#4384 AS cval_region_r_name_0#4391, cval_region_r_comment#4385 AS cval_region_r_comment_0#4392, cdepval_region_r_name#4386 AS cdepval_region_r_name_0#4393, cdepval_region_r_comment#4387 AS cdepval_region_r_comment_0#4394, cr_name#4388 AS cr_name_0#4395, cr_comment#4389 AS cr_comment_0#4396]
                     +- Relation[rid#4383,cval_region_r_name#4384,cval_region_r_comment#4385,cdepval_region_r_name#4386,cdepval_region_r_comment#4387,cr_name#4388,cr_comment#4389] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 3659ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/25 22:05:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:05:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4674L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:05:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4674L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#4748 AS rid_2#4793, cpfk_orders_lineitem#4749 AS cpfk_orders_lineitem_2#4794, cpfk_supplier_lineitem#4750 AS cpfk_supplier_lineitem_2#4795, cfpk_lineitem_supplier#4751 AS cfpk_lineitem_supplier_2#4796, cfpk_lineitem_partsupp#4752 AS cfpk_lineitem_partsupp_2#4797, cpfk_part_lineitem#4753 AS cpfk_part_lineitem_2#4798, cfpk_lineitem_part#4754 AS cfpk_lineitem_part_2#4799, cpfk_partsupp_lineitem#4755 AS cpfk_partsupp_lineitem_2#4800, cfpk_lineitem_orders#4756 AS cfpk_lineitem_orders_2#4801, cval_lineitem_l_quantity#4757 AS cval_lineitem_l_quantity_2#4802, cval_lineitem_l_extendedprice#4758 AS cval_lineitem_l_extendedprice_2#4803, cval_lineitem_l_discount#4759 AS cval_lineitem_l_discount_2#4804, cval_lineitem_l_tax#4760 AS cval_lineitem_l_tax_2#4805, cval_lineitem_l_returnflag#4761 AS cval_lineitem_l_returnflag_2#4806, cval_lineitem_l_linestatus#4762 AS cval_lineitem_l_linestatus_2#4807, cval_lineitem_l_commitdate#4763 AS cval_lineitem_l_commitdate_2#4808, cval_lineitem_l_receiptdate#4764 AS cval_lineitem_l_receiptdate_2#4809, cval_lineitem_l_shipinstruct#4765 AS cval_lineitem_l_shipinstruct_2#4810, cval_lineitem_l_shipmode#4766 AS cval_lineitem_l_shipmode_2#4811, cval_lineitem_l_comment#4767 AS cval_lineitem_l_comment_2#4812, cval_lineitem_l_shipdate#4768 AS cval_lineitem_l_shipdate_2#4813, cdepval_lineitem_l_quantity#4769 AS cdepval_lineitem_l_quantity_2#4814, cdepval_lineitem_l_extendedprice#4770 AS cdepval_lineitem_l_extendedprice_2#4815, cdepval_lineitem_l_discount#4771 AS cdepval_lineitem_l_discount_2#4816, ... 21 more fields]
         :  :  +- Relation[rid#4748,cpfk_orders_lineitem#4749,cpfk_supplier_lineitem#4750,cfpk_lineitem_supplier#4751,cfpk_lineitem_partsupp#4752,cpfk_part_lineitem#4753,cfpk_lineitem_part#4754,cpfk_partsupp_lineitem#4755,cfpk_lineitem_orders#4756,cval_lineitem_l_quantity#4757,cval_lineitem_l_extendedprice#4758,cval_lineitem_l_discount#4759,cval_lineitem_l_tax#4760,cval_lineitem_l_returnflag#4761,cval_lineitem_l_linestatus#4762,cval_lineitem_l_commitdate#4763,cval_lineitem_l_receiptdate#4764,cval_lineitem_l_shipinstruct#4765,cval_lineitem_l_shipmode#4766,cval_lineitem_l_comment#4767,cval_lineitem_l_shipdate#4768,cdepval_lineitem_l_quantity#4769,cdepval_lineitem_l_extendedprice#4770,cdepval_lineitem_l_discount#4771,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :- Project [rid#4712 AS rid_1#4730, cpfk_nation_supplier#4713 AS cpfk_nation_supplier_1#4731, cfpk_supplier_nation#4714 AS cfpk_supplier_nation_1#4732, cval_supplier_s_name#4715 AS cval_supplier_s_name_1#4733, cval_supplier_s_address#4716 AS cval_supplier_s_address_1#4734, cval_supplier_s_phone#4717 AS cval_supplier_s_phone_1#4735, cval_supplier_s_acctbal#4718 AS cval_supplier_s_acctbal_1#4736, cval_supplier_s_comment#4719 AS cval_supplier_s_comment_1#4737, cdepval_supplier_s_name#4720 AS cdepval_supplier_s_name_1#4738, cdepval_supplier_s_address#4721 AS cdepval_supplier_s_address_1#4739, cdepval_supplier_s_phone#4722 AS cdepval_supplier_s_phone_1#4740, cdepval_supplier_s_acctbal#4723 AS cdepval_supplier_s_acctbal_1#4741, cdepval_supplier_s_comment#4724 AS cdepval_supplier_s_comment_1#4742, cs_name#4725 AS cs_name_1#4743, cs_address#4726 AS cs_address_1#4744, cs_phone#4727 AS cs_phone_1#4745, cs_acctbal#4728 AS cs_acctbal_1#4746, cs_comment#4729 AS cs_comment_1#4747]
         :     :  +- Relation[rid#4712,cpfk_nation_supplier#4713,cfpk_supplier_nation#4714,cval_supplier_s_name#4715,cval_supplier_s_address#4716,cval_supplier_s_phone#4717,cval_supplier_s_acctbal#4718,cval_supplier_s_comment#4719,cdepval_supplier_s_name#4720,cdepval_supplier_s_address#4721,cdepval_supplier_s_phone#4722,cdepval_supplier_s_acctbal#4723,cdepval_supplier_s_comment#4724,cs_name#4725,cs_address#4726,cs_phone#4727,cs_acctbal#4728,cs_comment#4729] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :        +- Project [rid#4676 AS rid_0#4685, cpfk_region_nation#4677 AS cpfk_region_nation_0#4686, cfpk_nation_region#4678 AS cfpk_nation_region_0#4687, cval_nation_n_name#4679 AS cval_nation_n_name_0#4688, cval_nation_n_comment#4680 AS cval_nation_n_comment_0#4689, cdepval_nation_n_name#4681 AS cdepval_nation_n_name_0#4690, cdepval_nation_n_comment#4682 AS cdepval_nation_n_comment_0#4691, cn_name#4683 AS cn_name_0#4692, cn_comment#4684 AS cn_comment_0#4693]
         :           +- Relation[rid#4676,cpfk_region_nation#4677,cfpk_nation_region#4678,cval_nation_n_name#4679,cval_nation_n_comment#4680,cdepval_nation_n_name#4681,cdepval_nation_n_comment#4682,cn_name#4683,cn_comment#4684] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#4916 AS rid_5#4940, cpfk_customer_orders#4917 AS cpfk_customer_orders_5#4941, cfpk_orders_customer#4918 AS cfpk_orders_customer_5#4942, cval_orders_o_orderstatus#4919 AS cval_orders_o_orderstatus_5#4943, cval_orders_o_totalprice#4920 AS cval_orders_o_totalprice_5#4944, cval_orders_o_orderpriority#4921 AS cval_orders_o_orderpriority_5#4945, cval_orders_o_clerk#4922 AS cval_orders_o_clerk_5#4946, cval_orders_o_shippriority#4923 AS cval_orders_o_shippriority_5#4947, cval_orders_o_comment#4924 AS cval_orders_o_comment_5#4948, cval_orders_o_orderdate#4925 AS cval_orders_o_orderdate_5#4949, cdepval_orders_o_orderstatus#4926 AS cdepval_orders_o_orderstatus_5#4950, cdepval_orders_o_totalprice#4927 AS cdepval_orders_o_totalprice_5#4951, cdepval_orders_o_orderpriority#4928 AS cdepval_orders_o_orderpriority_5#4952, cdepval_orders_o_clerk#4929 AS cdepval_orders_o_clerk_5#4953, cdepval_orders_o_shippriority#4930 AS cdepval_orders_o_shippriority_5#4954, cdepval_orders_o_comment#4931 AS cdepval_orders_o_comment_5#4955, cdepval_orders_o_orderdate#4932 AS cdepval_orders_o_orderdate_5#4956, co_orderstatus#4933 AS co_orderstatus_5#4957, co_totalprice#4934 AS co_totalprice_5#4958, co_orderpriority#4935 AS co_orderpriority_5#4959, co_clerk#4936 AS co_clerk_5#4960, co_shippriority#4937 AS co_shippriority_5#4961, co_comment#4938 AS co_comment_5#4962, co_orderdate#4939 AS co_orderdate_5#4963]
            :  +- Relation[rid#4916,cpfk_customer_orders#4917,cfpk_orders_customer#4918,cval_orders_o_orderstatus#4919,cval_orders_o_totalprice#4920,cval_orders_o_orderpriority#4921,cval_orders_o_clerk#4922,cval_orders_o_shippriority#4923,cval_orders_o_comment#4924,cval_orders_o_orderdate#4925,cdepval_orders_o_orderstatus#4926,cdepval_orders_o_totalprice#4927,cdepval_orders_o_orderpriority#4928,cdepval_orders_o_clerk#4929,cdepval_orders_o_shippriority#4930,cdepval_orders_o_comment#4931,cdepval_orders_o_orderdate#4932,co_orderstatus#4933,co_totalprice#4934,co_orderpriority#4935,co_clerk#4936,co_shippriority#4937,co_comment#4938,co_orderdate#4939] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_4, BinaryType)), 'cfpk_customer_nation_4) = 'rid_3)
               :- Project [rid#4874 AS rid_4#4895, cpfk_nation_customer#4875 AS cpfk_nation_customer_4#4896, cfpk_customer_nation#4876 AS cfpk_customer_nation_4#4897, cval_customer_c_name#4877 AS cval_customer_c_name_4#4898, cval_customer_c_address#4878 AS cval_customer_c_address_4#4899, cval_customer_c_phone#4879 AS cval_customer_c_phone_4#4900, cval_customer_c_acctbal#4880 AS cval_customer_c_acctbal_4#4901, cval_customer_c_comment#4881 AS cval_customer_c_comment_4#4902, cval_customer_c_mktsegment#4882 AS cval_customer_c_mktsegment_4#4903, cdepval_customer_c_name#4883 AS cdepval_customer_c_name_4#4904, cdepval_customer_c_address#4884 AS cdepval_customer_c_address_4#4905, cdepval_customer_c_phone#4885 AS cdepval_customer_c_phone_4#4906, cdepval_customer_c_acctbal#4886 AS cdepval_customer_c_acctbal_4#4907, cdepval_customer_c_comment#4887 AS cdepval_customer_c_comment_4#4908, cdepval_customer_c_mktsegment#4888 AS cdepval_customer_c_mktsegment_4#4909, cc_name#4889 AS cc_name_4#4910, cc_address#4890 AS cc_address_4#4911, cc_phone#4891 AS cc_phone_4#4912, cc_acctbal#4892 AS cc_acctbal_4#4913, cc_comment#4893 AS cc_comment_4#4914, cc_mktsegment#4894 AS cc_mktsegment_4#4915]
               :  +- Relation[rid#4874,cpfk_nation_customer#4875,cfpk_customer_nation#4876,cval_customer_c_name#4877,cval_customer_c_address#4878,cval_customer_c_phone#4879,cval_customer_c_acctbal#4880,cval_customer_c_comment#4881,cval_customer_c_mktsegment#4882,cdepval_customer_c_name#4883,cdepval_customer_c_address#4884,cdepval_customer_c_phone#4885,cdepval_customer_c_acctbal#4886,cdepval_customer_c_comment#4887,cdepval_customer_c_mktsegment#4888,cc_name#4889,cc_address#4890,cc_phone#4891,cc_acctbal#4892,cc_comment#4893,cc_mktsegment#4894] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
                  +- Project [rid#4838 AS rid_3#4847, cpfk_region_nation#4839 AS cpfk_region_nation_3#4848, cfpk_nation_region#4840 AS cfpk_nation_region_3#4849, cval_nation_n_name#4841 AS cval_nation_n_name_3#4850, cval_nation_n_comment#4842 AS cval_nation_n_comment_3#4851, cdepval_nation_n_name#4843 AS cdepval_nation_n_name_3#4852, cdepval_nation_n_comment#4844 AS cdepval_nation_n_comment_3#4853, cn_name#4845 AS cn_name_3#4854, cn_comment#4846 AS cn_comment_3#4855]
                     +- Relation[rid#4838,cpfk_region_nation#4839,cfpk_nation_region#4840,cval_nation_n_name#4841,cval_nation_n_comment#4842,cdepval_nation_n_name#4843,cdepval_nation_n_comment#4844,cn_name#4845,cn_comment#4846] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 35236ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/25 22:05:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:05:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5095L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:05:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5095L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5097 AS rid_0#5142, cpfk_orders_lineitem#5098 AS cpfk_orders_lineitem_0#5143, cpfk_supplier_lineitem#5099 AS cpfk_supplier_lineitem_0#5144, cfpk_lineitem_supplier#5100 AS cfpk_lineitem_supplier_0#5145, cfpk_lineitem_partsupp#5101 AS cfpk_lineitem_partsupp_0#5146, cpfk_part_lineitem#5102 AS cpfk_part_lineitem_0#5147, cfpk_lineitem_part#5103 AS cfpk_lineitem_part_0#5148, cpfk_partsupp_lineitem#5104 AS cpfk_partsupp_lineitem_0#5149, cfpk_lineitem_orders#5105 AS cfpk_lineitem_orders_0#5150, cval_lineitem_l_quantity#5106 AS cval_lineitem_l_quantity_0#5151, cval_lineitem_l_extendedprice#5107 AS cval_lineitem_l_extendedprice_0#5152, cval_lineitem_l_discount#5108 AS cval_lineitem_l_discount_0#5153, cval_lineitem_l_tax#5109 AS cval_lineitem_l_tax_0#5154, cval_lineitem_l_returnflag#5110 AS cval_lineitem_l_returnflag_0#5155, cval_lineitem_l_linestatus#5111 AS cval_lineitem_l_linestatus_0#5156, cval_lineitem_l_commitdate#5112 AS cval_lineitem_l_commitdate_0#5157, cval_lineitem_l_receiptdate#5113 AS cval_lineitem_l_receiptdate_0#5158, cval_lineitem_l_shipinstruct#5114 AS cval_lineitem_l_shipinstruct_0#5159, cval_lineitem_l_shipmode#5115 AS cval_lineitem_l_shipmode_0#5160, cval_lineitem_l_comment#5116 AS cval_lineitem_l_comment_0#5161, cval_lineitem_l_shipdate#5117 AS cval_lineitem_l_shipdate_0#5162, cdepval_lineitem_l_quantity#5118 AS cdepval_lineitem_l_quantity_0#5163, cdepval_lineitem_l_extendedprice#5119 AS cdepval_lineitem_l_extendedprice_0#5164, cdepval_lineitem_l_discount#5120 AS cdepval_lineitem_l_discount_0#5165, ... 21 more fields]
         +- Relation[rid#5097,cpfk_orders_lineitem#5098,cpfk_supplier_lineitem#5099,cfpk_lineitem_supplier#5100,cfpk_lineitem_partsupp#5101,cpfk_part_lineitem#5102,cfpk_lineitem_part#5103,cpfk_partsupp_lineitem#5104,cfpk_lineitem_orders#5105,cval_lineitem_l_quantity#5106,cval_lineitem_l_extendedprice#5107,cval_lineitem_l_discount#5108,cval_lineitem_l_tax#5109,cval_lineitem_l_returnflag#5110,cval_lineitem_l_linestatus#5111,cval_lineitem_l_commitdate#5112,cval_lineitem_l_receiptdate#5113,cval_lineitem_l_shipinstruct#5114,cval_lineitem_l_shipmode#5115,cval_lineitem_l_comment#5116,cval_lineitem_l_shipdate#5117,cdepval_lineitem_l_quantity#5118,cdepval_lineitem_l_extendedprice#5119,cdepval_lineitem_l_discount#5120,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2438ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/25 22:06:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:06:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5236L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:06:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5236L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#5238 AS rid_0#5283, cpfk_orders_lineitem#5239 AS cpfk_orders_lineitem_0#5284, cpfk_supplier_lineitem#5240 AS cpfk_supplier_lineitem_0#5285, cfpk_lineitem_supplier#5241 AS cfpk_lineitem_supplier_0#5286, cfpk_lineitem_partsupp#5242 AS cfpk_lineitem_partsupp_0#5287, cpfk_part_lineitem#5243 AS cpfk_part_lineitem_0#5288, cfpk_lineitem_part#5244 AS cfpk_lineitem_part_0#5289, cpfk_partsupp_lineitem#5245 AS cpfk_partsupp_lineitem_0#5290, cfpk_lineitem_orders#5246 AS cfpk_lineitem_orders_0#5291, cval_lineitem_l_quantity#5247 AS cval_lineitem_l_quantity_0#5292, cval_lineitem_l_extendedprice#5248 AS cval_lineitem_l_extendedprice_0#5293, cval_lineitem_l_discount#5249 AS cval_lineitem_l_discount_0#5294, cval_lineitem_l_tax#5250 AS cval_lineitem_l_tax_0#5295, cval_lineitem_l_returnflag#5251 AS cval_lineitem_l_returnflag_0#5296, cval_lineitem_l_linestatus#5252 AS cval_lineitem_l_linestatus_0#5297, cval_lineitem_l_commitdate#5253 AS cval_lineitem_l_commitdate_0#5298, cval_lineitem_l_receiptdate#5254 AS cval_lineitem_l_receiptdate_0#5299, cval_lineitem_l_shipinstruct#5255 AS cval_lineitem_l_shipinstruct_0#5300, cval_lineitem_l_shipmode#5256 AS cval_lineitem_l_shipmode_0#5301, cval_lineitem_l_comment#5257 AS cval_lineitem_l_comment_0#5302, cval_lineitem_l_shipdate#5258 AS cval_lineitem_l_shipdate_0#5303, cdepval_lineitem_l_quantity#5259 AS cdepval_lineitem_l_quantity_0#5304, cdepval_lineitem_l_extendedprice#5260 AS cdepval_lineitem_l_extendedprice_0#5305, cdepval_lineitem_l_discount#5261 AS cdepval_lineitem_l_discount_0#5306, ... 21 more fields]
         :     +- Relation[rid#5238,cpfk_orders_lineitem#5239,cpfk_supplier_lineitem#5240,cfpk_lineitem_supplier#5241,cfpk_lineitem_partsupp#5242,cpfk_part_lineitem#5243,cfpk_lineitem_part#5244,cpfk_partsupp_lineitem#5245,cfpk_lineitem_orders#5246,cval_lineitem_l_quantity#5247,cval_lineitem_l_extendedprice#5248,cval_lineitem_l_discount#5249,cval_lineitem_l_tax#5250,cval_lineitem_l_returnflag#5251,cval_lineitem_l_linestatus#5252,cval_lineitem_l_commitdate#5253,cval_lineitem_l_receiptdate#5254,cval_lineitem_l_shipinstruct#5255,cval_lineitem_l_shipmode#5256,cval_lineitem_l_comment#5257,cval_lineitem_l_shipdate#5258,cdepval_lineitem_l_quantity#5259,cdepval_lineitem_l_extendedprice#5260,cdepval_lineitem_l_discount#5261,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5418 AS rid_1#5442, cpfk_customer_orders#5419 AS cpfk_customer_orders_1#5443, cfpk_orders_customer#5420 AS cfpk_orders_customer_1#5444, cval_orders_o_orderstatus#5421 AS cval_orders_o_orderstatus_1#5445, cval_orders_o_totalprice#5422 AS cval_orders_o_totalprice_1#5446, cval_orders_o_orderpriority#5423 AS cval_orders_o_orderpriority_1#5447, cval_orders_o_clerk#5424 AS cval_orders_o_clerk_1#5448, cval_orders_o_shippriority#5425 AS cval_orders_o_shippriority_1#5449, cval_orders_o_comment#5426 AS cval_orders_o_comment_1#5450, cval_orders_o_orderdate#5427 AS cval_orders_o_orderdate_1#5451, cdepval_orders_o_orderstatus#5428 AS cdepval_orders_o_orderstatus_1#5452, cdepval_orders_o_totalprice#5429 AS cdepval_orders_o_totalprice_1#5453, cdepval_orders_o_orderpriority#5430 AS cdepval_orders_o_orderpriority_1#5454, cdepval_orders_o_clerk#5431 AS cdepval_orders_o_clerk_1#5455, cdepval_orders_o_shippriority#5432 AS cdepval_orders_o_shippriority_1#5456, cdepval_orders_o_comment#5433 AS cdepval_orders_o_comment_1#5457, cdepval_orders_o_orderdate#5434 AS cdepval_orders_o_orderdate_1#5458, co_orderstatus#5435 AS co_orderstatus_1#5459, co_totalprice#5436 AS co_totalprice_1#5460, co_orderpriority#5437 AS co_orderpriority_1#5461, co_clerk#5438 AS co_clerk_1#5462, co_shippriority#5439 AS co_shippriority_1#5463, co_comment#5440 AS co_comment_1#5464, co_orderdate#5441 AS co_orderdate_1#5465]
            +- Relation[rid#5418,cpfk_customer_orders#5419,cfpk_orders_customer#5420,cval_orders_o_orderstatus#5421,cval_orders_o_totalprice#5422,cval_orders_o_orderpriority#5423,cval_orders_o_clerk#5424,cval_orders_o_shippriority#5425,cval_orders_o_comment#5426,cval_orders_o_orderdate#5427,cdepval_orders_o_orderstatus#5428,cdepval_orders_o_totalprice#5429,cdepval_orders_o_orderpriority#5430,cdepval_orders_o_clerk#5431,cdepval_orders_o_shippriority#5432,cdepval_orders_o_comment#5433,cdepval_orders_o_orderdate#5434,co_orderstatus#5435,co_totalprice#5436,co_orderpriority#5437,co_clerk#5438,co_shippriority#5439,co_comment#5440,co_orderdate#5441] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21426ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/25 22:06:22 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:06:22 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5540L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:06:22 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5540L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#5542 AS rid_0#5566, cpfk_customer_orders#5543 AS cpfk_customer_orders_0#5567, cfpk_orders_customer#5544 AS cfpk_orders_customer_0#5568, cval_orders_o_orderstatus#5545 AS cval_orders_o_orderstatus_0#5569, cval_orders_o_totalprice#5546 AS cval_orders_o_totalprice_0#5570, cval_orders_o_orderpriority#5547 AS cval_orders_o_orderpriority_0#5571, cval_orders_o_clerk#5548 AS cval_orders_o_clerk_0#5572, cval_orders_o_shippriority#5549 AS cval_orders_o_shippriority_0#5573, cval_orders_o_comment#5550 AS cval_orders_o_comment_0#5574, cval_orders_o_orderdate#5551 AS cval_orders_o_orderdate_0#5575, cdepval_orders_o_orderstatus#5552 AS cdepval_orders_o_orderstatus_0#5576, cdepval_orders_o_totalprice#5553 AS cdepval_orders_o_totalprice_0#5577, cdepval_orders_o_orderpriority#5554 AS cdepval_orders_o_orderpriority_0#5578, cdepval_orders_o_clerk#5555 AS cdepval_orders_o_clerk_0#5579, cdepval_orders_o_shippriority#5556 AS cdepval_orders_o_shippriority_0#5580, cdepval_orders_o_comment#5557 AS cdepval_orders_o_comment_0#5581, cdepval_orders_o_orderdate#5558 AS cdepval_orders_o_orderdate_0#5582, co_orderstatus#5559 AS co_orderstatus_0#5583, co_totalprice#5560 AS co_totalprice_0#5584, co_orderpriority#5561 AS co_orderpriority_0#5585, co_clerk#5562 AS co_clerk_0#5586, co_shippriority#5563 AS co_shippriority_0#5587, co_comment#5564 AS co_comment_0#5588, co_orderdate#5565 AS co_orderdate_0#5589]
         :  +- Relation[rid#5542,cpfk_customer_orders#5543,cfpk_orders_customer#5544,cval_orders_o_orderstatus#5545,cval_orders_o_totalprice#5546,cval_orders_o_orderpriority#5547,cval_orders_o_clerk#5548,cval_orders_o_shippriority#5549,cval_orders_o_comment#5550,cval_orders_o_orderdate#5551,cdepval_orders_o_orderstatus#5552,cdepval_orders_o_totalprice#5553,cdepval_orders_o_orderpriority#5554,cdepval_orders_o_clerk#5555,cdepval_orders_o_shippriority#5556,cdepval_orders_o_comment#5557,cdepval_orders_o_orderdate#5558,co_orderstatus#5559,co_totalprice#5560,co_orderpriority#5561,co_clerk#5562,co_shippriority#5563,co_comment#5564,co_orderdate#5565] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#5590 AS rid_1#5611, cpfk_nation_customer#5591 AS cpfk_nation_customer_1#5612, cfpk_customer_nation#5592 AS cfpk_customer_nation_1#5613, cval_customer_c_name#5593 AS cval_customer_c_name_1#5614, cval_customer_c_address#5594 AS cval_customer_c_address_1#5615, cval_customer_c_phone#5595 AS cval_customer_c_phone_1#5616, cval_customer_c_acctbal#5596 AS cval_customer_c_acctbal_1#5617, cval_customer_c_comment#5597 AS cval_customer_c_comment_1#5618, cval_customer_c_mktsegment#5598 AS cval_customer_c_mktsegment_1#5619, cdepval_customer_c_name#5599 AS cdepval_customer_c_name_1#5620, cdepval_customer_c_address#5600 AS cdepval_customer_c_address_1#5621, cdepval_customer_c_phone#5601 AS cdepval_customer_c_phone_1#5622, cdepval_customer_c_acctbal#5602 AS cdepval_customer_c_acctbal_1#5623, cdepval_customer_c_comment#5603 AS cdepval_customer_c_comment_1#5624, cdepval_customer_c_mktsegment#5604 AS cdepval_customer_c_mktsegment_1#5625, cc_name#5605 AS cc_name_1#5626, cc_address#5606 AS cc_address_1#5627, cc_phone#5607 AS cc_phone_1#5628, cc_acctbal#5608 AS cc_acctbal_1#5629, cc_comment#5609 AS cc_comment_1#5630, cc_mktsegment#5610 AS cc_mktsegment_1#5631]
            +- Relation[rid#5590,cpfk_nation_customer#5591,cfpk_customer_nation#5592,cval_customer_c_name#5593,cval_customer_c_address#5594,cval_customer_c_phone#5595,cval_customer_c_acctbal#5596,cval_customer_c_comment#5597,cval_customer_c_mktsegment#5598,cdepval_customer_c_name#5599,cdepval_customer_c_address#5600,cdepval_customer_c_phone#5601,cdepval_customer_c_acctbal#5602,cdepval_customer_c_comment#5603,cdepval_customer_c_mktsegment#5604,cc_name#5605,cc_address#5606,cc_phone#5607,cc_acctbal#5608,cc_comment#5609,cc_mktsegment#5610] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4353ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/25 22:06:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:06:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5683L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:06:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5683L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#5735 AS rid_1#5780, cpfk_orders_lineitem#5736 AS cpfk_orders_lineitem_1#5781, cpfk_supplier_lineitem#5737 AS cpfk_supplier_lineitem_1#5782, cfpk_lineitem_supplier#5738 AS cfpk_lineitem_supplier_1#5783, cfpk_lineitem_partsupp#5739 AS cfpk_lineitem_partsupp_1#5784, cpfk_part_lineitem#5740 AS cpfk_part_lineitem_1#5785, cfpk_lineitem_part#5741 AS cfpk_lineitem_part_1#5786, cpfk_partsupp_lineitem#5742 AS cpfk_partsupp_lineitem_1#5787, cfpk_lineitem_orders#5743 AS cfpk_lineitem_orders_1#5788, cval_lineitem_l_quantity#5744 AS cval_lineitem_l_quantity_1#5789, cval_lineitem_l_extendedprice#5745 AS cval_lineitem_l_extendedprice_1#5790, cval_lineitem_l_discount#5746 AS cval_lineitem_l_discount_1#5791, cval_lineitem_l_tax#5747 AS cval_lineitem_l_tax_1#5792, cval_lineitem_l_returnflag#5748 AS cval_lineitem_l_returnflag_1#5793, cval_lineitem_l_linestatus#5749 AS cval_lineitem_l_linestatus_1#5794, cval_lineitem_l_commitdate#5750 AS cval_lineitem_l_commitdate_1#5795, cval_lineitem_l_receiptdate#5751 AS cval_lineitem_l_receiptdate_1#5796, cval_lineitem_l_shipinstruct#5752 AS cval_lineitem_l_shipinstruct_1#5797, cval_lineitem_l_shipmode#5753 AS cval_lineitem_l_shipmode_1#5798, cval_lineitem_l_comment#5754 AS cval_lineitem_l_comment_1#5799, cval_lineitem_l_shipdate#5755 AS cval_lineitem_l_shipdate_1#5800, cdepval_lineitem_l_quantity#5756 AS cdepval_lineitem_l_quantity_1#5801, cdepval_lineitem_l_extendedprice#5757 AS cdepval_lineitem_l_extendedprice_1#5802, cdepval_lineitem_l_discount#5758 AS cdepval_lineitem_l_discount_1#5803, ... 21 more fields]
         :  +- Relation[rid#5735,cpfk_orders_lineitem#5736,cpfk_supplier_lineitem#5737,cfpk_lineitem_supplier#5738,cfpk_lineitem_partsupp#5739,cpfk_part_lineitem#5740,cfpk_lineitem_part#5741,cpfk_partsupp_lineitem#5742,cfpk_lineitem_orders#5743,cval_lineitem_l_quantity#5744,cval_lineitem_l_extendedprice#5745,cval_lineitem_l_discount#5746,cval_lineitem_l_tax#5747,cval_lineitem_l_returnflag#5748,cval_lineitem_l_linestatus#5749,cval_lineitem_l_commitdate#5750,cval_lineitem_l_receiptdate#5751,cval_lineitem_l_shipinstruct#5752,cval_lineitem_l_shipmode#5753,cval_lineitem_l_comment#5754,cval_lineitem_l_shipdate#5755,cdepval_lineitem_l_quantity#5756,cdepval_lineitem_l_extendedprice#5757,cdepval_lineitem_l_discount#5758,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5685 AS rid_0#5710, cval_part_p_name#5686 AS cval_part_p_name_0#5711, cval_part_p_mfgr#5687 AS cval_part_p_mfgr_0#5712, cval_part_p_type#5688 AS cval_part_p_type_0#5713, cval_part_p_size#5689 AS cval_part_p_size_0#5714, cval_part_p_container#5690 AS cval_part_p_container_0#5715, cval_part_p_retailprice#5691 AS cval_part_p_retailprice_0#5716, cval_part_p_comment#5692 AS cval_part_p_comment_0#5717, cval_part_p_brand#5693 AS cval_part_p_brand_0#5718, cdepval_part_p_name#5694 AS cdepval_part_p_name_0#5719, cdepval_part_p_mfgr#5695 AS cdepval_part_p_mfgr_0#5720, cdepval_part_p_type#5696 AS cdepval_part_p_type_0#5721, cdepval_part_p_size#5697 AS cdepval_part_p_size_0#5722, cdepval_part_p_container#5698 AS cdepval_part_p_container_0#5723, cdepval_part_p_retailprice#5699 AS cdepval_part_p_retailprice_0#5724, cdepval_part_p_comment#5700 AS cdepval_part_p_comment_0#5725, cdepval_part_p_brand#5701 AS cdepval_part_p_brand_0#5726, cp_name#5702 AS cp_name_0#5727, cp_mfgr#5703 AS cp_mfgr_0#5728, cp_type#5704 AS cp_type_0#5729, cp_size#5705 AS cp_size_0#5730, cp_container#5706 AS cp_container_0#5731, cp_retailprice#5707 AS cp_retailprice_0#5732, cp_comment#5708 AS cp_comment_0#5733, cp_brand#5709 AS cp_brand_0#5734]
            +- Relation[rid#5685,cval_part_p_name#5686,cval_part_p_mfgr#5687,cval_part_p_type#5688,cval_part_p_size#5689,cval_part_p_container#5690,cval_part_p_retailprice#5691,cval_part_p_comment#5692,cval_part_p_brand#5693,cdepval_part_p_name#5694,cdepval_part_p_mfgr#5695,cdepval_part_p_type#5696,cdepval_part_p_size#5697,cdepval_part_p_container#5698,cdepval_part_p_retailprice#5699,cdepval_part_p_comment#5700,cdepval_part_p_brand#5701,cp_name#5702,cp_mfgr#5703,cp_type#5704,cp_size#5705,cp_container#5706,cp_retailprice#5707,cp_comment#5708,cp_brand#5709] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17763ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/25 22:06:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:06:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5900L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:06:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#5900L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#5902 AS rid_0#5947, cpfk_orders_lineitem#5903 AS cpfk_orders_lineitem_0#5948, cpfk_supplier_lineitem#5904 AS cpfk_supplier_lineitem_0#5949, cfpk_lineitem_supplier#5905 AS cfpk_lineitem_supplier_0#5950, cfpk_lineitem_partsupp#5906 AS cfpk_lineitem_partsupp_0#5951, cpfk_part_lineitem#5907 AS cpfk_part_lineitem_0#5952, cfpk_lineitem_part#5908 AS cfpk_lineitem_part_0#5953, cpfk_partsupp_lineitem#5909 AS cpfk_partsupp_lineitem_0#5954, cfpk_lineitem_orders#5910 AS cfpk_lineitem_orders_0#5955, cval_lineitem_l_quantity#5911 AS cval_lineitem_l_quantity_0#5956, cval_lineitem_l_extendedprice#5912 AS cval_lineitem_l_extendedprice_0#5957, cval_lineitem_l_discount#5913 AS cval_lineitem_l_discount_0#5958, cval_lineitem_l_tax#5914 AS cval_lineitem_l_tax_0#5959, cval_lineitem_l_returnflag#5915 AS cval_lineitem_l_returnflag_0#5960, cval_lineitem_l_linestatus#5916 AS cval_lineitem_l_linestatus_0#5961, cval_lineitem_l_commitdate#5917 AS cval_lineitem_l_commitdate_0#5962, cval_lineitem_l_receiptdate#5918 AS cval_lineitem_l_receiptdate_0#5963, cval_lineitem_l_shipinstruct#5919 AS cval_lineitem_l_shipinstruct_0#5964, cval_lineitem_l_shipmode#5920 AS cval_lineitem_l_shipmode_0#5965, cval_lineitem_l_comment#5921 AS cval_lineitem_l_comment_0#5966, cval_lineitem_l_shipdate#5922 AS cval_lineitem_l_shipdate_0#5967, cdepval_lineitem_l_quantity#5923 AS cdepval_lineitem_l_quantity_0#5968, cdepval_lineitem_l_extendedprice#5924 AS cdepval_lineitem_l_extendedprice_0#5969, cdepval_lineitem_l_discount#5925 AS cdepval_lineitem_l_discount_0#5970, ... 21 more fields]
         +- Relation[rid#5902,cpfk_orders_lineitem#5903,cpfk_supplier_lineitem#5904,cfpk_lineitem_supplier#5905,cfpk_lineitem_partsupp#5906,cpfk_part_lineitem#5907,cfpk_lineitem_part#5908,cpfk_partsupp_lineitem#5909,cfpk_lineitem_orders#5910,cval_lineitem_l_quantity#5911,cval_lineitem_l_extendedprice#5912,cval_lineitem_l_discount#5913,cval_lineitem_l_tax#5914,cval_lineitem_l_returnflag#5915,cval_lineitem_l_linestatus#5916,cval_lineitem_l_commitdate#5917,cval_lineitem_l_receiptdate#5918,cval_lineitem_l_shipinstruct#5919,cval_lineitem_l_shipmode#5920,cval_lineitem_l_comment#5921,cval_lineitem_l_shipdate#5922,cdepval_lineitem_l_quantity#5923,cdepval_lineitem_l_extendedprice#5924,cdepval_lineitem_l_discount#5925,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2312ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/25 22:06:46 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:06:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6044L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:06:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:06:46 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:06:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6044L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :- Project [rid#6146 AS rid_1#6160, cpfk_part_partsupp#6147 AS cpfk_part_partsupp_1#6161, cfpk_partsupp_part#6148 AS cfpk_partsupp_part_1#6162, cpfk_supplier_partsupp#6149 AS cpfk_supplier_partsupp_1#6163, cfpk_partsupp_supplier#6150 AS cfpk_partsupp_supplier_1#6164, cval_partsupp_ps_availqty#6151 AS cval_partsupp_ps_availqty_1#6165, cval_partsupp_ps_supplycost#6152 AS cval_partsupp_ps_supplycost_1#6166, cval_partsupp_ps_comment#6153 AS cval_partsupp_ps_comment_1#6167, cdepval_partsupp_ps_availqty#6154 AS cdepval_partsupp_ps_availqty_1#6168, cdepval_partsupp_ps_supplycost#6155 AS cdepval_partsupp_ps_supplycost_1#6169, cdepval_partsupp_ps_comment#6156 AS cdepval_partsupp_ps_comment_1#6170, cps_availqty#6157 AS cps_availqty_1#6171, cps_supplycost#6158 AS cps_supplycost_1#6172, cps_comment#6159 AS cps_comment_1#6173]
         :  +- Relation[rid#6146,cpfk_part_partsupp#6147,cfpk_partsupp_part#6148,cpfk_supplier_partsupp#6149,cfpk_partsupp_supplier#6150,cval_partsupp_ps_availqty#6151,cval_partsupp_ps_supplycost#6152,cval_partsupp_ps_comment#6153,cdepval_partsupp_ps_availqty#6154,cdepval_partsupp_ps_supplycost#6155,cdepval_partsupp_ps_comment#6156,cps_availqty#6157,cps_supplycost#6158,cps_comment#6159] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
            +- Project [rid#6046 AS rid_0#6071, cval_part_p_name#6047 AS cval_part_p_name_0#6072, cval_part_p_mfgr#6048 AS cval_part_p_mfgr_0#6073, cval_part_p_type#6049 AS cval_part_p_type_0#6074, cval_part_p_size#6050 AS cval_part_p_size_0#6075, cval_part_p_container#6051 AS cval_part_p_container_0#6076, cval_part_p_retailprice#6052 AS cval_part_p_retailprice_0#6077, cval_part_p_comment#6053 AS cval_part_p_comment_0#6078, cval_part_p_brand#6054 AS cval_part_p_brand_0#6079, cdepval_part_p_name#6055 AS cdepval_part_p_name_0#6080, cdepval_part_p_mfgr#6056 AS cdepval_part_p_mfgr_0#6081, cdepval_part_p_type#6057 AS cdepval_part_p_type_0#6082, cdepval_part_p_size#6058 AS cdepval_part_p_size_0#6083, cdepval_part_p_container#6059 AS cdepval_part_p_container_0#6084, cdepval_part_p_retailprice#6060 AS cdepval_part_p_retailprice_0#6085, cdepval_part_p_comment#6061 AS cdepval_part_p_comment_0#6086, cdepval_part_p_brand#6062 AS cdepval_part_p_brand_0#6087, cp_name#6063 AS cp_name_0#6088, cp_mfgr#6064 AS cp_mfgr_0#6089, cp_type#6065 AS cp_type_0#6090, cp_size#6066 AS cp_size_0#6091, cp_container#6067 AS cp_container_0#6092, cp_retailprice#6068 AS cp_retailprice_0#6093, cp_comment#6069 AS cp_comment_0#6094, cp_brand#6070 AS cp_brand_0#6095]
               +- Relation[rid#6046,cval_part_p_name#6047,cval_part_p_mfgr#6048,cval_part_p_type#6049,cval_part_p_size#6050,cval_part_p_container#6051,cval_part_p_retailprice#6052,cval_part_p_comment#6053,cval_part_p_brand#6054,cdepval_part_p_name#6055,cdepval_part_p_mfgr#6056,cdepval_part_p_type#6057,cdepval_part_p_size#6058,cdepval_part_p_container#6059,cdepval_part_p_retailprice#6060,cdepval_part_p_comment#6061,cdepval_part_p_brand#6062,cp_name#6063,cp_mfgr#6064,cp_type#6065,cp_size#6066,cp_container#6067,cp_retailprice#6068,cp_comment#6069,cp_brand#6070] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 3593ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/25 22:06:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:06:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6219L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:06:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:06:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6219L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#6357 AS rid_4#6402, cpfk_orders_lineitem#6358 AS cpfk_orders_lineitem_4#6403, cpfk_supplier_lineitem#6359 AS cpfk_supplier_lineitem_4#6404, cfpk_lineitem_supplier#6360 AS cfpk_lineitem_supplier_4#6405, cfpk_lineitem_partsupp#6361 AS cfpk_lineitem_partsupp_4#6406, cpfk_part_lineitem#6362 AS cpfk_part_lineitem_4#6407, cfpk_lineitem_part#6363 AS cfpk_lineitem_part_4#6408, cpfk_partsupp_lineitem#6364 AS cpfk_partsupp_lineitem_4#6409, cfpk_lineitem_orders#6365 AS cfpk_lineitem_orders_4#6410, cval_lineitem_l_quantity#6366 AS cval_lineitem_l_quantity_4#6411, cval_lineitem_l_extendedprice#6367 AS cval_lineitem_l_extendedprice_4#6412, cval_lineitem_l_discount#6368 AS cval_lineitem_l_discount_4#6413, cval_lineitem_l_tax#6369 AS cval_lineitem_l_tax_4#6414, cval_lineitem_l_returnflag#6370 AS cval_lineitem_l_returnflag_4#6415, cval_lineitem_l_linestatus#6371 AS cval_lineitem_l_linestatus_4#6416, cval_lineitem_l_commitdate#6372 AS cval_lineitem_l_commitdate_4#6417, cval_lineitem_l_receiptdate#6373 AS cval_lineitem_l_receiptdate_4#6418, cval_lineitem_l_shipinstruct#6374 AS cval_lineitem_l_shipinstruct_4#6419, cval_lineitem_l_shipmode#6375 AS cval_lineitem_l_shipmode_4#6420, cval_lineitem_l_comment#6376 AS cval_lineitem_l_comment_4#6421, cval_lineitem_l_shipdate#6377 AS cval_lineitem_l_shipdate_4#6422, cdepval_lineitem_l_quantity#6378 AS cdepval_lineitem_l_quantity_4#6423, cdepval_lineitem_l_extendedprice#6379 AS cdepval_lineitem_l_extendedprice_4#6424, cdepval_lineitem_l_discount#6380 AS cdepval_lineitem_l_discount_4#6425, ... 21 more fields]
            :  :  +- Relation[rid#6357,cpfk_orders_lineitem#6358,cpfk_supplier_lineitem#6359,cfpk_lineitem_supplier#6360,cfpk_lineitem_partsupp#6361,cpfk_part_lineitem#6362,cfpk_lineitem_part#6363,cpfk_partsupp_lineitem#6364,cfpk_lineitem_orders#6365,cval_lineitem_l_quantity#6366,cval_lineitem_l_extendedprice#6367,cval_lineitem_l_discount#6368,cval_lineitem_l_tax#6369,cval_lineitem_l_returnflag#6370,cval_lineitem_l_linestatus#6371,cval_lineitem_l_commitdate#6372,cval_lineitem_l_receiptdate#6373,cval_lineitem_l_shipinstruct#6374,cval_lineitem_l_shipmode#6375,cval_lineitem_l_comment#6376,cval_lineitem_l_shipdate#6377,cdepval_lineitem_l_quantity#6378,cdepval_lineitem_l_extendedprice#6379,cdepval_lineitem_l_discount#6380,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#6309 AS rid_3#6333, cpfk_customer_orders#6310 AS cpfk_customer_orders_3#6334, cfpk_orders_customer#6311 AS cfpk_orders_customer_3#6335, cval_orders_o_orderstatus#6312 AS cval_orders_o_orderstatus_3#6336, cval_orders_o_totalprice#6313 AS cval_orders_o_totalprice_3#6337, cval_orders_o_orderpriority#6314 AS cval_orders_o_orderpriority_3#6338, cval_orders_o_clerk#6315 AS cval_orders_o_clerk_3#6339, cval_orders_o_shippriority#6316 AS cval_orders_o_shippriority_3#6340, cval_orders_o_comment#6317 AS cval_orders_o_comment_3#6341, cval_orders_o_orderdate#6318 AS cval_orders_o_orderdate_3#6342, cdepval_orders_o_orderstatus#6319 AS cdepval_orders_o_orderstatus_3#6343, cdepval_orders_o_totalprice#6320 AS cdepval_orders_o_totalprice_3#6344, cdepval_orders_o_orderpriority#6321 AS cdepval_orders_o_orderpriority_3#6345, cdepval_orders_o_clerk#6322 AS cdepval_orders_o_clerk_3#6346, cdepval_orders_o_shippriority#6323 AS cdepval_orders_o_shippriority_3#6347, cdepval_orders_o_comment#6324 AS cdepval_orders_o_comment_3#6348, cdepval_orders_o_orderdate#6325 AS cdepval_orders_o_orderdate_3#6349, co_orderstatus#6326 AS co_orderstatus_3#6350, co_totalprice#6327 AS co_totalprice_3#6351, co_orderpriority#6328 AS co_orderpriority_3#6352, co_clerk#6329 AS co_clerk_3#6353, co_shippriority#6330 AS co_shippriority_3#6354, co_comment#6331 AS co_comment_3#6355, co_orderdate#6332 AS co_orderdate_3#6356]
            :     :  +- Relation[rid#6309,cpfk_customer_orders#6310,cfpk_orders_customer#6311,cval_orders_o_orderstatus#6312,cval_orders_o_totalprice#6313,cval_orders_o_orderpriority#6314,cval_orders_o_clerk#6315,cval_orders_o_shippriority#6316,cval_orders_o_comment#6317,cval_orders_o_orderdate#6318,cdepval_orders_o_orderstatus#6319,cdepval_orders_o_totalprice#6320,cdepval_orders_o_orderpriority#6321,cdepval_orders_o_clerk#6322,cdepval_orders_o_shippriority#6323,cdepval_orders_o_comment#6324,cdepval_orders_o_orderdate#6325,co_orderstatus#6326,co_totalprice#6327,co_orderpriority#6328,co_clerk#6329,co_shippriority#6330,co_comment#6331,co_orderdate#6332] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#6267 AS rid_2#6288, cpfk_nation_customer#6268 AS cpfk_nation_customer_2#6289, cfpk_customer_nation#6269 AS cfpk_customer_nation_2#6290, cval_customer_c_name#6270 AS cval_customer_c_name_2#6291, cval_customer_c_address#6271 AS cval_customer_c_address_2#6292, cval_customer_c_phone#6272 AS cval_customer_c_phone_2#6293, cval_customer_c_acctbal#6273 AS cval_customer_c_acctbal_2#6294, cval_customer_c_comment#6274 AS cval_customer_c_comment_2#6295, cval_customer_c_mktsegment#6275 AS cval_customer_c_mktsegment_2#6296, cdepval_customer_c_name#6276 AS cdepval_customer_c_name_2#6297, cdepval_customer_c_address#6277 AS cdepval_customer_c_address_2#6298, cdepval_customer_c_phone#6278 AS cdepval_customer_c_phone_2#6299, cdepval_customer_c_acctbal#6279 AS cdepval_customer_c_acctbal_2#6300, cdepval_customer_c_comment#6280 AS cdepval_customer_c_comment_2#6301, cdepval_customer_c_mktsegment#6281 AS cdepval_customer_c_mktsegment_2#6302, cc_name#6282 AS cc_name_2#6303, cc_address#6283 AS cc_address_2#6304, cc_phone#6284 AS cc_phone_2#6305, cc_acctbal#6285 AS cc_acctbal_2#6306, cc_comment#6286 AS cc_comment_2#6307, cc_mktsegment#6287 AS cc_mktsegment_2#6308]
            :        :  +- Relation[rid#6267,cpfk_nation_customer#6268,cfpk_customer_nation#6269,cval_customer_c_name#6270,cval_customer_c_address#6271,cval_customer_c_phone#6272,cval_customer_c_acctbal#6273,cval_customer_c_comment#6274,cval_customer_c_mktsegment#6275,cdepval_customer_c_name#6276,cdepval_customer_c_address#6277,cdepval_customer_c_phone#6278,cdepval_customer_c_acctbal#6279,cdepval_customer_c_comment#6280,cdepval_customer_c_mktsegment#6281,cc_name#6282,cc_address#6283,cc_phone#6284,cc_acctbal#6285,cc_comment#6286,cc_mktsegment#6287] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_1, BinaryType)), 'cfpk_nation_region_1) = 'rid_0)
            :           :- Project [rid#6249 AS rid_1#6258, cpfk_region_nation#6250 AS cpfk_region_nation_1#6259, cfpk_nation_region#6251 AS cfpk_nation_region_1#6260, cval_nation_n_name#6252 AS cval_nation_n_name_1#6261, cval_nation_n_comment#6253 AS cval_nation_n_comment_1#6262, cdepval_nation_n_name#6254 AS cdepval_nation_n_name_1#6263, cdepval_nation_n_comment#6255 AS cdepval_nation_n_comment_1#6264, cn_name#6256 AS cn_name_1#6265, cn_comment#6257 AS cn_comment_1#6266]
            :           :  +- Relation[rid#6249,cpfk_region_nation#6250,cfpk_nation_region#6251,cval_nation_n_name#6252,cval_nation_n_comment#6253,cdepval_nation_n_name#6254,cdepval_nation_n_comment#6255,cn_name#6256,cn_comment#6257] JDBCRelation(tnation) [numPartitions=1]
            :           +- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :              +- Project [rid#6221 AS rid_0#6228, cval_region_r_name#6222 AS cval_region_r_name_0#6229, cval_region_r_comment#6223 AS cval_region_r_comment_0#6230, cdepval_region_r_name#6224 AS cdepval_region_r_name_0#6231, cdepval_region_r_comment#6225 AS cdepval_region_r_comment_0#6232, cr_name#6226 AS cr_name_0#6233, cr_comment#6227 AS cr_comment_0#6234]
            :                 +- Relation[rid#6221,cval_region_r_name#6222,cval_region_r_comment#6223,cdepval_region_r_name#6224,cdepval_region_r_comment#6225,cr_name#6226,cr_comment#6227] JDBCRelation(tregion) [numPartitions=1]
            +- Project [rid#6447 AS rid_5#6465, cpfk_nation_supplier#6448 AS cpfk_nation_supplier_5#6466, cfpk_supplier_nation#6449 AS cfpk_supplier_nation_5#6467, cval_supplier_s_name#6450 AS cval_supplier_s_name_5#6468, cval_supplier_s_address#6451 AS cval_supplier_s_address_5#6469, cval_supplier_s_phone#6452 AS cval_supplier_s_phone_5#6470, cval_supplier_s_acctbal#6453 AS cval_supplier_s_acctbal_5#6471, cval_supplier_s_comment#6454 AS cval_supplier_s_comment_5#6472, cdepval_supplier_s_name#6455 AS cdepval_supplier_s_name_5#6473, cdepval_supplier_s_address#6456 AS cdepval_supplier_s_address_5#6474, cdepval_supplier_s_phone#6457 AS cdepval_supplier_s_phone_5#6475, cdepval_supplier_s_acctbal#6458 AS cdepval_supplier_s_acctbal_5#6476, cdepval_supplier_s_comment#6459 AS cdepval_supplier_s_comment_5#6477, cs_name#6460 AS cs_name_5#6478, cs_address#6461 AS cs_address_5#6479, cs_phone#6462 AS cs_phone_5#6480, cs_acctbal#6463 AS cs_acctbal_5#6481, cs_comment#6464 AS cs_comment_5#6482]
               +- Relation[rid#6447,cpfk_nation_supplier#6448,cfpk_supplier_nation#6449,cval_supplier_s_name#6450,cval_supplier_s_address#6451,cval_supplier_s_phone#6452,cval_supplier_s_acctbal#6453,cval_supplier_s_comment#6454,cdepval_supplier_s_name#6455,cdepval_supplier_s_address#6456,cdepval_supplier_s_phone#6457,cdepval_supplier_s_acctbal#6458,cdepval_supplier_s_comment#6459,cs_name#6460,cs_address#6461,cs_phone#6462,cs_acctbal#6463,cs_comment#6464] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 30596ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/25 22:07:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:07:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6611L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/25 22:07:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6611L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#6613 AS rid_0#6637, cpfk_customer_orders#6614 AS cpfk_customer_orders_0#6638, cfpk_orders_customer#6615 AS cfpk_orders_customer_0#6639, cval_orders_o_orderstatus#6616 AS cval_orders_o_orderstatus_0#6640, cval_orders_o_totalprice#6617 AS cval_orders_o_totalprice_0#6641, cval_orders_o_orderpriority#6618 AS cval_orders_o_orderpriority_0#6642, cval_orders_o_clerk#6619 AS cval_orders_o_clerk_0#6643, cval_orders_o_shippriority#6620 AS cval_orders_o_shippriority_0#6644, cval_orders_o_comment#6621 AS cval_orders_o_comment_0#6645, cval_orders_o_orderdate#6622 AS cval_orders_o_orderdate_0#6646, cdepval_orders_o_orderstatus#6623 AS cdepval_orders_o_orderstatus_0#6647, cdepval_orders_o_totalprice#6624 AS cdepval_orders_o_totalprice_0#6648, cdepval_orders_o_orderpriority#6625 AS cdepval_orders_o_orderpriority_0#6649, cdepval_orders_o_clerk#6626 AS cdepval_orders_o_clerk_0#6650, cdepval_orders_o_shippriority#6627 AS cdepval_orders_o_shippriority_0#6651, cdepval_orders_o_comment#6628 AS cdepval_orders_o_comment_0#6652, cdepval_orders_o_orderdate#6629 AS cdepval_orders_o_orderdate_0#6653, co_orderstatus#6630 AS co_orderstatus_0#6654, co_totalprice#6631 AS co_totalprice_0#6655, co_orderpriority#6632 AS co_orderpriority_0#6656, co_clerk#6633 AS co_clerk_0#6657, co_shippriority#6634 AS co_shippriority_0#6658, co_comment#6635 AS co_comment_0#6659, co_orderdate#6636 AS co_orderdate_0#6660]
         :  +- Relation[rid#6613,cpfk_customer_orders#6614,cfpk_orders_customer#6615,cval_orders_o_orderstatus#6616,cval_orders_o_totalprice#6617,cval_orders_o_orderpriority#6618,cval_orders_o_clerk#6619,cval_orders_o_shippriority#6620,cval_orders_o_comment#6621,cval_orders_o_orderdate#6622,cdepval_orders_o_orderstatus#6623,cdepval_orders_o_totalprice#6624,cdepval_orders_o_orderpriority#6625,cdepval_orders_o_clerk#6626,cdepval_orders_o_shippriority#6627,cdepval_orders_o_comment#6628,cdepval_orders_o_orderdate#6629,co_orderstatus#6630,co_totalprice#6631,co_orderpriority#6632,co_clerk#6633,co_shippriority#6634,co_comment#6635,co_orderdate#6636] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#6661 AS rid_1#6682, cpfk_nation_customer#6662 AS cpfk_nation_customer_1#6683, cfpk_customer_nation#6663 AS cfpk_customer_nation_1#6684, cval_customer_c_name#6664 AS cval_customer_c_name_1#6685, cval_customer_c_address#6665 AS cval_customer_c_address_1#6686, cval_customer_c_phone#6666 AS cval_customer_c_phone_1#6687, cval_customer_c_acctbal#6667 AS cval_customer_c_acctbal_1#6688, cval_customer_c_comment#6668 AS cval_customer_c_comment_1#6689, cval_customer_c_mktsegment#6669 AS cval_customer_c_mktsegment_1#6690, cdepval_customer_c_name#6670 AS cdepval_customer_c_name_1#6691, cdepval_customer_c_address#6671 AS cdepval_customer_c_address_1#6692, cdepval_customer_c_phone#6672 AS cdepval_customer_c_phone_1#6693, cdepval_customer_c_acctbal#6673 AS cdepval_customer_c_acctbal_1#6694, cdepval_customer_c_comment#6674 AS cdepval_customer_c_comment_1#6695, cdepval_customer_c_mktsegment#6675 AS cdepval_customer_c_mktsegment_1#6696, cc_name#6676 AS cc_name_1#6697, cc_address#6677 AS cc_address_1#6698, cc_phone#6678 AS cc_phone_1#6699, cc_acctbal#6679 AS cc_acctbal_1#6700, cc_comment#6680 AS cc_comment_1#6701, cc_mktsegment#6681 AS cc_mktsegment_1#6702]
            +- Relation[rid#6661,cpfk_nation_customer#6662,cfpk_customer_nation#6663,cval_customer_c_name#6664,cval_customer_c_address#6665,cval_customer_c_phone#6666,cval_customer_c_acctbal#6667,cval_customer_c_comment#6668,cval_customer_c_mktsegment#6669,cdepval_customer_c_name#6670,cdepval_customer_c_address#6671,cdepval_customer_c_phone#6672,cdepval_customer_c_acctbal#6673,cdepval_customer_c_comment#6674,cdepval_customer_c_mktsegment#6675,cc_name#6676,cc_address#6677,cc_phone#6678,cc_acctbal#6679,cc_comment#6680,cc_mktsegment#6681] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4387ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/25 22:07:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:07:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6760L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:07:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:07:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:07:25 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6760L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#6762 AS rid_0#6807, cpfk_orders_lineitem#6763 AS cpfk_orders_lineitem_0#6808, cpfk_supplier_lineitem#6764 AS cpfk_supplier_lineitem_0#6809, cfpk_lineitem_supplier#6765 AS cfpk_lineitem_supplier_0#6810, cfpk_lineitem_partsupp#6766 AS cfpk_lineitem_partsupp_0#6811, cpfk_part_lineitem#6767 AS cpfk_part_lineitem_0#6812, cfpk_lineitem_part#6768 AS cfpk_lineitem_part_0#6813, cpfk_partsupp_lineitem#6769 AS cpfk_partsupp_lineitem_0#6814, cfpk_lineitem_orders#6770 AS cfpk_lineitem_orders_0#6815, cval_lineitem_l_quantity#6771 AS cval_lineitem_l_quantity_0#6816, cval_lineitem_l_extendedprice#6772 AS cval_lineitem_l_extendedprice_0#6817, cval_lineitem_l_discount#6773 AS cval_lineitem_l_discount_0#6818, cval_lineitem_l_tax#6774 AS cval_lineitem_l_tax_0#6819, cval_lineitem_l_returnflag#6775 AS cval_lineitem_l_returnflag_0#6820, cval_lineitem_l_linestatus#6776 AS cval_lineitem_l_linestatus_0#6821, cval_lineitem_l_commitdate#6777 AS cval_lineitem_l_commitdate_0#6822, cval_lineitem_l_receiptdate#6778 AS cval_lineitem_l_receiptdate_0#6823, cval_lineitem_l_shipinstruct#6779 AS cval_lineitem_l_shipinstruct_0#6824, cval_lineitem_l_shipmode#6780 AS cval_lineitem_l_shipmode_0#6825, cval_lineitem_l_comment#6781 AS cval_lineitem_l_comment_0#6826, cval_lineitem_l_shipdate#6782 AS cval_lineitem_l_shipdate_0#6827, cdepval_lineitem_l_quantity#6783 AS cdepval_lineitem_l_quantity_0#6828, cdepval_lineitem_l_extendedprice#6784 AS cdepval_lineitem_l_extendedprice_0#6829, cdepval_lineitem_l_discount#6785 AS cdepval_lineitem_l_discount_0#6830, ... 21 more fields]
         :  :  :     +- Relation[rid#6762,cpfk_orders_lineitem#6763,cpfk_supplier_lineitem#6764,cfpk_lineitem_supplier#6765,cfpk_lineitem_partsupp#6766,cpfk_part_lineitem#6767,cfpk_lineitem_part#6768,cpfk_partsupp_lineitem#6769,cfpk_lineitem_orders#6770,cval_lineitem_l_quantity#6771,cval_lineitem_l_extendedprice#6772,cval_lineitem_l_discount#6773,cval_lineitem_l_tax#6774,cval_lineitem_l_returnflag#6775,cval_lineitem_l_linestatus#6776,cval_lineitem_l_commitdate#6777,cval_lineitem_l_receiptdate#6778,cval_lineitem_l_shipinstruct#6779,cval_lineitem_l_shipmode#6780,cval_lineitem_l_comment#6781,cval_lineitem_l_shipdate#6782,cdepval_lineitem_l_quantity#6783,cdepval_lineitem_l_extendedprice#6784,cdepval_lineitem_l_discount#6785,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#6942 AS rid_1#6966, cpfk_customer_orders#6943 AS cpfk_customer_orders_1#6967, cfpk_orders_customer#6944 AS cfpk_orders_customer_1#6968, cval_orders_o_orderstatus#6945 AS cval_orders_o_orderstatus_1#6969, cval_orders_o_totalprice#6946 AS cval_orders_o_totalprice_1#6970, cval_orders_o_orderpriority#6947 AS cval_orders_o_orderpriority_1#6971, cval_orders_o_clerk#6948 AS cval_orders_o_clerk_1#6972, cval_orders_o_shippriority#6949 AS cval_orders_o_shippriority_1#6973, cval_orders_o_comment#6950 AS cval_orders_o_comment_1#6974, cval_orders_o_orderdate#6951 AS cval_orders_o_orderdate_1#6975, cdepval_orders_o_orderstatus#6952 AS cdepval_orders_o_orderstatus_1#6976, cdepval_orders_o_totalprice#6953 AS cdepval_orders_o_totalprice_1#6977, cdepval_orders_o_orderpriority#6954 AS cdepval_orders_o_orderpriority_1#6978, cdepval_orders_o_clerk#6955 AS cdepval_orders_o_clerk_1#6979, cdepval_orders_o_shippriority#6956 AS cdepval_orders_o_shippriority_1#6980, cdepval_orders_o_comment#6957 AS cdepval_orders_o_comment_1#6981, cdepval_orders_o_orderdate#6958 AS cdepval_orders_o_orderdate_1#6982, co_orderstatus#6959 AS co_orderstatus_1#6983, co_totalprice#6960 AS co_totalprice_1#6984, co_orderpriority#6961 AS co_orderpriority_1#6985, co_clerk#6962 AS co_clerk_1#6986, co_shippriority#6963 AS co_shippriority_1#6987, co_comment#6964 AS co_comment_1#6988, co_orderdate#6965 AS co_orderdate_1#6989]
         :  :     +- Relation[rid#6942,cpfk_customer_orders#6943,cfpk_orders_customer#6944,cval_orders_o_orderstatus#6945,cval_orders_o_totalprice#6946,cval_orders_o_orderpriority#6947,cval_orders_o_clerk#6948,cval_orders_o_shippriority#6949,cval_orders_o_comment#6950,cval_orders_o_orderdate#6951,cdepval_orders_o_orderstatus#6952,cdepval_orders_o_totalprice#6953,cdepval_orders_o_orderpriority#6954,cdepval_orders_o_clerk#6955,cdepval_orders_o_shippriority#6956,cdepval_orders_o_comment#6957,cdepval_orders_o_orderdate#6958,co_orderstatus#6959,co_totalprice#6960,co_orderpriority#6961,co_clerk#6962,co_shippriority#6963,co_comment#6964,co_orderdate#6965] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#6990 AS rid_2#7011, cpfk_nation_customer#6991 AS cpfk_nation_customer_2#7012, cfpk_customer_nation#6992 AS cfpk_customer_nation_2#7013, cval_customer_c_name#6993 AS cval_customer_c_name_2#7014, cval_customer_c_address#6994 AS cval_customer_c_address_2#7015, cval_customer_c_phone#6995 AS cval_customer_c_phone_2#7016, cval_customer_c_acctbal#6996 AS cval_customer_c_acctbal_2#7017, cval_customer_c_comment#6997 AS cval_customer_c_comment_2#7018, cval_customer_c_mktsegment#6998 AS cval_customer_c_mktsegment_2#7019, cdepval_customer_c_name#6999 AS cdepval_customer_c_name_2#7020, cdepval_customer_c_address#7000 AS cdepval_customer_c_address_2#7021, cdepval_customer_c_phone#7001 AS cdepval_customer_c_phone_2#7022, cdepval_customer_c_acctbal#7002 AS cdepval_customer_c_acctbal_2#7023, cdepval_customer_c_comment#7003 AS cdepval_customer_c_comment_2#7024, cdepval_customer_c_mktsegment#7004 AS cdepval_customer_c_mktsegment_2#7025, cc_name#7005 AS cc_name_2#7026, cc_address#7006 AS cc_address_2#7027, cc_phone#7007 AS cc_phone_2#7028, cc_acctbal#7008 AS cc_acctbal_2#7029, cc_comment#7009 AS cc_comment_2#7030, cc_mktsegment#7010 AS cc_mktsegment_2#7031]
         :     +- Relation[rid#6990,cpfk_nation_customer#6991,cfpk_customer_nation#6992,cval_customer_c_name#6993,cval_customer_c_address#6994,cval_customer_c_phone#6995,cval_customer_c_acctbal#6996,cval_customer_c_comment#6997,cval_customer_c_mktsegment#6998,cdepval_customer_c_name#6999,cdepval_customer_c_address#7000,cdepval_customer_c_phone#7001,cdepval_customer_c_acctbal#7002,cdepval_customer_c_comment#7003,cdepval_customer_c_mktsegment#7004,cc_name#7005,cc_address#7006,cc_phone#7007,cc_acctbal#7008,cc_comment#7009,cc_mktsegment#7010] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#7032 AS rid_3#7041, cpfk_region_nation#7033 AS cpfk_region_nation_3#7042, cfpk_nation_region#7034 AS cfpk_nation_region_3#7043, cval_nation_n_name#7035 AS cval_nation_n_name_3#7044, cval_nation_n_comment#7036 AS cval_nation_n_comment_3#7045, cdepval_nation_n_name#7037 AS cdepval_nation_n_name_3#7046, cdepval_nation_n_comment#7038 AS cdepval_nation_n_comment_3#7047, cn_name#7039 AS cn_name_3#7048, cn_comment#7040 AS cn_comment_3#7049]
            +- Relation[rid#7032,cpfk_region_nation#7033,cfpk_nation_region#7034,cval_nation_n_name#7035,cval_nation_n_comment#7036,cdepval_nation_n_name#7037,cdepval_nation_n_comment#7038,cn_name#7039,cn_comment#7040] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 60694ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/25 22:08:25 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:08:25 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7156L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/25 22:08:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:08:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:08:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:08:25 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:08:25 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=region
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:08:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:08:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7156L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :  :  :  :- Project [rid#7258 AS rid_1#7303, cpfk_orders_lineitem#7259 AS cpfk_orders_lineitem_1#7304, cpfk_supplier_lineitem#7260 AS cpfk_supplier_lineitem_1#7305, cfpk_lineitem_supplier#7261 AS cfpk_lineitem_supplier_1#7306, cfpk_lineitem_partsupp#7262 AS cfpk_lineitem_partsupp_1#7307, cpfk_part_lineitem#7263 AS cpfk_part_lineitem_1#7308, cfpk_lineitem_part#7264 AS cfpk_lineitem_part_1#7309, cpfk_partsupp_lineitem#7265 AS cpfk_partsupp_lineitem_1#7310, cfpk_lineitem_orders#7266 AS cfpk_lineitem_orders_1#7311, cval_lineitem_l_quantity#7267 AS cval_lineitem_l_quantity_1#7312, cval_lineitem_l_extendedprice#7268 AS cval_lineitem_l_extendedprice_1#7313, cval_lineitem_l_discount#7269 AS cval_lineitem_l_discount_1#7314, cval_lineitem_l_tax#7270 AS cval_lineitem_l_tax_1#7315, cval_lineitem_l_returnflag#7271 AS cval_lineitem_l_returnflag_1#7316, cval_lineitem_l_linestatus#7272 AS cval_lineitem_l_linestatus_1#7317, cval_lineitem_l_commitdate#7273 AS cval_lineitem_l_commitdate_1#7318, cval_lineitem_l_receiptdate#7274 AS cval_lineitem_l_receiptdate_1#7319, cval_lineitem_l_shipinstruct#7275 AS cval_lineitem_l_shipinstruct_1#7320, cval_lineitem_l_shipmode#7276 AS cval_lineitem_l_shipmode_1#7321, cval_lineitem_l_comment#7277 AS cval_lineitem_l_comment_1#7322, cval_lineitem_l_shipdate#7278 AS cval_lineitem_l_shipdate_1#7323, cdepval_lineitem_l_quantity#7279 AS cdepval_lineitem_l_quantity_1#7324, cdepval_lineitem_l_extendedprice#7280 AS cdepval_lineitem_l_extendedprice_1#7325, cdepval_lineitem_l_discount#7281 AS cdepval_lineitem_l_discount_1#7326, ... 21 more fields]
         :  :  :  :  +- Relation[rid#7258,cpfk_orders_lineitem#7259,cpfk_supplier_lineitem#7260,cfpk_lineitem_supplier#7261,cfpk_lineitem_partsupp#7262,cpfk_part_lineitem#7263,cfpk_lineitem_part#7264,cpfk_partsupp_lineitem#7265,cfpk_lineitem_orders#7266,cval_lineitem_l_quantity#7267,cval_lineitem_l_extendedprice#7268,cval_lineitem_l_discount#7269,cval_lineitem_l_tax#7270,cval_lineitem_l_returnflag#7271,cval_lineitem_l_linestatus#7272,cval_lineitem_l_commitdate#7273,cval_lineitem_l_receiptdate#7274,cval_lineitem_l_shipinstruct#7275,cval_lineitem_l_shipmode#7276,cval_lineitem_l_comment#7277,cval_lineitem_l_shipdate#7278,cdepval_lineitem_l_quantity#7279,cdepval_lineitem_l_extendedprice#7280,cdepval_lineitem_l_discount#7281,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :     +- Project [rid#7158 AS rid_0#7183, cval_part_p_name#7159 AS cval_part_p_name_0#7184, cval_part_p_mfgr#7160 AS cval_part_p_mfgr_0#7185, cval_part_p_type#7161 AS cval_part_p_type_0#7186, cval_part_p_size#7162 AS cval_part_p_size_0#7187, cval_part_p_container#7163 AS cval_part_p_container_0#7188, cval_part_p_retailprice#7164 AS cval_part_p_retailprice_0#7189, cval_part_p_comment#7165 AS cval_part_p_comment_0#7190, cval_part_p_brand#7166 AS cval_part_p_brand_0#7191, cdepval_part_p_name#7167 AS cdepval_part_p_name_0#7192, cdepval_part_p_mfgr#7168 AS cdepval_part_p_mfgr_0#7193, cdepval_part_p_type#7169 AS cdepval_part_p_type_0#7194, cdepval_part_p_size#7170 AS cdepval_part_p_size_0#7195, cdepval_part_p_container#7171 AS cdepval_part_p_container_0#7196, cdepval_part_p_retailprice#7172 AS cdepval_part_p_retailprice_0#7197, cdepval_part_p_comment#7173 AS cdepval_part_p_comment_0#7198, cdepval_part_p_brand#7174 AS cdepval_part_p_brand_0#7199, cp_name#7175 AS cp_name_0#7200, cp_mfgr#7176 AS cp_mfgr_0#7201, cp_type#7177 AS cp_type_0#7202, cp_size#7178 AS cp_size_0#7203, cp_container#7179 AS cp_container_0#7204, cp_retailprice#7180 AS cp_retailprice_0#7205, cp_comment#7181 AS cp_comment_0#7206, cp_brand#7182 AS cp_brand_0#7207]
         :  :  :        +- Relation[rid#7158,cval_part_p_name#7159,cval_part_p_mfgr#7160,cval_part_p_type#7161,cval_part_p_size#7162,cval_part_p_container#7163,cval_part_p_retailprice#7164,cval_part_p_comment#7165,cval_part_p_brand#7166,cdepval_part_p_name#7167,cdepval_part_p_mfgr#7168,cdepval_part_p_type#7169,cdepval_part_p_size#7170,cdepval_part_p_container#7171,cdepval_part_p_retailprice#7172,cdepval_part_p_comment#7173,cdepval_part_p_brand#7174,cp_name#7175,cp_mfgr#7176,cp_type#7177,cp_size#7178,cp_container#7179,cp_retailprice#7180,cp_comment#7181,cp_brand#7182] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- Project [rid#7348 AS rid_2#7366, cpfk_nation_supplier#7349 AS cpfk_nation_supplier_2#7367, cfpk_supplier_nation#7350 AS cfpk_supplier_nation_2#7368, cval_supplier_s_name#7351 AS cval_supplier_s_name_2#7369, cval_supplier_s_address#7352 AS cval_supplier_s_address_2#7370, cval_supplier_s_phone#7353 AS cval_supplier_s_phone_2#7371, cval_supplier_s_acctbal#7354 AS cval_supplier_s_acctbal_2#7372, cval_supplier_s_comment#7355 AS cval_supplier_s_comment_2#7373, cdepval_supplier_s_name#7356 AS cdepval_supplier_s_name_2#7374, cdepval_supplier_s_address#7357 AS cdepval_supplier_s_address_2#7375, cdepval_supplier_s_phone#7358 AS cdepval_supplier_s_phone_2#7376, cdepval_supplier_s_acctbal#7359 AS cdepval_supplier_s_acctbal_2#7377, cdepval_supplier_s_comment#7360 AS cdepval_supplier_s_comment_2#7378, cs_name#7361 AS cs_name_2#7379, cs_address#7362 AS cs_address_2#7380, cs_phone#7363 AS cs_phone_2#7381, cs_acctbal#7364 AS cs_acctbal_2#7382, cs_comment#7365 AS cs_comment_2#7383]
         :  :     +- Relation[rid#7348,cpfk_nation_supplier#7349,cfpk_supplier_nation#7350,cval_supplier_s_name#7351,cval_supplier_s_address#7352,cval_supplier_s_phone#7353,cval_supplier_s_acctbal#7354,cval_supplier_s_comment#7355,cdepval_supplier_s_name#7356,cdepval_supplier_s_address#7357,cdepval_supplier_s_phone#7358,cdepval_supplier_s_acctbal#7359,cdepval_supplier_s_comment#7360,cs_name#7361,cs_address#7362,cs_phone#7363,cs_acctbal#7364,cs_comment#7365] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#7384 AS rid_3#7393, cpfk_region_nation#7385 AS cpfk_region_nation_3#7394, cfpk_nation_region#7386 AS cfpk_nation_region_3#7395, cval_nation_n_name#7387 AS cval_nation_n_name_3#7396, cval_nation_n_comment#7388 AS cval_nation_n_comment_3#7397, cdepval_nation_n_name#7389 AS cdepval_nation_n_name_3#7398, cdepval_nation_n_comment#7390 AS cdepval_nation_n_comment_3#7399, cn_name#7391 AS cn_name_3#7400, cn_comment#7392 AS cn_comment_3#7401]
         :     +- Relation[rid#7384,cpfk_region_nation#7385,cfpk_nation_region#7386,cval_nation_n_name#7387,cval_nation_n_comment#7388,cdepval_nation_n_name#7389,cdepval_nation_n_comment#7390,cn_name#7391,cn_comment#7392] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#7490 AS rid_7#7514, cpfk_customer_orders#7491 AS cpfk_customer_orders_7#7515, cfpk_orders_customer#7492 AS cfpk_orders_customer_7#7516, cval_orders_o_orderstatus#7493 AS cval_orders_o_orderstatus_7#7517, cval_orders_o_totalprice#7494 AS cval_orders_o_totalprice_7#7518, cval_orders_o_orderpriority#7495 AS cval_orders_o_orderpriority_7#7519, cval_orders_o_clerk#7496 AS cval_orders_o_clerk_7#7520, cval_orders_o_shippriority#7497 AS cval_orders_o_shippriority_7#7521, cval_orders_o_comment#7498 AS cval_orders_o_comment_7#7522, cval_orders_o_orderdate#7499 AS cval_orders_o_orderdate_7#7523, cdepval_orders_o_orderstatus#7500 AS cdepval_orders_o_orderstatus_7#7524, cdepval_orders_o_totalprice#7501 AS cdepval_orders_o_totalprice_7#7525, cdepval_orders_o_orderpriority#7502 AS cdepval_orders_o_orderpriority_7#7526, cdepval_orders_o_clerk#7503 AS cdepval_orders_o_clerk_7#7527, cdepval_orders_o_shippriority#7504 AS cdepval_orders_o_shippriority_7#7528, cdepval_orders_o_comment#7505 AS cdepval_orders_o_comment_7#7529, cdepval_orders_o_orderdate#7506 AS cdepval_orders_o_orderdate_7#7530, co_orderstatus#7507 AS co_orderstatus_7#7531, co_totalprice#7508 AS co_totalprice_7#7532, co_orderpriority#7509 AS co_orderpriority_7#7533, co_clerk#7510 AS co_clerk_7#7534, co_shippriority#7511 AS co_shippriority_7#7535, co_comment#7512 AS co_comment_7#7536, co_orderdate#7513 AS co_orderdate_7#7537]
            :  +- Relation[rid#7490,cpfk_customer_orders#7491,cfpk_orders_customer#7492,cval_orders_o_orderstatus#7493,cval_orders_o_totalprice#7494,cval_orders_o_orderpriority#7495,cval_orders_o_clerk#7496,cval_orders_o_shippriority#7497,cval_orders_o_comment#7498,cval_orders_o_orderdate#7499,cdepval_orders_o_orderstatus#7500,cdepval_orders_o_totalprice#7501,cdepval_orders_o_orderpriority#7502,cdepval_orders_o_clerk#7503,cdepval_orders_o_shippriority#7504,cdepval_orders_o_comment#7505,cdepval_orders_o_orderdate#7506,co_orderstatus#7507,co_totalprice#7508,co_orderpriority#7509,co_clerk#7510,co_shippriority#7511,co_comment#7512,co_orderdate#7513] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#7448 AS rid_6#7469, cpfk_nation_customer#7449 AS cpfk_nation_customer_6#7470, cfpk_customer_nation#7450 AS cfpk_customer_nation_6#7471, cval_customer_c_name#7451 AS cval_customer_c_name_6#7472, cval_customer_c_address#7452 AS cval_customer_c_address_6#7473, cval_customer_c_phone#7453 AS cval_customer_c_phone_6#7474, cval_customer_c_acctbal#7454 AS cval_customer_c_acctbal_6#7475, cval_customer_c_comment#7455 AS cval_customer_c_comment_6#7476, cval_customer_c_mktsegment#7456 AS cval_customer_c_mktsegment_6#7477, cdepval_customer_c_name#7457 AS cdepval_customer_c_name_6#7478, cdepval_customer_c_address#7458 AS cdepval_customer_c_address_6#7479, cdepval_customer_c_phone#7459 AS cdepval_customer_c_phone_6#7480, cdepval_customer_c_acctbal#7460 AS cdepval_customer_c_acctbal_6#7481, cdepval_customer_c_comment#7461 AS cdepval_customer_c_comment_6#7482, cdepval_customer_c_mktsegment#7462 AS cdepval_customer_c_mktsegment_6#7483, cc_name#7463 AS cc_name_6#7484, cc_address#7464 AS cc_address_6#7485, cc_phone#7465 AS cc_phone_6#7486, cc_acctbal#7466 AS cc_acctbal_6#7487, cc_comment#7467 AS cc_comment_6#7488, cc_mktsegment#7468 AS cc_mktsegment_6#7489]
               :  +- Relation[rid#7448,cpfk_nation_customer#7449,cfpk_customer_nation#7450,cval_customer_c_name#7451,cval_customer_c_address#7452,cval_customer_c_phone#7453,cval_customer_c_acctbal#7454,cval_customer_c_comment#7455,cval_customer_c_mktsegment#7456,cdepval_customer_c_name#7457,cdepval_customer_c_address#7458,cdepval_customer_c_phone#7459,cdepval_customer_c_acctbal#7460,cdepval_customer_c_comment#7461,cdepval_customer_c_mktsegment#7462,cc_name#7463,cc_address#7464,cc_phone#7465,cc_acctbal#7466,cc_comment#7467,cc_mktsegment#7468] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join Inner, (dexdecrypt(dexprf(0xF12C2C67FD267F8052626A7378A13D68B34452A56593BA17D2035DC8BA4A5246, dexencode('rid_5, BinaryType)), 'cfpk_nation_region_5) = 'rid_4)
                  :- Project [rid#7430 AS rid_5#7439, cpfk_region_nation#7431 AS cpfk_region_nation_5#7440, cfpk_nation_region#7432 AS cfpk_nation_region_5#7441, cval_nation_n_name#7433 AS cval_nation_n_name_5#7442, cval_nation_n_comment#7434 AS cval_nation_n_comment_5#7443, cdepval_nation_n_name#7435 AS cdepval_nation_n_name_5#7444, cdepval_nation_n_comment#7436 AS cdepval_nation_n_comment_5#7445, cn_name#7437 AS cn_name_5#7446, cn_comment#7438 AS cn_comment_5#7447]
                  :  +- Relation[rid#7430,cpfk_region_nation#7431,cfpk_nation_region#7432,cval_nation_n_name#7433,cval_nation_n_comment#7434,cdepval_nation_n_name#7435,cdepval_nation_n_comment#7436,cn_name#7437,cn_comment#7438] JDBCRelation(tnation) [numPartitions=1]
                  +- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                     +- Project [rid#7402 AS rid_4#7409, cval_region_r_name#7403 AS cval_region_r_name_4#7410, cval_region_r_comment#7404 AS cval_region_r_comment_4#7411, cdepval_region_r_name#7405 AS cdepval_region_r_name_4#7412, cdepval_region_r_comment#7406 AS cdepval_region_r_comment_4#7413, cr_name#7407 AS cr_name_4#7414, cr_comment#7408 AS cr_comment_4#7415]
                        +- Relation[rid#7402,cval_region_r_name#7403,cval_region_r_comment#7404,cdepval_region_r_name#7405,cdepval_region_r_comment#7406,cr_name#7407,cr_comment#7408] JDBCRelation(tregion) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 44976ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/25 22:09:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:09:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7704L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:09:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:09:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:09:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:09:10 WARN DexPlanner: InMemoryFileIndex=customer
20/04/25 22:09:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7704L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#7838 AS rid_2#7883, cpfk_orders_lineitem#7839 AS cpfk_orders_lineitem_2#7884, cpfk_supplier_lineitem#7840 AS cpfk_supplier_lineitem_2#7885, cfpk_lineitem_supplier#7841 AS cfpk_lineitem_supplier_2#7886, cfpk_lineitem_partsupp#7842 AS cfpk_lineitem_partsupp_2#7887, cpfk_part_lineitem#7843 AS cpfk_part_lineitem_2#7888, cfpk_lineitem_part#7844 AS cfpk_lineitem_part_2#7889, cpfk_partsupp_lineitem#7845 AS cpfk_partsupp_lineitem_2#7890, cfpk_lineitem_orders#7846 AS cfpk_lineitem_orders_2#7891, cval_lineitem_l_quantity#7847 AS cval_lineitem_l_quantity_2#7892, cval_lineitem_l_extendedprice#7848 AS cval_lineitem_l_extendedprice_2#7893, cval_lineitem_l_discount#7849 AS cval_lineitem_l_discount_2#7894, cval_lineitem_l_tax#7850 AS cval_lineitem_l_tax_2#7895, cval_lineitem_l_returnflag#7851 AS cval_lineitem_l_returnflag_2#7896, cval_lineitem_l_linestatus#7852 AS cval_lineitem_l_linestatus_2#7897, cval_lineitem_l_commitdate#7853 AS cval_lineitem_l_commitdate_2#7898, cval_lineitem_l_receiptdate#7854 AS cval_lineitem_l_receiptdate_2#7899, cval_lineitem_l_shipinstruct#7855 AS cval_lineitem_l_shipinstruct_2#7900, cval_lineitem_l_shipmode#7856 AS cval_lineitem_l_shipmode_2#7901, cval_lineitem_l_comment#7857 AS cval_lineitem_l_comment_2#7902, cval_lineitem_l_shipdate#7858 AS cval_lineitem_l_shipdate_2#7903, cdepval_lineitem_l_quantity#7859 AS cdepval_lineitem_l_quantity_2#7904, cdepval_lineitem_l_extendedprice#7860 AS cdepval_lineitem_l_extendedprice_2#7905, cdepval_lineitem_l_discount#7861 AS cdepval_lineitem_l_discount_2#7906, ... 21 more fields]
         :  +- Relation[rid#7838,cpfk_orders_lineitem#7839,cpfk_supplier_lineitem#7840,cfpk_lineitem_supplier#7841,cfpk_lineitem_partsupp#7842,cpfk_part_lineitem#7843,cfpk_lineitem_part#7844,cpfk_partsupp_lineitem#7845,cfpk_lineitem_orders#7846,cval_lineitem_l_quantity#7847,cval_lineitem_l_extendedprice#7848,cval_lineitem_l_discount#7849,cval_lineitem_l_tax#7850,cval_lineitem_l_returnflag#7851,cval_lineitem_l_linestatus#7852,cval_lineitem_l_commitdate#7853,cval_lineitem_l_receiptdate#7854,cval_lineitem_l_shipinstruct#7855,cval_lineitem_l_shipmode#7856,cval_lineitem_l_comment#7857,cval_lineitem_l_shipdate#7858,cdepval_lineitem_l_quantity#7859,cdepval_lineitem_l_extendedprice#7860,cdepval_lineitem_l_discount#7861,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#7790 AS rid_1#7814, cpfk_customer_orders#7791 AS cpfk_customer_orders_1#7815, cfpk_orders_customer#7792 AS cfpk_orders_customer_1#7816, cval_orders_o_orderstatus#7793 AS cval_orders_o_orderstatus_1#7817, cval_orders_o_totalprice#7794 AS cval_orders_o_totalprice_1#7818, cval_orders_o_orderpriority#7795 AS cval_orders_o_orderpriority_1#7819, cval_orders_o_clerk#7796 AS cval_orders_o_clerk_1#7820, cval_orders_o_shippriority#7797 AS cval_orders_o_shippriority_1#7821, cval_orders_o_comment#7798 AS cval_orders_o_comment_1#7822, cval_orders_o_orderdate#7799 AS cval_orders_o_orderdate_1#7823, cdepval_orders_o_orderstatus#7800 AS cdepval_orders_o_orderstatus_1#7824, cdepval_orders_o_totalprice#7801 AS cdepval_orders_o_totalprice_1#7825, cdepval_orders_o_orderpriority#7802 AS cdepval_orders_o_orderpriority_1#7826, cdepval_orders_o_clerk#7803 AS cdepval_orders_o_clerk_1#7827, cdepval_orders_o_shippriority#7804 AS cdepval_orders_o_shippriority_1#7828, cdepval_orders_o_comment#7805 AS cdepval_orders_o_comment_1#7829, cdepval_orders_o_orderdate#7806 AS cdepval_orders_o_orderdate_1#7830, co_orderstatus#7807 AS co_orderstatus_1#7831, co_totalprice#7808 AS co_totalprice_1#7832, co_orderpriority#7809 AS co_orderpriority_1#7833, co_clerk#7810 AS co_clerk_1#7834, co_shippriority#7811 AS co_shippriority_1#7835, co_comment#7812 AS co_comment_1#7836, co_orderdate#7813 AS co_orderdate_1#7837]
            :  +- Relation[rid#7790,cpfk_customer_orders#7791,cfpk_orders_customer#7792,cval_orders_o_orderstatus#7793,cval_orders_o_totalprice#7794,cval_orders_o_orderpriority#7795,cval_orders_o_clerk#7796,cval_orders_o_shippriority#7797,cval_orders_o_comment#7798,cval_orders_o_orderdate#7799,cdepval_orders_o_orderstatus#7800,cdepval_orders_o_totalprice#7801,cdepval_orders_o_orderpriority#7802,cdepval_orders_o_clerk#7803,cdepval_orders_o_shippriority#7804,cdepval_orders_o_comment#7805,cdepval_orders_o_orderdate#7806,co_orderstatus#7807,co_totalprice#7808,co_orderpriority#7809,co_clerk#7810,co_shippriority#7811,co_comment#7812,co_orderdate#7813] JDBCRelation(torders) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
               +- Project [rid#7706 AS rid_0#7727, cpfk_nation_customer#7707 AS cpfk_nation_customer_0#7728, cfpk_customer_nation#7708 AS cfpk_customer_nation_0#7729, cval_customer_c_name#7709 AS cval_customer_c_name_0#7730, cval_customer_c_address#7710 AS cval_customer_c_address_0#7731, cval_customer_c_phone#7711 AS cval_customer_c_phone_0#7732, cval_customer_c_acctbal#7712 AS cval_customer_c_acctbal_0#7733, cval_customer_c_comment#7713 AS cval_customer_c_comment_0#7734, cval_customer_c_mktsegment#7714 AS cval_customer_c_mktsegment_0#7735, cdepval_customer_c_name#7715 AS cdepval_customer_c_name_0#7736, cdepval_customer_c_address#7716 AS cdepval_customer_c_address_0#7737, cdepval_customer_c_phone#7717 AS cdepval_customer_c_phone_0#7738, cdepval_customer_c_acctbal#7718 AS cdepval_customer_c_acctbal_0#7739, cdepval_customer_c_comment#7719 AS cdepval_customer_c_comment_0#7740, cdepval_customer_c_mktsegment#7720 AS cdepval_customer_c_mktsegment_0#7741, cc_name#7721 AS cc_name_0#7742, cc_address#7722 AS cc_address_0#7743, cc_phone#7723 AS cc_phone_0#7744, cc_acctbal#7724 AS cc_acctbal_0#7745, cc_comment#7725 AS cc_comment_0#7746, cc_mktsegment#7726 AS cc_mktsegment_0#7747]
                  +- Relation[rid#7706,cpfk_nation_customer#7707,cfpk_customer_nation#7708,cval_customer_c_name#7709,cval_customer_c_address#7710,cval_customer_c_phone#7711,cval_customer_c_acctbal#7712,cval_customer_c_comment#7713,cval_customer_c_mktsegment#7714,cdepval_customer_c_name#7715,cdepval_customer_c_address#7716,cdepval_customer_c_phone#7717,cdepval_customer_c_acctbal#7718,cdepval_customer_c_comment#7719,cdepval_customer_c_mktsegment#7720,cc_name#7721,cc_address#7722,cc_phone#7723,cc_acctbal#7724,cc_comment#7725,cc_mktsegment#7726] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 39587ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/25 22:09:50 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:09:50 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8022L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:09:50 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:09:50 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8022L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#8024 AS rid_0#8069, cpfk_orders_lineitem#8025 AS cpfk_orders_lineitem_0#8070, cpfk_supplier_lineitem#8026 AS cpfk_supplier_lineitem_0#8071, cfpk_lineitem_supplier#8027 AS cfpk_lineitem_supplier_0#8072, cfpk_lineitem_partsupp#8028 AS cfpk_lineitem_partsupp_0#8073, cpfk_part_lineitem#8029 AS cpfk_part_lineitem_0#8074, cfpk_lineitem_part#8030 AS cfpk_lineitem_part_0#8075, cpfk_partsupp_lineitem#8031 AS cpfk_partsupp_lineitem_0#8076, cfpk_lineitem_orders#8032 AS cfpk_lineitem_orders_0#8077, cval_lineitem_l_quantity#8033 AS cval_lineitem_l_quantity_0#8078, cval_lineitem_l_extendedprice#8034 AS cval_lineitem_l_extendedprice_0#8079, cval_lineitem_l_discount#8035 AS cval_lineitem_l_discount_0#8080, cval_lineitem_l_tax#8036 AS cval_lineitem_l_tax_0#8081, cval_lineitem_l_returnflag#8037 AS cval_lineitem_l_returnflag_0#8082, cval_lineitem_l_linestatus#8038 AS cval_lineitem_l_linestatus_0#8083, cval_lineitem_l_commitdate#8039 AS cval_lineitem_l_commitdate_0#8084, cval_lineitem_l_receiptdate#8040 AS cval_lineitem_l_receiptdate_0#8085, cval_lineitem_l_shipinstruct#8041 AS cval_lineitem_l_shipinstruct_0#8086, cval_lineitem_l_shipmode#8042 AS cval_lineitem_l_shipmode_0#8087, cval_lineitem_l_comment#8043 AS cval_lineitem_l_comment_0#8088, cval_lineitem_l_shipdate#8044 AS cval_lineitem_l_shipdate_0#8089, cdepval_lineitem_l_quantity#8045 AS cdepval_lineitem_l_quantity_0#8090, cdepval_lineitem_l_extendedprice#8046 AS cdepval_lineitem_l_extendedprice_0#8091, cdepval_lineitem_l_discount#8047 AS cdepval_lineitem_l_discount_0#8092, ... 21 more fields]
         :  +- Relation[rid#8024,cpfk_orders_lineitem#8025,cpfk_supplier_lineitem#8026,cfpk_lineitem_supplier#8027,cfpk_lineitem_partsupp#8028,cpfk_part_lineitem#8029,cfpk_lineitem_part#8030,cpfk_partsupp_lineitem#8031,cfpk_lineitem_orders#8032,cval_lineitem_l_quantity#8033,cval_lineitem_l_extendedprice#8034,cval_lineitem_l_discount#8035,cval_lineitem_l_tax#8036,cval_lineitem_l_returnflag#8037,cval_lineitem_l_linestatus#8038,cval_lineitem_l_commitdate#8039,cval_lineitem_l_receiptdate#8040,cval_lineitem_l_shipinstruct#8041,cval_lineitem_l_shipmode#8042,cval_lineitem_l_comment#8043,cval_lineitem_l_shipdate#8044,cdepval_lineitem_l_quantity#8045,cdepval_lineitem_l_extendedprice#8046,cdepval_lineitem_l_discount#8047,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_4)
            :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
            :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
            :  :  :- Project [rid#8210 AS rid_2#8255, cpfk_orders_lineitem#8211 AS cpfk_orders_lineitem_2#8256, cpfk_supplier_lineitem#8212 AS cpfk_supplier_lineitem_2#8257, cfpk_lineitem_supplier#8213 AS cfpk_lineitem_supplier_2#8258, cfpk_lineitem_partsupp#8214 AS cfpk_lineitem_partsupp_2#8259, cpfk_part_lineitem#8215 AS cpfk_part_lineitem_2#8260, cfpk_lineitem_part#8216 AS cfpk_lineitem_part_2#8261, cpfk_partsupp_lineitem#8217 AS cpfk_partsupp_lineitem_2#8262, cfpk_lineitem_orders#8218 AS cfpk_lineitem_orders_2#8263, cval_lineitem_l_quantity#8219 AS cval_lineitem_l_quantity_2#8264, cval_lineitem_l_extendedprice#8220 AS cval_lineitem_l_extendedprice_2#8265, cval_lineitem_l_discount#8221 AS cval_lineitem_l_discount_2#8266, cval_lineitem_l_tax#8222 AS cval_lineitem_l_tax_2#8267, cval_lineitem_l_returnflag#8223 AS cval_lineitem_l_returnflag_2#8268, cval_lineitem_l_linestatus#8224 AS cval_lineitem_l_linestatus_2#8269, cval_lineitem_l_commitdate#8225 AS cval_lineitem_l_commitdate_2#8270, cval_lineitem_l_receiptdate#8226 AS cval_lineitem_l_receiptdate_2#8271, cval_lineitem_l_shipinstruct#8227 AS cval_lineitem_l_shipinstruct_2#8272, cval_lineitem_l_shipmode#8228 AS cval_lineitem_l_shipmode_2#8273, cval_lineitem_l_comment#8229 AS cval_lineitem_l_comment_2#8274, cval_lineitem_l_shipdate#8230 AS cval_lineitem_l_shipdate_2#8275, cdepval_lineitem_l_quantity#8231 AS cdepval_lineitem_l_quantity_2#8276, cdepval_lineitem_l_extendedprice#8232 AS cdepval_lineitem_l_extendedprice_2#8277, cdepval_lineitem_l_discount#8233 AS cdepval_lineitem_l_discount_2#8278, ... 21 more fields]
            :  :  :  +- Relation[rid#8210,cpfk_orders_lineitem#8211,cpfk_supplier_lineitem#8212,cfpk_lineitem_supplier#8213,cfpk_lineitem_partsupp#8214,cpfk_part_lineitem#8215,cfpk_lineitem_part#8216,cpfk_partsupp_lineitem#8217,cfpk_lineitem_orders#8218,cval_lineitem_l_quantity#8219,cval_lineitem_l_extendedprice#8220,cval_lineitem_l_discount#8221,cval_lineitem_l_tax#8222,cval_lineitem_l_returnflag#8223,cval_lineitem_l_linestatus#8224,cval_lineitem_l_commitdate#8225,cval_lineitem_l_receiptdate#8226,cval_lineitem_l_shipinstruct#8227,cval_lineitem_l_shipmode#8228,cval_lineitem_l_comment#8229,cval_lineitem_l_shipdate#8230,cdepval_lineitem_l_quantity#8231,cdepval_lineitem_l_extendedprice#8232,cdepval_lineitem_l_discount#8233,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  :  +- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
            :  :     +- Project [rid#8114 AS rid_1#8138, cpfk_customer_orders#8115 AS cpfk_customer_orders_1#8139, cfpk_orders_customer#8116 AS cfpk_orders_customer_1#8140, cval_orders_o_orderstatus#8117 AS cval_orders_o_orderstatus_1#8141, cval_orders_o_totalprice#8118 AS cval_orders_o_totalprice_1#8142, cval_orders_o_orderpriority#8119 AS cval_orders_o_orderpriority_1#8143, cval_orders_o_clerk#8120 AS cval_orders_o_clerk_1#8144, cval_orders_o_shippriority#8121 AS cval_orders_o_shippriority_1#8145, cval_orders_o_comment#8122 AS cval_orders_o_comment_1#8146, cval_orders_o_orderdate#8123 AS cval_orders_o_orderdate_1#8147, cdepval_orders_o_orderstatus#8124 AS cdepval_orders_o_orderstatus_1#8148, cdepval_orders_o_totalprice#8125 AS cdepval_orders_o_totalprice_1#8149, cdepval_orders_o_orderpriority#8126 AS cdepval_orders_o_orderpriority_1#8150, cdepval_orders_o_clerk#8127 AS cdepval_orders_o_clerk_1#8151, cdepval_orders_o_shippriority#8128 AS cdepval_orders_o_shippriority_1#8152, cdepval_orders_o_comment#8129 AS cdepval_orders_o_comment_1#8153, cdepval_orders_o_orderdate#8130 AS cdepval_orders_o_orderdate_1#8154, co_orderstatus#8131 AS co_orderstatus_1#8155, co_totalprice#8132 AS co_totalprice_1#8156, co_orderpriority#8133 AS co_orderpriority_1#8157, co_clerk#8134 AS co_clerk_1#8158, co_shippriority#8135 AS co_shippriority_1#8159, co_comment#8136 AS co_comment_1#8160, co_orderdate#8137 AS co_orderdate_1#8161]
            :  :        +- Relation[rid#8114,cpfk_customer_orders#8115,cfpk_orders_customer#8116,cval_orders_o_orderstatus#8117,cval_orders_o_totalprice#8118,cval_orders_o_orderpriority#8119,cval_orders_o_clerk#8120,cval_orders_o_shippriority#8121,cval_orders_o_comment#8122,cval_orders_o_orderdate#8123,cdepval_orders_o_orderstatus#8124,cdepval_orders_o_totalprice#8125,cdepval_orders_o_orderpriority#8126,cdepval_orders_o_clerk#8127,cdepval_orders_o_shippriority#8128,cdepval_orders_o_comment#8129,cdepval_orders_o_orderdate#8130,co_orderstatus#8131,co_totalprice#8132,co_orderpriority#8133,co_clerk#8134,co_shippriority#8135,co_comment#8136,co_orderdate#8137] JDBCRelation(torders) [numPartitions=1]
            :  +- Project [rid#8300 AS rid_3#8318, cpfk_nation_supplier#8301 AS cpfk_nation_supplier_3#8319, cfpk_supplier_nation#8302 AS cfpk_supplier_nation_3#8320, cval_supplier_s_name#8303 AS cval_supplier_s_name_3#8321, cval_supplier_s_address#8304 AS cval_supplier_s_address_3#8322, cval_supplier_s_phone#8305 AS cval_supplier_s_phone_3#8323, cval_supplier_s_acctbal#8306 AS cval_supplier_s_acctbal_3#8324, cval_supplier_s_comment#8307 AS cval_supplier_s_comment_3#8325, cdepval_supplier_s_name#8308 AS cdepval_supplier_s_name_3#8326, cdepval_supplier_s_address#8309 AS cdepval_supplier_s_address_3#8327, cdepval_supplier_s_phone#8310 AS cdepval_supplier_s_phone_3#8328, cdepval_supplier_s_acctbal#8311 AS cdepval_supplier_s_acctbal_3#8329, cdepval_supplier_s_comment#8312 AS cdepval_supplier_s_comment_3#8330, cs_name#8313 AS cs_name_3#8331, cs_address#8314 AS cs_address_3#8332, cs_phone#8315 AS cs_phone_3#8333, cs_acctbal#8316 AS cs_acctbal_3#8334, cs_comment#8317 AS cs_comment_3#8335]
            :     +- Relation[rid#8300,cpfk_nation_supplier#8301,cfpk_supplier_nation#8302,cval_supplier_s_name#8303,cval_supplier_s_address#8304,cval_supplier_s_phone#8305,cval_supplier_s_acctbal#8306,cval_supplier_s_comment#8307,cdepval_supplier_s_name#8308,cdepval_supplier_s_address#8309,cdepval_supplier_s_phone#8310,cdepval_supplier_s_acctbal#8311,cdepval_supplier_s_comment#8312,cs_name#8313,cs_address#8314,cs_phone#8315,cs_acctbal#8316,cs_comment#8317] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
               +- Project [rid#8336 AS rid_4#8345, cpfk_region_nation#8337 AS cpfk_region_nation_4#8346, cfpk_nation_region#8338 AS cfpk_nation_region_4#8347, cval_nation_n_name#8339 AS cval_nation_n_name_4#8348, cval_nation_n_comment#8340 AS cval_nation_n_comment_4#8349, cdepval_nation_n_name#8341 AS cdepval_nation_n_name_4#8350, cdepval_nation_n_comment#8342 AS cdepval_nation_n_comment_4#8351, cn_name#8343 AS cn_name_4#8352, cn_comment#8344 AS cn_comment_4#8353]
                  +- Relation[rid#8336,cpfk_region_nation#8337,cfpk_nation_region#8338,cval_nation_n_name#8339,cval_nation_n_comment#8340,cdepval_nation_n_name#8341,cdepval_nation_n_comment#8342,cn_name#8343,cn_comment#8344] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 76215ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/25 22:11:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:11:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8518L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:11:06 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8518L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_part_1) = 'rid_0)
         :  :- Project [rid#8620 AS rid_1#8634, cpfk_part_partsupp#8621 AS cpfk_part_partsupp_1#8635, cfpk_partsupp_part#8622 AS cfpk_partsupp_part_1#8636, cpfk_supplier_partsupp#8623 AS cpfk_supplier_partsupp_1#8637, cfpk_partsupp_supplier#8624 AS cfpk_partsupp_supplier_1#8638, cval_partsupp_ps_availqty#8625 AS cval_partsupp_ps_availqty_1#8639, cval_partsupp_ps_supplycost#8626 AS cval_partsupp_ps_supplycost_1#8640, cval_partsupp_ps_comment#8627 AS cval_partsupp_ps_comment_1#8641, cdepval_partsupp_ps_availqty#8628 AS cdepval_partsupp_ps_availqty_1#8642, cdepval_partsupp_ps_supplycost#8629 AS cdepval_partsupp_ps_supplycost_1#8643, cdepval_partsupp_ps_comment#8630 AS cdepval_partsupp_ps_comment_1#8644, cps_availqty#8631 AS cps_availqty_1#8645, cps_supplycost#8632 AS cps_supplycost_1#8646, cps_comment#8633 AS cps_comment_1#8647]
         :  :  +- Relation[rid#8620,cpfk_part_partsupp#8621,cfpk_partsupp_part#8622,cpfk_supplier_partsupp#8623,cfpk_partsupp_supplier#8624,cval_partsupp_ps_availqty#8625,cval_partsupp_ps_supplycost#8626,cval_partsupp_ps_comment#8627,cdepval_partsupp_ps_availqty#8628,cdepval_partsupp_ps_supplycost#8629,cdepval_partsupp_ps_comment#8630,cps_availqty#8631,cps_supplycost#8632,cps_comment#8633] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :     +- Project [rid#8520 AS rid_0#8545, cval_part_p_name#8521 AS cval_part_p_name_0#8546, cval_part_p_mfgr#8522 AS cval_part_p_mfgr_0#8547, cval_part_p_type#8523 AS cval_part_p_type_0#8548, cval_part_p_size#8524 AS cval_part_p_size_0#8549, cval_part_p_container#8525 AS cval_part_p_container_0#8550, cval_part_p_retailprice#8526 AS cval_part_p_retailprice_0#8551, cval_part_p_comment#8527 AS cval_part_p_comment_0#8552, cval_part_p_brand#8528 AS cval_part_p_brand_0#8553, cdepval_part_p_name#8529 AS cdepval_part_p_name_0#8554, cdepval_part_p_mfgr#8530 AS cdepval_part_p_mfgr_0#8555, cdepval_part_p_type#8531 AS cdepval_part_p_type_0#8556, cdepval_part_p_size#8532 AS cdepval_part_p_size_0#8557, cdepval_part_p_container#8533 AS cdepval_part_p_container_0#8558, cdepval_part_p_retailprice#8534 AS cdepval_part_p_retailprice_0#8559, cdepval_part_p_comment#8535 AS cdepval_part_p_comment_0#8560, cdepval_part_p_brand#8536 AS cdepval_part_p_brand_0#8561, cp_name#8537 AS cp_name_0#8562, cp_mfgr#8538 AS cp_mfgr_0#8563, cp_type#8539 AS cp_type_0#8564, cp_size#8540 AS cp_size_0#8565, cp_container#8541 AS cp_container_0#8566, cp_retailprice#8542 AS cp_retailprice_0#8567, cp_comment#8543 AS cp_comment_0#8568, cp_brand#8544 AS cp_brand_0#8569]
         :        +- Relation[rid#8520,cval_part_p_name#8521,cval_part_p_mfgr#8522,cval_part_p_type#8523,cval_part_p_size#8524,cval_part_p_container#8525,cval_part_p_retailprice#8526,cval_part_p_comment#8527,cval_part_p_brand#8528,cdepval_part_p_name#8529,cdepval_part_p_mfgr#8530,cdepval_part_p_type#8531,cdepval_part_p_size#8532,cdepval_part_p_container#8533,cdepval_part_p_retailprice#8534,cdepval_part_p_comment#8535,cdepval_part_p_brand#8536,cp_name#8537,cp_mfgr#8538,cp_type#8539,cp_size#8540,cp_container#8541,cp_retailprice#8542,cp_comment#8543,cp_brand#8544] JDBCRelation(tpart) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_3, BinaryType)), 'cfpk_supplier_nation_3) = 'rid_2)
            :- Project [rid#8684 AS rid_3#8702, cpfk_nation_supplier#8685 AS cpfk_nation_supplier_3#8703, cfpk_supplier_nation#8686 AS cfpk_supplier_nation_3#8704, cval_supplier_s_name#8687 AS cval_supplier_s_name_3#8705, cval_supplier_s_address#8688 AS cval_supplier_s_address_3#8706, cval_supplier_s_phone#8689 AS cval_supplier_s_phone_3#8707, cval_supplier_s_acctbal#8690 AS cval_supplier_s_acctbal_3#8708, cval_supplier_s_comment#8691 AS cval_supplier_s_comment_3#8709, cdepval_supplier_s_name#8692 AS cdepval_supplier_s_name_3#8710, cdepval_supplier_s_address#8693 AS cdepval_supplier_s_address_3#8711, cdepval_supplier_s_phone#8694 AS cdepval_supplier_s_phone_3#8712, cdepval_supplier_s_acctbal#8695 AS cdepval_supplier_s_acctbal_3#8713, cdepval_supplier_s_comment#8696 AS cdepval_supplier_s_comment_3#8714, cs_name#8697 AS cs_name_3#8715, cs_address#8698 AS cs_address_3#8716, cs_phone#8699 AS cs_phone_3#8717, cs_acctbal#8700 AS cs_acctbal_3#8718, cs_comment#8701 AS cs_comment_3#8719]
            :  +- Relation[rid#8684,cpfk_nation_supplier#8685,cfpk_supplier_nation#8686,cval_supplier_s_name#8687,cval_supplier_s_address#8688,cval_supplier_s_phone#8689,cval_supplier_s_acctbal#8690,cval_supplier_s_comment#8691,cdepval_supplier_s_name#8692,cdepval_supplier_s_address#8693,cdepval_supplier_s_phone#8694,cdepval_supplier_s_acctbal#8695,cdepval_supplier_s_comment#8696,cs_name#8697,cs_address#8698,cs_phone#8699,cs_acctbal#8700,cs_comment#8701] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
               +- Project [rid#8648 AS rid_2#8657, cpfk_region_nation#8649 AS cpfk_region_nation_2#8658, cfpk_nation_region#8650 AS cfpk_nation_region_2#8659, cval_nation_n_name#8651 AS cval_nation_n_name_2#8660, cval_nation_n_comment#8652 AS cval_nation_n_comment_2#8661, cdepval_nation_n_name#8653 AS cdepval_nation_n_name_2#8662, cdepval_nation_n_comment#8654 AS cdepval_nation_n_comment_2#8663, cn_name#8655 AS cn_name_2#8664, cn_comment#8656 AS cn_comment_2#8665]
                  +- Relation[rid#8648,cpfk_region_nation#8649,cfpk_nation_region#8650,cval_nation_n_name#8651,cval_nation_n_comment#8652,cdepval_nation_n_name#8653,cdepval_nation_n_comment#8654,cn_name#8655,cn_comment#8656] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 3795ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/25 22:11:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:11:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8793L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/25 22:11:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8793L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#8831 AS rid_1#8876, cpfk_orders_lineitem#8832 AS cpfk_orders_lineitem_1#8877, cpfk_supplier_lineitem#8833 AS cpfk_supplier_lineitem_1#8878, cfpk_lineitem_supplier#8834 AS cfpk_lineitem_supplier_1#8879, cfpk_lineitem_partsupp#8835 AS cfpk_lineitem_partsupp_1#8880, cpfk_part_lineitem#8836 AS cpfk_part_lineitem_1#8881, cfpk_lineitem_part#8837 AS cfpk_lineitem_part_1#8882, cpfk_partsupp_lineitem#8838 AS cpfk_partsupp_lineitem_1#8883, cfpk_lineitem_orders#8839 AS cfpk_lineitem_orders_1#8884, cval_lineitem_l_quantity#8840 AS cval_lineitem_l_quantity_1#8885, cval_lineitem_l_extendedprice#8841 AS cval_lineitem_l_extendedprice_1#8886, cval_lineitem_l_discount#8842 AS cval_lineitem_l_discount_1#8887, cval_lineitem_l_tax#8843 AS cval_lineitem_l_tax_1#8888, cval_lineitem_l_returnflag#8844 AS cval_lineitem_l_returnflag_1#8889, cval_lineitem_l_linestatus#8845 AS cval_lineitem_l_linestatus_1#8890, cval_lineitem_l_commitdate#8846 AS cval_lineitem_l_commitdate_1#8891, cval_lineitem_l_receiptdate#8847 AS cval_lineitem_l_receiptdate_1#8892, cval_lineitem_l_shipinstruct#8848 AS cval_lineitem_l_shipinstruct_1#8893, cval_lineitem_l_shipmode#8849 AS cval_lineitem_l_shipmode_1#8894, cval_lineitem_l_comment#8850 AS cval_lineitem_l_comment_1#8895, cval_lineitem_l_shipdate#8851 AS cval_lineitem_l_shipdate_1#8896, cdepval_lineitem_l_quantity#8852 AS cdepval_lineitem_l_quantity_1#8897, cdepval_lineitem_l_extendedprice#8853 AS cdepval_lineitem_l_extendedprice_1#8898, cdepval_lineitem_l_discount#8854 AS cdepval_lineitem_l_discount_1#8899, ... 21 more fields]
         :  +- Relation[rid#8831,cpfk_orders_lineitem#8832,cpfk_supplier_lineitem#8833,cfpk_lineitem_supplier#8834,cfpk_lineitem_partsupp#8835,cpfk_part_lineitem#8836,cfpk_lineitem_part#8837,cpfk_partsupp_lineitem#8838,cfpk_lineitem_orders#8839,cval_lineitem_l_quantity#8840,cval_lineitem_l_extendedprice#8841,cval_lineitem_l_discount#8842,cval_lineitem_l_tax#8843,cval_lineitem_l_returnflag#8844,cval_lineitem_l_linestatus#8845,cval_lineitem_l_commitdate#8846,cval_lineitem_l_receiptdate#8847,cval_lineitem_l_shipinstruct#8848,cval_lineitem_l_shipmode#8849,cval_lineitem_l_comment#8850,cval_lineitem_l_shipdate#8851,cdepval_lineitem_l_quantity#8852,cdepval_lineitem_l_extendedprice#8853,cdepval_lineitem_l_discount#8854,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8795 AS rid_0#8813, cpfk_nation_supplier#8796 AS cpfk_nation_supplier_0#8814, cfpk_supplier_nation#8797 AS cfpk_supplier_nation_0#8815, cval_supplier_s_name#8798 AS cval_supplier_s_name_0#8816, cval_supplier_s_address#8799 AS cval_supplier_s_address_0#8817, cval_supplier_s_phone#8800 AS cval_supplier_s_phone_0#8818, cval_supplier_s_acctbal#8801 AS cval_supplier_s_acctbal_0#8819, cval_supplier_s_comment#8802 AS cval_supplier_s_comment_0#8820, cdepval_supplier_s_name#8803 AS cdepval_supplier_s_name_0#8821, cdepval_supplier_s_address#8804 AS cdepval_supplier_s_address_0#8822, cdepval_supplier_s_phone#8805 AS cdepval_supplier_s_phone_0#8823, cdepval_supplier_s_acctbal#8806 AS cdepval_supplier_s_acctbal_0#8824, cdepval_supplier_s_comment#8807 AS cdepval_supplier_s_comment_0#8825, cs_name#8808 AS cs_name_0#8826, cs_address#8809 AS cs_address_0#8827, cs_phone#8810 AS cs_phone_0#8828, cs_acctbal#8811 AS cs_acctbal_0#8829, cs_comment#8812 AS cs_comment_0#8830]
            +- Relation[rid#8795,cpfk_nation_supplier#8796,cfpk_supplier_nation#8797,cval_supplier_s_name#8798,cval_supplier_s_address#8799,cval_supplier_s_phone#8800,cval_supplier_s_acctbal#8801,cval_supplier_s_comment#8802,cdepval_supplier_s_name#8803,cdepval_supplier_s_address#8804,cdepval_supplier_s_phone#8805,cdepval_supplier_s_acctbal#8806,cdepval_supplier_s_comment#8807,cs_name#8808,cs_address#8809,cs_phone#8810,cs_acctbal#8811,cs_comment#8812] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17298ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/25 22:11:27 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/25 22:11:27 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8990L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=nation
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/25 22:11:27 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/25 22:11:27 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8990L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#9064 AS rid_2#9078, cpfk_part_partsupp#9065 AS cpfk_part_partsupp_2#9079, cfpk_partsupp_part#9066 AS cfpk_partsupp_part_2#9080, cpfk_supplier_partsupp#9067 AS cpfk_supplier_partsupp_2#9081, cfpk_partsupp_supplier#9068 AS cfpk_partsupp_supplier_2#9082, cval_partsupp_ps_availqty#9069 AS cval_partsupp_ps_availqty_2#9083, cval_partsupp_ps_supplycost#9070 AS cval_partsupp_ps_supplycost_2#9084, cval_partsupp_ps_comment#9071 AS cval_partsupp_ps_comment_2#9085, cdepval_partsupp_ps_availqty#9072 AS cdepval_partsupp_ps_availqty_2#9086, cdepval_partsupp_ps_supplycost#9073 AS cdepval_partsupp_ps_supplycost_2#9087, cdepval_partsupp_ps_comment#9074 AS cdepval_partsupp_ps_comment_2#9088, cps_availqty#9075 AS cps_availqty_2#9089, cps_supplycost#9076 AS cps_supplycost_2#9090, cps_comment#9077 AS cps_comment_2#9091]
         :  +- Relation[rid#9064,cpfk_part_partsupp#9065,cfpk_partsupp_part#9066,cpfk_supplier_partsupp#9067,cfpk_partsupp_supplier#9068,cval_partsupp_ps_availqty#9069,cval_partsupp_ps_supplycost#9070,cval_partsupp_ps_comment#9071,cdepval_partsupp_ps_availqty#9072,cdepval_partsupp_ps_supplycost#9073,cdepval_partsupp_ps_comment#9074,cps_availqty#9075,cps_supplycost#9076,cps_comment#9077] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
            :- Project [rid#9028 AS rid_1#9046, cpfk_nation_supplier#9029 AS cpfk_nation_supplier_1#9047, cfpk_supplier_nation#9030 AS cfpk_supplier_nation_1#9048, cval_supplier_s_name#9031 AS cval_supplier_s_name_1#9049, cval_supplier_s_address#9032 AS cval_supplier_s_address_1#9050, cval_supplier_s_phone#9033 AS cval_supplier_s_phone_1#9051, cval_supplier_s_acctbal#9034 AS cval_supplier_s_acctbal_1#9052, cval_supplier_s_comment#9035 AS cval_supplier_s_comment_1#9053, cdepval_supplier_s_name#9036 AS cdepval_supplier_s_name_1#9054, cdepval_supplier_s_address#9037 AS cdepval_supplier_s_address_1#9055, cdepval_supplier_s_phone#9038 AS cdepval_supplier_s_phone_1#9056, cdepval_supplier_s_acctbal#9039 AS cdepval_supplier_s_acctbal_1#9057, cdepval_supplier_s_comment#9040 AS cdepval_supplier_s_comment_1#9058, cs_name#9041 AS cs_name_1#9059, cs_address#9042 AS cs_address_1#9060, cs_phone#9043 AS cs_phone_1#9061, cs_acctbal#9044 AS cs_acctbal_1#9062, cs_comment#9045 AS cs_comment_1#9063]
            :  +- Relation[rid#9028,cpfk_nation_supplier#9029,cfpk_supplier_nation#9030,cval_supplier_s_name#9031,cval_supplier_s_address#9032,cval_supplier_s_phone#9033,cval_supplier_s_acctbal#9034,cval_supplier_s_comment#9035,cdepval_supplier_s_name#9036,cdepval_supplier_s_address#9037,cdepval_supplier_s_phone#9038,cdepval_supplier_s_acctbal#9039,cdepval_supplier_s_comment#9040,cs_name#9041,cs_address#9042,cs_phone#9043,cs_acctbal#9044,cs_comment#9045] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
               +- Project [rid#8992 AS rid_0#9001, cpfk_region_nation#8993 AS cpfk_region_nation_0#9002, cfpk_nation_region#8994 AS cfpk_nation_region_0#9003, cval_nation_n_name#8995 AS cval_nation_n_name_0#9004, cval_nation_n_comment#8996 AS cval_nation_n_comment_0#9005, cdepval_nation_n_name#8997 AS cdepval_nation_n_name_0#9006, cdepval_nation_n_comment#8998 AS cdepval_nation_n_comment_0#9007, cn_name#8999 AS cn_name_0#9008, cn_comment#9000 AS cn_comment_0#9009]
                  +- Relation[rid#8992,cpfk_region_nation#8993,cfpk_nation_region#8994,cval_nation_n_name#8995,cval_nation_n_comment#8996,cdepval_nation_n_name#8997,cdepval_nation_n_comment#8998,cn_name#8999,cn_comment#9000] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 3453ms
query=q1, count=6001215, duration=2312
query=q10, count=1478870, duration=60694
query=q11, count=31680, duration=3453
query=q12, count=857401, duration=21426
query=q13, count=1500000, duration=4387
query=q14, count=6001215, duration=17763
query=q15, count=6001215, duration=17298
query=q16, count=15780, duration=3593
query=q17, count=6088, duration=25759
query=q18, count=6001215, duration=22073
query=q19, count=205, duration=16173
query=q2, count=3162, duration=3659
query=q20, count=632, duration=3795
query=q21a, count=597422, duration=76215
query=q22, count=1500000, duration=4353
query=q3, count=1214743, duration=39587
query=q4, count=6001215, duration=19899
query=q5, count=48089, duration=30596
query=q6, count=6001215, duration=2438
query=q7, count=9735, duration=35236
query=q8, count=8716, duration=44976
query=q9a, count=6001215, duration=63950
query=q9b, count=6001215, duration=37821
