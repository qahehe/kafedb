20/04/26 21:21:17 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10664ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 21:21:20 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 21:21:21 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 21:21:21 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 21:21:22 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 21:21:22 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 21:21:26 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 21:21:29 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 21:21:29 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:21:31 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:21:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2083L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:21:31 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:21:31 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 21:21:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2083L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#2217 AS rid_4#2262, cpfk_orders_lineitem#2218 AS cpfk_orders_lineitem_4#2263, cpfk_supplier_lineitem#2219 AS cpfk_supplier_lineitem_4#2264, cfpk_lineitem_supplier#2220 AS cfpk_lineitem_supplier_4#2265, cfpk_lineitem_partsupp#2221 AS cfpk_lineitem_partsupp_4#2266, cpfk_part_lineitem#2222 AS cpfk_part_lineitem_4#2267, cfpk_lineitem_part#2223 AS cfpk_lineitem_part_4#2268, cpfk_partsupp_lineitem#2224 AS cpfk_partsupp_lineitem_4#2269, cfpk_lineitem_orders#2225 AS cfpk_lineitem_orders_4#2270, cval_lineitem_l_quantity#2226 AS cval_lineitem_l_quantity_4#2271, cval_lineitem_l_extendedprice#2227 AS cval_lineitem_l_extendedprice_4#2272, cval_lineitem_l_discount#2228 AS cval_lineitem_l_discount_4#2273, cval_lineitem_l_tax#2229 AS cval_lineitem_l_tax_4#2274, cval_lineitem_l_returnflag#2230 AS cval_lineitem_l_returnflag_4#2275, cval_lineitem_l_linestatus#2231 AS cval_lineitem_l_linestatus_4#2276, cval_lineitem_l_commitdate#2232 AS cval_lineitem_l_commitdate_4#2277, cval_lineitem_l_receiptdate#2233 AS cval_lineitem_l_receiptdate_4#2278, cval_lineitem_l_shipinstruct#2234 AS cval_lineitem_l_shipinstruct_4#2279, cval_lineitem_l_shipmode#2235 AS cval_lineitem_l_shipmode_4#2280, cval_lineitem_l_comment#2236 AS cval_lineitem_l_comment_4#2281, cval_lineitem_l_shipdate#2237 AS cval_lineitem_l_shipdate_4#2282, cdepval_lineitem_l_quantity#2238 AS cdepval_lineitem_l_quantity_4#2283, cdepval_lineitem_l_extendedprice#2239 AS cdepval_lineitem_l_extendedprice_4#2284, cdepval_lineitem_l_discount#2240 AS cdepval_lineitem_l_discount_4#2285, ... 21 more fields]
         :  :  +- Relation[rid#2217,cpfk_orders_lineitem#2218,cpfk_supplier_lineitem#2219,cfpk_lineitem_supplier#2220,cfpk_lineitem_partsupp#2221,cpfk_part_lineitem#2222,cfpk_lineitem_part#2223,cpfk_partsupp_lineitem#2224,cfpk_lineitem_orders#2225,cval_lineitem_l_quantity#2226,cval_lineitem_l_extendedprice#2227,cval_lineitem_l_discount#2228,cval_lineitem_l_tax#2229,cval_lineitem_l_returnflag#2230,cval_lineitem_l_linestatus#2231,cval_lineitem_l_commitdate#2232,cval_lineitem_l_receiptdate#2233,cval_lineitem_l_shipinstruct#2234,cval_lineitem_l_shipmode#2235,cval_lineitem_l_comment#2236,cval_lineitem_l_shipdate#2237,cdepval_lineitem_l_quantity#2238,cdepval_lineitem_l_extendedprice#2239,cdepval_lineitem_l_discount#2240,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#2139 AS rid_2#2153, cpfk_part_partsupp#2140 AS cpfk_part_partsupp_2#2154, cfpk_partsupp_part#2141 AS cfpk_partsupp_part_2#2155, cpfk_supplier_partsupp#2142 AS cpfk_supplier_partsupp_2#2156, cfpk_partsupp_supplier#2143 AS cfpk_partsupp_supplier_2#2157, cval_partsupp_ps_availqty#2144 AS cval_partsupp_ps_availqty_2#2158, cval_partsupp_ps_supplycost#2145 AS cval_partsupp_ps_supplycost_2#2159, cval_partsupp_ps_comment#2146 AS cval_partsupp_ps_comment_2#2160, cdepval_partsupp_ps_availqty#2147 AS cdepval_partsupp_ps_availqty_2#2161, cdepval_partsupp_ps_supplycost#2148 AS cdepval_partsupp_ps_supplycost_2#2162, cdepval_partsupp_ps_comment#2149 AS cdepval_partsupp_ps_comment_2#2163, cps_availqty#2150 AS cps_availqty_2#2164, cps_supplycost#2151 AS cps_supplycost_2#2165, cps_comment#2152 AS cps_comment_2#2166]
         :     :  :  +- Relation[rid#2139,cpfk_part_partsupp#2140,cfpk_partsupp_part#2141,cpfk_supplier_partsupp#2142,cfpk_partsupp_supplier#2143,cval_partsupp_ps_availqty#2144,cval_partsupp_ps_supplycost#2145,cval_partsupp_ps_comment#2146,cdepval_partsupp_ps_availqty#2147,cdepval_partsupp_ps_supplycost#2148,cdepval_partsupp_ps_comment#2149,cps_availqty#2150,cps_supplycost#2151,cps_comment#2152] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#2103 AS rid_1#2121, cpfk_nation_supplier#2104 AS cpfk_nation_supplier_1#2122, cfpk_supplier_nation#2105 AS cfpk_supplier_nation_1#2123, cval_supplier_s_name#2106 AS cval_supplier_s_name_1#2124, cval_supplier_s_address#2107 AS cval_supplier_s_address_1#2125, cval_supplier_s_phone#2108 AS cval_supplier_s_phone_1#2126, cval_supplier_s_acctbal#2109 AS cval_supplier_s_acctbal_1#2127, cval_supplier_s_comment#2110 AS cval_supplier_s_comment_1#2128, cdepval_supplier_s_name#2111 AS cdepval_supplier_s_name_1#2129, cdepval_supplier_s_address#2112 AS cdepval_supplier_s_address_1#2130, cdepval_supplier_s_phone#2113 AS cdepval_supplier_s_phone_1#2131, cdepval_supplier_s_acctbal#2114 AS cdepval_supplier_s_acctbal_1#2132, cdepval_supplier_s_comment#2115 AS cdepval_supplier_s_comment_1#2133, cs_name#2116 AS cs_name_1#2134, cs_address#2117 AS cs_address_1#2135, cs_phone#2118 AS cs_phone_1#2136, cs_acctbal#2119 AS cs_acctbal_1#2137, cs_comment#2120 AS cs_comment_1#2138]
         :     :     :  +- Relation[rid#2103,cpfk_nation_supplier#2104,cfpk_supplier_nation#2105,cval_supplier_s_name#2106,cval_supplier_s_address#2107,cval_supplier_s_phone#2108,cval_supplier_s_acctbal#2109,cval_supplier_s_comment#2110,cdepval_supplier_s_name#2111,cdepval_supplier_s_address#2112,cdepval_supplier_s_phone#2113,cdepval_supplier_s_acctbal#2114,cdepval_supplier_s_comment#2115,cs_name#2116,cs_address#2117,cs_phone#2118,cs_acctbal#2119,cs_comment#2120] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#2085 AS rid_0#2094, cpfk_region_nation#2086 AS cpfk_region_nation_0#2095, cfpk_nation_region#2087 AS cfpk_nation_region_0#2096, cval_nation_n_name#2088 AS cval_nation_n_name_0#2097, cval_nation_n_comment#2089 AS cval_nation_n_comment_0#2098, cdepval_nation_n_name#2090 AS cdepval_nation_n_name_0#2099, cdepval_nation_n_comment#2091 AS cdepval_nation_n_comment_0#2100, cn_name#2092 AS cn_name_0#2101, cn_comment#2093 AS cn_comment_0#2102]
         :     :        +- Relation[rid#2085,cpfk_region_nation#2086,cfpk_nation_region#2087,cval_nation_n_name#2088,cval_nation_n_comment#2089,cdepval_nation_n_name#2090,cdepval_nation_n_comment#2091,cn_name#2092,cn_comment#2093] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#2167 AS rid_3#2192, cval_part_p_name#2168 AS cval_part_p_name_3#2193, cval_part_p_mfgr#2169 AS cval_part_p_mfgr_3#2194, cval_part_p_type#2170 AS cval_part_p_type_3#2195, cval_part_p_size#2171 AS cval_part_p_size_3#2196, cval_part_p_container#2172 AS cval_part_p_container_3#2197, cval_part_p_retailprice#2173 AS cval_part_p_retailprice_3#2198, cval_part_p_comment#2174 AS cval_part_p_comment_3#2199, cval_part_p_brand#2175 AS cval_part_p_brand_3#2200, cdepval_part_p_name#2176 AS cdepval_part_p_name_3#2201, cdepval_part_p_mfgr#2177 AS cdepval_part_p_mfgr_3#2202, cdepval_part_p_type#2178 AS cdepval_part_p_type_3#2203, cdepval_part_p_size#2179 AS cdepval_part_p_size_3#2204, cdepval_part_p_container#2180 AS cdepval_part_p_container_3#2205, cdepval_part_p_retailprice#2181 AS cdepval_part_p_retailprice_3#2206, cdepval_part_p_comment#2182 AS cdepval_part_p_comment_3#2207, cdepval_part_p_brand#2183 AS cdepval_part_p_brand_3#2208, cp_name#2184 AS cp_name_3#2209, cp_mfgr#2185 AS cp_mfgr_3#2210, cp_type#2186 AS cp_type_3#2211, cp_size#2187 AS cp_size_3#2212, cp_container#2188 AS cp_container_3#2213, cp_retailprice#2189 AS cp_retailprice_3#2214, cp_comment#2190 AS cp_comment_3#2215, cp_brand#2191 AS cp_brand_3#2216]
         :        +- Relation[rid#2167,cval_part_p_name#2168,cval_part_p_mfgr#2169,cval_part_p_type#2170,cval_part_p_size#2171,cval_part_p_container#2172,cval_part_p_retailprice#2173,cval_part_p_comment#2174,cval_part_p_brand#2175,cdepval_part_p_name#2176,cdepval_part_p_mfgr#2177,cdepval_part_p_type#2178,cdepval_part_p_size#2179,cdepval_part_p_container#2180,cdepval_part_p_retailprice#2181,cdepval_part_p_comment#2182,cdepval_part_p_brand#2183,cp_name#2184,cp_mfgr#2185,cp_type#2186,cp_size#2187,cp_container#2188,cp_retailprice#2189,cp_comment#2190,cp_brand#2191] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#2307 AS rid_5#2331, cpfk_customer_orders#2308 AS cpfk_customer_orders_5#2332, cfpk_orders_customer#2309 AS cfpk_orders_customer_5#2333, cval_orders_o_orderstatus#2310 AS cval_orders_o_orderstatus_5#2334, cval_orders_o_totalprice#2311 AS cval_orders_o_totalprice_5#2335, cval_orders_o_orderpriority#2312 AS cval_orders_o_orderpriority_5#2336, cval_orders_o_clerk#2313 AS cval_orders_o_clerk_5#2337, cval_orders_o_shippriority#2314 AS cval_orders_o_shippriority_5#2338, cval_orders_o_comment#2315 AS cval_orders_o_comment_5#2339, cval_orders_o_orderdate#2316 AS cval_orders_o_orderdate_5#2340, cdepval_orders_o_orderstatus#2317 AS cdepval_orders_o_orderstatus_5#2341, cdepval_orders_o_totalprice#2318 AS cdepval_orders_o_totalprice_5#2342, cdepval_orders_o_orderpriority#2319 AS cdepval_orders_o_orderpriority_5#2343, cdepval_orders_o_clerk#2320 AS cdepval_orders_o_clerk_5#2344, cdepval_orders_o_shippriority#2321 AS cdepval_orders_o_shippriority_5#2345, cdepval_orders_o_comment#2322 AS cdepval_orders_o_comment_5#2346, cdepval_orders_o_orderdate#2323 AS cdepval_orders_o_orderdate_5#2347, co_orderstatus#2324 AS co_orderstatus_5#2348, co_totalprice#2325 AS co_totalprice_5#2349, co_orderpriority#2326 AS co_orderpriority_5#2350, co_clerk#2327 AS co_clerk_5#2351, co_shippriority#2328 AS co_shippriority_5#2352, co_comment#2329 AS co_comment_5#2353, co_orderdate#2330 AS co_orderdate_5#2354]
            +- Relation[rid#2307,cpfk_customer_orders#2308,cfpk_orders_customer#2309,cval_orders_o_orderstatus#2310,cval_orders_o_totalprice#2311,cval_orders_o_orderpriority#2312,cval_orders_o_clerk#2313,cval_orders_o_shippriority#2314,cval_orders_o_comment#2315,cval_orders_o_orderdate#2316,cdepval_orders_o_orderstatus#2317,cdepval_orders_o_totalprice#2318,cdepval_orders_o_orderpriority#2319,cdepval_orders_o_clerk#2320,cdepval_orders_o_shippriority#2321,cdepval_orders_o_comment#2322,cdepval_orders_o_orderdate#2323,co_orderstatus#2324,co_totalprice#2325,co_orderpriority#2326,co_clerk#2327,co_shippriority#2328,co_comment#2329,co_orderdate#2330] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 38010ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 21:22:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:22:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2495L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:22:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2495L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2522, cval_part_p_name_0#2523, cval_part_p_mfgr_0#2524, cval_part_p_type_0#2525, cval_part_p_size_0#2526, cval_part_p_container_0#2527, cval_part_p_retailprice_0#2528, cval_part_p_comment_0#2529, cval_part_p_brand_0#2530, cdepval_part_p_name_0#2531, cdepval_part_p_mfgr_0#2532, cdepval_part_p_type_0#2533, cdepval_part_p_size_0#2534, cdepval_part_p_container_0#2535, cdepval_part_p_retailprice_0#2536, cdepval_part_p_comment_0#2537, cdepval_part_p_brand_0#2538, cp_name_0#2539, cp_mfgr_0#2540, cp_type_0#2541, cp_size_0#2542, cp_container_0#2543, cp_retailprice_0#2544, cp_comment_0#2545, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#2497 AS rid_0#2522, cval_part_p_name#2498 AS cval_part_p_name_0#2523, cval_part_p_mfgr#2499 AS cval_part_p_mfgr_0#2524, cval_part_p_type#2500 AS cval_part_p_type_0#2525, cval_part_p_size#2501 AS cval_part_p_size_0#2526, cval_part_p_container#2502 AS cval_part_p_container_0#2527, cval_part_p_retailprice#2503 AS cval_part_p_retailprice_0#2528, cval_part_p_comment#2504 AS cval_part_p_comment_0#2529, cval_part_p_brand#2505 AS cval_part_p_brand_0#2530, cdepval_part_p_name#2506 AS cdepval_part_p_name_0#2531, cdepval_part_p_mfgr#2507 AS cdepval_part_p_mfgr_0#2532, cdepval_part_p_type#2508 AS cdepval_part_p_type_0#2533, cdepval_part_p_size#2509 AS cdepval_part_p_size_0#2534, cdepval_part_p_container#2510 AS cdepval_part_p_container_0#2535, cdepval_part_p_retailprice#2511 AS cdepval_part_p_retailprice_0#2536, cdepval_part_p_comment#2512 AS cdepval_part_p_comment_0#2537, cdepval_part_p_brand#2513 AS cdepval_part_p_brand_0#2538, cp_name#2514 AS cp_name_0#2539, cp_mfgr#2515 AS cp_mfgr_0#2540, cp_type#2516 AS cp_type_0#2541, cp_size#2517 AS cp_size_0#2542, cp_container#2518 AS cp_container_0#2543, cp_retailprice#2519 AS cp_retailprice_0#2544, cp_comment#2520 AS cp_comment_0#2545, cp_brand#2521 AS cp_brand_0#2546]
         :  :        +- Relation[rid#2497,cval_part_p_name#2498,cval_part_p_mfgr#2499,cval_part_p_type#2500,cval_part_p_size#2501,cval_part_p_container#2502,cval_part_p_retailprice#2503,cval_part_p_comment#2504,cval_part_p_brand#2505,cdepval_part_p_name#2506,cdepval_part_p_mfgr#2507,cdepval_part_p_type#2508,cdepval_part_p_size#2509,cdepval_part_p_container#2510,cdepval_part_p_retailprice#2511,cdepval_part_p_comment#2512,cdepval_part_p_brand#2513,cp_name#2514,cp_mfgr#2515,cp_type#2516,cp_size#2517,cp_container#2518,cp_retailprice#2519,cp_comment#2520,cp_brand#2521] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#2967 AS rid_1#3012, cpfk_orders_lineitem#2968 AS cpfk_orders_lineitem_1#3013, cpfk_supplier_lineitem#2969 AS cpfk_supplier_lineitem_1#3014, cfpk_lineitem_supplier#2970 AS cfpk_lineitem_supplier_1#3015, cfpk_lineitem_partsupp#2971 AS cfpk_lineitem_partsupp_1#3016, cpfk_part_lineitem#2972 AS cpfk_part_lineitem_1#3017, cfpk_lineitem_part#2973 AS cfpk_lineitem_part_1#3018, cpfk_partsupp_lineitem#2974 AS cpfk_partsupp_lineitem_1#3019, cfpk_lineitem_orders#2975 AS cfpk_lineitem_orders_1#3020, cval_lineitem_l_quantity#2976 AS cval_lineitem_l_quantity_1#3021, cval_lineitem_l_extendedprice#2977 AS cval_lineitem_l_extendedprice_1#3022, cval_lineitem_l_discount#2978 AS cval_lineitem_l_discount_1#3023, cval_lineitem_l_tax#2979 AS cval_lineitem_l_tax_1#3024, cval_lineitem_l_returnflag#2980 AS cval_lineitem_l_returnflag_1#3025, cval_lineitem_l_linestatus#2981 AS cval_lineitem_l_linestatus_1#3026, cval_lineitem_l_commitdate#2982 AS cval_lineitem_l_commitdate_1#3027, cval_lineitem_l_receiptdate#2983 AS cval_lineitem_l_receiptdate_1#3028, cval_lineitem_l_shipinstruct#2984 AS cval_lineitem_l_shipinstruct_1#3029, cval_lineitem_l_shipmode#2985 AS cval_lineitem_l_shipmode_1#3030, cval_lineitem_l_comment#2986 AS cval_lineitem_l_comment_1#3031, cval_lineitem_l_shipdate#2987 AS cval_lineitem_l_shipdate_1#3032, cdepval_lineitem_l_quantity#2988 AS cdepval_lineitem_l_quantity_1#3033, cdepval_lineitem_l_extendedprice#2989 AS cdepval_lineitem_l_extendedprice_1#3034, cdepval_lineitem_l_discount#2990 AS cdepval_lineitem_l_discount_1#3035, ... 21 more fields]
         :        +- Relation[rid#2967,cpfk_orders_lineitem#2968,cpfk_supplier_lineitem#2969,cfpk_lineitem_supplier#2970,cfpk_lineitem_partsupp#2971,cpfk_part_lineitem#2972,cfpk_lineitem_part#2973,cpfk_partsupp_lineitem#2974,cfpk_lineitem_orders#2975,cval_lineitem_l_quantity#2976,cval_lineitem_l_extendedprice#2977,cval_lineitem_l_discount#2978,cval_lineitem_l_tax#2979,cval_lineitem_l_returnflag#2980,cval_lineitem_l_linestatus#2981,cval_lineitem_l_commitdate#2982,cval_lineitem_l_receiptdate#2983,cval_lineitem_l_shipinstruct#2984,cval_lineitem_l_shipmode#2985,cval_lineitem_l_comment#2986,cval_lineitem_l_shipdate#2987,cdepval_lineitem_l_quantity#2988,cdepval_lineitem_l_extendedprice#2989,cdepval_lineitem_l_discount#2990,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#2647 AS rid_1#2692, cpfk_orders_lineitem#2648 AS cpfk_orders_lineitem_1#2693, cpfk_supplier_lineitem#2649 AS cpfk_supplier_lineitem_1#2694, cfpk_lineitem_supplier#2650 AS cfpk_lineitem_supplier_1#2695, cfpk_lineitem_partsupp#2651 AS cfpk_lineitem_partsupp_1#2696, cpfk_part_lineitem#2652 AS cpfk_part_lineitem_1#2697, cfpk_lineitem_part#2653 AS cfpk_lineitem_part_1#2698, cpfk_partsupp_lineitem#2654 AS cpfk_partsupp_lineitem_1#2699, cfpk_lineitem_orders#2655 AS cfpk_lineitem_orders_1#2700, cval_lineitem_l_quantity#2656 AS cval_lineitem_l_quantity_1#2701, cval_lineitem_l_extendedprice#2657 AS cval_lineitem_l_extendedprice_1#2702, cval_lineitem_l_discount#2658 AS cval_lineitem_l_discount_1#2703, cval_lineitem_l_tax#2659 AS cval_lineitem_l_tax_1#2704, cval_lineitem_l_returnflag#2660 AS cval_lineitem_l_returnflag_1#2705, cval_lineitem_l_linestatus#2661 AS cval_lineitem_l_linestatus_1#2706, cval_lineitem_l_commitdate#2662 AS cval_lineitem_l_commitdate_1#2707, cval_lineitem_l_receiptdate#2663 AS cval_lineitem_l_receiptdate_1#2708, cval_lineitem_l_shipinstruct#2664 AS cval_lineitem_l_shipinstruct_1#2709, cval_lineitem_l_shipmode#2665 AS cval_lineitem_l_shipmode_1#2710, cval_lineitem_l_comment#2666 AS cval_lineitem_l_comment_1#2711, cval_lineitem_l_shipdate#2667 AS cval_lineitem_l_shipdate_1#2712, cdepval_lineitem_l_quantity#2668 AS cdepval_lineitem_l_quantity_1#2713, cdepval_lineitem_l_extendedprice#2669 AS cdepval_lineitem_l_extendedprice_1#2714, cdepval_lineitem_l_discount#2670 AS cdepval_lineitem_l_discount_1#2715, ... 21 more fields]
                  +- Relation[rid#2647,cpfk_orders_lineitem#2648,cpfk_supplier_lineitem#2649,cfpk_lineitem_supplier#2650,cfpk_lineitem_partsupp#2651,cpfk_part_lineitem#2652,cfpk_lineitem_part#2653,cpfk_partsupp_lineitem#2654,cfpk_lineitem_orders#2655,cval_lineitem_l_quantity#2656,cval_lineitem_l_extendedprice#2657,cval_lineitem_l_discount#2658,cval_lineitem_l_tax#2659,cval_lineitem_l_returnflag#2660,cval_lineitem_l_linestatus#2661,cval_lineitem_l_commitdate#2662,cval_lineitem_l_receiptdate#2663,cval_lineitem_l_shipinstruct#2664,cval_lineitem_l_shipmode#2665,cval_lineitem_l_comment#2666,cval_lineitem_l_shipdate#2667,cdepval_lineitem_l_quantity#2668,cdepval_lineitem_l_extendedprice#2669,cdepval_lineitem_l_discount#2670,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16695ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 21:22:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:22:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3139L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:22:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:22:26 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:22:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3139L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#3141 AS rid_0#3186, cpfk_orders_lineitem#3142 AS cpfk_orders_lineitem_0#3187, cpfk_supplier_lineitem#3143 AS cpfk_supplier_lineitem_0#3188, cfpk_lineitem_supplier#3144 AS cfpk_lineitem_supplier_0#3189, cfpk_lineitem_partsupp#3145 AS cfpk_lineitem_partsupp_0#3190, cpfk_part_lineitem#3146 AS cpfk_part_lineitem_0#3191, cfpk_lineitem_part#3147 AS cfpk_lineitem_part_0#3192, cpfk_partsupp_lineitem#3148 AS cpfk_partsupp_lineitem_0#3193, cfpk_lineitem_orders#3149 AS cfpk_lineitem_orders_0#3194, cval_lineitem_l_quantity#3150 AS cval_lineitem_l_quantity_0#3195, cval_lineitem_l_extendedprice#3151 AS cval_lineitem_l_extendedprice_0#3196, cval_lineitem_l_discount#3152 AS cval_lineitem_l_discount_0#3197, cval_lineitem_l_tax#3153 AS cval_lineitem_l_tax_0#3198, cval_lineitem_l_returnflag#3154 AS cval_lineitem_l_returnflag_0#3199, cval_lineitem_l_linestatus#3155 AS cval_lineitem_l_linestatus_0#3200, cval_lineitem_l_commitdate#3156 AS cval_lineitem_l_commitdate_0#3201, cval_lineitem_l_receiptdate#3157 AS cval_lineitem_l_receiptdate_0#3202, cval_lineitem_l_shipinstruct#3158 AS cval_lineitem_l_shipinstruct_0#3203, cval_lineitem_l_shipmode#3159 AS cval_lineitem_l_shipmode_0#3204, cval_lineitem_l_comment#3160 AS cval_lineitem_l_comment_0#3205, cval_lineitem_l_shipdate#3161 AS cval_lineitem_l_shipdate_0#3206, cdepval_lineitem_l_quantity#3162 AS cdepval_lineitem_l_quantity_0#3207, cdepval_lineitem_l_extendedprice#3163 AS cdepval_lineitem_l_extendedprice_0#3208, cdepval_lineitem_l_discount#3164 AS cdepval_lineitem_l_discount_0#3209, ... 21 more fields]
         :  :  :     +- Relation[rid#3141,cpfk_orders_lineitem#3142,cpfk_supplier_lineitem#3143,cfpk_lineitem_supplier#3144,cfpk_lineitem_partsupp#3145,cpfk_part_lineitem#3146,cfpk_lineitem_part#3147,cpfk_partsupp_lineitem#3148,cfpk_lineitem_orders#3149,cval_lineitem_l_quantity#3150,cval_lineitem_l_extendedprice#3151,cval_lineitem_l_discount#3152,cval_lineitem_l_tax#3153,cval_lineitem_l_returnflag#3154,cval_lineitem_l_linestatus#3155,cval_lineitem_l_commitdate#3156,cval_lineitem_l_receiptdate#3157,cval_lineitem_l_shipinstruct#3158,cval_lineitem_l_shipmode#3159,cval_lineitem_l_comment#3160,cval_lineitem_l_shipdate#3161,cdepval_lineitem_l_quantity#3162,cdepval_lineitem_l_extendedprice#3163,cdepval_lineitem_l_discount#3164,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#3321 AS rid_1#3345, cpfk_customer_orders#3322 AS cpfk_customer_orders_1#3346, cfpk_orders_customer#3323 AS cfpk_orders_customer_1#3347, cval_orders_o_orderstatus#3324 AS cval_orders_o_orderstatus_1#3348, cval_orders_o_totalprice#3325 AS cval_orders_o_totalprice_1#3349, cval_orders_o_orderpriority#3326 AS cval_orders_o_orderpriority_1#3350, cval_orders_o_clerk#3327 AS cval_orders_o_clerk_1#3351, cval_orders_o_shippriority#3328 AS cval_orders_o_shippriority_1#3352, cval_orders_o_comment#3329 AS cval_orders_o_comment_1#3353, cval_orders_o_orderdate#3330 AS cval_orders_o_orderdate_1#3354, cdepval_orders_o_orderstatus#3331 AS cdepval_orders_o_orderstatus_1#3355, cdepval_orders_o_totalprice#3332 AS cdepval_orders_o_totalprice_1#3356, cdepval_orders_o_orderpriority#3333 AS cdepval_orders_o_orderpriority_1#3357, cdepval_orders_o_clerk#3334 AS cdepval_orders_o_clerk_1#3358, cdepval_orders_o_shippriority#3335 AS cdepval_orders_o_shippriority_1#3359, cdepval_orders_o_comment#3336 AS cdepval_orders_o_comment_1#3360, cdepval_orders_o_orderdate#3337 AS cdepval_orders_o_orderdate_1#3361, co_orderstatus#3338 AS co_orderstatus_1#3362, co_totalprice#3339 AS co_totalprice_1#3363, co_orderpriority#3340 AS co_orderpriority_1#3364, co_clerk#3341 AS co_clerk_1#3365, co_shippriority#3342 AS co_shippriority_1#3366, co_comment#3343 AS co_comment_1#3367, co_orderdate#3344 AS co_orderdate_1#3368]
         :  :     +- Relation[rid#3321,cpfk_customer_orders#3322,cfpk_orders_customer#3323,cval_orders_o_orderstatus#3324,cval_orders_o_totalprice#3325,cval_orders_o_orderpriority#3326,cval_orders_o_clerk#3327,cval_orders_o_shippriority#3328,cval_orders_o_comment#3329,cval_orders_o_orderdate#3330,cdepval_orders_o_orderstatus#3331,cdepval_orders_o_totalprice#3332,cdepval_orders_o_orderpriority#3333,cdepval_orders_o_clerk#3334,cdepval_orders_o_shippriority#3335,cdepval_orders_o_comment#3336,cdepval_orders_o_orderdate#3337,co_orderstatus#3338,co_totalprice#3339,co_orderpriority#3340,co_clerk#3341,co_shippriority#3342,co_comment#3343,co_orderdate#3344] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#3369 AS rid_2#3390, cpfk_nation_customer#3370 AS cpfk_nation_customer_2#3391, cfpk_customer_nation#3371 AS cfpk_customer_nation_2#3392, cval_customer_c_name#3372 AS cval_customer_c_name_2#3393, cval_customer_c_address#3373 AS cval_customer_c_address_2#3394, cval_customer_c_phone#3374 AS cval_customer_c_phone_2#3395, cval_customer_c_acctbal#3375 AS cval_customer_c_acctbal_2#3396, cval_customer_c_comment#3376 AS cval_customer_c_comment_2#3397, cval_customer_c_mktsegment#3377 AS cval_customer_c_mktsegment_2#3398, cdepval_customer_c_name#3378 AS cdepval_customer_c_name_2#3399, cdepval_customer_c_address#3379 AS cdepval_customer_c_address_2#3400, cdepval_customer_c_phone#3380 AS cdepval_customer_c_phone_2#3401, cdepval_customer_c_acctbal#3381 AS cdepval_customer_c_acctbal_2#3402, cdepval_customer_c_comment#3382 AS cdepval_customer_c_comment_2#3403, cdepval_customer_c_mktsegment#3383 AS cdepval_customer_c_mktsegment_2#3404, cc_name#3384 AS cc_name_2#3405, cc_address#3385 AS cc_address_2#3406, cc_phone#3386 AS cc_phone_2#3407, cc_acctbal#3387 AS cc_acctbal_2#3408, cc_comment#3388 AS cc_comment_2#3409, cc_mktsegment#3389 AS cc_mktsegment_2#3410]
         :     +- Relation[rid#3369,cpfk_nation_customer#3370,cfpk_customer_nation#3371,cval_customer_c_name#3372,cval_customer_c_address#3373,cval_customer_c_phone#3374,cval_customer_c_acctbal#3375,cval_customer_c_comment#3376,cval_customer_c_mktsegment#3377,cdepval_customer_c_name#3378,cdepval_customer_c_address#3379,cdepval_customer_c_phone#3380,cdepval_customer_c_acctbal#3381,cdepval_customer_c_comment#3382,cdepval_customer_c_mktsegment#3383,cc_name#3384,cc_address#3385,cc_phone#3386,cc_acctbal#3387,cc_comment#3388,cc_mktsegment#3389] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#3411 AS rid_3#3420, cpfk_region_nation#3412 AS cpfk_region_nation_3#3421, cfpk_nation_region#3413 AS cfpk_nation_region_3#3422, cval_nation_n_name#3414 AS cval_nation_n_name_3#3423, cval_nation_n_comment#3415 AS cval_nation_n_comment_3#3424, cdepval_nation_n_name#3416 AS cdepval_nation_n_name_3#3425, cdepval_nation_n_comment#3417 AS cdepval_nation_n_comment_3#3426, cn_name#3418 AS cn_name_3#3427, cn_comment#3419 AS cn_comment_3#3428]
            +- Relation[rid#3411,cpfk_region_nation#3412,cfpk_nation_region#3413,cval_nation_n_name#3414,cval_nation_n_comment#3415,cdepval_nation_n_name#3416,cdepval_nation_n_comment#3417,cn_name#3418,cn_comment#3419] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 57038ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 21:23:23 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:23:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3535L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:23 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3535L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3562, cval_part_p_name_0#3563, cval_part_p_mfgr_0#3564, cval_part_p_type_0#3565, cval_part_p_size_0#3566, cval_part_p_container_0#3567, cval_part_p_retailprice_0#3568, cval_part_p_comment_0#3569, cval_part_p_brand_0#3570, cdepval_part_p_name_0#3571, cdepval_part_p_mfgr_0#3572, cdepval_part_p_type_0#3573, cdepval_part_p_size_0#3574, cdepval_part_p_container_0#3575, cdepval_part_p_retailprice_0#3576, cdepval_part_p_comment_0#3577, cdepval_part_p_brand_0#3578, cp_name_0#3579, cp_mfgr_0#3580, cp_type_0#3581, cp_size_0#3582, cp_container_0#3583, cp_retailprice_0#3584, cp_comment_0#3585, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#3537 AS rid_0#3562, cval_part_p_name#3538 AS cval_part_p_name_0#3563, cval_part_p_mfgr#3539 AS cval_part_p_mfgr_0#3564, cval_part_p_type#3540 AS cval_part_p_type_0#3565, cval_part_p_size#3541 AS cval_part_p_size_0#3566, cval_part_p_container#3542 AS cval_part_p_container_0#3567, cval_part_p_retailprice#3543 AS cval_part_p_retailprice_0#3568, cval_part_p_comment#3544 AS cval_part_p_comment_0#3569, cval_part_p_brand#3545 AS cval_part_p_brand_0#3570, cdepval_part_p_name#3546 AS cdepval_part_p_name_0#3571, cdepval_part_p_mfgr#3547 AS cdepval_part_p_mfgr_0#3572, cdepval_part_p_type#3548 AS cdepval_part_p_type_0#3573, cdepval_part_p_size#3549 AS cdepval_part_p_size_0#3574, cdepval_part_p_container#3550 AS cdepval_part_p_container_0#3575, cdepval_part_p_retailprice#3551 AS cdepval_part_p_retailprice_0#3576, cdepval_part_p_comment#3552 AS cdepval_part_p_comment_0#3577, cdepval_part_p_brand#3553 AS cdepval_part_p_brand_0#3578, cp_name#3554 AS cp_name_0#3579, cp_mfgr#3555 AS cp_mfgr_0#3580, cp_type#3556 AS cp_type_0#3581, cp_size#3557 AS cp_size_0#3582, cp_container#3558 AS cp_container_0#3583, cp_retailprice#3559 AS cp_retailprice_0#3584, cp_comment#3560 AS cp_comment_0#3585, cp_brand#3561 AS cp_brand_0#3586]
         :  :  :  :  :     +- Relation[rid#3537,cval_part_p_name#3538,cval_part_p_mfgr#3539,cval_part_p_type#3540,cval_part_p_size#3541,cval_part_p_container#3542,cval_part_p_retailprice#3543,cval_part_p_comment#3544,cval_part_p_brand#3545,cdepval_part_p_name#3546,cdepval_part_p_mfgr#3547,cdepval_part_p_type#3548,cdepval_part_p_size#3549,cdepval_part_p_container#3550,cdepval_part_p_retailprice#3551,cdepval_part_p_comment#3552,cdepval_part_p_brand#3553,cp_name#3554,cp_mfgr#3555,cp_type#3556,cp_size#3557,cp_container#3558,cp_retailprice#3559,cp_comment#3560,cp_brand#3561] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#3777 AS rid_1#3822, cpfk_orders_lineitem#3778 AS cpfk_orders_lineitem_1#3823, cpfk_supplier_lineitem#3779 AS cpfk_supplier_lineitem_1#3824, cfpk_lineitem_supplier#3780 AS cfpk_lineitem_supplier_1#3825, cfpk_lineitem_partsupp#3781 AS cfpk_lineitem_partsupp_1#3826, cpfk_part_lineitem#3782 AS cpfk_part_lineitem_1#3827, cfpk_lineitem_part#3783 AS cfpk_lineitem_part_1#3828, cpfk_partsupp_lineitem#3784 AS cpfk_partsupp_lineitem_1#3829, cfpk_lineitem_orders#3785 AS cfpk_lineitem_orders_1#3830, cval_lineitem_l_quantity#3786 AS cval_lineitem_l_quantity_1#3831, cval_lineitem_l_extendedprice#3787 AS cval_lineitem_l_extendedprice_1#3832, cval_lineitem_l_discount#3788 AS cval_lineitem_l_discount_1#3833, cval_lineitem_l_tax#3789 AS cval_lineitem_l_tax_1#3834, cval_lineitem_l_returnflag#3790 AS cval_lineitem_l_returnflag_1#3835, cval_lineitem_l_linestatus#3791 AS cval_lineitem_l_linestatus_1#3836, cval_lineitem_l_commitdate#3792 AS cval_lineitem_l_commitdate_1#3837, cval_lineitem_l_receiptdate#3793 AS cval_lineitem_l_receiptdate_1#3838, cval_lineitem_l_shipinstruct#3794 AS cval_lineitem_l_shipinstruct_1#3839, cval_lineitem_l_shipmode#3795 AS cval_lineitem_l_shipmode_1#3840, cval_lineitem_l_comment#3796 AS cval_lineitem_l_comment_1#3841, cval_lineitem_l_shipdate#3797 AS cval_lineitem_l_shipdate_1#3842, cdepval_lineitem_l_quantity#3798 AS cdepval_lineitem_l_quantity_1#3843, cdepval_lineitem_l_extendedprice#3799 AS cdepval_lineitem_l_extendedprice_1#3844, cdepval_lineitem_l_discount#3800 AS cdepval_lineitem_l_discount_1#3845, ... 21 more fields]
         :  :  :  :        +- Relation[rid#3777,cpfk_orders_lineitem#3778,cpfk_supplier_lineitem#3779,cfpk_lineitem_supplier#3780,cfpk_lineitem_partsupp#3781,cpfk_part_lineitem#3782,cfpk_lineitem_part#3783,cpfk_partsupp_lineitem#3784,cfpk_lineitem_orders#3785,cval_lineitem_l_quantity#3786,cval_lineitem_l_extendedprice#3787,cval_lineitem_l_discount#3788,cval_lineitem_l_tax#3789,cval_lineitem_l_returnflag#3790,cval_lineitem_l_linestatus#3791,cval_lineitem_l_commitdate#3792,cval_lineitem_l_receiptdate#3793,cval_lineitem_l_shipinstruct#3794,cval_lineitem_l_shipmode#3795,cval_lineitem_l_comment#3796,cval_lineitem_l_shipdate#3797,cdepval_lineitem_l_quantity#3798,cdepval_lineitem_l_extendedprice#3799,cdepval_lineitem_l_discount#3800,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#3637 AS rid_1#3682, cpfk_orders_lineitem#3638 AS cpfk_orders_lineitem_1#3683, cpfk_supplier_lineitem#3639 AS cpfk_supplier_lineitem_1#3684, cfpk_lineitem_supplier#3640 AS cfpk_lineitem_supplier_1#3685, cfpk_lineitem_partsupp#3641 AS cfpk_lineitem_partsupp_1#3686, cpfk_part_lineitem#3642 AS cpfk_part_lineitem_1#3687, cfpk_lineitem_part#3643 AS cfpk_lineitem_part_1#3688, cpfk_partsupp_lineitem#3644 AS cpfk_partsupp_lineitem_1#3689, cfpk_lineitem_orders#3645 AS cfpk_lineitem_orders_1#3690, cval_lineitem_l_quantity#3646 AS cval_lineitem_l_quantity_1#3691, cval_lineitem_l_extendedprice#3647 AS cval_lineitem_l_extendedprice_1#3692, cval_lineitem_l_discount#3648 AS cval_lineitem_l_discount_1#3693, cval_lineitem_l_tax#3649 AS cval_lineitem_l_tax_1#3694, cval_lineitem_l_returnflag#3650 AS cval_lineitem_l_returnflag_1#3695, cval_lineitem_l_linestatus#3651 AS cval_lineitem_l_linestatus_1#3696, cval_lineitem_l_commitdate#3652 AS cval_lineitem_l_commitdate_1#3697, cval_lineitem_l_receiptdate#3653 AS cval_lineitem_l_receiptdate_1#3698, cval_lineitem_l_shipinstruct#3654 AS cval_lineitem_l_shipinstruct_1#3699, cval_lineitem_l_shipmode#3655 AS cval_lineitem_l_shipmode_1#3700, cval_lineitem_l_comment#3656 AS cval_lineitem_l_comment_1#3701, cval_lineitem_l_shipdate#3657 AS cval_lineitem_l_shipdate_1#3702, cdepval_lineitem_l_quantity#3658 AS cdepval_lineitem_l_quantity_1#3703, cdepval_lineitem_l_extendedprice#3659 AS cdepval_lineitem_l_extendedprice_1#3704, cdepval_lineitem_l_discount#3660 AS cdepval_lineitem_l_discount_1#3705, ... 21 more fields]
         :  :  :     +- Relation[rid#3637,cpfk_orders_lineitem#3638,cpfk_supplier_lineitem#3639,cfpk_lineitem_supplier#3640,cfpk_lineitem_partsupp#3641,cpfk_part_lineitem#3642,cfpk_lineitem_part#3643,cpfk_partsupp_lineitem#3644,cfpk_lineitem_orders#3645,cval_lineitem_l_quantity#3646,cval_lineitem_l_extendedprice#3647,cval_lineitem_l_discount#3648,cval_lineitem_l_tax#3649,cval_lineitem_l_returnflag#3650,cval_lineitem_l_linestatus#3651,cval_lineitem_l_commitdate#3652,cval_lineitem_l_receiptdate#3653,cval_lineitem_l_shipinstruct#3654,cval_lineitem_l_shipmode#3655,cval_lineitem_l_comment#3656,cval_lineitem_l_shipdate#3657,cdepval_lineitem_l_quantity#3658,cdepval_lineitem_l_extendedprice#3659,cdepval_lineitem_l_discount#3660,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#3867 AS rid_2#3885, cpfk_nation_supplier#3868 AS cpfk_nation_supplier_2#3886, cfpk_supplier_nation#3869 AS cfpk_supplier_nation_2#3887, cval_supplier_s_name#3870 AS cval_supplier_s_name_2#3888, cval_supplier_s_address#3871 AS cval_supplier_s_address_2#3889, cval_supplier_s_phone#3872 AS cval_supplier_s_phone_2#3890, cval_supplier_s_acctbal#3873 AS cval_supplier_s_acctbal_2#3891, cval_supplier_s_comment#3874 AS cval_supplier_s_comment_2#3892, cdepval_supplier_s_name#3875 AS cdepval_supplier_s_name_2#3893, cdepval_supplier_s_address#3876 AS cdepval_supplier_s_address_2#3894, cdepval_supplier_s_phone#3877 AS cdepval_supplier_s_phone_2#3895, cdepval_supplier_s_acctbal#3878 AS cdepval_supplier_s_acctbal_2#3896, cdepval_supplier_s_comment#3879 AS cdepval_supplier_s_comment_2#3897, cs_name#3880 AS cs_name_2#3898, cs_address#3881 AS cs_address_2#3899, cs_phone#3882 AS cs_phone_2#3900, cs_acctbal#3883 AS cs_acctbal_2#3901, cs_comment#3884 AS cs_comment_2#3902]
         :  :     +- Relation[rid#3867,cpfk_nation_supplier#3868,cfpk_supplier_nation#3869,cval_supplier_s_name#3870,cval_supplier_s_address#3871,cval_supplier_s_phone#3872,cval_supplier_s_acctbal#3873,cval_supplier_s_comment#3874,cdepval_supplier_s_name#3875,cdepval_supplier_s_address#3876,cdepval_supplier_s_phone#3877,cdepval_supplier_s_acctbal#3878,cdepval_supplier_s_comment#3879,cs_name#3880,cs_address#3881,cs_phone#3882,cs_acctbal#3883,cs_comment#3884] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#3903 AS rid_3#3912, cpfk_region_nation#3904 AS cpfk_region_nation_3#3913, cfpk_nation_region#3905 AS cfpk_nation_region_3#3914, cval_nation_n_name#3906 AS cval_nation_n_name_3#3915, cval_nation_n_comment#3907 AS cval_nation_n_comment_3#3916, cdepval_nation_n_name#3908 AS cdepval_nation_n_name_3#3917, cdepval_nation_n_comment#3909 AS cdepval_nation_n_comment_3#3918, cn_name#3910 AS cn_name_3#3919, cn_comment#3911 AS cn_comment_3#3920]
         :     +- Relation[rid#3903,cpfk_region_nation#3904,cfpk_nation_region#3905,cval_nation_n_name#3906,cval_nation_n_comment#3907,cdepval_nation_n_name#3908,cdepval_nation_n_comment#3909,cn_name#3910,cn_comment#3911] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#4041 AS rid_7#4065, cpfk_customer_orders#4042 AS cpfk_customer_orders_7#4066, cfpk_orders_customer#4043 AS cfpk_orders_customer_7#4067, cval_orders_o_orderstatus#4044 AS cval_orders_o_orderstatus_7#4068, cval_orders_o_totalprice#4045 AS cval_orders_o_totalprice_7#4069, cval_orders_o_orderpriority#4046 AS cval_orders_o_orderpriority_7#4070, cval_orders_o_clerk#4047 AS cval_orders_o_clerk_7#4071, cval_orders_o_shippriority#4048 AS cval_orders_o_shippriority_7#4072, cval_orders_o_comment#4049 AS cval_orders_o_comment_7#4073, cval_orders_o_orderdate#4050 AS cval_orders_o_orderdate_7#4074, cdepval_orders_o_orderstatus#4051 AS cdepval_orders_o_orderstatus_7#4075, cdepval_orders_o_totalprice#4052 AS cdepval_orders_o_totalprice_7#4076, cdepval_orders_o_orderpriority#4053 AS cdepval_orders_o_orderpriority_7#4077, cdepval_orders_o_clerk#4054 AS cdepval_orders_o_clerk_7#4078, cdepval_orders_o_shippriority#4055 AS cdepval_orders_o_shippriority_7#4079, cdepval_orders_o_comment#4056 AS cdepval_orders_o_comment_7#4080, cdepval_orders_o_orderdate#4057 AS cdepval_orders_o_orderdate_7#4081, co_orderstatus#4058 AS co_orderstatus_7#4082, co_totalprice#4059 AS co_totalprice_7#4083, co_orderpriority#4060 AS co_orderpriority_7#4084, co_clerk#4061 AS co_clerk_7#4085, co_shippriority#4062 AS co_shippriority_7#4086, co_comment#4063 AS co_comment_7#4087, co_orderdate#4064 AS co_orderdate_7#4088]
            :  +- Relation[rid#4041,cpfk_customer_orders#4042,cfpk_orders_customer#4043,cval_orders_o_orderstatus#4044,cval_orders_o_totalprice#4045,cval_orders_o_orderpriority#4046,cval_orders_o_clerk#4047,cval_orders_o_shippriority#4048,cval_orders_o_comment#4049,cval_orders_o_orderdate#4050,cdepval_orders_o_orderstatus#4051,cdepval_orders_o_totalprice#4052,cdepval_orders_o_orderpriority#4053,cdepval_orders_o_clerk#4054,cdepval_orders_o_shippriority#4055,cdepval_orders_o_comment#4056,cdepval_orders_o_orderdate#4057,co_orderstatus#4058,co_totalprice#4059,co_orderpriority#4060,co_clerk#4061,co_shippriority#4062,co_comment#4063,co_orderdate#4064] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#3999 AS rid_6#4020, cpfk_nation_customer#4000 AS cpfk_nation_customer_6#4021, cfpk_customer_nation#4001 AS cfpk_customer_nation_6#4022, cval_customer_c_name#4002 AS cval_customer_c_name_6#4023, cval_customer_c_address#4003 AS cval_customer_c_address_6#4024, cval_customer_c_phone#4004 AS cval_customer_c_phone_6#4025, cval_customer_c_acctbal#4005 AS cval_customer_c_acctbal_6#4026, cval_customer_c_comment#4006 AS cval_customer_c_comment_6#4027, cval_customer_c_mktsegment#4007 AS cval_customer_c_mktsegment_6#4028, cdepval_customer_c_name#4008 AS cdepval_customer_c_name_6#4029, cdepval_customer_c_address#4009 AS cdepval_customer_c_address_6#4030, cdepval_customer_c_phone#4010 AS cdepval_customer_c_phone_6#4031, cdepval_customer_c_acctbal#4011 AS cdepval_customer_c_acctbal_6#4032, cdepval_customer_c_comment#4012 AS cdepval_customer_c_comment_6#4033, cdepval_customer_c_mktsegment#4013 AS cdepval_customer_c_mktsegment_6#4034, cc_name#4014 AS cc_name_6#4035, cc_address#4015 AS cc_address_6#4036, cc_phone#4016 AS cc_phone_6#4037, cc_acctbal#4017 AS cc_acctbal_6#4038, cc_comment#4018 AS cc_comment_6#4039, cc_mktsegment#4019 AS cc_mktsegment_6#4040]
               :  +- Relation[rid#3999,cpfk_nation_customer#4000,cfpk_customer_nation#4001,cval_customer_c_name#4002,cval_customer_c_address#4003,cval_customer_c_phone#4004,cval_customer_c_acctbal#4005,cval_customer_c_comment#4006,cval_customer_c_mktsegment#4007,cdepval_customer_c_name#4008,cdepval_customer_c_address#4009,cdepval_customer_c_phone#4010,cdepval_customer_c_acctbal#4011,cdepval_customer_c_comment#4012,cdepval_customer_c_mktsegment#4013,cc_name#4014,cc_address#4015,cc_phone#4016,cc_acctbal#4017,cc_comment#4018,cc_mktsegment#4019] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#3928, cval_region_r_name_4#3929, cval_region_r_comment_4#3930, cdepval_region_r_name_4#3931, cdepval_region_r_comment_4#3932, cr_name_4#3933, cr_comment_4#3934, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#3921 AS rid_4#3928, cval_region_r_name#3922 AS cval_region_r_name_4#3929, cval_region_r_comment#3923 AS cval_region_r_comment_4#3930, cdepval_region_r_name#3924 AS cdepval_region_r_name_4#3931, cdepval_region_r_comment#3925 AS cdepval_region_r_comment_4#3932, cr_name#3926 AS cr_name_4#3933, cr_comment#3927 AS cr_comment_4#3934]
                  :  :     +- Relation[rid#3921,cval_region_r_name#3922,cval_region_r_comment#3923,cdepval_region_r_name#3924,cdepval_region_r_comment#3925,cr_name#3926,cr_comment#3927] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#3981 AS rid_5#3990, cpfk_region_nation#3982 AS cpfk_region_nation_5#3991, cfpk_nation_region#3983 AS cfpk_nation_region_5#3992, cval_nation_n_name#3984 AS cval_nation_n_name_5#3993, cval_nation_n_comment#3985 AS cval_nation_n_comment_5#3994, cdepval_nation_n_name#3986 AS cdepval_nation_n_name_5#3995, cdepval_nation_n_comment#3987 AS cdepval_nation_n_comment_5#3996, cn_name#3988 AS cn_name_5#3997, cn_comment#3989 AS cn_comment_5#3998]
                  :        +- Relation[rid#3981,cpfk_region_nation#3982,cfpk_nation_region#3983,cval_nation_n_name#3984,cval_nation_n_comment#3985,cdepval_nation_n_name#3986,cdepval_nation_n_comment#3987,cn_name#3988,cn_comment#3989] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#3949 AS rid_5#3958, cpfk_region_nation#3950 AS cpfk_region_nation_5#3959, cfpk_nation_region#3951 AS cfpk_nation_region_5#3960, cval_nation_n_name#3952 AS cval_nation_n_name_5#3961, cval_nation_n_comment#3953 AS cval_nation_n_comment_5#3962, cdepval_nation_n_name#3954 AS cdepval_nation_n_name_5#3963, cdepval_nation_n_comment#3955 AS cdepval_nation_n_comment_5#3964, cn_name#3956 AS cn_name_5#3965, cn_comment#3957 AS cn_comment_5#3966]
                     +- Relation[rid#3949,cpfk_region_nation#3950,cfpk_nation_region#3951,cval_nation_n_name#3952,cval_nation_n_comment#3953,cdepval_nation_n_name#3954,cdepval_nation_n_comment#3955,cn_name#3956,cn_comment#3957] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3469ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 21:23:26 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:23:26 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4251L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:23:26 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4251L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#4253 AS rid_0#4298, cpfk_orders_lineitem#4254 AS cpfk_orders_lineitem_0#4299, cpfk_supplier_lineitem#4255 AS cpfk_supplier_lineitem_0#4300, cfpk_lineitem_supplier#4256 AS cfpk_lineitem_supplier_0#4301, cfpk_lineitem_partsupp#4257 AS cfpk_lineitem_partsupp_0#4302, cpfk_part_lineitem#4258 AS cpfk_part_lineitem_0#4303, cfpk_lineitem_part#4259 AS cfpk_lineitem_part_0#4304, cpfk_partsupp_lineitem#4260 AS cpfk_partsupp_lineitem_0#4305, cfpk_lineitem_orders#4261 AS cfpk_lineitem_orders_0#4306, cval_lineitem_l_quantity#4262 AS cval_lineitem_l_quantity_0#4307, cval_lineitem_l_extendedprice#4263 AS cval_lineitem_l_extendedprice_0#4308, cval_lineitem_l_discount#4264 AS cval_lineitem_l_discount_0#4309, cval_lineitem_l_tax#4265 AS cval_lineitem_l_tax_0#4310, cval_lineitem_l_returnflag#4266 AS cval_lineitem_l_returnflag_0#4311, cval_lineitem_l_linestatus#4267 AS cval_lineitem_l_linestatus_0#4312, cval_lineitem_l_commitdate#4268 AS cval_lineitem_l_commitdate_0#4313, cval_lineitem_l_receiptdate#4269 AS cval_lineitem_l_receiptdate_0#4314, cval_lineitem_l_shipinstruct#4270 AS cval_lineitem_l_shipinstruct_0#4315, cval_lineitem_l_shipmode#4271 AS cval_lineitem_l_shipmode_0#4316, cval_lineitem_l_comment#4272 AS cval_lineitem_l_comment_0#4317, cval_lineitem_l_shipdate#4273 AS cval_lineitem_l_shipdate_0#4318, cdepval_lineitem_l_quantity#4274 AS cdepval_lineitem_l_quantity_0#4319, cdepval_lineitem_l_extendedprice#4275 AS cdepval_lineitem_l_extendedprice_0#4320, cdepval_lineitem_l_discount#4276 AS cdepval_lineitem_l_discount_0#4321, ... 21 more fields]
         :     +- Relation[rid#4253,cpfk_orders_lineitem#4254,cpfk_supplier_lineitem#4255,cfpk_lineitem_supplier#4256,cfpk_lineitem_partsupp#4257,cpfk_part_lineitem#4258,cfpk_lineitem_part#4259,cpfk_partsupp_lineitem#4260,cfpk_lineitem_orders#4261,cval_lineitem_l_quantity#4262,cval_lineitem_l_extendedprice#4263,cval_lineitem_l_discount#4264,cval_lineitem_l_tax#4265,cval_lineitem_l_returnflag#4266,cval_lineitem_l_linestatus#4267,cval_lineitem_l_commitdate#4268,cval_lineitem_l_receiptdate#4269,cval_lineitem_l_shipinstruct#4270,cval_lineitem_l_shipmode#4271,cval_lineitem_l_comment#4272,cval_lineitem_l_shipdate#4273,cdepval_lineitem_l_quantity#4274,cdepval_lineitem_l_extendedprice#4275,cdepval_lineitem_l_discount#4276,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4433 AS rid_1#4457, cpfk_customer_orders#4434 AS cpfk_customer_orders_1#4458, cfpk_orders_customer#4435 AS cfpk_orders_customer_1#4459, cval_orders_o_orderstatus#4436 AS cval_orders_o_orderstatus_1#4460, cval_orders_o_totalprice#4437 AS cval_orders_o_totalprice_1#4461, cval_orders_o_orderpriority#4438 AS cval_orders_o_orderpriority_1#4462, cval_orders_o_clerk#4439 AS cval_orders_o_clerk_1#4463, cval_orders_o_shippriority#4440 AS cval_orders_o_shippriority_1#4464, cval_orders_o_comment#4441 AS cval_orders_o_comment_1#4465, cval_orders_o_orderdate#4442 AS cval_orders_o_orderdate_1#4466, cdepval_orders_o_orderstatus#4443 AS cdepval_orders_o_orderstatus_1#4467, cdepval_orders_o_totalprice#4444 AS cdepval_orders_o_totalprice_1#4468, cdepval_orders_o_orderpriority#4445 AS cdepval_orders_o_orderpriority_1#4469, cdepval_orders_o_clerk#4446 AS cdepval_orders_o_clerk_1#4470, cdepval_orders_o_shippriority#4447 AS cdepval_orders_o_shippriority_1#4471, cdepval_orders_o_comment#4448 AS cdepval_orders_o_comment_1#4472, cdepval_orders_o_orderdate#4449 AS cdepval_orders_o_orderdate_1#4473, co_orderstatus#4450 AS co_orderstatus_1#4474, co_totalprice#4451 AS co_totalprice_1#4475, co_orderpriority#4452 AS co_orderpriority_1#4476, co_clerk#4453 AS co_clerk_1#4477, co_shippriority#4454 AS co_shippriority_1#4478, co_comment#4455 AS co_comment_1#4479, co_orderdate#4456 AS co_orderdate_1#4480]
            +- Relation[rid#4433,cpfk_customer_orders#4434,cfpk_orders_customer#4435,cval_orders_o_orderstatus#4436,cval_orders_o_totalprice#4437,cval_orders_o_orderpriority#4438,cval_orders_o_clerk#4439,cval_orders_o_shippriority#4440,cval_orders_o_comment#4441,cval_orders_o_orderdate#4442,cdepval_orders_o_orderstatus#4443,cdepval_orders_o_totalprice#4444,cdepval_orders_o_orderpriority#4445,cdepval_orders_o_clerk#4446,cdepval_orders_o_shippriority#4447,cdepval_orders_o_comment#4448,cdepval_orders_o_orderdate#4449,co_orderstatus#4450,co_totalprice#4451,co_orderpriority#4452,co_clerk#4453,co_shippriority#4454,co_comment#4455,co_orderdate#4456] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 21989ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 21:23:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:23:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4556L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:23:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4556L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#4684 AS rid_2#4698, cpfk_part_partsupp#4685 AS cpfk_part_partsupp_2#4699, cfpk_partsupp_part#4686 AS cfpk_partsupp_part_2#4700, cpfk_supplier_partsupp#4687 AS cpfk_supplier_partsupp_2#4701, cfpk_partsupp_supplier#4688 AS cfpk_partsupp_supplier_2#4702, cval_partsupp_ps_availqty#4689 AS cval_partsupp_ps_availqty_2#4703, cval_partsupp_ps_supplycost#4690 AS cval_partsupp_ps_supplycost_2#4704, cval_partsupp_ps_comment#4691 AS cval_partsupp_ps_comment_2#4705, cdepval_partsupp_ps_availqty#4692 AS cdepval_partsupp_ps_availqty_2#4706, cdepval_partsupp_ps_supplycost#4693 AS cdepval_partsupp_ps_supplycost_2#4707, cdepval_partsupp_ps_comment#4694 AS cdepval_partsupp_ps_comment_2#4708, cps_availqty#4695 AS cps_availqty_2#4709, cps_supplycost#4696 AS cps_supplycost_2#4710, cps_comment#4697 AS cps_comment_2#4711]
         :  +- Relation[rid#4684,cpfk_part_partsupp#4685,cfpk_partsupp_part#4686,cpfk_supplier_partsupp#4687,cfpk_partsupp_supplier#4688,cval_partsupp_ps_availqty#4689,cval_partsupp_ps_supplycost#4690,cval_partsupp_ps_comment#4691,cdepval_partsupp_ps_availqty#4692,cdepval_partsupp_ps_supplycost#4693,cdepval_partsupp_ps_comment#4694,cps_availqty#4695,cps_supplycost#4696,cps_comment#4697] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4567, cpfk_region_nation_0#4568, cfpk_nation_region_0#4569, cval_nation_n_name_0#4570, cval_nation_n_comment_0#4571, cdepval_nation_n_name_0#4572, cdepval_nation_n_comment_0#4573, cn_name_0#4574, cn_comment_0#4575, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#4558 AS rid_0#4567, cpfk_region_nation#4559 AS cpfk_region_nation_0#4568, cfpk_nation_region#4560 AS cfpk_nation_region_0#4569, cval_nation_n_name#4561 AS cval_nation_n_name_0#4570, cval_nation_n_comment#4562 AS cval_nation_n_comment_0#4571, cdepval_nation_n_name#4563 AS cdepval_nation_n_name_0#4572, cdepval_nation_n_comment#4564 AS cdepval_nation_n_comment_0#4573, cn_name#4565 AS cn_name_0#4574, cn_comment#4566 AS cn_comment_0#4575]
            :  :     +- Relation[rid#4558,cpfk_region_nation#4559,cfpk_nation_region#4560,cval_nation_n_name#4561,cval_nation_n_comment#4562,cdepval_nation_n_name#4563,cdepval_nation_n_comment#4564,cn_name#4565,cn_comment#4566] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#4648 AS rid_1#4666, cpfk_nation_supplier#4649 AS cpfk_nation_supplier_1#4667, cfpk_supplier_nation#4650 AS cfpk_supplier_nation_1#4668, cval_supplier_s_name#4651 AS cval_supplier_s_name_1#4669, cval_supplier_s_address#4652 AS cval_supplier_s_address_1#4670, cval_supplier_s_phone#4653 AS cval_supplier_s_phone_1#4671, cval_supplier_s_acctbal#4654 AS cval_supplier_s_acctbal_1#4672, cval_supplier_s_comment#4655 AS cval_supplier_s_comment_1#4673, cdepval_supplier_s_name#4656 AS cdepval_supplier_s_name_1#4674, cdepval_supplier_s_address#4657 AS cdepval_supplier_s_address_1#4675, cdepval_supplier_s_phone#4658 AS cdepval_supplier_s_phone_1#4676, cdepval_supplier_s_acctbal#4659 AS cdepval_supplier_s_acctbal_1#4677, cdepval_supplier_s_comment#4660 AS cdepval_supplier_s_comment_1#4678, cs_name#4661 AS cs_name_1#4679, cs_address#4662 AS cs_address_1#4680, cs_phone#4663 AS cs_phone_1#4681, cs_acctbal#4664 AS cs_acctbal_1#4682, cs_comment#4665 AS cs_comment_1#4683]
            :        +- Relation[rid#4648,cpfk_nation_supplier#4649,cfpk_supplier_nation#4650,cval_supplier_s_name#4651,cval_supplier_s_address#4652,cval_supplier_s_phone#4653,cval_supplier_s_acctbal#4654,cval_supplier_s_comment#4655,cdepval_supplier_s_name#4656,cdepval_supplier_s_address#4657,cdepval_supplier_s_phone#4658,cdepval_supplier_s_acctbal#4659,cdepval_supplier_s_comment#4660,cs_name#4661,cs_address#4662,cs_phone#4663,cs_acctbal#4664,cs_comment#4665] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#4594 AS rid_1#4612, cpfk_nation_supplier#4595 AS cpfk_nation_supplier_1#4613, cfpk_supplier_nation#4596 AS cfpk_supplier_nation_1#4614, cval_supplier_s_name#4597 AS cval_supplier_s_name_1#4615, cval_supplier_s_address#4598 AS cval_supplier_s_address_1#4616, cval_supplier_s_phone#4599 AS cval_supplier_s_phone_1#4617, cval_supplier_s_acctbal#4600 AS cval_supplier_s_acctbal_1#4618, cval_supplier_s_comment#4601 AS cval_supplier_s_comment_1#4619, cdepval_supplier_s_name#4602 AS cdepval_supplier_s_name_1#4620, cdepval_supplier_s_address#4603 AS cdepval_supplier_s_address_1#4621, cdepval_supplier_s_phone#4604 AS cdepval_supplier_s_phone_1#4622, cdepval_supplier_s_acctbal#4605 AS cdepval_supplier_s_acctbal_1#4623, cdepval_supplier_s_comment#4606 AS cdepval_supplier_s_comment_1#4624, cs_name#4607 AS cs_name_1#4625, cs_address#4608 AS cs_address_1#4626, cs_phone#4609 AS cs_phone_1#4627, cs_acctbal#4610 AS cs_acctbal_1#4628, cs_comment#4611 AS cs_comment_1#4629]
               +- Relation[rid#4594,cpfk_nation_supplier#4595,cfpk_supplier_nation#4596,cval_supplier_s_name#4597,cval_supplier_s_address#4598,cval_supplier_s_phone#4599,cval_supplier_s_acctbal#4600,cval_supplier_s_comment#4601,cdepval_supplier_s_name#4602,cdepval_supplier_s_address#4603,cdepval_supplier_s_phone#4604,cdepval_supplier_s_acctbal#4605,cdepval_supplier_s_comment#4606,cs_name#4607,cs_address#4608,cs_phone#4609,cs_acctbal#4610,cs_comment#4611] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2511ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 21:23:51 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:23:51 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4760L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:23:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:51 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:23:51 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4760L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#4798 AS rid_1#4843, cpfk_orders_lineitem#4799 AS cpfk_orders_lineitem_1#4844, cpfk_supplier_lineitem#4800 AS cpfk_supplier_lineitem_1#4845, cfpk_lineitem_supplier#4801 AS cfpk_lineitem_supplier_1#4846, cfpk_lineitem_partsupp#4802 AS cfpk_lineitem_partsupp_1#4847, cpfk_part_lineitem#4803 AS cpfk_part_lineitem_1#4848, cfpk_lineitem_part#4804 AS cfpk_lineitem_part_1#4849, cpfk_partsupp_lineitem#4805 AS cpfk_partsupp_lineitem_1#4850, cfpk_lineitem_orders#4806 AS cfpk_lineitem_orders_1#4851, cval_lineitem_l_quantity#4807 AS cval_lineitem_l_quantity_1#4852, cval_lineitem_l_extendedprice#4808 AS cval_lineitem_l_extendedprice_1#4853, cval_lineitem_l_discount#4809 AS cval_lineitem_l_discount_1#4854, cval_lineitem_l_tax#4810 AS cval_lineitem_l_tax_1#4855, cval_lineitem_l_returnflag#4811 AS cval_lineitem_l_returnflag_1#4856, cval_lineitem_l_linestatus#4812 AS cval_lineitem_l_linestatus_1#4857, cval_lineitem_l_commitdate#4813 AS cval_lineitem_l_commitdate_1#4858, cval_lineitem_l_receiptdate#4814 AS cval_lineitem_l_receiptdate_1#4859, cval_lineitem_l_shipinstruct#4815 AS cval_lineitem_l_shipinstruct_1#4860, cval_lineitem_l_shipmode#4816 AS cval_lineitem_l_shipmode_1#4861, cval_lineitem_l_comment#4817 AS cval_lineitem_l_comment_1#4862, cval_lineitem_l_shipdate#4818 AS cval_lineitem_l_shipdate_1#4863, cdepval_lineitem_l_quantity#4819 AS cdepval_lineitem_l_quantity_1#4864, cdepval_lineitem_l_extendedprice#4820 AS cdepval_lineitem_l_extendedprice_1#4865, cdepval_lineitem_l_discount#4821 AS cdepval_lineitem_l_discount_1#4866, ... 21 more fields]
         :  +- Relation[rid#4798,cpfk_orders_lineitem#4799,cpfk_supplier_lineitem#4800,cfpk_lineitem_supplier#4801,cfpk_lineitem_partsupp#4802,cpfk_part_lineitem#4803,cfpk_lineitem_part#4804,cpfk_partsupp_lineitem#4805,cfpk_lineitem_orders#4806,cval_lineitem_l_quantity#4807,cval_lineitem_l_extendedprice#4808,cval_lineitem_l_discount#4809,cval_lineitem_l_tax#4810,cval_lineitem_l_returnflag#4811,cval_lineitem_l_linestatus#4812,cval_lineitem_l_commitdate#4813,cval_lineitem_l_receiptdate#4814,cval_lineitem_l_shipinstruct#4815,cval_lineitem_l_shipmode#4816,cval_lineitem_l_comment#4817,cval_lineitem_l_shipdate#4818,cdepval_lineitem_l_quantity#4819,cdepval_lineitem_l_extendedprice#4820,cdepval_lineitem_l_discount#4821,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4762 AS rid_0#4780, cpfk_nation_supplier#4763 AS cpfk_nation_supplier_0#4781, cfpk_supplier_nation#4764 AS cfpk_supplier_nation_0#4782, cval_supplier_s_name#4765 AS cval_supplier_s_name_0#4783, cval_supplier_s_address#4766 AS cval_supplier_s_address_0#4784, cval_supplier_s_phone#4767 AS cval_supplier_s_phone_0#4785, cval_supplier_s_acctbal#4768 AS cval_supplier_s_acctbal_0#4786, cval_supplier_s_comment#4769 AS cval_supplier_s_comment_0#4787, cdepval_supplier_s_name#4770 AS cdepval_supplier_s_name_0#4788, cdepval_supplier_s_address#4771 AS cdepval_supplier_s_address_0#4789, cdepval_supplier_s_phone#4772 AS cdepval_supplier_s_phone_0#4790, cdepval_supplier_s_acctbal#4773 AS cdepval_supplier_s_acctbal_0#4791, cdepval_supplier_s_comment#4774 AS cdepval_supplier_s_comment_0#4792, cs_name#4775 AS cs_name_0#4793, cs_address#4776 AS cs_address_0#4794, cs_phone#4777 AS cs_phone_0#4795, cs_acctbal#4778 AS cs_acctbal_0#4796, cs_comment#4779 AS cs_comment_0#4797]
            +- Relation[rid#4762,cpfk_nation_supplier#4763,cfpk_supplier_nation#4764,cval_supplier_s_name#4765,cval_supplier_s_address#4766,cval_supplier_s_phone#4767,cval_supplier_s_acctbal#4768,cval_supplier_s_comment#4769,cdepval_supplier_s_name#4770,cdepval_supplier_s_address#4771,cdepval_supplier_s_phone#4772,cdepval_supplier_s_acctbal#4773,cdepval_supplier_s_comment#4774,cs_name#4775,cs_address#4776,cs_phone#4777,cs_acctbal#4778,cs_comment#4779] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17140ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 21:24:08 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:24:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4960L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:24:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4960L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#5052 AS rid_2#5097, cpfk_orders_lineitem#5053 AS cpfk_orders_lineitem_2#5098, cpfk_supplier_lineitem#5054 AS cpfk_supplier_lineitem_2#5099, cfpk_lineitem_supplier#5055 AS cfpk_lineitem_supplier_2#5100, cfpk_lineitem_partsupp#5056 AS cfpk_lineitem_partsupp_2#5101, cpfk_part_lineitem#5057 AS cpfk_part_lineitem_2#5102, cfpk_lineitem_part#5058 AS cfpk_lineitem_part_2#5103, cpfk_partsupp_lineitem#5059 AS cpfk_partsupp_lineitem_2#5104, cfpk_lineitem_orders#5060 AS cfpk_lineitem_orders_2#5105, cval_lineitem_l_quantity#5061 AS cval_lineitem_l_quantity_2#5106, cval_lineitem_l_extendedprice#5062 AS cval_lineitem_l_extendedprice_2#5107, cval_lineitem_l_discount#5063 AS cval_lineitem_l_discount_2#5108, cval_lineitem_l_tax#5064 AS cval_lineitem_l_tax_2#5109, cval_lineitem_l_returnflag#5065 AS cval_lineitem_l_returnflag_2#5110, cval_lineitem_l_linestatus#5066 AS cval_lineitem_l_linestatus_2#5111, cval_lineitem_l_commitdate#5067 AS cval_lineitem_l_commitdate_2#5112, cval_lineitem_l_receiptdate#5068 AS cval_lineitem_l_receiptdate_2#5113, cval_lineitem_l_shipinstruct#5069 AS cval_lineitem_l_shipinstruct_2#5114, cval_lineitem_l_shipmode#5070 AS cval_lineitem_l_shipmode_2#5115, cval_lineitem_l_comment#5071 AS cval_lineitem_l_comment_2#5116, cval_lineitem_l_shipdate#5072 AS cval_lineitem_l_shipdate_2#5117, cdepval_lineitem_l_quantity#5073 AS cdepval_lineitem_l_quantity_2#5118, cdepval_lineitem_l_extendedprice#5074 AS cdepval_lineitem_l_extendedprice_2#5119, cdepval_lineitem_l_discount#5075 AS cdepval_lineitem_l_discount_2#5120, ... 21 more fields]
         :  +- Relation[rid#5052,cpfk_orders_lineitem#5053,cpfk_supplier_lineitem#5054,cfpk_lineitem_supplier#5055,cfpk_lineitem_partsupp#5056,cpfk_part_lineitem#5057,cfpk_lineitem_part#5058,cpfk_partsupp_lineitem#5059,cfpk_lineitem_orders#5060,cval_lineitem_l_quantity#5061,cval_lineitem_l_extendedprice#5062,cval_lineitem_l_discount#5063,cval_lineitem_l_tax#5064,cval_lineitem_l_returnflag#5065,cval_lineitem_l_linestatus#5066,cval_lineitem_l_commitdate#5067,cval_lineitem_l_receiptdate#5068,cval_lineitem_l_shipinstruct#5069,cval_lineitem_l_shipmode#5070,cval_lineitem_l_comment#5071,cval_lineitem_l_shipdate#5072,cdepval_lineitem_l_quantity#5073,cdepval_lineitem_l_extendedprice#5074,cdepval_lineitem_l_discount#5075,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#5004 AS rid_1#5028, cpfk_customer_orders#5005 AS cpfk_customer_orders_1#5029, cfpk_orders_customer#5006 AS cfpk_orders_customer_1#5030, cval_orders_o_orderstatus#5007 AS cval_orders_o_orderstatus_1#5031, cval_orders_o_totalprice#5008 AS cval_orders_o_totalprice_1#5032, cval_orders_o_orderpriority#5009 AS cval_orders_o_orderpriority_1#5033, cval_orders_o_clerk#5010 AS cval_orders_o_clerk_1#5034, cval_orders_o_shippriority#5011 AS cval_orders_o_shippriority_1#5035, cval_orders_o_comment#5012 AS cval_orders_o_comment_1#5036, cval_orders_o_orderdate#5013 AS cval_orders_o_orderdate_1#5037, cdepval_orders_o_orderstatus#5014 AS cdepval_orders_o_orderstatus_1#5038, cdepval_orders_o_totalprice#5015 AS cdepval_orders_o_totalprice_1#5039, cdepval_orders_o_orderpriority#5016 AS cdepval_orders_o_orderpriority_1#5040, cdepval_orders_o_clerk#5017 AS cdepval_orders_o_clerk_1#5041, cdepval_orders_o_shippriority#5018 AS cdepval_orders_o_shippriority_1#5042, cdepval_orders_o_comment#5019 AS cdepval_orders_o_comment_1#5043, cdepval_orders_o_orderdate#5020 AS cdepval_orders_o_orderdate_1#5044, co_orderstatus#5021 AS co_orderstatus_1#5045, co_totalprice#5022 AS co_totalprice_1#5046, co_orderpriority#5023 AS co_orderpriority_1#5047, co_clerk#5024 AS co_clerk_1#5048, co_shippriority#5025 AS co_shippriority_1#5049, co_comment#5026 AS co_comment_1#5050, co_orderdate#5027 AS co_orderdate_1#5051]
            :  +- Relation[rid#5004,cpfk_customer_orders#5005,cfpk_orders_customer#5006,cval_orders_o_orderstatus#5007,cval_orders_o_totalprice#5008,cval_orders_o_orderpriority#5009,cval_orders_o_clerk#5010,cval_orders_o_shippriority#5011,cval_orders_o_comment#5012,cval_orders_o_orderdate#5013,cdepval_orders_o_orderstatus#5014,cdepval_orders_o_totalprice#5015,cdepval_orders_o_orderpriority#5016,cdepval_orders_o_clerk#5017,cdepval_orders_o_shippriority#5018,cdepval_orders_o_comment#5019,cdepval_orders_o_orderdate#5020,co_orderstatus#5021,co_totalprice#5022,co_orderpriority#5023,co_clerk#5024,co_shippriority#5025,co_comment#5026,co_orderdate#5027] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#4962 AS rid_0#4983, cpfk_nation_customer#4963 AS cpfk_nation_customer_0#4984, cfpk_customer_nation#4964 AS cfpk_customer_nation_0#4985, cval_customer_c_name#4965 AS cval_customer_c_name_0#4986, cval_customer_c_address#4966 AS cval_customer_c_address_0#4987, cval_customer_c_phone#4967 AS cval_customer_c_phone_0#4988, cval_customer_c_acctbal#4968 AS cval_customer_c_acctbal_0#4989, cval_customer_c_comment#4969 AS cval_customer_c_comment_0#4990, cval_customer_c_mktsegment#4970 AS cval_customer_c_mktsegment_0#4991, cdepval_customer_c_name#4971 AS cdepval_customer_c_name_0#4992, cdepval_customer_c_address#4972 AS cdepval_customer_c_address_0#4993, cdepval_customer_c_phone#4973 AS cdepval_customer_c_phone_0#4994, cdepval_customer_c_acctbal#4974 AS cdepval_customer_c_acctbal_0#4995, cdepval_customer_c_comment#4975 AS cdepval_customer_c_comment_0#4996, cdepval_customer_c_mktsegment#4976 AS cdepval_customer_c_mktsegment_0#4997, cc_name#4977 AS cc_name_0#4998, cc_address#4978 AS cc_address_0#4999, cc_phone#4979 AS cc_phone_0#5000, cc_acctbal#4980 AS cc_acctbal_0#5001, cc_comment#4981 AS cc_comment_0#5002, cc_mktsegment#4982 AS cc_mktsegment_0#5003]
               +- Relation[rid#4962,cpfk_nation_customer#4963,cfpk_customer_nation#4964,cval_customer_c_name#4965,cval_customer_c_address#4966,cval_customer_c_phone#4967,cval_customer_c_acctbal#4968,cval_customer_c_comment#4969,cval_customer_c_mktsegment#4970,cdepval_customer_c_name#4971,cdepval_customer_c_address#4972,cdepval_customer_c_phone#4973,cdepval_customer_c_acctbal#4974,cdepval_customer_c_comment#4975,cdepval_customer_c_mktsegment#4976,cc_name#4977,cc_address#4978,cc_phone#4979,cc_acctbal#4980,cc_comment#4981,cc_mktsegment#4982] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22331ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 21:24:30 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:24:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5260L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:24:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5260L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#5262 AS rid_0#5307, cpfk_orders_lineitem#5263 AS cpfk_orders_lineitem_0#5308, cpfk_supplier_lineitem#5264 AS cpfk_supplier_lineitem_0#5309, cfpk_lineitem_supplier#5265 AS cfpk_lineitem_supplier_0#5310, cfpk_lineitem_partsupp#5266 AS cfpk_lineitem_partsupp_0#5311, cpfk_part_lineitem#5267 AS cpfk_part_lineitem_0#5312, cfpk_lineitem_part#5268 AS cfpk_lineitem_part_0#5313, cpfk_partsupp_lineitem#5269 AS cpfk_partsupp_lineitem_0#5314, cfpk_lineitem_orders#5270 AS cfpk_lineitem_orders_0#5315, cval_lineitem_l_quantity#5271 AS cval_lineitem_l_quantity_0#5316, cval_lineitem_l_extendedprice#5272 AS cval_lineitem_l_extendedprice_0#5317, cval_lineitem_l_discount#5273 AS cval_lineitem_l_discount_0#5318, cval_lineitem_l_tax#5274 AS cval_lineitem_l_tax_0#5319, cval_lineitem_l_returnflag#5275 AS cval_lineitem_l_returnflag_0#5320, cval_lineitem_l_linestatus#5276 AS cval_lineitem_l_linestatus_0#5321, cval_lineitem_l_commitdate#5277 AS cval_lineitem_l_commitdate_0#5322, cval_lineitem_l_receiptdate#5278 AS cval_lineitem_l_receiptdate_0#5323, cval_lineitem_l_shipinstruct#5279 AS cval_lineitem_l_shipinstruct_0#5324, cval_lineitem_l_shipmode#5280 AS cval_lineitem_l_shipmode_0#5325, cval_lineitem_l_comment#5281 AS cval_lineitem_l_comment_0#5326, cval_lineitem_l_shipdate#5282 AS cval_lineitem_l_shipdate_0#5327, cdepval_lineitem_l_quantity#5283 AS cdepval_lineitem_l_quantity_0#5328, cdepval_lineitem_l_extendedprice#5284 AS cdepval_lineitem_l_extendedprice_0#5329, cdepval_lineitem_l_discount#5285 AS cdepval_lineitem_l_discount_0#5330, ... 21 more fields]
         :  +- Relation[rid#5262,cpfk_orders_lineitem#5263,cpfk_supplier_lineitem#5264,cfpk_lineitem_supplier#5265,cfpk_lineitem_partsupp#5266,cpfk_part_lineitem#5267,cfpk_lineitem_part#5268,cpfk_partsupp_lineitem#5269,cfpk_lineitem_orders#5270,cval_lineitem_l_quantity#5271,cval_lineitem_l_extendedprice#5272,cval_lineitem_l_discount#5273,cval_lineitem_l_tax#5274,cval_lineitem_l_returnflag#5275,cval_lineitem_l_linestatus#5276,cval_lineitem_l_commitdate#5277,cval_lineitem_l_receiptdate#5278,cval_lineitem_l_shipinstruct#5279,cval_lineitem_l_shipmode#5280,cval_lineitem_l_comment#5281,cval_lineitem_l_shipdate#5282,cdepval_lineitem_l_quantity#5283,cdepval_lineitem_l_extendedprice#5284,cdepval_lineitem_l_discount#5285,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5352 AS rid_1#5376, cpfk_customer_orders#5353 AS cpfk_customer_orders_1#5377, cfpk_orders_customer#5354 AS cfpk_orders_customer_1#5378, cval_orders_o_orderstatus#5355 AS cval_orders_o_orderstatus_1#5379, cval_orders_o_totalprice#5356 AS cval_orders_o_totalprice_1#5380, cval_orders_o_orderpriority#5357 AS cval_orders_o_orderpriority_1#5381, cval_orders_o_clerk#5358 AS cval_orders_o_clerk_1#5382, cval_orders_o_shippriority#5359 AS cval_orders_o_shippriority_1#5383, cval_orders_o_comment#5360 AS cval_orders_o_comment_1#5384, cval_orders_o_orderdate#5361 AS cval_orders_o_orderdate_1#5385, cdepval_orders_o_orderstatus#5362 AS cdepval_orders_o_orderstatus_1#5386, cdepval_orders_o_totalprice#5363 AS cdepval_orders_o_totalprice_1#5387, cdepval_orders_o_orderpriority#5364 AS cdepval_orders_o_orderpriority_1#5388, cdepval_orders_o_clerk#5365 AS cdepval_orders_o_clerk_1#5389, cdepval_orders_o_shippriority#5366 AS cdepval_orders_o_shippriority_1#5390, cdepval_orders_o_comment#5367 AS cdepval_orders_o_comment_1#5391, cdepval_orders_o_orderdate#5368 AS cdepval_orders_o_orderdate_1#5392, co_orderstatus#5369 AS co_orderstatus_1#5393, co_totalprice#5370 AS co_totalprice_1#5394, co_orderpriority#5371 AS co_orderpriority_1#5395, co_clerk#5372 AS co_clerk_1#5396, co_shippriority#5373 AS co_shippriority_1#5397, co_comment#5374 AS co_comment_1#5398, co_orderdate#5375 AS co_orderdate_1#5399]
            +- Relation[rid#5352,cpfk_customer_orders#5353,cfpk_orders_customer#5354,cval_orders_o_orderstatus#5355,cval_orders_o_totalprice#5356,cval_orders_o_orderpriority#5357,cval_orders_o_clerk#5358,cval_orders_o_shippriority#5359,cval_orders_o_comment#5360,cval_orders_o_orderdate#5361,cdepval_orders_o_orderstatus#5362,cdepval_orders_o_totalprice#5363,cdepval_orders_o_orderpriority#5364,cdepval_orders_o_clerk#5365,cdepval_orders_o_shippriority#5366,cdepval_orders_o_comment#5367,cdepval_orders_o_orderdate#5368,co_orderstatus#5369,co_totalprice#5370,co_orderpriority#5371,co_clerk#5372,co_shippriority#5373,co_comment#5374,co_orderdate#5375] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18384ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 21:24:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:24:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5474L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:24:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:24:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5474L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5501, cval_part_p_name_0#5502, cval_part_p_mfgr_0#5503, cval_part_p_type_0#5504, cval_part_p_size_0#5505, cval_part_p_container_0#5506, cval_part_p_retailprice_0#5507, cval_part_p_comment_0#5508, cval_part_p_brand_0#5509, cdepval_part_p_name_0#5510, cdepval_part_p_mfgr_0#5511, cdepval_part_p_type_0#5512, cdepval_part_p_size_0#5513, cdepval_part_p_container_0#5514, cdepval_part_p_retailprice_0#5515, cdepval_part_p_comment_0#5516, cdepval_part_p_brand_0#5517, cp_name_0#5518, cp_mfgr_0#5519, cp_type_0#5520, cp_size_0#5521, cp_container_0#5522, cp_retailprice_0#5523, cp_comment_0#5524, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#5476 AS rid_0#5501, cval_part_p_name#5477 AS cval_part_p_name_0#5502, cval_part_p_mfgr#5478 AS cval_part_p_mfgr_0#5503, cval_part_p_type#5479 AS cval_part_p_type_0#5504, cval_part_p_size#5480 AS cval_part_p_size_0#5505, cval_part_p_container#5481 AS cval_part_p_container_0#5506, cval_part_p_retailprice#5482 AS cval_part_p_retailprice_0#5507, cval_part_p_comment#5483 AS cval_part_p_comment_0#5508, cval_part_p_brand#5484 AS cval_part_p_brand_0#5509, cdepval_part_p_name#5485 AS cdepval_part_p_name_0#5510, cdepval_part_p_mfgr#5486 AS cdepval_part_p_mfgr_0#5511, cdepval_part_p_type#5487 AS cdepval_part_p_type_0#5512, cdepval_part_p_size#5488 AS cdepval_part_p_size_0#5513, cdepval_part_p_container#5489 AS cdepval_part_p_container_0#5514, cdepval_part_p_retailprice#5490 AS cdepval_part_p_retailprice_0#5515, cdepval_part_p_comment#5491 AS cdepval_part_p_comment_0#5516, cdepval_part_p_brand#5492 AS cdepval_part_p_brand_0#5517, cp_name#5493 AS cp_name_0#5518, cp_mfgr#5494 AS cp_mfgr_0#5519, cp_type#5495 AS cp_type_0#5520, cp_size#5496 AS cp_size_0#5521, cp_container#5497 AS cp_container_0#5522, cp_retailprice#5498 AS cp_retailprice_0#5523, cp_comment#5499 AS cp_comment_0#5524, cp_brand#5500 AS cp_brand_0#5525]
         :  :  :     +- Relation[rid#5476,cval_part_p_name#5477,cval_part_p_mfgr#5478,cval_part_p_type#5479,cval_part_p_size#5480,cval_part_p_container#5481,cval_part_p_retailprice#5482,cval_part_p_comment#5483,cval_part_p_brand#5484,cdepval_part_p_name#5485,cdepval_part_p_mfgr#5486,cdepval_part_p_type#5487,cdepval_part_p_size#5488,cdepval_part_p_container#5489,cdepval_part_p_retailprice#5490,cdepval_part_p_comment#5491,cdepval_part_p_brand#5492,cp_name#5493,cp_mfgr#5494,cp_type#5495,cp_size#5496,cp_container#5497,cp_retailprice#5498,cp_comment#5499,cp_brand#5500] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#5654 AS rid_1#5668, cpfk_part_partsupp#5655 AS cpfk_part_partsupp_1#5669, cfpk_partsupp_part#5656 AS cfpk_partsupp_part_1#5670, cpfk_supplier_partsupp#5657 AS cpfk_supplier_partsupp_1#5671, cfpk_partsupp_supplier#5658 AS cfpk_partsupp_supplier_1#5672, cval_partsupp_ps_availqty#5659 AS cval_partsupp_ps_availqty_1#5673, cval_partsupp_ps_supplycost#5660 AS cval_partsupp_ps_supplycost_1#5674, cval_partsupp_ps_comment#5661 AS cval_partsupp_ps_comment_1#5675, cdepval_partsupp_ps_availqty#5662 AS cdepval_partsupp_ps_availqty_1#5676, cdepval_partsupp_ps_supplycost#5663 AS cdepval_partsupp_ps_supplycost_1#5677, cdepval_partsupp_ps_comment#5664 AS cdepval_partsupp_ps_comment_1#5678, cps_availqty#5665 AS cps_availqty_1#5679, cps_supplycost#5666 AS cps_supplycost_1#5680, cps_comment#5667 AS cps_comment_1#5681]
         :  :        +- Relation[rid#5654,cpfk_part_partsupp#5655,cfpk_partsupp_part#5656,cpfk_supplier_partsupp#5657,cfpk_partsupp_supplier#5658,cval_partsupp_ps_availqty#5659,cval_partsupp_ps_supplycost#5660,cval_partsupp_ps_comment#5661,cdepval_partsupp_ps_availqty#5662,cdepval_partsupp_ps_supplycost#5663,cdepval_partsupp_ps_comment#5664,cps_availqty#5665,cps_supplycost#5666,cps_comment#5667] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#5576 AS rid_1#5590, cpfk_part_partsupp#5577 AS cpfk_part_partsupp_1#5591, cfpk_partsupp_part#5578 AS cfpk_partsupp_part_1#5592, cpfk_supplier_partsupp#5579 AS cpfk_supplier_partsupp_1#5593, cfpk_partsupp_supplier#5580 AS cfpk_partsupp_supplier_1#5594, cval_partsupp_ps_availqty#5581 AS cval_partsupp_ps_availqty_1#5595, cval_partsupp_ps_supplycost#5582 AS cval_partsupp_ps_supplycost_1#5596, cval_partsupp_ps_comment#5583 AS cval_partsupp_ps_comment_1#5597, cdepval_partsupp_ps_availqty#5584 AS cdepval_partsupp_ps_availqty_1#5598, cdepval_partsupp_ps_supplycost#5585 AS cdepval_partsupp_ps_supplycost_1#5599, cdepval_partsupp_ps_comment#5586 AS cdepval_partsupp_ps_comment_1#5600, cps_availqty#5587 AS cps_availqty_1#5601, cps_supplycost#5588 AS cps_supplycost_1#5602, cps_comment#5589 AS cps_comment_1#5603]
         :     +- Relation[rid#5576,cpfk_part_partsupp#5577,cfpk_partsupp_part#5578,cpfk_supplier_partsupp#5579,cfpk_partsupp_supplier#5580,cval_partsupp_ps_availqty#5581,cval_partsupp_ps_supplycost#5582,cval_partsupp_ps_comment#5583,cdepval_partsupp_ps_availqty#5584,cdepval_partsupp_ps_supplycost#5585,cdepval_partsupp_ps_comment#5586,cps_availqty#5587,cps_supplycost#5588,cps_comment#5589] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#5691, cpfk_region_nation_2#5692, cfpk_nation_region_2#5693, cval_nation_n_name_2#5694, cval_nation_n_comment_2#5695, cdepval_nation_n_name_2#5696, cdepval_nation_n_comment_2#5697, cn_name_2#5698, cn_comment_2#5699, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#5682 AS rid_2#5691, cpfk_region_nation#5683 AS cpfk_region_nation_2#5692, cfpk_nation_region#5684 AS cfpk_nation_region_2#5693, cval_nation_n_name#5685 AS cval_nation_n_name_2#5694, cval_nation_n_comment#5686 AS cval_nation_n_comment_2#5695, cdepval_nation_n_name#5687 AS cdepval_nation_n_name_2#5696, cdepval_nation_n_comment#5688 AS cdepval_nation_n_comment_2#5697, cn_name#5689 AS cn_name_2#5698, cn_comment#5690 AS cn_comment_2#5699]
            :  :     +- Relation[rid#5682,cpfk_region_nation#5683,cfpk_nation_region#5684,cval_nation_n_name#5685,cval_nation_n_comment#5686,cdepval_nation_n_name#5687,cdepval_nation_n_comment#5688,cn_name#5689,cn_comment#5690] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#5772 AS rid_3#5790, cpfk_nation_supplier#5773 AS cpfk_nation_supplier_3#5791, cfpk_supplier_nation#5774 AS cfpk_supplier_nation_3#5792, cval_supplier_s_name#5775 AS cval_supplier_s_name_3#5793, cval_supplier_s_address#5776 AS cval_supplier_s_address_3#5794, cval_supplier_s_phone#5777 AS cval_supplier_s_phone_3#5795, cval_supplier_s_acctbal#5778 AS cval_supplier_s_acctbal_3#5796, cval_supplier_s_comment#5779 AS cval_supplier_s_comment_3#5797, cdepval_supplier_s_name#5780 AS cdepval_supplier_s_name_3#5798, cdepval_supplier_s_address#5781 AS cdepval_supplier_s_address_3#5799, cdepval_supplier_s_phone#5782 AS cdepval_supplier_s_phone_3#5800, cdepval_supplier_s_acctbal#5783 AS cdepval_supplier_s_acctbal_3#5801, cdepval_supplier_s_comment#5784 AS cdepval_supplier_s_comment_3#5802, cs_name#5785 AS cs_name_3#5803, cs_address#5786 AS cs_address_3#5804, cs_phone#5787 AS cs_phone_3#5805, cs_acctbal#5788 AS cs_acctbal_3#5806, cs_comment#5789 AS cs_comment_3#5807]
            :        +- Relation[rid#5772,cpfk_nation_supplier#5773,cfpk_supplier_nation#5774,cval_supplier_s_name#5775,cval_supplier_s_address#5776,cval_supplier_s_phone#5777,cval_supplier_s_acctbal#5778,cval_supplier_s_comment#5779,cdepval_supplier_s_name#5780,cdepval_supplier_s_address#5781,cdepval_supplier_s_phone#5782,cdepval_supplier_s_acctbal#5783,cdepval_supplier_s_comment#5784,cs_name#5785,cs_address#5786,cs_phone#5787,cs_acctbal#5788,cs_comment#5789] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#5718 AS rid_3#5736, cpfk_nation_supplier#5719 AS cpfk_nation_supplier_3#5737, cfpk_supplier_nation#5720 AS cfpk_supplier_nation_3#5738, cval_supplier_s_name#5721 AS cval_supplier_s_name_3#5739, cval_supplier_s_address#5722 AS cval_supplier_s_address_3#5740, cval_supplier_s_phone#5723 AS cval_supplier_s_phone_3#5741, cval_supplier_s_acctbal#5724 AS cval_supplier_s_acctbal_3#5742, cval_supplier_s_comment#5725 AS cval_supplier_s_comment_3#5743, cdepval_supplier_s_name#5726 AS cdepval_supplier_s_name_3#5744, cdepval_supplier_s_address#5727 AS cdepval_supplier_s_address_3#5745, cdepval_supplier_s_phone#5728 AS cdepval_supplier_s_phone_3#5746, cdepval_supplier_s_acctbal#5729 AS cdepval_supplier_s_acctbal_3#5747, cdepval_supplier_s_comment#5730 AS cdepval_supplier_s_comment_3#5748, cs_name#5731 AS cs_name_3#5749, cs_address#5732 AS cs_address_3#5750, cs_phone#5733 AS cs_phone_3#5751, cs_acctbal#5734 AS cs_acctbal_3#5752, cs_comment#5735 AS cs_comment_3#5753]
               +- Relation[rid#5718,cpfk_nation_supplier#5719,cfpk_supplier_nation#5720,cval_supplier_s_name#5721,cval_supplier_s_address#5722,cval_supplier_s_phone#5723,cval_supplier_s_acctbal#5724,cval_supplier_s_comment#5725,cdepval_supplier_s_name#5726,cdepval_supplier_s_address#5727,cdepval_supplier_s_phone#5728,cdepval_supplier_s_acctbal#5729,cdepval_supplier_s_comment#5730,cs_name#5731,cs_address#5732,cs_phone#5733,cs_acctbal#5734,cs_comment#5735] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 906ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 21:24:49 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:24:49 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5882L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:24:49 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:24:49 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5882L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#6106 AS rid_2#6151, cpfk_orders_lineitem#6107 AS cpfk_orders_lineitem_2#6152, cpfk_supplier_lineitem#6108 AS cpfk_supplier_lineitem_2#6153, cfpk_lineitem_supplier#6109 AS cfpk_lineitem_supplier_2#6154, cfpk_lineitem_partsupp#6110 AS cfpk_lineitem_partsupp_2#6155, cpfk_part_lineitem#6111 AS cpfk_part_lineitem_2#6156, cfpk_lineitem_part#6112 AS cfpk_lineitem_part_2#6157, cpfk_partsupp_lineitem#6113 AS cpfk_partsupp_lineitem_2#6158, cfpk_lineitem_orders#6114 AS cfpk_lineitem_orders_2#6159, cval_lineitem_l_quantity#6115 AS cval_lineitem_l_quantity_2#6160, cval_lineitem_l_extendedprice#6116 AS cval_lineitem_l_extendedprice_2#6161, cval_lineitem_l_discount#6117 AS cval_lineitem_l_discount_2#6162, cval_lineitem_l_tax#6118 AS cval_lineitem_l_tax_2#6163, cval_lineitem_l_returnflag#6119 AS cval_lineitem_l_returnflag_2#6164, cval_lineitem_l_linestatus#6120 AS cval_lineitem_l_linestatus_2#6165, cval_lineitem_l_commitdate#6121 AS cval_lineitem_l_commitdate_2#6166, cval_lineitem_l_receiptdate#6122 AS cval_lineitem_l_receiptdate_2#6167, cval_lineitem_l_shipinstruct#6123 AS cval_lineitem_l_shipinstruct_2#6168, cval_lineitem_l_shipmode#6124 AS cval_lineitem_l_shipmode_2#6169, cval_lineitem_l_comment#6125 AS cval_lineitem_l_comment_2#6170, cval_lineitem_l_shipdate#6126 AS cval_lineitem_l_shipdate_2#6171, cdepval_lineitem_l_quantity#6127 AS cdepval_lineitem_l_quantity_2#6172, cdepval_lineitem_l_extendedprice#6128 AS cdepval_lineitem_l_extendedprice_2#6173, cdepval_lineitem_l_discount#6129 AS cdepval_lineitem_l_discount_2#6174, ... 21 more fields]
         :  +- Relation[rid#6106,cpfk_orders_lineitem#6107,cpfk_supplier_lineitem#6108,cfpk_lineitem_supplier#6109,cfpk_lineitem_partsupp#6110,cpfk_part_lineitem#6111,cfpk_lineitem_part#6112,cpfk_partsupp_lineitem#6113,cfpk_lineitem_orders#6114,cval_lineitem_l_quantity#6115,cval_lineitem_l_extendedprice#6116,cval_lineitem_l_discount#6117,cval_lineitem_l_tax#6118,cval_lineitem_l_returnflag#6119,cval_lineitem_l_linestatus#6120,cval_lineitem_l_commitdate#6121,cval_lineitem_l_receiptdate#6122,cval_lineitem_l_shipinstruct#6123,cval_lineitem_l_shipmode#6124,cval_lineitem_l_comment#6125,cval_lineitem_l_shipdate#6126,cdepval_lineitem_l_quantity#6127,cdepval_lineitem_l_extendedprice#6128,cdepval_lineitem_l_discount#6129,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5905, cpfk_nation_customer_0#5906, cfpk_customer_nation_0#5907, cval_customer_c_name_0#5908, cval_customer_c_address_0#5909, cval_customer_c_phone_0#5910, cval_customer_c_acctbal_0#5911, cval_customer_c_comment_0#5912, cval_customer_c_mktsegment_0#5913, cdepval_customer_c_name_0#5914, cdepval_customer_c_address_0#5915, cdepval_customer_c_phone_0#5916, cdepval_customer_c_acctbal_0#5917, cdepval_customer_c_comment_0#5918, cdepval_customer_c_mktsegment_0#5919, cc_name_0#5920, cc_address_0#5921, cc_phone_0#5922, cc_acctbal_0#5923, cc_comment_0#5924, cc_mktsegment_0#5925, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#5884 AS rid_0#5905, cpfk_nation_customer#5885 AS cpfk_nation_customer_0#5906, cfpk_customer_nation#5886 AS cfpk_customer_nation_0#5907, cval_customer_c_name#5887 AS cval_customer_c_name_0#5908, cval_customer_c_address#5888 AS cval_customer_c_address_0#5909, cval_customer_c_phone#5889 AS cval_customer_c_phone_0#5910, cval_customer_c_acctbal#5890 AS cval_customer_c_acctbal_0#5911, cval_customer_c_comment#5891 AS cval_customer_c_comment_0#5912, cval_customer_c_mktsegment#5892 AS cval_customer_c_mktsegment_0#5913, cdepval_customer_c_name#5893 AS cdepval_customer_c_name_0#5914, cdepval_customer_c_address#5894 AS cdepval_customer_c_address_0#5915, cdepval_customer_c_phone#5895 AS cdepval_customer_c_phone_0#5916, cdepval_customer_c_acctbal#5896 AS cdepval_customer_c_acctbal_0#5917, cdepval_customer_c_comment#5897 AS cdepval_customer_c_comment_0#5918, cdepval_customer_c_mktsegment#5898 AS cdepval_customer_c_mktsegment_0#5919, cc_name#5899 AS cc_name_0#5920, cc_address#5900 AS cc_address_0#5921, cc_phone#5901 AS cc_phone_0#5922, cc_acctbal#5902 AS cc_acctbal_0#5923, cc_comment#5903 AS cc_comment_0#5924, cc_mktsegment#5904 AS cc_mktsegment_0#5925]
            :  :     +- Relation[rid#5884,cpfk_nation_customer#5885,cfpk_customer_nation#5886,cval_customer_c_name#5887,cval_customer_c_address#5888,cval_customer_c_phone#5889,cval_customer_c_acctbal#5890,cval_customer_c_comment#5891,cval_customer_c_mktsegment#5892,cdepval_customer_c_name#5893,cdepval_customer_c_address#5894,cdepval_customer_c_phone#5895,cdepval_customer_c_acctbal#5896,cdepval_customer_c_comment#5897,cdepval_customer_c_mktsegment#5898,cc_name#5899,cc_address#5900,cc_phone#5901,cc_acctbal#5902,cc_comment#5903,cc_mktsegment#5904] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#6058 AS rid_1#6082, cpfk_customer_orders#6059 AS cpfk_customer_orders_1#6083, cfpk_orders_customer#6060 AS cfpk_orders_customer_1#6084, cval_orders_o_orderstatus#6061 AS cval_orders_o_orderstatus_1#6085, cval_orders_o_totalprice#6062 AS cval_orders_o_totalprice_1#6086, cval_orders_o_orderpriority#6063 AS cval_orders_o_orderpriority_1#6087, cval_orders_o_clerk#6064 AS cval_orders_o_clerk_1#6088, cval_orders_o_shippriority#6065 AS cval_orders_o_shippriority_1#6089, cval_orders_o_comment#6066 AS cval_orders_o_comment_1#6090, cval_orders_o_orderdate#6067 AS cval_orders_o_orderdate_1#6091, cdepval_orders_o_orderstatus#6068 AS cdepval_orders_o_orderstatus_1#6092, cdepval_orders_o_totalprice#6069 AS cdepval_orders_o_totalprice_1#6093, cdepval_orders_o_orderpriority#6070 AS cdepval_orders_o_orderpriority_1#6094, cdepval_orders_o_clerk#6071 AS cdepval_orders_o_clerk_1#6095, cdepval_orders_o_shippriority#6072 AS cdepval_orders_o_shippriority_1#6096, cdepval_orders_o_comment#6073 AS cdepval_orders_o_comment_1#6097, cdepval_orders_o_orderdate#6074 AS cdepval_orders_o_orderdate_1#6098, co_orderstatus#6075 AS co_orderstatus_1#6099, co_totalprice#6076 AS co_totalprice_1#6100, co_orderpriority#6077 AS co_orderpriority_1#6101, co_clerk#6078 AS co_clerk_1#6102, co_shippriority#6079 AS co_shippriority_1#6103, co_comment#6080 AS co_comment_1#6104, co_orderdate#6081 AS co_orderdate_1#6105]
            :        +- Relation[rid#6058,cpfk_customer_orders#6059,cfpk_orders_customer#6060,cval_orders_o_orderstatus#6061,cval_orders_o_totalprice#6062,cval_orders_o_orderpriority#6063,cval_orders_o_clerk#6064,cval_orders_o_shippriority#6065,cval_orders_o_comment#6066,cval_orders_o_orderdate#6067,cdepval_orders_o_orderstatus#6068,cdepval_orders_o_totalprice#6069,cdepval_orders_o_orderpriority#6070,cdepval_orders_o_clerk#6071,cdepval_orders_o_shippriority#6072,cdepval_orders_o_comment#6073,cdepval_orders_o_orderdate#6074,co_orderstatus#6075,co_totalprice#6076,co_orderpriority#6077,co_clerk#6078,co_shippriority#6079,co_comment#6080,co_orderdate#6081] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#5968 AS rid_1#5992, cpfk_customer_orders#5969 AS cpfk_customer_orders_1#5993, cfpk_orders_customer#5970 AS cfpk_orders_customer_1#5994, cval_orders_o_orderstatus#5971 AS cval_orders_o_orderstatus_1#5995, cval_orders_o_totalprice#5972 AS cval_orders_o_totalprice_1#5996, cval_orders_o_orderpriority#5973 AS cval_orders_o_orderpriority_1#5997, cval_orders_o_clerk#5974 AS cval_orders_o_clerk_1#5998, cval_orders_o_shippriority#5975 AS cval_orders_o_shippriority_1#5999, cval_orders_o_comment#5976 AS cval_orders_o_comment_1#6000, cval_orders_o_orderdate#5977 AS cval_orders_o_orderdate_1#6001, cdepval_orders_o_orderstatus#5978 AS cdepval_orders_o_orderstatus_1#6002, cdepval_orders_o_totalprice#5979 AS cdepval_orders_o_totalprice_1#6003, cdepval_orders_o_orderpriority#5980 AS cdepval_orders_o_orderpriority_1#6004, cdepval_orders_o_clerk#5981 AS cdepval_orders_o_clerk_1#6005, cdepval_orders_o_shippriority#5982 AS cdepval_orders_o_shippriority_1#6006, cdepval_orders_o_comment#5983 AS cdepval_orders_o_comment_1#6007, cdepval_orders_o_orderdate#5984 AS cdepval_orders_o_orderdate_1#6008, co_orderstatus#5985 AS co_orderstatus_1#6009, co_totalprice#5986 AS co_totalprice_1#6010, co_orderpriority#5987 AS co_orderpriority_1#6011, co_clerk#5988 AS co_clerk_1#6012, co_shippriority#5989 AS co_shippriority_1#6013, co_comment#5990 AS co_comment_1#6014, co_orderdate#5991 AS co_orderdate_1#6015]
               +- Relation[rid#5968,cpfk_customer_orders#5969,cfpk_orders_customer#5970,cval_orders_o_orderstatus#5971,cval_orders_o_totalprice#5972,cval_orders_o_orderpriority#5973,cval_orders_o_clerk#5974,cval_orders_o_shippriority#5975,cval_orders_o_comment#5976,cval_orders_o_orderdate#5977,cdepval_orders_o_orderstatus#5978,cdepval_orders_o_totalprice#5979,cdepval_orders_o_orderpriority#5980,cdepval_orders_o_clerk#5981,cdepval_orders_o_shippriority#5982,cdepval_orders_o_comment#5983,cdepval_orders_o_orderdate#5984,co_orderstatus#5985,co_totalprice#5986,co_orderpriority#5987,co_clerk#5988,co_shippriority#5989,co_comment#5990,co_orderdate#5991] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 24104ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 21:25:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:25:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6290L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:25:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:14 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:25:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6290L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6317, cval_part_p_name_0#6318, cval_part_p_mfgr_0#6319, cval_part_p_type_0#6320, cval_part_p_size_0#6321, cval_part_p_container_0#6322, cval_part_p_retailprice_0#6323, cval_part_p_comment_0#6324, cval_part_p_brand_0#6325, cdepval_part_p_name_0#6326, cdepval_part_p_mfgr_0#6327, cdepval_part_p_type_0#6328, cdepval_part_p_size_0#6329, cdepval_part_p_container_0#6330, cdepval_part_p_retailprice_0#6331, cdepval_part_p_comment_0#6332, cdepval_part_p_brand_0#6333, cp_name_0#6334, cp_mfgr_0#6335, cp_type_0#6336, cp_size_0#6337, cp_container_0#6338, cp_retailprice_0#6339, cp_comment_0#6340, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#6292 AS rid_0#6317, cval_part_p_name#6293 AS cval_part_p_name_0#6318, cval_part_p_mfgr#6294 AS cval_part_p_mfgr_0#6319, cval_part_p_type#6295 AS cval_part_p_type_0#6320, cval_part_p_size#6296 AS cval_part_p_size_0#6321, cval_part_p_container#6297 AS cval_part_p_container_0#6322, cval_part_p_retailprice#6298 AS cval_part_p_retailprice_0#6323, cval_part_p_comment#6299 AS cval_part_p_comment_0#6324, cval_part_p_brand#6300 AS cval_part_p_brand_0#6325, cdepval_part_p_name#6301 AS cdepval_part_p_name_0#6326, cdepval_part_p_mfgr#6302 AS cdepval_part_p_mfgr_0#6327, cdepval_part_p_type#6303 AS cdepval_part_p_type_0#6328, cdepval_part_p_size#6304 AS cdepval_part_p_size_0#6329, cdepval_part_p_container#6305 AS cdepval_part_p_container_0#6330, cdepval_part_p_retailprice#6306 AS cdepval_part_p_retailprice_0#6331, cdepval_part_p_comment#6307 AS cdepval_part_p_comment_0#6332, cdepval_part_p_brand#6308 AS cdepval_part_p_brand_0#6333, cp_name#6309 AS cp_name_0#6334, cp_mfgr#6310 AS cp_mfgr_0#6335, cp_type#6311 AS cp_type_0#6336, cp_size#6312 AS cp_size_0#6337, cp_container#6313 AS cp_container_0#6338, cp_retailprice#6314 AS cp_retailprice_0#6339, cp_comment#6315 AS cp_comment_0#6340, cp_brand#6316 AS cp_brand_0#6341]
         :  :        +- Relation[rid#6292,cval_part_p_name#6293,cval_part_p_mfgr#6294,cval_part_p_type#6295,cval_part_p_size#6296,cval_part_p_container#6297,cval_part_p_retailprice#6298,cval_part_p_comment#6299,cval_part_p_brand#6300,cdepval_part_p_name#6301,cdepval_part_p_mfgr#6302,cdepval_part_p_type#6303,cdepval_part_p_size#6304,cdepval_part_p_container#6305,cdepval_part_p_retailprice#6306,cdepval_part_p_comment#6307,cdepval_part_p_brand#6308,cp_name#6309,cp_mfgr#6310,cp_type#6311,cp_size#6312,cp_container#6313,cp_retailprice#6314,cp_comment#6315,cp_brand#6316] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#6582 AS rid_1#6627, cpfk_orders_lineitem#6583 AS cpfk_orders_lineitem_1#6628, cpfk_supplier_lineitem#6584 AS cpfk_supplier_lineitem_1#6629, cfpk_lineitem_supplier#6585 AS cfpk_lineitem_supplier_1#6630, cfpk_lineitem_partsupp#6586 AS cfpk_lineitem_partsupp_1#6631, cpfk_part_lineitem#6587 AS cpfk_part_lineitem_1#6632, cfpk_lineitem_part#6588 AS cfpk_lineitem_part_1#6633, cpfk_partsupp_lineitem#6589 AS cpfk_partsupp_lineitem_1#6634, cfpk_lineitem_orders#6590 AS cfpk_lineitem_orders_1#6635, cval_lineitem_l_quantity#6591 AS cval_lineitem_l_quantity_1#6636, cval_lineitem_l_extendedprice#6592 AS cval_lineitem_l_extendedprice_1#6637, cval_lineitem_l_discount#6593 AS cval_lineitem_l_discount_1#6638, cval_lineitem_l_tax#6594 AS cval_lineitem_l_tax_1#6639, cval_lineitem_l_returnflag#6595 AS cval_lineitem_l_returnflag_1#6640, cval_lineitem_l_linestatus#6596 AS cval_lineitem_l_linestatus_1#6641, cval_lineitem_l_commitdate#6597 AS cval_lineitem_l_commitdate_1#6642, cval_lineitem_l_receiptdate#6598 AS cval_lineitem_l_receiptdate_1#6643, cval_lineitem_l_shipinstruct#6599 AS cval_lineitem_l_shipinstruct_1#6644, cval_lineitem_l_shipmode#6600 AS cval_lineitem_l_shipmode_1#6645, cval_lineitem_l_comment#6601 AS cval_lineitem_l_comment_1#6646, cval_lineitem_l_shipdate#6602 AS cval_lineitem_l_shipdate_1#6647, cdepval_lineitem_l_quantity#6603 AS cdepval_lineitem_l_quantity_1#6648, cdepval_lineitem_l_extendedprice#6604 AS cdepval_lineitem_l_extendedprice_1#6649, cdepval_lineitem_l_discount#6605 AS cdepval_lineitem_l_discount_1#6650, ... 21 more fields]
         :        +- Relation[rid#6582,cpfk_orders_lineitem#6583,cpfk_supplier_lineitem#6584,cfpk_lineitem_supplier#6585,cfpk_lineitem_partsupp#6586,cpfk_part_lineitem#6587,cfpk_lineitem_part#6588,cpfk_partsupp_lineitem#6589,cfpk_lineitem_orders#6590,cval_lineitem_l_quantity#6591,cval_lineitem_l_extendedprice#6592,cval_lineitem_l_discount#6593,cval_lineitem_l_tax#6594,cval_lineitem_l_returnflag#6595,cval_lineitem_l_linestatus#6596,cval_lineitem_l_commitdate#6597,cval_lineitem_l_receiptdate#6598,cval_lineitem_l_shipinstruct#6599,cval_lineitem_l_shipmode#6600,cval_lineitem_l_comment#6601,cval_lineitem_l_shipdate#6602,cdepval_lineitem_l_quantity#6603,cdepval_lineitem_l_extendedprice#6604,cdepval_lineitem_l_discount#6605,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#6442 AS rid_1#6487, cpfk_orders_lineitem#6443 AS cpfk_orders_lineitem_1#6488, cpfk_supplier_lineitem#6444 AS cpfk_supplier_lineitem_1#6489, cfpk_lineitem_supplier#6445 AS cfpk_lineitem_supplier_1#6490, cfpk_lineitem_partsupp#6446 AS cfpk_lineitem_partsupp_1#6491, cpfk_part_lineitem#6447 AS cpfk_part_lineitem_1#6492, cfpk_lineitem_part#6448 AS cfpk_lineitem_part_1#6493, cpfk_partsupp_lineitem#6449 AS cpfk_partsupp_lineitem_1#6494, cfpk_lineitem_orders#6450 AS cfpk_lineitem_orders_1#6495, cval_lineitem_l_quantity#6451 AS cval_lineitem_l_quantity_1#6496, cval_lineitem_l_extendedprice#6452 AS cval_lineitem_l_extendedprice_1#6497, cval_lineitem_l_discount#6453 AS cval_lineitem_l_discount_1#6498, cval_lineitem_l_tax#6454 AS cval_lineitem_l_tax_1#6499, cval_lineitem_l_returnflag#6455 AS cval_lineitem_l_returnflag_1#6500, cval_lineitem_l_linestatus#6456 AS cval_lineitem_l_linestatus_1#6501, cval_lineitem_l_commitdate#6457 AS cval_lineitem_l_commitdate_1#6502, cval_lineitem_l_receiptdate#6458 AS cval_lineitem_l_receiptdate_1#6503, cval_lineitem_l_shipinstruct#6459 AS cval_lineitem_l_shipinstruct_1#6504, cval_lineitem_l_shipmode#6460 AS cval_lineitem_l_shipmode_1#6505, cval_lineitem_l_comment#6461 AS cval_lineitem_l_comment_1#6506, cval_lineitem_l_shipdate#6462 AS cval_lineitem_l_shipdate_1#6507, cdepval_lineitem_l_quantity#6463 AS cdepval_lineitem_l_quantity_1#6508, cdepval_lineitem_l_extendedprice#6464 AS cdepval_lineitem_l_extendedprice_1#6509, cdepval_lineitem_l_discount#6465 AS cdepval_lineitem_l_discount_1#6510, ... 21 more fields]
            +- Relation[rid#6442,cpfk_orders_lineitem#6443,cpfk_supplier_lineitem#6444,cfpk_lineitem_supplier#6445,cfpk_lineitem_partsupp#6446,cpfk_part_lineitem#6447,cfpk_lineitem_part#6448,cpfk_partsupp_lineitem#6449,cfpk_lineitem_orders#6450,cval_lineitem_l_quantity#6451,cval_lineitem_l_extendedprice#6452,cval_lineitem_l_discount#6453,cval_lineitem_l_tax#6454,cval_lineitem_l_returnflag#6455,cval_lineitem_l_linestatus#6456,cval_lineitem_l_commitdate#6457,cval_lineitem_l_receiptdate#6458,cval_lineitem_l_shipinstruct#6459,cval_lineitem_l_shipmode#6460,cval_lineitem_l_comment#6461,cval_lineitem_l_shipdate#6462,cdepval_lineitem_l_quantity#6463,cdepval_lineitem_l_extendedprice#6464,cdepval_lineitem_l_discount#6465,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 521ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 21:25:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:25:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6747L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:25:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6747L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#6749 AS rid_0#6773, cpfk_customer_orders#6750 AS cpfk_customer_orders_0#6774, cfpk_orders_customer#6751 AS cfpk_orders_customer_0#6775, cval_orders_o_orderstatus#6752 AS cval_orders_o_orderstatus_0#6776, cval_orders_o_totalprice#6753 AS cval_orders_o_totalprice_0#6777, cval_orders_o_orderpriority#6754 AS cval_orders_o_orderpriority_0#6778, cval_orders_o_clerk#6755 AS cval_orders_o_clerk_0#6779, cval_orders_o_shippriority#6756 AS cval_orders_o_shippriority_0#6780, cval_orders_o_comment#6757 AS cval_orders_o_comment_0#6781, cval_orders_o_orderdate#6758 AS cval_orders_o_orderdate_0#6782, cdepval_orders_o_orderstatus#6759 AS cdepval_orders_o_orderstatus_0#6783, cdepval_orders_o_totalprice#6760 AS cdepval_orders_o_totalprice_0#6784, cdepval_orders_o_orderpriority#6761 AS cdepval_orders_o_orderpriority_0#6785, cdepval_orders_o_clerk#6762 AS cdepval_orders_o_clerk_0#6786, cdepval_orders_o_shippriority#6763 AS cdepval_orders_o_shippriority_0#6787, cdepval_orders_o_comment#6764 AS cdepval_orders_o_comment_0#6788, cdepval_orders_o_orderdate#6765 AS cdepval_orders_o_orderdate_0#6789, co_orderstatus#6766 AS co_orderstatus_0#6790, co_totalprice#6767 AS co_totalprice_0#6791, co_orderpriority#6768 AS co_orderpriority_0#6792, co_clerk#6769 AS co_clerk_0#6793, co_shippriority#6770 AS co_shippriority_0#6794, co_comment#6771 AS co_comment_0#6795, co_orderdate#6772 AS co_orderdate_0#6796]
         :  +- Relation[rid#6749,cpfk_customer_orders#6750,cfpk_orders_customer#6751,cval_orders_o_orderstatus#6752,cval_orders_o_totalprice#6753,cval_orders_o_orderpriority#6754,cval_orders_o_clerk#6755,cval_orders_o_shippriority#6756,cval_orders_o_comment#6757,cval_orders_o_orderdate#6758,cdepval_orders_o_orderstatus#6759,cdepval_orders_o_totalprice#6760,cdepval_orders_o_orderpriority#6761,cdepval_orders_o_clerk#6762,cdepval_orders_o_shippriority#6763,cdepval_orders_o_comment#6764,cdepval_orders_o_orderdate#6765,co_orderstatus#6766,co_totalprice#6767,co_orderpriority#6768,co_clerk#6769,co_shippriority#6770,co_comment#6771,co_orderdate#6772] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#6797 AS rid_1#6818, cpfk_nation_customer#6798 AS cpfk_nation_customer_1#6819, cfpk_customer_nation#6799 AS cfpk_customer_nation_1#6820, cval_customer_c_name#6800 AS cval_customer_c_name_1#6821, cval_customer_c_address#6801 AS cval_customer_c_address_1#6822, cval_customer_c_phone#6802 AS cval_customer_c_phone_1#6823, cval_customer_c_acctbal#6803 AS cval_customer_c_acctbal_1#6824, cval_customer_c_comment#6804 AS cval_customer_c_comment_1#6825, cval_customer_c_mktsegment#6805 AS cval_customer_c_mktsegment_1#6826, cdepval_customer_c_name#6806 AS cdepval_customer_c_name_1#6827, cdepval_customer_c_address#6807 AS cdepval_customer_c_address_1#6828, cdepval_customer_c_phone#6808 AS cdepval_customer_c_phone_1#6829, cdepval_customer_c_acctbal#6809 AS cdepval_customer_c_acctbal_1#6830, cdepval_customer_c_comment#6810 AS cdepval_customer_c_comment_1#6831, cdepval_customer_c_mktsegment#6811 AS cdepval_customer_c_mktsegment_1#6832, cc_name#6812 AS cc_name_1#6833, cc_address#6813 AS cc_address_1#6834, cc_phone#6814 AS cc_phone_1#6835, cc_acctbal#6815 AS cc_acctbal_1#6836, cc_comment#6816 AS cc_comment_1#6837, cc_mktsegment#6817 AS cc_mktsegment_1#6838]
            +- Relation[rid#6797,cpfk_nation_customer#6798,cfpk_customer_nation#6799,cval_customer_c_name#6800,cval_customer_c_address#6801,cval_customer_c_phone#6802,cval_customer_c_acctbal#6803,cval_customer_c_comment#6804,cval_customer_c_mktsegment#6805,cdepval_customer_c_name#6806,cdepval_customer_c_address#6807,cdepval_customer_c_phone#6808,cdepval_customer_c_acctbal#6809,cdepval_customer_c_comment#6810,cdepval_customer_c_mktsegment#6811,cc_name#6812,cc_address#6813,cc_phone#6814,cc_acctbal#6815,cc_comment#6816,cc_mktsegment#6817] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4367ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 21:25:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:25:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6892L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6892L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#7020 AS rid_2#7065, cpfk_orders_lineitem#7021 AS cpfk_orders_lineitem_2#7066, cpfk_supplier_lineitem#7022 AS cpfk_supplier_lineitem_2#7067, cfpk_lineitem_supplier#7023 AS cfpk_lineitem_supplier_2#7068, cfpk_lineitem_partsupp#7024 AS cfpk_lineitem_partsupp_2#7069, cpfk_part_lineitem#7025 AS cpfk_part_lineitem_2#7070, cfpk_lineitem_part#7026 AS cfpk_lineitem_part_2#7071, cpfk_partsupp_lineitem#7027 AS cpfk_partsupp_lineitem_2#7072, cfpk_lineitem_orders#7028 AS cfpk_lineitem_orders_2#7073, cval_lineitem_l_quantity#7029 AS cval_lineitem_l_quantity_2#7074, cval_lineitem_l_extendedprice#7030 AS cval_lineitem_l_extendedprice_2#7075, cval_lineitem_l_discount#7031 AS cval_lineitem_l_discount_2#7076, cval_lineitem_l_tax#7032 AS cval_lineitem_l_tax_2#7077, cval_lineitem_l_returnflag#7033 AS cval_lineitem_l_returnflag_2#7078, cval_lineitem_l_linestatus#7034 AS cval_lineitem_l_linestatus_2#7079, cval_lineitem_l_commitdate#7035 AS cval_lineitem_l_commitdate_2#7080, cval_lineitem_l_receiptdate#7036 AS cval_lineitem_l_receiptdate_2#7081, cval_lineitem_l_shipinstruct#7037 AS cval_lineitem_l_shipinstruct_2#7082, cval_lineitem_l_shipmode#7038 AS cval_lineitem_l_shipmode_2#7083, cval_lineitem_l_comment#7039 AS cval_lineitem_l_comment_2#7084, cval_lineitem_l_shipdate#7040 AS cval_lineitem_l_shipdate_2#7085, cdepval_lineitem_l_quantity#7041 AS cdepval_lineitem_l_quantity_2#7086, cdepval_lineitem_l_extendedprice#7042 AS cdepval_lineitem_l_extendedprice_2#7087, cdepval_lineitem_l_discount#7043 AS cdepval_lineitem_l_discount_2#7088, ... 21 more fields]
         :  :  +- Relation[rid#7020,cpfk_orders_lineitem#7021,cpfk_supplier_lineitem#7022,cfpk_lineitem_supplier#7023,cfpk_lineitem_partsupp#7024,cpfk_part_lineitem#7025,cfpk_lineitem_part#7026,cpfk_partsupp_lineitem#7027,cfpk_lineitem_orders#7028,cval_lineitem_l_quantity#7029,cval_lineitem_l_extendedprice#7030,cval_lineitem_l_discount#7031,cval_lineitem_l_tax#7032,cval_lineitem_l_returnflag#7033,cval_lineitem_l_linestatus#7034,cval_lineitem_l_commitdate#7035,cval_lineitem_l_receiptdate#7036,cval_lineitem_l_shipinstruct#7037,cval_lineitem_l_shipmode#7038,cval_lineitem_l_comment#7039,cval_lineitem_l_shipdate#7040,cdepval_lineitem_l_quantity#7041,cdepval_lineitem_l_extendedprice#7042,cdepval_lineitem_l_discount#7043,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6903, cpfk_region_nation_0#6904, cfpk_nation_region_0#6905, cval_nation_n_name_0#6906, cval_nation_n_comment_0#6907, cdepval_nation_n_name_0#6908, cdepval_nation_n_comment_0#6909, cn_name_0#6910, cn_comment_0#6911, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#6894 AS rid_0#6903, cpfk_region_nation#6895 AS cpfk_region_nation_0#6904, cfpk_nation_region#6896 AS cfpk_nation_region_0#6905, cval_nation_n_name#6897 AS cval_nation_n_name_0#6906, cval_nation_n_comment#6898 AS cval_nation_n_comment_0#6907, cdepval_nation_n_name#6899 AS cdepval_nation_n_name_0#6908, cdepval_nation_n_comment#6900 AS cdepval_nation_n_comment_0#6909, cn_name#6901 AS cn_name_0#6910, cn_comment#6902 AS cn_comment_0#6911]
         :     :  :     +- Relation[rid#6894,cpfk_region_nation#6895,cfpk_nation_region#6896,cval_nation_n_name#6897,cval_nation_n_comment#6898,cdepval_nation_n_name#6899,cdepval_nation_n_comment#6900,cn_name#6901,cn_comment#6902] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#6984 AS rid_1#7002, cpfk_nation_supplier#6985 AS cpfk_nation_supplier_1#7003, cfpk_supplier_nation#6986 AS cfpk_supplier_nation_1#7004, cval_supplier_s_name#6987 AS cval_supplier_s_name_1#7005, cval_supplier_s_address#6988 AS cval_supplier_s_address_1#7006, cval_supplier_s_phone#6989 AS cval_supplier_s_phone_1#7007, cval_supplier_s_acctbal#6990 AS cval_supplier_s_acctbal_1#7008, cval_supplier_s_comment#6991 AS cval_supplier_s_comment_1#7009, cdepval_supplier_s_name#6992 AS cdepval_supplier_s_name_1#7010, cdepval_supplier_s_address#6993 AS cdepval_supplier_s_address_1#7011, cdepval_supplier_s_phone#6994 AS cdepval_supplier_s_phone_1#7012, cdepval_supplier_s_acctbal#6995 AS cdepval_supplier_s_acctbal_1#7013, cdepval_supplier_s_comment#6996 AS cdepval_supplier_s_comment_1#7014, cs_name#6997 AS cs_name_1#7015, cs_address#6998 AS cs_address_1#7016, cs_phone#6999 AS cs_phone_1#7017, cs_acctbal#7000 AS cs_acctbal_1#7018, cs_comment#7001 AS cs_comment_1#7019]
         :     :        +- Relation[rid#6984,cpfk_nation_supplier#6985,cfpk_supplier_nation#6986,cval_supplier_s_name#6987,cval_supplier_s_address#6988,cval_supplier_s_phone#6989,cval_supplier_s_acctbal#6990,cval_supplier_s_comment#6991,cdepval_supplier_s_name#6992,cdepval_supplier_s_address#6993,cdepval_supplier_s_phone#6994,cdepval_supplier_s_acctbal#6995,cdepval_supplier_s_comment#6996,cs_name#6997,cs_address#6998,cs_phone#6999,cs_acctbal#7000,cs_comment#7001] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#6930 AS rid_1#6948, cpfk_nation_supplier#6931 AS cpfk_nation_supplier_1#6949, cfpk_supplier_nation#6932 AS cfpk_supplier_nation_1#6950, cval_supplier_s_name#6933 AS cval_supplier_s_name_1#6951, cval_supplier_s_address#6934 AS cval_supplier_s_address_1#6952, cval_supplier_s_phone#6935 AS cval_supplier_s_phone_1#6953, cval_supplier_s_acctbal#6936 AS cval_supplier_s_acctbal_1#6954, cval_supplier_s_comment#6937 AS cval_supplier_s_comment_1#6955, cdepval_supplier_s_name#6938 AS cdepval_supplier_s_name_1#6956, cdepval_supplier_s_address#6939 AS cdepval_supplier_s_address_1#6957, cdepval_supplier_s_phone#6940 AS cdepval_supplier_s_phone_1#6958, cdepval_supplier_s_acctbal#6941 AS cdepval_supplier_s_acctbal_1#6959, cdepval_supplier_s_comment#6942 AS cdepval_supplier_s_comment_1#6960, cs_name#6943 AS cs_name_1#6961, cs_address#6944 AS cs_address_1#6962, cs_phone#6945 AS cs_phone_1#6963, cs_acctbal#6946 AS cs_acctbal_1#6964, cs_comment#6947 AS cs_comment_1#6965]
         :        +- Relation[rid#6930,cpfk_nation_supplier#6931,cfpk_supplier_nation#6932,cval_supplier_s_name#6933,cval_supplier_s_address#6934,cval_supplier_s_phone#6935,cval_supplier_s_acctbal#6936,cval_supplier_s_comment#6937,cdepval_supplier_s_name#6938,cdepval_supplier_s_address#6939,cdepval_supplier_s_phone#6940,cdepval_supplier_s_acctbal#6941,cdepval_supplier_s_comment#6942,cs_name#6943,cs_address#6944,cs_phone#6945,cs_acctbal#6946,cs_comment#6947] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#7248 AS rid_5#7272, cpfk_customer_orders#7249 AS cpfk_customer_orders_5#7273, cfpk_orders_customer#7250 AS cfpk_orders_customer_5#7274, cval_orders_o_orderstatus#7251 AS cval_orders_o_orderstatus_5#7275, cval_orders_o_totalprice#7252 AS cval_orders_o_totalprice_5#7276, cval_orders_o_orderpriority#7253 AS cval_orders_o_orderpriority_5#7277, cval_orders_o_clerk#7254 AS cval_orders_o_clerk_5#7278, cval_orders_o_shippriority#7255 AS cval_orders_o_shippriority_5#7279, cval_orders_o_comment#7256 AS cval_orders_o_comment_5#7280, cval_orders_o_orderdate#7257 AS cval_orders_o_orderdate_5#7281, cdepval_orders_o_orderstatus#7258 AS cdepval_orders_o_orderstatus_5#7282, cdepval_orders_o_totalprice#7259 AS cdepval_orders_o_totalprice_5#7283, cdepval_orders_o_orderpriority#7260 AS cdepval_orders_o_orderpriority_5#7284, cdepval_orders_o_clerk#7261 AS cdepval_orders_o_clerk_5#7285, cdepval_orders_o_shippriority#7262 AS cdepval_orders_o_shippriority_5#7286, cdepval_orders_o_comment#7263 AS cdepval_orders_o_comment_5#7287, cdepval_orders_o_orderdate#7264 AS cdepval_orders_o_orderdate_5#7288, co_orderstatus#7265 AS co_orderstatus_5#7289, co_totalprice#7266 AS co_totalprice_5#7290, co_orderpriority#7267 AS co_orderpriority_5#7291, co_clerk#7268 AS co_clerk_5#7292, co_shippriority#7269 AS co_shippriority_5#7293, co_comment#7270 AS co_comment_5#7294, co_orderdate#7271 AS co_orderdate_5#7295]
            :  +- Relation[rid#7248,cpfk_customer_orders#7249,cfpk_orders_customer#7250,cval_orders_o_orderstatus#7251,cval_orders_o_totalprice#7252,cval_orders_o_orderpriority#7253,cval_orders_o_clerk#7254,cval_orders_o_shippriority#7255,cval_orders_o_comment#7256,cval_orders_o_orderdate#7257,cdepval_orders_o_orderstatus#7258,cdepval_orders_o_totalprice#7259,cdepval_orders_o_orderpriority#7260,cdepval_orders_o_clerk#7261,cdepval_orders_o_shippriority#7262,cdepval_orders_o_comment#7263,cdepval_orders_o_orderdate#7264,co_orderstatus#7265,co_totalprice#7266,co_orderpriority#7267,co_clerk#7268,co_shippriority#7269,co_comment#7270,co_orderdate#7271] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#7119, cpfk_region_nation_3#7120, cfpk_nation_region_3#7121, cval_nation_n_name_3#7122, cval_nation_n_comment_3#7123, cdepval_nation_n_name_3#7124, cdepval_nation_n_comment_3#7125, cn_name_3#7126, cn_comment_3#7127, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#7110 AS rid_3#7119, cpfk_region_nation#7111 AS cpfk_region_nation_3#7120, cfpk_nation_region#7112 AS cfpk_nation_region_3#7121, cval_nation_n_name#7113 AS cval_nation_n_name_3#7122, cval_nation_n_comment#7114 AS cval_nation_n_comment_3#7123, cdepval_nation_n_name#7115 AS cdepval_nation_n_name_3#7124, cdepval_nation_n_comment#7116 AS cdepval_nation_n_comment_3#7125, cn_name#7117 AS cn_name_3#7126, cn_comment#7118 AS cn_comment_3#7127]
               :  :     +- Relation[rid#7110,cpfk_region_nation#7111,cfpk_nation_region#7112,cval_nation_n_name#7113,cval_nation_n_comment#7114,cdepval_nation_n_name#7115,cdepval_nation_n_comment#7116,cn_name#7117,cn_comment#7118] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#7206 AS rid_4#7227, cpfk_nation_customer#7207 AS cpfk_nation_customer_4#7228, cfpk_customer_nation#7208 AS cfpk_customer_nation_4#7229, cval_customer_c_name#7209 AS cval_customer_c_name_4#7230, cval_customer_c_address#7210 AS cval_customer_c_address_4#7231, cval_customer_c_phone#7211 AS cval_customer_c_phone_4#7232, cval_customer_c_acctbal#7212 AS cval_customer_c_acctbal_4#7233, cval_customer_c_comment#7213 AS cval_customer_c_comment_4#7234, cval_customer_c_mktsegment#7214 AS cval_customer_c_mktsegment_4#7235, cdepval_customer_c_name#7215 AS cdepval_customer_c_name_4#7236, cdepval_customer_c_address#7216 AS cdepval_customer_c_address_4#7237, cdepval_customer_c_phone#7217 AS cdepval_customer_c_phone_4#7238, cdepval_customer_c_acctbal#7218 AS cdepval_customer_c_acctbal_4#7239, cdepval_customer_c_comment#7219 AS cdepval_customer_c_comment_4#7240, cdepval_customer_c_mktsegment#7220 AS cdepval_customer_c_mktsegment_4#7241, cc_name#7221 AS cc_name_4#7242, cc_address#7222 AS cc_address_4#7243, cc_phone#7223 AS cc_phone_4#7244, cc_acctbal#7224 AS cc_acctbal_4#7245, cc_comment#7225 AS cc_comment_4#7246, cc_mktsegment#7226 AS cc_mktsegment_4#7247]
               :        +- Relation[rid#7206,cpfk_nation_customer#7207,cfpk_customer_nation#7208,cval_customer_c_name#7209,cval_customer_c_address#7210,cval_customer_c_phone#7211,cval_customer_c_acctbal#7212,cval_customer_c_comment#7213,cval_customer_c_mktsegment#7214,cdepval_customer_c_name#7215,cdepval_customer_c_address#7216,cdepval_customer_c_phone#7217,cdepval_customer_c_acctbal#7218,cdepval_customer_c_comment#7219,cdepval_customer_c_mktsegment#7220,cc_name#7221,cc_address#7222,cc_phone#7223,cc_acctbal#7224,cc_comment#7225,cc_mktsegment#7226] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#7146 AS rid_4#7167, cpfk_nation_customer#7147 AS cpfk_nation_customer_4#7168, cfpk_customer_nation#7148 AS cfpk_customer_nation_4#7169, cval_customer_c_name#7149 AS cval_customer_c_name_4#7170, cval_customer_c_address#7150 AS cval_customer_c_address_4#7171, cval_customer_c_phone#7151 AS cval_customer_c_phone_4#7172, cval_customer_c_acctbal#7152 AS cval_customer_c_acctbal_4#7173, cval_customer_c_comment#7153 AS cval_customer_c_comment_4#7174, cval_customer_c_mktsegment#7154 AS cval_customer_c_mktsegment_4#7175, cdepval_customer_c_name#7155 AS cdepval_customer_c_name_4#7176, cdepval_customer_c_address#7156 AS cdepval_customer_c_address_4#7177, cdepval_customer_c_phone#7157 AS cdepval_customer_c_phone_4#7178, cdepval_customer_c_acctbal#7158 AS cdepval_customer_c_acctbal_4#7179, cdepval_customer_c_comment#7159 AS cdepval_customer_c_comment_4#7180, cdepval_customer_c_mktsegment#7160 AS cdepval_customer_c_mktsegment_4#7181, cc_name#7161 AS cc_name_4#7182, cc_address#7162 AS cc_address_4#7183, cc_phone#7163 AS cc_phone_4#7184, cc_acctbal#7164 AS cc_acctbal_4#7185, cc_comment#7165 AS cc_comment_4#7186, cc_mktsegment#7166 AS cc_mktsegment_4#7187]
                  +- Relation[rid#7146,cpfk_nation_customer#7147,cfpk_customer_nation#7148,cval_customer_c_name#7149,cval_customer_c_address#7150,cval_customer_c_phone#7151,cval_customer_c_acctbal#7152,cval_customer_c_comment#7153,cval_customer_c_mktsegment#7154,cdepval_customer_c_name#7155,cdepval_customer_c_address#7156,cdepval_customer_c_phone#7157,cdepval_customer_c_acctbal#7158,cdepval_customer_c_comment#7159,cdepval_customer_c_mktsegment#7160,cc_name#7161,cc_address#7162,cc_phone#7163,cc_acctbal#7164,cc_comment#7165,cc_mktsegment#7166] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40142ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 21:25:59 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:25:59 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7426L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:25:59 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:25:59 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7426L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#7428 AS rid_0#7473, cpfk_orders_lineitem#7429 AS cpfk_orders_lineitem_0#7474, cpfk_supplier_lineitem#7430 AS cpfk_supplier_lineitem_0#7475, cfpk_lineitem_supplier#7431 AS cfpk_lineitem_supplier_0#7476, cfpk_lineitem_partsupp#7432 AS cfpk_lineitem_partsupp_0#7477, cpfk_part_lineitem#7433 AS cpfk_part_lineitem_0#7478, cfpk_lineitem_part#7434 AS cfpk_lineitem_part_0#7479, cpfk_partsupp_lineitem#7435 AS cpfk_partsupp_lineitem_0#7480, cfpk_lineitem_orders#7436 AS cfpk_lineitem_orders_0#7481, cval_lineitem_l_quantity#7437 AS cval_lineitem_l_quantity_0#7482, cval_lineitem_l_extendedprice#7438 AS cval_lineitem_l_extendedprice_0#7483, cval_lineitem_l_discount#7439 AS cval_lineitem_l_discount_0#7484, cval_lineitem_l_tax#7440 AS cval_lineitem_l_tax_0#7485, cval_lineitem_l_returnflag#7441 AS cval_lineitem_l_returnflag_0#7486, cval_lineitem_l_linestatus#7442 AS cval_lineitem_l_linestatus_0#7487, cval_lineitem_l_commitdate#7443 AS cval_lineitem_l_commitdate_0#7488, cval_lineitem_l_receiptdate#7444 AS cval_lineitem_l_receiptdate_0#7489, cval_lineitem_l_shipinstruct#7445 AS cval_lineitem_l_shipinstruct_0#7490, cval_lineitem_l_shipmode#7446 AS cval_lineitem_l_shipmode_0#7491, cval_lineitem_l_comment#7447 AS cval_lineitem_l_comment_0#7492, cval_lineitem_l_shipdate#7448 AS cval_lineitem_l_shipdate_0#7493, cdepval_lineitem_l_quantity#7449 AS cdepval_lineitem_l_quantity_0#7494, cdepval_lineitem_l_extendedprice#7450 AS cdepval_lineitem_l_extendedprice_0#7495, cdepval_lineitem_l_discount#7451 AS cdepval_lineitem_l_discount_0#7496, ... 21 more fields]
         :  +- Relation[rid#7428,cpfk_orders_lineitem#7429,cpfk_supplier_lineitem#7430,cfpk_lineitem_supplier#7431,cfpk_lineitem_partsupp#7432,cpfk_part_lineitem#7433,cfpk_lineitem_part#7434,cpfk_partsupp_lineitem#7435,cfpk_lineitem_orders#7436,cval_lineitem_l_quantity#7437,cval_lineitem_l_extendedprice#7438,cval_lineitem_l_discount#7439,cval_lineitem_l_tax#7440,cval_lineitem_l_returnflag#7441,cval_lineitem_l_linestatus#7442,cval_lineitem_l_commitdate#7443,cval_lineitem_l_receiptdate#7444,cval_lineitem_l_shipinstruct#7445,cval_lineitem_l_shipmode#7446,cval_lineitem_l_comment#7447,cval_lineitem_l_shipdate#7448,cdepval_lineitem_l_quantity#7449,cdepval_lineitem_l_extendedprice#7450,cdepval_lineitem_l_discount#7451,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#7887, cpfk_region_nation_4#7888, cfpk_nation_region_4#7889, cval_nation_n_name_4#7890, cval_nation_n_comment_4#7891, cdepval_nation_n_name_4#7892, cdepval_nation_n_comment_4#7893, cn_name_4#7894, cn_comment_4#7895, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#7878 AS rid_4#7887, cpfk_region_nation#7879 AS cpfk_region_nation_4#7888, cfpk_nation_region#7880 AS cfpk_nation_region_4#7889, cval_nation_n_name#7881 AS cval_nation_n_name_4#7890, cval_nation_n_comment#7882 AS cval_nation_n_comment_4#7891, cdepval_nation_n_name#7883 AS cdepval_nation_n_name_4#7892, cdepval_nation_n_comment#7884 AS cdepval_nation_n_comment_4#7893, cn_name#7885 AS cn_name_4#7894, cn_comment#7886 AS cn_comment_4#7895]
            :  :     +- Relation[rid#7878,cpfk_region_nation#7879,cfpk_nation_region#7880,cval_nation_n_name#7881,cval_nation_n_comment#7882,cdepval_nation_n_name#7883,cdepval_nation_n_comment#7884,cn_name#7885,cn_comment#7886] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#7932 AS rid_3#7950, cpfk_nation_supplier#7933 AS cpfk_nation_supplier_3#7951, cfpk_supplier_nation#7934 AS cfpk_supplier_nation_3#7952, cval_supplier_s_name#7935 AS cval_supplier_s_name_3#7953, cval_supplier_s_address#7936 AS cval_supplier_s_address_3#7954, cval_supplier_s_phone#7937 AS cval_supplier_s_phone_3#7955, cval_supplier_s_acctbal#7938 AS cval_supplier_s_acctbal_3#7956, cval_supplier_s_comment#7939 AS cval_supplier_s_comment_3#7957, cdepval_supplier_s_name#7940 AS cdepval_supplier_s_name_3#7958, cdepval_supplier_s_address#7941 AS cdepval_supplier_s_address_3#7959, cdepval_supplier_s_phone#7942 AS cdepval_supplier_s_phone_3#7960, cdepval_supplier_s_acctbal#7943 AS cdepval_supplier_s_acctbal_3#7961, cdepval_supplier_s_comment#7944 AS cdepval_supplier_s_comment_3#7962, cs_name#7945 AS cs_name_3#7963, cs_address#7946 AS cs_address_3#7964, cs_phone#7947 AS cs_phone_3#7965, cs_acctbal#7948 AS cs_acctbal_3#7966, cs_comment#7949 AS cs_comment_3#7967]
            :        +- Relation[rid#7932,cpfk_nation_supplier#7933,cfpk_supplier_nation#7934,cval_supplier_s_name#7935,cval_supplier_s_address#7936,cval_supplier_s_phone#7937,cval_supplier_s_acctbal#7938,cval_supplier_s_comment#7939,cdepval_supplier_s_name#7940,cdepval_supplier_s_address#7941,cdepval_supplier_s_phone#7942,cdepval_supplier_s_acctbal#7943,cdepval_supplier_s_comment#7944,cs_name#7945,cs_address#7946,cs_phone#7947,cs_acctbal#7948,cs_comment#7949] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#7542, cpfk_customer_orders_1#7543, cfpk_orders_customer_1#7544, cval_orders_o_orderstatus_1#7545, cval_orders_o_totalprice_1#7546, cval_orders_o_orderpriority_1#7547, cval_orders_o_clerk_1#7548, cval_orders_o_shippriority_1#7549, cval_orders_o_comment_1#7550, cval_orders_o_orderdate_1#7551, cdepval_orders_o_orderstatus_1#7552, cdepval_orders_o_totalprice_1#7553, cdepval_orders_o_orderpriority_1#7554, cdepval_orders_o_clerk_1#7555, cdepval_orders_o_shippriority_1#7556, cdepval_orders_o_comment_1#7557, cdepval_orders_o_orderdate_1#7558, co_orderstatus_1#7559, co_totalprice_1#7560, co_orderpriority_1#7561, co_clerk_1#7562, co_shippriority_1#7563, co_comment_1#7564, co_orderdate_1#7565, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#7518 AS rid_1#7542, cpfk_customer_orders#7519 AS cpfk_customer_orders_1#7543, cfpk_orders_customer#7520 AS cfpk_orders_customer_1#7544, cval_orders_o_orderstatus#7521 AS cval_orders_o_orderstatus_1#7545, cval_orders_o_totalprice#7522 AS cval_orders_o_totalprice_1#7546, cval_orders_o_orderpriority#7523 AS cval_orders_o_orderpriority_1#7547, cval_orders_o_clerk#7524 AS cval_orders_o_clerk_1#7548, cval_orders_o_shippriority#7525 AS cval_orders_o_shippriority_1#7549, cval_orders_o_comment#7526 AS cval_orders_o_comment_1#7550, cval_orders_o_orderdate#7527 AS cval_orders_o_orderdate_1#7551, cdepval_orders_o_orderstatus#7528 AS cdepval_orders_o_orderstatus_1#7552, cdepval_orders_o_totalprice#7529 AS cdepval_orders_o_totalprice_1#7553, cdepval_orders_o_orderpriority#7530 AS cdepval_orders_o_orderpriority_1#7554, cdepval_orders_o_clerk#7531 AS cdepval_orders_o_clerk_1#7555, cdepval_orders_o_shippriority#7532 AS cdepval_orders_o_shippriority_1#7556, cdepval_orders_o_comment#7533 AS cdepval_orders_o_comment_1#7557, cdepval_orders_o_orderdate#7534 AS cdepval_orders_o_orderdate_1#7558, co_orderstatus#7535 AS co_orderstatus_1#7559, co_totalprice#7536 AS co_totalprice_1#7560, co_orderpriority#7537 AS co_orderpriority_1#7561, co_clerk#7538 AS co_clerk_1#7562, co_shippriority#7539 AS co_shippriority_1#7563, co_comment#7540 AS co_comment_1#7564, co_orderdate#7541 AS co_orderdate_1#7565]
               :  :  :     +- Relation[rid#7518,cpfk_customer_orders#7519,cfpk_orders_customer#7520,cval_orders_o_orderstatus#7521,cval_orders_o_totalprice#7522,cval_orders_o_orderpriority#7523,cval_orders_o_clerk#7524,cval_orders_o_shippriority#7525,cval_orders_o_comment#7526,cval_orders_o_orderdate#7527,cdepval_orders_o_orderstatus#7528,cdepval_orders_o_totalprice#7529,cdepval_orders_o_orderpriority#7530,cdepval_orders_o_clerk#7531,cdepval_orders_o_shippriority#7532,cdepval_orders_o_comment#7533,cdepval_orders_o_orderdate#7534,co_orderstatus#7535,co_totalprice#7536,co_orderpriority#7537,co_clerk#7538,co_shippriority#7539,co_comment#7540,co_orderdate#7541] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#7752 AS rid_2#7797, cpfk_orders_lineitem#7753 AS cpfk_orders_lineitem_2#7798, cpfk_supplier_lineitem#7754 AS cpfk_supplier_lineitem_2#7799, cfpk_lineitem_supplier#7755 AS cfpk_lineitem_supplier_2#7800, cfpk_lineitem_partsupp#7756 AS cfpk_lineitem_partsupp_2#7801, cpfk_part_lineitem#7757 AS cpfk_part_lineitem_2#7802, cfpk_lineitem_part#7758 AS cfpk_lineitem_part_2#7803, cpfk_partsupp_lineitem#7759 AS cpfk_partsupp_lineitem_2#7804, cfpk_lineitem_orders#7760 AS cfpk_lineitem_orders_2#7805, cval_lineitem_l_quantity#7761 AS cval_lineitem_l_quantity_2#7806, cval_lineitem_l_extendedprice#7762 AS cval_lineitem_l_extendedprice_2#7807, cval_lineitem_l_discount#7763 AS cval_lineitem_l_discount_2#7808, cval_lineitem_l_tax#7764 AS cval_lineitem_l_tax_2#7809, cval_lineitem_l_returnflag#7765 AS cval_lineitem_l_returnflag_2#7810, cval_lineitem_l_linestatus#7766 AS cval_lineitem_l_linestatus_2#7811, cval_lineitem_l_commitdate#7767 AS cval_lineitem_l_commitdate_2#7812, cval_lineitem_l_receiptdate#7768 AS cval_lineitem_l_receiptdate_2#7813, cval_lineitem_l_shipinstruct#7769 AS cval_lineitem_l_shipinstruct_2#7814, cval_lineitem_l_shipmode#7770 AS cval_lineitem_l_shipmode_2#7815, cval_lineitem_l_comment#7771 AS cval_lineitem_l_comment_2#7816, cval_lineitem_l_shipdate#7772 AS cval_lineitem_l_shipdate_2#7817, cdepval_lineitem_l_quantity#7773 AS cdepval_lineitem_l_quantity_2#7818, cdepval_lineitem_l_extendedprice#7774 AS cdepval_lineitem_l_extendedprice_2#7819, cdepval_lineitem_l_discount#7775 AS cdepval_lineitem_l_discount_2#7820, ... 21 more fields]
               :  :        +- Relation[rid#7752,cpfk_orders_lineitem#7753,cpfk_supplier_lineitem#7754,cfpk_lineitem_supplier#7755,cfpk_lineitem_partsupp#7756,cpfk_part_lineitem#7757,cfpk_lineitem_part#7758,cpfk_partsupp_lineitem#7759,cfpk_lineitem_orders#7760,cval_lineitem_l_quantity#7761,cval_lineitem_l_extendedprice#7762,cval_lineitem_l_discount#7763,cval_lineitem_l_tax#7764,cval_lineitem_l_returnflag#7765,cval_lineitem_l_linestatus#7766,cval_lineitem_l_commitdate#7767,cval_lineitem_l_receiptdate#7768,cval_lineitem_l_shipinstruct#7769,cval_lineitem_l_shipmode#7770,cval_lineitem_l_comment#7771,cval_lineitem_l_shipdate#7772,cdepval_lineitem_l_quantity#7773,cdepval_lineitem_l_extendedprice#7774,cdepval_lineitem_l_discount#7775,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#7614 AS rid_2#7659, cpfk_orders_lineitem#7615 AS cpfk_orders_lineitem_2#7660, cpfk_supplier_lineitem#7616 AS cpfk_supplier_lineitem_2#7661, cfpk_lineitem_supplier#7617 AS cfpk_lineitem_supplier_2#7662, cfpk_lineitem_partsupp#7618 AS cfpk_lineitem_partsupp_2#7663, cpfk_part_lineitem#7619 AS cpfk_part_lineitem_2#7664, cfpk_lineitem_part#7620 AS cfpk_lineitem_part_2#7665, cpfk_partsupp_lineitem#7621 AS cpfk_partsupp_lineitem_2#7666, cfpk_lineitem_orders#7622 AS cfpk_lineitem_orders_2#7667, cval_lineitem_l_quantity#7623 AS cval_lineitem_l_quantity_2#7668, cval_lineitem_l_extendedprice#7624 AS cval_lineitem_l_extendedprice_2#7669, cval_lineitem_l_discount#7625 AS cval_lineitem_l_discount_2#7670, cval_lineitem_l_tax#7626 AS cval_lineitem_l_tax_2#7671, cval_lineitem_l_returnflag#7627 AS cval_lineitem_l_returnflag_2#7672, cval_lineitem_l_linestatus#7628 AS cval_lineitem_l_linestatus_2#7673, cval_lineitem_l_commitdate#7629 AS cval_lineitem_l_commitdate_2#7674, cval_lineitem_l_receiptdate#7630 AS cval_lineitem_l_receiptdate_2#7675, cval_lineitem_l_shipinstruct#7631 AS cval_lineitem_l_shipinstruct_2#7676, cval_lineitem_l_shipmode#7632 AS cval_lineitem_l_shipmode_2#7677, cval_lineitem_l_comment#7633 AS cval_lineitem_l_comment_2#7678, cval_lineitem_l_shipdate#7634 AS cval_lineitem_l_shipdate_2#7679, cdepval_lineitem_l_quantity#7635 AS cdepval_lineitem_l_quantity_2#7680, cdepval_lineitem_l_extendedprice#7636 AS cdepval_lineitem_l_extendedprice_2#7681, cdepval_lineitem_l_discount#7637 AS cdepval_lineitem_l_discount_2#7682, ... 21 more fields]
               :     +- Relation[rid#7614,cpfk_orders_lineitem#7615,cpfk_supplier_lineitem#7616,cfpk_lineitem_supplier#7617,cfpk_lineitem_partsupp#7618,cpfk_part_lineitem#7619,cfpk_lineitem_part#7620,cpfk_partsupp_lineitem#7621,cfpk_lineitem_orders#7622,cval_lineitem_l_quantity#7623,cval_lineitem_l_extendedprice#7624,cval_lineitem_l_discount#7625,cval_lineitem_l_tax#7626,cval_lineitem_l_returnflag#7627,cval_lineitem_l_linestatus#7628,cval_lineitem_l_commitdate#7629,cval_lineitem_l_receiptdate#7630,cval_lineitem_l_shipinstruct#7631,cval_lineitem_l_shipmode#7632,cval_lineitem_l_comment#7633,cval_lineitem_l_shipdate#7634,cdepval_lineitem_l_quantity#7635,cdepval_lineitem_l_extendedprice#7636,cdepval_lineitem_l_discount#7637,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#7842 AS rid_3#7860, cpfk_nation_supplier#7843 AS cpfk_nation_supplier_3#7861, cfpk_supplier_nation#7844 AS cfpk_supplier_nation_3#7862, cval_supplier_s_name#7845 AS cval_supplier_s_name_3#7863, cval_supplier_s_address#7846 AS cval_supplier_s_address_3#7864, cval_supplier_s_phone#7847 AS cval_supplier_s_phone_3#7865, cval_supplier_s_acctbal#7848 AS cval_supplier_s_acctbal_3#7866, cval_supplier_s_comment#7849 AS cval_supplier_s_comment_3#7867, cdepval_supplier_s_name#7850 AS cdepval_supplier_s_name_3#7868, cdepval_supplier_s_address#7851 AS cdepval_supplier_s_address_3#7869, cdepval_supplier_s_phone#7852 AS cdepval_supplier_s_phone_3#7870, cdepval_supplier_s_acctbal#7853 AS cdepval_supplier_s_acctbal_3#7871, cdepval_supplier_s_comment#7854 AS cdepval_supplier_s_comment_3#7872, cs_name#7855 AS cs_name_3#7873, cs_address#7856 AS cs_address_3#7874, cs_phone#7857 AS cs_phone_3#7875, cs_acctbal#7858 AS cs_acctbal_3#7876, cs_comment#7859 AS cs_comment_3#7877]
                  +- Relation[rid#7842,cpfk_nation_supplier#7843,cfpk_supplier_nation#7844,cval_supplier_s_name#7845,cval_supplier_s_address#7846,cval_supplier_s_phone#7847,cval_supplier_s_acctbal#7848,cval_supplier_s_comment#7849,cdepval_supplier_s_name#7850,cdepval_supplier_s_address#7851,cdepval_supplier_s_phone#7852,cdepval_supplier_s_acctbal#7853,cdepval_supplier_s_comment#7854,cs_name#7855,cs_address#7856,cs_phone#7857,cs_acctbal#7858,cs_comment#7859] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 159102ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 21:28:38 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:28:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8114L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:28:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#8114L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#8116 AS rid_0#8161, cpfk_orders_lineitem#8117 AS cpfk_orders_lineitem_0#8162, cpfk_supplier_lineitem#8118 AS cpfk_supplier_lineitem_0#8163, cfpk_lineitem_supplier#8119 AS cfpk_lineitem_supplier_0#8164, cfpk_lineitem_partsupp#8120 AS cfpk_lineitem_partsupp_0#8165, cpfk_part_lineitem#8121 AS cpfk_part_lineitem_0#8166, cfpk_lineitem_part#8122 AS cfpk_lineitem_part_0#8167, cpfk_partsupp_lineitem#8123 AS cpfk_partsupp_lineitem_0#8168, cfpk_lineitem_orders#8124 AS cfpk_lineitem_orders_0#8169, cval_lineitem_l_quantity#8125 AS cval_lineitem_l_quantity_0#8170, cval_lineitem_l_extendedprice#8126 AS cval_lineitem_l_extendedprice_0#8171, cval_lineitem_l_discount#8127 AS cval_lineitem_l_discount_0#8172, cval_lineitem_l_tax#8128 AS cval_lineitem_l_tax_0#8173, cval_lineitem_l_returnflag#8129 AS cval_lineitem_l_returnflag_0#8174, cval_lineitem_l_linestatus#8130 AS cval_lineitem_l_linestatus_0#8175, cval_lineitem_l_commitdate#8131 AS cval_lineitem_l_commitdate_0#8176, cval_lineitem_l_receiptdate#8132 AS cval_lineitem_l_receiptdate_0#8177, cval_lineitem_l_shipinstruct#8133 AS cval_lineitem_l_shipinstruct_0#8178, cval_lineitem_l_shipmode#8134 AS cval_lineitem_l_shipmode_0#8179, cval_lineitem_l_comment#8135 AS cval_lineitem_l_comment_0#8180, cval_lineitem_l_shipdate#8136 AS cval_lineitem_l_shipdate_0#8181, cdepval_lineitem_l_quantity#8137 AS cdepval_lineitem_l_quantity_0#8182, cdepval_lineitem_l_extendedprice#8138 AS cdepval_lineitem_l_extendedprice_0#8183, cdepval_lineitem_l_discount#8139 AS cdepval_lineitem_l_discount_0#8184, ... 21 more fields]
         +- Relation[rid#8116,cpfk_orders_lineitem#8117,cpfk_supplier_lineitem#8118,cfpk_lineitem_supplier#8119,cfpk_lineitem_partsupp#8120,cpfk_part_lineitem#8121,cfpk_lineitem_part#8122,cpfk_partsupp_lineitem#8123,cfpk_lineitem_orders#8124,cval_lineitem_l_quantity#8125,cval_lineitem_l_extendedprice#8126,cval_lineitem_l_discount#8127,cval_lineitem_l_tax#8128,cval_lineitem_l_returnflag#8129,cval_lineitem_l_linestatus#8130,cval_lineitem_l_commitdate#8131,cval_lineitem_l_receiptdate#8132,cval_lineitem_l_shipinstruct#8133,cval_lineitem_l_shipmode#8134,cval_lineitem_l_comment#8135,cval_lineitem_l_shipdate#8136,cdepval_lineitem_l_quantity#8137,cdepval_lineitem_l_extendedprice#8138,cdepval_lineitem_l_discount#8139,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2350ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:28:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:28:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8260L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:28:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:28:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8260L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#8316 AS rid_2#8361, cpfk_orders_lineitem#8317 AS cpfk_orders_lineitem_2#8362, cpfk_supplier_lineitem#8318 AS cpfk_supplier_lineitem_2#8363, cfpk_lineitem_supplier#8319 AS cfpk_lineitem_supplier_2#8364, cfpk_lineitem_partsupp#8320 AS cfpk_lineitem_partsupp_2#8365, cpfk_part_lineitem#8321 AS cpfk_part_lineitem_2#8366, cfpk_lineitem_part#8322 AS cfpk_lineitem_part_2#8367, cpfk_partsupp_lineitem#8323 AS cpfk_partsupp_lineitem_2#8368, cfpk_lineitem_orders#8324 AS cfpk_lineitem_orders_2#8369, cval_lineitem_l_quantity#8325 AS cval_lineitem_l_quantity_2#8370, cval_lineitem_l_extendedprice#8326 AS cval_lineitem_l_extendedprice_2#8371, cval_lineitem_l_discount#8327 AS cval_lineitem_l_discount_2#8372, cval_lineitem_l_tax#8328 AS cval_lineitem_l_tax_2#8373, cval_lineitem_l_returnflag#8329 AS cval_lineitem_l_returnflag_2#8374, cval_lineitem_l_linestatus#8330 AS cval_lineitem_l_linestatus_2#8375, cval_lineitem_l_commitdate#8331 AS cval_lineitem_l_commitdate_2#8376, cval_lineitem_l_receiptdate#8332 AS cval_lineitem_l_receiptdate_2#8377, cval_lineitem_l_shipinstruct#8333 AS cval_lineitem_l_shipinstruct_2#8378, cval_lineitem_l_shipmode#8334 AS cval_lineitem_l_shipmode_2#8379, cval_lineitem_l_comment#8335 AS cval_lineitem_l_comment_2#8380, cval_lineitem_l_shipdate#8336 AS cval_lineitem_l_shipdate_2#8381, cdepval_lineitem_l_quantity#8337 AS cdepval_lineitem_l_quantity_2#8382, cdepval_lineitem_l_extendedprice#8338 AS cdepval_lineitem_l_extendedprice_2#8383, cdepval_lineitem_l_discount#8339 AS cdepval_lineitem_l_discount_2#8384, ... 21 more fields]
         :  :  :  :  +- Relation[rid#8316,cpfk_orders_lineitem#8317,cpfk_supplier_lineitem#8318,cfpk_lineitem_supplier#8319,cfpk_lineitem_partsupp#8320,cpfk_part_lineitem#8321,cfpk_lineitem_part#8322,cpfk_partsupp_lineitem#8323,cfpk_lineitem_orders#8324,cval_lineitem_l_quantity#8325,cval_lineitem_l_extendedprice#8326,cval_lineitem_l_discount#8327,cval_lineitem_l_tax#8328,cval_lineitem_l_returnflag#8329,cval_lineitem_l_linestatus#8330,cval_lineitem_l_commitdate#8331,cval_lineitem_l_receiptdate#8332,cval_lineitem_l_shipinstruct#8333,cval_lineitem_l_shipmode#8334,cval_lineitem_l_comment#8335,cval_lineitem_l_shipdate#8336,cdepval_lineitem_l_quantity#8337,cdepval_lineitem_l_extendedprice#8338,cdepval_lineitem_l_discount#8339,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#8280 AS rid_1#8298, cpfk_nation_supplier#8281 AS cpfk_nation_supplier_1#8299, cfpk_supplier_nation#8282 AS cfpk_supplier_nation_1#8300, cval_supplier_s_name#8283 AS cval_supplier_s_name_1#8301, cval_supplier_s_address#8284 AS cval_supplier_s_address_1#8302, cval_supplier_s_phone#8285 AS cval_supplier_s_phone_1#8303, cval_supplier_s_acctbal#8286 AS cval_supplier_s_acctbal_1#8304, cval_supplier_s_comment#8287 AS cval_supplier_s_comment_1#8305, cdepval_supplier_s_name#8288 AS cdepval_supplier_s_name_1#8306, cdepval_supplier_s_address#8289 AS cdepval_supplier_s_address_1#8307, cdepval_supplier_s_phone#8290 AS cdepval_supplier_s_phone_1#8308, cdepval_supplier_s_acctbal#8291 AS cdepval_supplier_s_acctbal_1#8309, cdepval_supplier_s_comment#8292 AS cdepval_supplier_s_comment_1#8310, cs_name#8293 AS cs_name_1#8311, cs_address#8294 AS cs_address_1#8312, cs_phone#8295 AS cs_phone_1#8313, cs_acctbal#8296 AS cs_acctbal_1#8314, cs_comment#8297 AS cs_comment_1#8315]
         :  :  :     :  +- Relation[rid#8280,cpfk_nation_supplier#8281,cfpk_supplier_nation#8282,cval_supplier_s_name#8283,cval_supplier_s_address#8284,cval_supplier_s_phone#8285,cval_supplier_s_acctbal#8286,cval_supplier_s_comment#8287,cdepval_supplier_s_name#8288,cdepval_supplier_s_address#8289,cdepval_supplier_s_phone#8290,cdepval_supplier_s_acctbal#8291,cdepval_supplier_s_comment#8292,cs_name#8293,cs_address#8294,cs_phone#8295,cs_acctbal#8296,cs_comment#8297] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#8262 AS rid_0#8271, cpfk_region_nation#8263 AS cpfk_region_nation_0#8272, cfpk_nation_region#8264 AS cfpk_nation_region_0#8273, cval_nation_n_name#8265 AS cval_nation_n_name_0#8274, cval_nation_n_comment#8266 AS cval_nation_n_comment_0#8275, cdepval_nation_n_name#8267 AS cdepval_nation_n_name_0#8276, cdepval_nation_n_comment#8268 AS cdepval_nation_n_comment_0#8277, cn_name#8269 AS cn_name_0#8278, cn_comment#8270 AS cn_comment_0#8279]
         :  :  :        +- Relation[rid#8262,cpfk_region_nation#8263,cfpk_nation_region#8264,cval_nation_n_name#8265,cval_nation_n_comment#8266,cdepval_nation_n_name#8267,cdepval_nation_n_comment#8268,cn_name#8269,cn_comment#8270] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#8406 AS rid_3#8431, cval_part_p_name#8407 AS cval_part_p_name_3#8432, cval_part_p_mfgr#8408 AS cval_part_p_mfgr_3#8433, cval_part_p_type#8409 AS cval_part_p_type_3#8434, cval_part_p_size#8410 AS cval_part_p_size_3#8435, cval_part_p_container#8411 AS cval_part_p_container_3#8436, cval_part_p_retailprice#8412 AS cval_part_p_retailprice_3#8437, cval_part_p_comment#8413 AS cval_part_p_comment_3#8438, cval_part_p_brand#8414 AS cval_part_p_brand_3#8439, cdepval_part_p_name#8415 AS cdepval_part_p_name_3#8440, cdepval_part_p_mfgr#8416 AS cdepval_part_p_mfgr_3#8441, cdepval_part_p_type#8417 AS cdepval_part_p_type_3#8442, cdepval_part_p_size#8418 AS cdepval_part_p_size_3#8443, cdepval_part_p_container#8419 AS cdepval_part_p_container_3#8444, cdepval_part_p_retailprice#8420 AS cdepval_part_p_retailprice_3#8445, cdepval_part_p_comment#8421 AS cdepval_part_p_comment_3#8446, cdepval_part_p_brand#8422 AS cdepval_part_p_brand_3#8447, cp_name#8423 AS cp_name_3#8448, cp_mfgr#8424 AS cp_mfgr_3#8449, cp_type#8425 AS cp_type_3#8450, cp_size#8426 AS cp_size_3#8451, cp_container#8427 AS cp_container_3#8452, cp_retailprice#8428 AS cp_retailprice_3#8453, cp_comment#8429 AS cp_comment_3#8454, cp_brand#8430 AS cp_brand_3#8455]
         :  :     +- Relation[rid#8406,cval_part_p_name#8407,cval_part_p_mfgr#8408,cval_part_p_type#8409,cval_part_p_size#8410,cval_part_p_container#8411,cval_part_p_retailprice#8412,cval_part_p_comment#8413,cval_part_p_brand#8414,cdepval_part_p_name#8415,cdepval_part_p_mfgr#8416,cdepval_part_p_type#8417,cdepval_part_p_size#8418,cdepval_part_p_container#8419,cdepval_part_p_retailprice#8420,cdepval_part_p_comment#8421,cdepval_part_p_brand#8422,cp_name#8423,cp_mfgr#8424,cp_type#8425,cp_size#8426,cp_container#8427,cp_retailprice#8428,cp_comment#8429,cp_brand#8430] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8456 AS rid_4#8470, cpfk_part_partsupp#8457 AS cpfk_part_partsupp_4#8471, cfpk_partsupp_part#8458 AS cfpk_partsupp_part_4#8472, cpfk_supplier_partsupp#8459 AS cpfk_supplier_partsupp_4#8473, cfpk_partsupp_supplier#8460 AS cfpk_partsupp_supplier_4#8474, cval_partsupp_ps_availqty#8461 AS cval_partsupp_ps_availqty_4#8475, cval_partsupp_ps_supplycost#8462 AS cval_partsupp_ps_supplycost_4#8476, cval_partsupp_ps_comment#8463 AS cval_partsupp_ps_comment_4#8477, cdepval_partsupp_ps_availqty#8464 AS cdepval_partsupp_ps_availqty_4#8478, cdepval_partsupp_ps_supplycost#8465 AS cdepval_partsupp_ps_supplycost_4#8479, cdepval_partsupp_ps_comment#8466 AS cdepval_partsupp_ps_comment_4#8480, cps_availqty#8467 AS cps_availqty_4#8481, cps_supplycost#8468 AS cps_supplycost_4#8482, cps_comment#8469 AS cps_comment_4#8483]
         :     +- Relation[rid#8456,cpfk_part_partsupp#8457,cfpk_partsupp_part#8458,cpfk_supplier_partsupp#8459,cfpk_partsupp_supplier#8460,cval_partsupp_ps_availqty#8461,cval_partsupp_ps_supplycost#8462,cval_partsupp_ps_comment#8463,cdepval_partsupp_ps_availqty#8464,cdepval_partsupp_ps_supplycost#8465,cdepval_partsupp_ps_comment#8466,cps_availqty#8467,cps_supplycost#8468,cps_comment#8469] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8484 AS rid_5#8508, cpfk_customer_orders#8485 AS cpfk_customer_orders_5#8509, cfpk_orders_customer#8486 AS cfpk_orders_customer_5#8510, cval_orders_o_orderstatus#8487 AS cval_orders_o_orderstatus_5#8511, cval_orders_o_totalprice#8488 AS cval_orders_o_totalprice_5#8512, cval_orders_o_orderpriority#8489 AS cval_orders_o_orderpriority_5#8513, cval_orders_o_clerk#8490 AS cval_orders_o_clerk_5#8514, cval_orders_o_shippriority#8491 AS cval_orders_o_shippriority_5#8515, cval_orders_o_comment#8492 AS cval_orders_o_comment_5#8516, cval_orders_o_orderdate#8493 AS cval_orders_o_orderdate_5#8517, cdepval_orders_o_orderstatus#8494 AS cdepval_orders_o_orderstatus_5#8518, cdepval_orders_o_totalprice#8495 AS cdepval_orders_o_totalprice_5#8519, cdepval_orders_o_orderpriority#8496 AS cdepval_orders_o_orderpriority_5#8520, cdepval_orders_o_clerk#8497 AS cdepval_orders_o_clerk_5#8521, cdepval_orders_o_shippriority#8498 AS cdepval_orders_o_shippriority_5#8522, cdepval_orders_o_comment#8499 AS cdepval_orders_o_comment_5#8523, cdepval_orders_o_orderdate#8500 AS cdepval_orders_o_orderdate_5#8524, co_orderstatus#8501 AS co_orderstatus_5#8525, co_totalprice#8502 AS co_totalprice_5#8526, co_orderpriority#8503 AS co_orderpriority_5#8527, co_clerk#8504 AS co_clerk_5#8528, co_shippriority#8505 AS co_shippriority_5#8529, co_comment#8506 AS co_comment_5#8530, co_orderdate#8507 AS co_orderdate_5#8531]
            +- Relation[rid#8484,cpfk_customer_orders#8485,cfpk_orders_customer#8486,cval_orders_o_orderstatus#8487,cval_orders_o_totalprice#8488,cval_orders_o_orderpriority#8489,cval_orders_o_clerk#8490,cval_orders_o_shippriority#8491,cval_orders_o_comment#8492,cval_orders_o_orderdate#8493,cdepval_orders_o_orderstatus#8494,cdepval_orders_o_totalprice#8495,cdepval_orders_o_orderpriority#8496,cdepval_orders_o_clerk#8497,cdepval_orders_o_shippriority#8498,cdepval_orders_o_comment#8499,cdepval_orders_o_orderdate#8500,co_orderstatus#8501,co_totalprice#8502,co_orderpriority#8503,co_clerk#8504,co_shippriority#8505,co_comment#8506,co_orderdate#8507] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63408ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 21:29:43 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:29:43 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8671L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:29:43 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8671L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#8673 AS rid_0#8697, cpfk_customer_orders#8674 AS cpfk_customer_orders_0#8698, cfpk_orders_customer#8675 AS cfpk_orders_customer_0#8699, cval_orders_o_orderstatus#8676 AS cval_orders_o_orderstatus_0#8700, cval_orders_o_totalprice#8677 AS cval_orders_o_totalprice_0#8701, cval_orders_o_orderpriority#8678 AS cval_orders_o_orderpriority_0#8702, cval_orders_o_clerk#8679 AS cval_orders_o_clerk_0#8703, cval_orders_o_shippriority#8680 AS cval_orders_o_shippriority_0#8704, cval_orders_o_comment#8681 AS cval_orders_o_comment_0#8705, cval_orders_o_orderdate#8682 AS cval_orders_o_orderdate_0#8706, cdepval_orders_o_orderstatus#8683 AS cdepval_orders_o_orderstatus_0#8707, cdepval_orders_o_totalprice#8684 AS cdepval_orders_o_totalprice_0#8708, cdepval_orders_o_orderpriority#8685 AS cdepval_orders_o_orderpriority_0#8709, cdepval_orders_o_clerk#8686 AS cdepval_orders_o_clerk_0#8710, cdepval_orders_o_shippriority#8687 AS cdepval_orders_o_shippriority_0#8711, cdepval_orders_o_comment#8688 AS cdepval_orders_o_comment_0#8712, cdepval_orders_o_orderdate#8689 AS cdepval_orders_o_orderdate_0#8713, co_orderstatus#8690 AS co_orderstatus_0#8714, co_totalprice#8691 AS co_totalprice_0#8715, co_orderpriority#8692 AS co_orderpriority_0#8716, co_clerk#8693 AS co_clerk_0#8717, co_shippriority#8694 AS co_shippriority_0#8718, co_comment#8695 AS co_comment_0#8719, co_orderdate#8696 AS co_orderdate_0#8720]
         :  +- Relation[rid#8673,cpfk_customer_orders#8674,cfpk_orders_customer#8675,cval_orders_o_orderstatus#8676,cval_orders_o_totalprice#8677,cval_orders_o_orderpriority#8678,cval_orders_o_clerk#8679,cval_orders_o_shippriority#8680,cval_orders_o_comment#8681,cval_orders_o_orderdate#8682,cdepval_orders_o_orderstatus#8683,cdepval_orders_o_totalprice#8684,cdepval_orders_o_orderpriority#8685,cdepval_orders_o_clerk#8686,cdepval_orders_o_shippriority#8687,cdepval_orders_o_comment#8688,cdepval_orders_o_orderdate#8689,co_orderstatus#8690,co_totalprice#8691,co_orderpriority#8692,co_clerk#8693,co_shippriority#8694,co_comment#8695,co_orderdate#8696] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#8721 AS rid_1#8742, cpfk_nation_customer#8722 AS cpfk_nation_customer_1#8743, cfpk_customer_nation#8723 AS cfpk_customer_nation_1#8744, cval_customer_c_name#8724 AS cval_customer_c_name_1#8745, cval_customer_c_address#8725 AS cval_customer_c_address_1#8746, cval_customer_c_phone#8726 AS cval_customer_c_phone_1#8747, cval_customer_c_acctbal#8727 AS cval_customer_c_acctbal_1#8748, cval_customer_c_comment#8728 AS cval_customer_c_comment_1#8749, cval_customer_c_mktsegment#8729 AS cval_customer_c_mktsegment_1#8750, cdepval_customer_c_name#8730 AS cdepval_customer_c_name_1#8751, cdepval_customer_c_address#8731 AS cdepval_customer_c_address_1#8752, cdepval_customer_c_phone#8732 AS cdepval_customer_c_phone_1#8753, cdepval_customer_c_acctbal#8733 AS cdepval_customer_c_acctbal_1#8754, cdepval_customer_c_comment#8734 AS cdepval_customer_c_comment_1#8755, cdepval_customer_c_mktsegment#8735 AS cdepval_customer_c_mktsegment_1#8756, cc_name#8736 AS cc_name_1#8757, cc_address#8737 AS cc_address_1#8758, cc_phone#8738 AS cc_phone_1#8759, cc_acctbal#8739 AS cc_acctbal_1#8760, cc_comment#8740 AS cc_comment_1#8761, cc_mktsegment#8741 AS cc_mktsegment_1#8762]
            +- Relation[rid#8721,cpfk_nation_customer#8722,cfpk_customer_nation#8723,cval_customer_c_name#8724,cval_customer_c_address#8725,cval_customer_c_phone#8726,cval_customer_c_acctbal#8727,cval_customer_c_comment#8728,cval_customer_c_mktsegment#8729,cdepval_customer_c_name#8730,cdepval_customer_c_address#8731,cdepval_customer_c_phone#8732,cdepval_customer_c_acctbal#8733,cdepval_customer_c_comment#8734,cdepval_customer_c_mktsegment#8735,cc_name#8736,cc_address#8737,cc_phone#8738,cc_acctbal#8739,cc_comment#8740,cc_mktsegment#8741] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4355ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 21:29:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:29:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8815L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:29:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:29:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:29:48 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:29:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8815L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#8842, cval_part_p_name_0#8843, cval_part_p_mfgr_0#8844, cval_part_p_type_0#8845, cval_part_p_size_0#8846, cval_part_p_container_0#8847, cval_part_p_retailprice_0#8848, cval_part_p_comment_0#8849, cval_part_p_brand_0#8850, cdepval_part_p_name_0#8851, cdepval_part_p_mfgr_0#8852, cdepval_part_p_type_0#8853, cdepval_part_p_size_0#8854, cdepval_part_p_container_0#8855, cdepval_part_p_retailprice_0#8856, cdepval_part_p_comment_0#8857, cdepval_part_p_brand_0#8858, cp_name_0#8859, cp_mfgr_0#8860, cp_type_0#8861, cp_size_0#8862, cp_container_0#8863, cp_retailprice_0#8864, cp_comment_0#8865, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#8817 AS rid_0#8842, cval_part_p_name#8818 AS cval_part_p_name_0#8843, cval_part_p_mfgr#8819 AS cval_part_p_mfgr_0#8844, cval_part_p_type#8820 AS cval_part_p_type_0#8845, cval_part_p_size#8821 AS cval_part_p_size_0#8846, cval_part_p_container#8822 AS cval_part_p_container_0#8847, cval_part_p_retailprice#8823 AS cval_part_p_retailprice_0#8848, cval_part_p_comment#8824 AS cval_part_p_comment_0#8849, cval_part_p_brand#8825 AS cval_part_p_brand_0#8850, cdepval_part_p_name#8826 AS cdepval_part_p_name_0#8851, cdepval_part_p_mfgr#8827 AS cdepval_part_p_mfgr_0#8852, cdepval_part_p_type#8828 AS cdepval_part_p_type_0#8853, cdepval_part_p_size#8829 AS cdepval_part_p_size_0#8854, cdepval_part_p_container#8830 AS cdepval_part_p_container_0#8855, cdepval_part_p_retailprice#8831 AS cdepval_part_p_retailprice_0#8856, cdepval_part_p_comment#8832 AS cdepval_part_p_comment_0#8857, cdepval_part_p_brand#8833 AS cdepval_part_p_brand_0#8858, cp_name#8834 AS cp_name_0#8859, cp_mfgr#8835 AS cp_mfgr_0#8860, cp_type#8836 AS cp_type_0#8861, cp_size#8837 AS cp_size_0#8862, cp_container#8838 AS cp_container_0#8863, cp_retailprice#8839 AS cp_retailprice_0#8864, cp_comment#8840 AS cp_comment_0#8865, cp_brand#8841 AS cp_brand_0#8866]
         :  :     +- Relation[rid#8817,cval_part_p_name#8818,cval_part_p_mfgr#8819,cval_part_p_type#8820,cval_part_p_size#8821,cval_part_p_container#8822,cval_part_p_retailprice#8823,cval_part_p_comment#8824,cval_part_p_brand#8825,cdepval_part_p_name#8826,cdepval_part_p_mfgr#8827,cdepval_part_p_type#8828,cdepval_part_p_size#8829,cdepval_part_p_container#8830,cdepval_part_p_retailprice#8831,cdepval_part_p_comment#8832,cdepval_part_p_brand#8833,cp_name#8834,cp_mfgr#8835,cp_type#8836,cp_size#8837,cp_container#8838,cp_retailprice#8839,cp_comment#8840,cp_brand#8841] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#8995 AS rid_1#9009, cpfk_part_partsupp#8996 AS cpfk_part_partsupp_1#9010, cfpk_partsupp_part#8997 AS cfpk_partsupp_part_1#9011, cpfk_supplier_partsupp#8998 AS cpfk_supplier_partsupp_1#9012, cfpk_partsupp_supplier#8999 AS cfpk_partsupp_supplier_1#9013, cval_partsupp_ps_availqty#9000 AS cval_partsupp_ps_availqty_1#9014, cval_partsupp_ps_supplycost#9001 AS cval_partsupp_ps_supplycost_1#9015, cval_partsupp_ps_comment#9002 AS cval_partsupp_ps_comment_1#9016, cdepval_partsupp_ps_availqty#9003 AS cdepval_partsupp_ps_availqty_1#9017, cdepval_partsupp_ps_supplycost#9004 AS cdepval_partsupp_ps_supplycost_1#9018, cdepval_partsupp_ps_comment#9005 AS cdepval_partsupp_ps_comment_1#9019, cps_availqty#9006 AS cps_availqty_1#9020, cps_supplycost#9007 AS cps_supplycost_1#9021, cps_comment#9008 AS cps_comment_1#9022]
         :        +- Relation[rid#8995,cpfk_part_partsupp#8996,cfpk_partsupp_part#8997,cpfk_supplier_partsupp#8998,cfpk_partsupp_supplier#8999,cval_partsupp_ps_availqty#9000,cval_partsupp_ps_supplycost#9001,cval_partsupp_ps_comment#9002,cdepval_partsupp_ps_availqty#9003,cdepval_partsupp_ps_supplycost#9004,cdepval_partsupp_ps_comment#9005,cps_availqty#9006,cps_supplycost#9007,cps_comment#9008] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8917 AS rid_1#8931, cpfk_part_partsupp#8918 AS cpfk_part_partsupp_1#8932, cfpk_partsupp_part#8919 AS cfpk_partsupp_part_1#8933, cpfk_supplier_partsupp#8920 AS cpfk_supplier_partsupp_1#8934, cfpk_partsupp_supplier#8921 AS cfpk_partsupp_supplier_1#8935, cval_partsupp_ps_availqty#8922 AS cval_partsupp_ps_availqty_1#8936, cval_partsupp_ps_supplycost#8923 AS cval_partsupp_ps_supplycost_1#8937, cval_partsupp_ps_comment#8924 AS cval_partsupp_ps_comment_1#8938, cdepval_partsupp_ps_availqty#8925 AS cdepval_partsupp_ps_availqty_1#8939, cdepval_partsupp_ps_supplycost#8926 AS cdepval_partsupp_ps_supplycost_1#8940, cdepval_partsupp_ps_comment#8927 AS cdepval_partsupp_ps_comment_1#8941, cps_availqty#8928 AS cps_availqty_1#8942, cps_supplycost#8929 AS cps_supplycost_1#8943, cps_comment#8930 AS cps_comment_1#8944]
            +- Relation[rid#8917,cpfk_part_partsupp#8918,cfpk_partsupp_part#8919,cpfk_supplier_partsupp#8920,cfpk_partsupp_supplier#8921,cval_partsupp_ps_availqty#8922,cval_partsupp_ps_supplycost#8923,cval_partsupp_ps_comment#8924,cdepval_partsupp_ps_availqty#8925,cdepval_partsupp_ps_supplycost#8926,cdepval_partsupp_ps_comment#8927,cps_availqty#8928,cps_supplycost#8929,cps_comment#8930] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 680ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 21:29:48 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:29:48 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9068L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:29:48 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9068L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#9120 AS rid_1#9165, cpfk_orders_lineitem#9121 AS cpfk_orders_lineitem_1#9166, cpfk_supplier_lineitem#9122 AS cpfk_supplier_lineitem_1#9167, cfpk_lineitem_supplier#9123 AS cfpk_lineitem_supplier_1#9168, cfpk_lineitem_partsupp#9124 AS cfpk_lineitem_partsupp_1#9169, cpfk_part_lineitem#9125 AS cpfk_part_lineitem_1#9170, cfpk_lineitem_part#9126 AS cfpk_lineitem_part_1#9171, cpfk_partsupp_lineitem#9127 AS cpfk_partsupp_lineitem_1#9172, cfpk_lineitem_orders#9128 AS cfpk_lineitem_orders_1#9173, cval_lineitem_l_quantity#9129 AS cval_lineitem_l_quantity_1#9174, cval_lineitem_l_extendedprice#9130 AS cval_lineitem_l_extendedprice_1#9175, cval_lineitem_l_discount#9131 AS cval_lineitem_l_discount_1#9176, cval_lineitem_l_tax#9132 AS cval_lineitem_l_tax_1#9177, cval_lineitem_l_returnflag#9133 AS cval_lineitem_l_returnflag_1#9178, cval_lineitem_l_linestatus#9134 AS cval_lineitem_l_linestatus_1#9179, cval_lineitem_l_commitdate#9135 AS cval_lineitem_l_commitdate_1#9180, cval_lineitem_l_receiptdate#9136 AS cval_lineitem_l_receiptdate_1#9181, cval_lineitem_l_shipinstruct#9137 AS cval_lineitem_l_shipinstruct_1#9182, cval_lineitem_l_shipmode#9138 AS cval_lineitem_l_shipmode_1#9183, cval_lineitem_l_comment#9139 AS cval_lineitem_l_comment_1#9184, cval_lineitem_l_shipdate#9140 AS cval_lineitem_l_shipdate_1#9185, cdepval_lineitem_l_quantity#9141 AS cdepval_lineitem_l_quantity_1#9186, cdepval_lineitem_l_extendedprice#9142 AS cdepval_lineitem_l_extendedprice_1#9187, cdepval_lineitem_l_discount#9143 AS cdepval_lineitem_l_discount_1#9188, ... 21 more fields]
         :  +- Relation[rid#9120,cpfk_orders_lineitem#9121,cpfk_supplier_lineitem#9122,cfpk_lineitem_supplier#9123,cfpk_lineitem_partsupp#9124,cpfk_part_lineitem#9125,cfpk_lineitem_part#9126,cpfk_partsupp_lineitem#9127,cfpk_lineitem_orders#9128,cval_lineitem_l_quantity#9129,cval_lineitem_l_extendedprice#9130,cval_lineitem_l_discount#9131,cval_lineitem_l_tax#9132,cval_lineitem_l_returnflag#9133,cval_lineitem_l_linestatus#9134,cval_lineitem_l_commitdate#9135,cval_lineitem_l_receiptdate#9136,cval_lineitem_l_shipinstruct#9137,cval_lineitem_l_shipmode#9138,cval_lineitem_l_comment#9139,cval_lineitem_l_shipdate#9140,cdepval_lineitem_l_quantity#9141,cdepval_lineitem_l_extendedprice#9142,cdepval_lineitem_l_discount#9143,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#9070 AS rid_0#9095, cval_part_p_name#9071 AS cval_part_p_name_0#9096, cval_part_p_mfgr#9072 AS cval_part_p_mfgr_0#9097, cval_part_p_type#9073 AS cval_part_p_type_0#9098, cval_part_p_size#9074 AS cval_part_p_size_0#9099, cval_part_p_container#9075 AS cval_part_p_container_0#9100, cval_part_p_retailprice#9076 AS cval_part_p_retailprice_0#9101, cval_part_p_comment#9077 AS cval_part_p_comment_0#9102, cval_part_p_brand#9078 AS cval_part_p_brand_0#9103, cdepval_part_p_name#9079 AS cdepval_part_p_name_0#9104, cdepval_part_p_mfgr#9080 AS cdepval_part_p_mfgr_0#9105, cdepval_part_p_type#9081 AS cdepval_part_p_type_0#9106, cdepval_part_p_size#9082 AS cdepval_part_p_size_0#9107, cdepval_part_p_container#9083 AS cdepval_part_p_container_0#9108, cdepval_part_p_retailprice#9084 AS cdepval_part_p_retailprice_0#9109, cdepval_part_p_comment#9085 AS cdepval_part_p_comment_0#9110, cdepval_part_p_brand#9086 AS cdepval_part_p_brand_0#9111, cp_name#9087 AS cp_name_0#9112, cp_mfgr#9088 AS cp_mfgr_0#9113, cp_type#9089 AS cp_type_0#9114, cp_size#9090 AS cp_size_0#9115, cp_container#9091 AS cp_container_0#9116, cp_retailprice#9092 AS cp_retailprice_0#9117, cp_comment#9093 AS cp_comment_0#9118, cp_brand#9094 AS cp_brand_0#9119]
            +- Relation[rid#9070,cval_part_p_name#9071,cval_part_p_mfgr#9072,cval_part_p_type#9073,cval_part_p_size#9074,cval_part_p_container#9075,cval_part_p_retailprice#9076,cval_part_p_comment#9077,cval_part_p_brand#9078,cdepval_part_p_name#9079,cdepval_part_p_mfgr#9080,cdepval_part_p_type#9081,cdepval_part_p_size#9082,cdepval_part_p_container#9083,cdepval_part_p_retailprice#9084,cdepval_part_p_comment#9085,cdepval_part_p_brand#9086,cp_name#9087,cp_mfgr#9088,cp_type#9089,cp_size#9090,cp_container#9091,cp_retailprice#9092,cp_comment#9093,cp_brand#9094] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17860ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 21:30:06 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:30:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9285L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:30:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#9285L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#9287 AS rid_0#9332, cpfk_orders_lineitem#9288 AS cpfk_orders_lineitem_0#9333, cpfk_supplier_lineitem#9289 AS cpfk_supplier_lineitem_0#9334, cfpk_lineitem_supplier#9290 AS cfpk_lineitem_supplier_0#9335, cfpk_lineitem_partsupp#9291 AS cfpk_lineitem_partsupp_0#9336, cpfk_part_lineitem#9292 AS cpfk_part_lineitem_0#9337, cfpk_lineitem_part#9293 AS cfpk_lineitem_part_0#9338, cpfk_partsupp_lineitem#9294 AS cpfk_partsupp_lineitem_0#9339, cfpk_lineitem_orders#9295 AS cfpk_lineitem_orders_0#9340, cval_lineitem_l_quantity#9296 AS cval_lineitem_l_quantity_0#9341, cval_lineitem_l_extendedprice#9297 AS cval_lineitem_l_extendedprice_0#9342, cval_lineitem_l_discount#9298 AS cval_lineitem_l_discount_0#9343, cval_lineitem_l_tax#9299 AS cval_lineitem_l_tax_0#9344, cval_lineitem_l_returnflag#9300 AS cval_lineitem_l_returnflag_0#9345, cval_lineitem_l_linestatus#9301 AS cval_lineitem_l_linestatus_0#9346, cval_lineitem_l_commitdate#9302 AS cval_lineitem_l_commitdate_0#9347, cval_lineitem_l_receiptdate#9303 AS cval_lineitem_l_receiptdate_0#9348, cval_lineitem_l_shipinstruct#9304 AS cval_lineitem_l_shipinstruct_0#9349, cval_lineitem_l_shipmode#9305 AS cval_lineitem_l_shipmode_0#9350, cval_lineitem_l_comment#9306 AS cval_lineitem_l_comment_0#9351, cval_lineitem_l_shipdate#9307 AS cval_lineitem_l_shipdate_0#9352, cdepval_lineitem_l_quantity#9308 AS cdepval_lineitem_l_quantity_0#9353, cdepval_lineitem_l_extendedprice#9309 AS cdepval_lineitem_l_extendedprice_0#9354, cdepval_lineitem_l_discount#9310 AS cdepval_lineitem_l_discount_0#9355, ... 21 more fields]
         +- Relation[rid#9287,cpfk_orders_lineitem#9288,cpfk_supplier_lineitem#9289,cfpk_lineitem_supplier#9290,cfpk_lineitem_partsupp#9291,cpfk_part_lineitem#9292,cfpk_lineitem_part#9293,cpfk_partsupp_lineitem#9294,cfpk_lineitem_orders#9295,cval_lineitem_l_quantity#9296,cval_lineitem_l_extendedprice#9297,cval_lineitem_l_discount#9298,cval_lineitem_l_tax#9299,cval_lineitem_l_returnflag#9300,cval_lineitem_l_linestatus#9301,cval_lineitem_l_commitdate#9302,cval_lineitem_l_receiptdate#9303,cval_lineitem_l_shipinstruct#9304,cval_lineitem_l_shipmode#9305,cval_lineitem_l_comment#9306,cval_lineitem_l_shipdate#9307,cdepval_lineitem_l_quantity#9308,cdepval_lineitem_l_extendedprice#9309,cdepval_lineitem_l_discount#9310,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2356ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 21:30:09 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:30:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9426L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:30:09 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:30:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9426L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#9567, cval_part_p_name_3#9568, cval_part_p_mfgr_3#9569, cval_part_p_type_3#9570, cval_part_p_size_3#9571, cval_part_p_container_3#9572, cval_part_p_retailprice_3#9573, cval_part_p_comment_3#9574, cval_part_p_brand_3#9575, cdepval_part_p_name_3#9576, cdepval_part_p_mfgr_3#9577, cdepval_part_p_type_3#9578, cdepval_part_p_size_3#9579, cdepval_part_p_container_3#9580, cdepval_part_p_retailprice_3#9581, cdepval_part_p_comment_3#9582, cdepval_part_p_brand_3#9583, cp_name_3#9584, cp_mfgr_3#9585, cp_type_3#9586, cp_size_3#9587, cp_container_3#9588, cp_retailprice_3#9589, cp_comment_3#9590, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#9542 AS rid_3#9567, cval_part_p_name#9543 AS cval_part_p_name_3#9568, cval_part_p_mfgr#9544 AS cval_part_p_mfgr_3#9569, cval_part_p_type#9545 AS cval_part_p_type_3#9570, cval_part_p_size#9546 AS cval_part_p_size_3#9571, cval_part_p_container#9547 AS cval_part_p_container_3#9572, cval_part_p_retailprice#9548 AS cval_part_p_retailprice_3#9573, cval_part_p_comment#9549 AS cval_part_p_comment_3#9574, cval_part_p_brand#9550 AS cval_part_p_brand_3#9575, cdepval_part_p_name#9551 AS cdepval_part_p_name_3#9576, cdepval_part_p_mfgr#9552 AS cdepval_part_p_mfgr_3#9577, cdepval_part_p_type#9553 AS cdepval_part_p_type_3#9578, cdepval_part_p_size#9554 AS cdepval_part_p_size_3#9579, cdepval_part_p_container#9555 AS cdepval_part_p_container_3#9580, cdepval_part_p_retailprice#9556 AS cdepval_part_p_retailprice_3#9581, cdepval_part_p_comment#9557 AS cdepval_part_p_comment_3#9582, cdepval_part_p_brand#9558 AS cdepval_part_p_brand_3#9583, cp_name#9559 AS cp_name_3#9584, cp_mfgr#9560 AS cp_mfgr_3#9585, cp_type#9561 AS cp_type_3#9586, cp_size#9562 AS cp_size_3#9587, cp_container#9563 AS cp_container_3#9588, cp_retailprice#9564 AS cp_retailprice_3#9589, cp_comment#9565 AS cp_comment_3#9590, cp_brand#9566 AS cp_brand_3#9591]
         :  :  :     +- Relation[rid#9542,cval_part_p_name#9543,cval_part_p_mfgr#9544,cval_part_p_type#9545,cval_part_p_size#9546,cval_part_p_container#9547,cval_part_p_retailprice#9548,cval_part_p_comment#9549,cval_part_p_brand#9550,cdepval_part_p_name#9551,cdepval_part_p_mfgr#9552,cdepval_part_p_type#9553,cdepval_part_p_size#9554,cdepval_part_p_container#9555,cdepval_part_p_retailprice#9556,cdepval_part_p_comment#9557,cdepval_part_p_brand#9558,cp_name#9559,cp_mfgr#9560,cp_type#9561,cp_size#9562,cp_container#9563,cp_retailprice#9564,cp_comment#9565,cp_brand#9566] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#9720 AS rid_4#9734, cpfk_part_partsupp#9721 AS cpfk_part_partsupp_4#9735, cfpk_partsupp_part#9722 AS cfpk_partsupp_part_4#9736, cpfk_supplier_partsupp#9723 AS cpfk_supplier_partsupp_4#9737, cfpk_partsupp_supplier#9724 AS cfpk_partsupp_supplier_4#9738, cval_partsupp_ps_availqty#9725 AS cval_partsupp_ps_availqty_4#9739, cval_partsupp_ps_supplycost#9726 AS cval_partsupp_ps_supplycost_4#9740, cval_partsupp_ps_comment#9727 AS cval_partsupp_ps_comment_4#9741, cdepval_partsupp_ps_availqty#9728 AS cdepval_partsupp_ps_availqty_4#9742, cdepval_partsupp_ps_supplycost#9729 AS cdepval_partsupp_ps_supplycost_4#9743, cdepval_partsupp_ps_comment#9730 AS cdepval_partsupp_ps_comment_4#9744, cps_availqty#9731 AS cps_availqty_4#9745, cps_supplycost#9732 AS cps_supplycost_4#9746, cps_comment#9733 AS cps_comment_4#9747]
         :  :        +- Relation[rid#9720,cpfk_part_partsupp#9721,cfpk_partsupp_part#9722,cpfk_supplier_partsupp#9723,cfpk_partsupp_supplier#9724,cval_partsupp_ps_availqty#9725,cval_partsupp_ps_supplycost#9726,cval_partsupp_ps_comment#9727,cdepval_partsupp_ps_availqty#9728,cdepval_partsupp_ps_supplycost#9729,cdepval_partsupp_ps_comment#9730,cps_availqty#9731,cps_supplycost#9732,cps_comment#9733] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#9642 AS rid_4#9656, cpfk_part_partsupp#9643 AS cpfk_part_partsupp_4#9657, cfpk_partsupp_part#9644 AS cfpk_partsupp_part_4#9658, cpfk_supplier_partsupp#9645 AS cpfk_supplier_partsupp_4#9659, cfpk_partsupp_supplier#9646 AS cfpk_partsupp_supplier_4#9660, cval_partsupp_ps_availqty#9647 AS cval_partsupp_ps_availqty_4#9661, cval_partsupp_ps_supplycost#9648 AS cval_partsupp_ps_supplycost_4#9662, cval_partsupp_ps_comment#9649 AS cval_partsupp_ps_comment_4#9663, cdepval_partsupp_ps_availqty#9650 AS cdepval_partsupp_ps_availqty_4#9664, cdepval_partsupp_ps_supplycost#9651 AS cdepval_partsupp_ps_supplycost_4#9665, cdepval_partsupp_ps_comment#9652 AS cdepval_partsupp_ps_comment_4#9666, cps_availqty#9653 AS cps_availqty_4#9667, cps_supplycost#9654 AS cps_supplycost_4#9668, cps_comment#9655 AS cps_comment_4#9669]
         :     +- Relation[rid#9642,cpfk_part_partsupp#9643,cfpk_partsupp_part#9644,cpfk_supplier_partsupp#9645,cfpk_partsupp_supplier#9646,cval_partsupp_ps_availqty#9647,cval_partsupp_ps_supplycost#9648,cval_partsupp_ps_comment#9649,cdepval_partsupp_ps_availqty#9650,cdepval_partsupp_ps_supplycost#9651,cdepval_partsupp_ps_comment#9652,cps_availqty#9653,cps_supplycost#9654,cps_comment#9655] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#9506 AS rid_2#9524, cpfk_nation_supplier#9507 AS cpfk_nation_supplier_2#9525, cfpk_supplier_nation#9508 AS cfpk_supplier_nation_2#9526, cval_supplier_s_name#9509 AS cval_supplier_s_name_2#9527, cval_supplier_s_address#9510 AS cval_supplier_s_address_2#9528, cval_supplier_s_phone#9511 AS cval_supplier_s_phone_2#9529, cval_supplier_s_acctbal#9512 AS cval_supplier_s_acctbal_2#9530, cval_supplier_s_comment#9513 AS cval_supplier_s_comment_2#9531, cdepval_supplier_s_name#9514 AS cdepval_supplier_s_name_2#9532, cdepval_supplier_s_address#9515 AS cdepval_supplier_s_address_2#9533, cdepval_supplier_s_phone#9516 AS cdepval_supplier_s_phone_2#9534, cdepval_supplier_s_acctbal#9517 AS cdepval_supplier_s_acctbal_2#9535, cdepval_supplier_s_comment#9518 AS cdepval_supplier_s_comment_2#9536, cs_name#9519 AS cs_name_2#9537, cs_address#9520 AS cs_address_2#9538, cs_phone#9521 AS cs_phone_2#9539, cs_acctbal#9522 AS cs_acctbal_2#9540, cs_comment#9523 AS cs_comment_2#9541]
            :  +- Relation[rid#9506,cpfk_nation_supplier#9507,cfpk_supplier_nation#9508,cval_supplier_s_name#9509,cval_supplier_s_address#9510,cval_supplier_s_phone#9511,cval_supplier_s_acctbal#9512,cval_supplier_s_comment#9513,cdepval_supplier_s_name#9514,cdepval_supplier_s_address#9515,cdepval_supplier_s_phone#9516,cdepval_supplier_s_acctbal#9517,cdepval_supplier_s_comment#9518,cs_name#9519,cs_address#9520,cs_phone#9521,cs_acctbal#9522,cs_comment#9523] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9435, cval_region_r_name_0#9436, cval_region_r_comment_0#9437, cdepval_region_r_name_0#9438, cdepval_region_r_comment_0#9439, cr_name_0#9440, cr_comment_0#9441, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#9428 AS rid_0#9435, cval_region_r_name#9429 AS cval_region_r_name_0#9436, cval_region_r_comment#9430 AS cval_region_r_comment_0#9437, cdepval_region_r_name#9431 AS cdepval_region_r_name_0#9438, cdepval_region_r_comment#9432 AS cdepval_region_r_comment_0#9439, cr_name#9433 AS cr_name_0#9440, cr_comment#9434 AS cr_comment_0#9441]
               :  :     +- Relation[rid#9428,cval_region_r_name#9429,cval_region_r_comment#9430,cdepval_region_r_name#9431,cdepval_region_r_comment#9432,cr_name#9433,cr_comment#9434] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#9488 AS rid_1#9497, cpfk_region_nation#9489 AS cpfk_region_nation_1#9498, cfpk_nation_region#9490 AS cfpk_nation_region_1#9499, cval_nation_n_name#9491 AS cval_nation_n_name_1#9500, cval_nation_n_comment#9492 AS cval_nation_n_comment_1#9501, cdepval_nation_n_name#9493 AS cdepval_nation_n_name_1#9502, cdepval_nation_n_comment#9494 AS cdepval_nation_n_comment_1#9503, cn_name#9495 AS cn_name_1#9504, cn_comment#9496 AS cn_comment_1#9505]
               :        +- Relation[rid#9488,cpfk_region_nation#9489,cfpk_nation_region#9490,cval_nation_n_name#9491,cval_nation_n_comment#9492,cdepval_nation_n_name#9493,cdepval_nation_n_comment#9494,cn_name#9495,cn_comment#9496] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#9456 AS rid_1#9465, cpfk_region_nation#9457 AS cpfk_region_nation_1#9466, cfpk_nation_region#9458 AS cfpk_nation_region_1#9467, cval_nation_n_name#9459 AS cval_nation_n_name_1#9468, cval_nation_n_comment#9460 AS cval_nation_n_comment_1#9469, cdepval_nation_n_name#9461 AS cdepval_nation_n_name_1#9470, cdepval_nation_n_comment#9462 AS cdepval_nation_n_comment_1#9471, cn_name#9463 AS cn_name_1#9472, cn_comment#9464 AS cn_comment_1#9473]
                  +- Relation[rid#9456,cpfk_region_nation#9457,cfpk_nation_region#9458,cval_nation_n_name#9459,cval_nation_n_comment#9460,cdepval_nation_n_name#9461,cdepval_nation_n_comment#9462,cn_name#9463,cn_comment#9464] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 923ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 21:30:10 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:30:10 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9827L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:30:10 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:30:10 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9827L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#9997 AS rid_4#10042, cpfk_orders_lineitem#9998 AS cpfk_orders_lineitem_4#10043, cpfk_supplier_lineitem#9999 AS cpfk_supplier_lineitem_4#10044, cfpk_lineitem_supplier#10000 AS cfpk_lineitem_supplier_4#10045, cfpk_lineitem_partsupp#10001 AS cfpk_lineitem_partsupp_4#10046, cpfk_part_lineitem#10002 AS cpfk_part_lineitem_4#10047, cfpk_lineitem_part#10003 AS cfpk_lineitem_part_4#10048, cpfk_partsupp_lineitem#10004 AS cpfk_partsupp_lineitem_4#10049, cfpk_lineitem_orders#10005 AS cfpk_lineitem_orders_4#10050, cval_lineitem_l_quantity#10006 AS cval_lineitem_l_quantity_4#10051, cval_lineitem_l_extendedprice#10007 AS cval_lineitem_l_extendedprice_4#10052, cval_lineitem_l_discount#10008 AS cval_lineitem_l_discount_4#10053, cval_lineitem_l_tax#10009 AS cval_lineitem_l_tax_4#10054, cval_lineitem_l_returnflag#10010 AS cval_lineitem_l_returnflag_4#10055, cval_lineitem_l_linestatus#10011 AS cval_lineitem_l_linestatus_4#10056, cval_lineitem_l_commitdate#10012 AS cval_lineitem_l_commitdate_4#10057, cval_lineitem_l_receiptdate#10013 AS cval_lineitem_l_receiptdate_4#10058, cval_lineitem_l_shipinstruct#10014 AS cval_lineitem_l_shipinstruct_4#10059, cval_lineitem_l_shipmode#10015 AS cval_lineitem_l_shipmode_4#10060, cval_lineitem_l_comment#10016 AS cval_lineitem_l_comment_4#10061, cval_lineitem_l_shipdate#10017 AS cval_lineitem_l_shipdate_4#10062, cdepval_lineitem_l_quantity#10018 AS cdepval_lineitem_l_quantity_4#10063, cdepval_lineitem_l_extendedprice#10019 AS cdepval_lineitem_l_extendedprice_4#10064, cdepval_lineitem_l_discount#10020 AS cdepval_lineitem_l_discount_4#10065, ... 21 more fields]
            :  :  +- Relation[rid#9997,cpfk_orders_lineitem#9998,cpfk_supplier_lineitem#9999,cfpk_lineitem_supplier#10000,cfpk_lineitem_partsupp#10001,cpfk_part_lineitem#10002,cfpk_lineitem_part#10003,cpfk_partsupp_lineitem#10004,cfpk_lineitem_orders#10005,cval_lineitem_l_quantity#10006,cval_lineitem_l_extendedprice#10007,cval_lineitem_l_discount#10008,cval_lineitem_l_tax#10009,cval_lineitem_l_returnflag#10010,cval_lineitem_l_linestatus#10011,cval_lineitem_l_commitdate#10012,cval_lineitem_l_receiptdate#10013,cval_lineitem_l_shipinstruct#10014,cval_lineitem_l_shipmode#10015,cval_lineitem_l_comment#10016,cval_lineitem_l_shipdate#10017,cdepval_lineitem_l_quantity#10018,cdepval_lineitem_l_extendedprice#10019,cdepval_lineitem_l_discount#10020,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#9949 AS rid_3#9973, cpfk_customer_orders#9950 AS cpfk_customer_orders_3#9974, cfpk_orders_customer#9951 AS cfpk_orders_customer_3#9975, cval_orders_o_orderstatus#9952 AS cval_orders_o_orderstatus_3#9976, cval_orders_o_totalprice#9953 AS cval_orders_o_totalprice_3#9977, cval_orders_o_orderpriority#9954 AS cval_orders_o_orderpriority_3#9978, cval_orders_o_clerk#9955 AS cval_orders_o_clerk_3#9979, cval_orders_o_shippriority#9956 AS cval_orders_o_shippriority_3#9980, cval_orders_o_comment#9957 AS cval_orders_o_comment_3#9981, cval_orders_o_orderdate#9958 AS cval_orders_o_orderdate_3#9982, cdepval_orders_o_orderstatus#9959 AS cdepval_orders_o_orderstatus_3#9983, cdepval_orders_o_totalprice#9960 AS cdepval_orders_o_totalprice_3#9984, cdepval_orders_o_orderpriority#9961 AS cdepval_orders_o_orderpriority_3#9985, cdepval_orders_o_clerk#9962 AS cdepval_orders_o_clerk_3#9986, cdepval_orders_o_shippriority#9963 AS cdepval_orders_o_shippriority_3#9987, cdepval_orders_o_comment#9964 AS cdepval_orders_o_comment_3#9988, cdepval_orders_o_orderdate#9965 AS cdepval_orders_o_orderdate_3#9989, co_orderstatus#9966 AS co_orderstatus_3#9990, co_totalprice#9967 AS co_totalprice_3#9991, co_orderpriority#9968 AS co_orderpriority_3#9992, co_clerk#9969 AS co_clerk_3#9993, co_shippriority#9970 AS co_shippriority_3#9994, co_comment#9971 AS co_comment_3#9995, co_orderdate#9972 AS co_orderdate_3#9996]
            :     :  +- Relation[rid#9949,cpfk_customer_orders#9950,cfpk_orders_customer#9951,cval_orders_o_orderstatus#9952,cval_orders_o_totalprice#9953,cval_orders_o_orderpriority#9954,cval_orders_o_clerk#9955,cval_orders_o_shippriority#9956,cval_orders_o_comment#9957,cval_orders_o_orderdate#9958,cdepval_orders_o_orderstatus#9959,cdepval_orders_o_totalprice#9960,cdepval_orders_o_orderpriority#9961,cdepval_orders_o_clerk#9962,cdepval_orders_o_shippriority#9963,cdepval_orders_o_comment#9964,cdepval_orders_o_orderdate#9965,co_orderstatus#9966,co_totalprice#9967,co_orderpriority#9968,co_clerk#9969,co_shippriority#9970,co_comment#9971,co_orderdate#9972] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#9907 AS rid_2#9928, cpfk_nation_customer#9908 AS cpfk_nation_customer_2#9929, cfpk_customer_nation#9909 AS cfpk_customer_nation_2#9930, cval_customer_c_name#9910 AS cval_customer_c_name_2#9931, cval_customer_c_address#9911 AS cval_customer_c_address_2#9932, cval_customer_c_phone#9912 AS cval_customer_c_phone_2#9933, cval_customer_c_acctbal#9913 AS cval_customer_c_acctbal_2#9934, cval_customer_c_comment#9914 AS cval_customer_c_comment_2#9935, cval_customer_c_mktsegment#9915 AS cval_customer_c_mktsegment_2#9936, cdepval_customer_c_name#9916 AS cdepval_customer_c_name_2#9937, cdepval_customer_c_address#9917 AS cdepval_customer_c_address_2#9938, cdepval_customer_c_phone#9918 AS cdepval_customer_c_phone_2#9939, cdepval_customer_c_acctbal#9919 AS cdepval_customer_c_acctbal_2#9940, cdepval_customer_c_comment#9920 AS cdepval_customer_c_comment_2#9941, cdepval_customer_c_mktsegment#9921 AS cdepval_customer_c_mktsegment_2#9942, cc_name#9922 AS cc_name_2#9943, cc_address#9923 AS cc_address_2#9944, cc_phone#9924 AS cc_phone_2#9945, cc_acctbal#9925 AS cc_acctbal_2#9946, cc_comment#9926 AS cc_comment_2#9947, cc_mktsegment#9927 AS cc_mktsegment_2#9948]
            :        :  +- Relation[rid#9907,cpfk_nation_customer#9908,cfpk_customer_nation#9909,cval_customer_c_name#9910,cval_customer_c_address#9911,cval_customer_c_phone#9912,cval_customer_c_acctbal#9913,cval_customer_c_comment#9914,cval_customer_c_mktsegment#9915,cdepval_customer_c_name#9916,cdepval_customer_c_address#9917,cdepval_customer_c_phone#9918,cdepval_customer_c_acctbal#9919,cdepval_customer_c_comment#9920,cdepval_customer_c_mktsegment#9921,cc_name#9922,cc_address#9923,cc_phone#9924,cc_acctbal#9925,cc_comment#9926,cc_mktsegment#9927] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9836, cval_region_r_name_0#9837, cval_region_r_comment_0#9838, cdepval_region_r_name_0#9839, cdepval_region_r_comment_0#9840, cr_name_0#9841, cr_comment_0#9842, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#9829 AS rid_0#9836, cval_region_r_name#9830 AS cval_region_r_name_0#9837, cval_region_r_comment#9831 AS cval_region_r_comment_0#9838, cdepval_region_r_name#9832 AS cdepval_region_r_name_0#9839, cdepval_region_r_comment#9833 AS cdepval_region_r_comment_0#9840, cr_name#9834 AS cr_name_0#9841, cr_comment#9835 AS cr_comment_0#9842]
            :           :  :     +- Relation[rid#9829,cval_region_r_name#9830,cval_region_r_comment#9831,cdepval_region_r_name#9832,cdepval_region_r_comment#9833,cr_name#9834,cr_comment#9835] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#9889 AS rid_1#9898, cpfk_region_nation#9890 AS cpfk_region_nation_1#9899, cfpk_nation_region#9891 AS cfpk_nation_region_1#9900, cval_nation_n_name#9892 AS cval_nation_n_name_1#9901, cval_nation_n_comment#9893 AS cval_nation_n_comment_1#9902, cdepval_nation_n_name#9894 AS cdepval_nation_n_name_1#9903, cdepval_nation_n_comment#9895 AS cdepval_nation_n_comment_1#9904, cn_name#9896 AS cn_name_1#9905, cn_comment#9897 AS cn_comment_1#9906]
            :           :        +- Relation[rid#9889,cpfk_region_nation#9890,cfpk_nation_region#9891,cval_nation_n_name#9892,cval_nation_n_comment#9893,cdepval_nation_n_name#9894,cdepval_nation_n_comment#9895,cn_name#9896,cn_comment#9897] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#9857 AS rid_1#9866, cpfk_region_nation#9858 AS cpfk_region_nation_1#9867, cfpk_nation_region#9859 AS cfpk_nation_region_1#9868, cval_nation_n_name#9860 AS cval_nation_n_name_1#9869, cval_nation_n_comment#9861 AS cval_nation_n_comment_1#9870, cdepval_nation_n_name#9862 AS cdepval_nation_n_name_1#9871, cdepval_nation_n_comment#9863 AS cdepval_nation_n_comment_1#9872, cn_name#9864 AS cn_name_1#9873, cn_comment#9865 AS cn_comment_1#9874]
            :              +- Relation[rid#9857,cpfk_region_nation#9858,cfpk_nation_region#9859,cval_nation_n_name#9860,cval_nation_n_comment#9861,cdepval_nation_n_name#9862,cdepval_nation_n_comment#9863,cn_name#9864,cn_comment#9865] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#10087 AS rid_5#10105, cpfk_nation_supplier#10088 AS cpfk_nation_supplier_5#10106, cfpk_supplier_nation#10089 AS cfpk_supplier_nation_5#10107, cval_supplier_s_name#10090 AS cval_supplier_s_name_5#10108, cval_supplier_s_address#10091 AS cval_supplier_s_address_5#10109, cval_supplier_s_phone#10092 AS cval_supplier_s_phone_5#10110, cval_supplier_s_acctbal#10093 AS cval_supplier_s_acctbal_5#10111, cval_supplier_s_comment#10094 AS cval_supplier_s_comment_5#10112, cdepval_supplier_s_name#10095 AS cdepval_supplier_s_name_5#10113, cdepval_supplier_s_address#10096 AS cdepval_supplier_s_address_5#10114, cdepval_supplier_s_phone#10097 AS cdepval_supplier_s_phone_5#10115, cdepval_supplier_s_acctbal#10098 AS cdepval_supplier_s_acctbal_5#10116, cdepval_supplier_s_comment#10099 AS cdepval_supplier_s_comment_5#10117, cs_name#10100 AS cs_name_5#10118, cs_address#10101 AS cs_address_5#10119, cs_phone#10102 AS cs_phone_5#10120, cs_acctbal#10103 AS cs_acctbal_5#10121, cs_comment#10104 AS cs_comment_5#10122]
               +- Relation[rid#10087,cpfk_nation_supplier#10088,cfpk_supplier_nation#10089,cval_supplier_s_name#10090,cval_supplier_s_address#10091,cval_supplier_s_phone#10092,cval_supplier_s_acctbal#10093,cval_supplier_s_comment#10094,cdepval_supplier_s_name#10095,cdepval_supplier_s_address#10096,cdepval_supplier_s_phone#10097,cdepval_supplier_s_acctbal#10098,cdepval_supplier_s_comment#10099,cs_name#10100,cs_address#10101,cs_phone#10102,cs_acctbal#10103,cs_comment#10104] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29569ms
query=q1, count=6001215, duration=2356
query=q10, count=1478870, duration=57038
query=q11, count=31680, duration=2511
query=q12, count=857401, duration=21989
query=q13, count=1500000, duration=4355
query=q14, count=6001215, duration=17860
query=q15, count=6001215, duration=17140
query=q16, count=15780, duration=680
query=q17, count=6088, duration=521
query=q18, count=6001215, duration=22331
query=q19, count=205, duration=16695
query=q2, count=3162, duration=923
query=q20, count=632, duration=906
query=q21a, count=597422, duration=159102
query=q22, count=1500000, duration=4367
query=q3, count=1214743, duration=24104
query=q4, count=6001215, duration=18384
query=q5, count=48089, duration=29569
query=q6, count=6001215, duration=2350
query=q7, count=9735, duration=40142
query=q8, count=8716, duration=3469
query=q9a, count=6001215, duration=63408
query=q9b, count=6001215, duration=38010
