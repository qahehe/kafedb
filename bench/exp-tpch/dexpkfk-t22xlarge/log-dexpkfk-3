20/04/26 21:30:40 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 10711ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Sun Apr 26 21:30:43 UTC 2020                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Sun Apr 26 21:30:45 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Sun Apr 26 21:30:45 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Sun Apr 26 21:30:45 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Sun Apr 26 21:30:45 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Sun Apr 26 21:30:49 UTC 2020                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Sun Apr 26 21:30:53 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Sun Apr 26 21:30:53 UTC 2020                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
20/04/26 21:30:54 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:30:54 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2082L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:30:54 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:30:55 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:30:55 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:30:55 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:30:55 WARN DexPlanner: InMemoryFileIndex=customer
20/04/26 21:30:55 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
20/04/26 21:30:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2082L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#2306 AS rid_2#2351, cpfk_orders_lineitem#2307 AS cpfk_orders_lineitem_2#2352, cpfk_supplier_lineitem#2308 AS cpfk_supplier_lineitem_2#2353, cfpk_lineitem_supplier#2309 AS cfpk_lineitem_supplier_2#2354, cfpk_lineitem_partsupp#2310 AS cfpk_lineitem_partsupp_2#2355, cpfk_part_lineitem#2311 AS cpfk_part_lineitem_2#2356, cfpk_lineitem_part#2312 AS cfpk_lineitem_part_2#2357, cpfk_partsupp_lineitem#2313 AS cpfk_partsupp_lineitem_2#2358, cfpk_lineitem_orders#2314 AS cfpk_lineitem_orders_2#2359, cval_lineitem_l_quantity#2315 AS cval_lineitem_l_quantity_2#2360, cval_lineitem_l_extendedprice#2316 AS cval_lineitem_l_extendedprice_2#2361, cval_lineitem_l_discount#2317 AS cval_lineitem_l_discount_2#2362, cval_lineitem_l_tax#2318 AS cval_lineitem_l_tax_2#2363, cval_lineitem_l_returnflag#2319 AS cval_lineitem_l_returnflag_2#2364, cval_lineitem_l_linestatus#2320 AS cval_lineitem_l_linestatus_2#2365, cval_lineitem_l_commitdate#2321 AS cval_lineitem_l_commitdate_2#2366, cval_lineitem_l_receiptdate#2322 AS cval_lineitem_l_receiptdate_2#2367, cval_lineitem_l_shipinstruct#2323 AS cval_lineitem_l_shipinstruct_2#2368, cval_lineitem_l_shipmode#2324 AS cval_lineitem_l_shipmode_2#2369, cval_lineitem_l_comment#2325 AS cval_lineitem_l_comment_2#2370, cval_lineitem_l_shipdate#2326 AS cval_lineitem_l_shipdate_2#2371, cdepval_lineitem_l_quantity#2327 AS cdepval_lineitem_l_quantity_2#2372, cdepval_lineitem_l_extendedprice#2328 AS cdepval_lineitem_l_extendedprice_2#2373, cdepval_lineitem_l_discount#2329 AS cdepval_lineitem_l_discount_2#2374, ... 21 more fields]
         :  +- Relation[rid#2306,cpfk_orders_lineitem#2307,cpfk_supplier_lineitem#2308,cfpk_lineitem_supplier#2309,cfpk_lineitem_partsupp#2310,cpfk_part_lineitem#2311,cfpk_lineitem_part#2312,cpfk_partsupp_lineitem#2313,cfpk_lineitem_orders#2314,cval_lineitem_l_quantity#2315,cval_lineitem_l_extendedprice#2316,cval_lineitem_l_discount#2317,cval_lineitem_l_tax#2318,cval_lineitem_l_returnflag#2319,cval_lineitem_l_linestatus#2320,cval_lineitem_l_commitdate#2321,cval_lineitem_l_receiptdate#2322,cval_lineitem_l_shipinstruct#2323,cval_lineitem_l_shipmode#2324,cval_lineitem_l_comment#2325,cval_lineitem_l_shipdate#2326,cdepval_lineitem_l_quantity#2327,cdepval_lineitem_l_extendedprice#2328,cdepval_lineitem_l_discount#2329,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin customer~orders, 'cpfk_customer_orders_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2105, cpfk_nation_customer_0#2106, cfpk_customer_nation_0#2107, cval_customer_c_name_0#2108, cval_customer_c_address_0#2109, cval_customer_c_phone_0#2110, cval_customer_c_acctbal_0#2111, cval_customer_c_comment_0#2112, cval_customer_c_mktsegment_0#2113, cdepval_customer_c_name_0#2114, cdepval_customer_c_address_0#2115, cdepval_customer_c_phone_0#2116, cdepval_customer_c_acctbal_0#2117, cdepval_customer_c_comment_0#2118, cdepval_customer_c_mktsegment_0#2119, cc_name_0#2120, cc_address_0#2121, cc_phone_0#2122, cc_acctbal_0#2123, cc_comment_0#2124, cc_mktsegment_0#2125, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter customer~c_mktsegment~BUILDING, cval_customer_c_mktsegment, 'cval_customer_c_mktsegment_0, tcustomer
            :  :  +- Project [rid#2084 AS rid_0#2105, cpfk_nation_customer#2085 AS cpfk_nation_customer_0#2106, cfpk_customer_nation#2086 AS cfpk_customer_nation_0#2107, cval_customer_c_name#2087 AS cval_customer_c_name_0#2108, cval_customer_c_address#2088 AS cval_customer_c_address_0#2109, cval_customer_c_phone#2089 AS cval_customer_c_phone_0#2110, cval_customer_c_acctbal#2090 AS cval_customer_c_acctbal_0#2111, cval_customer_c_comment#2091 AS cval_customer_c_comment_0#2112, cval_customer_c_mktsegment#2092 AS cval_customer_c_mktsegment_0#2113, cdepval_customer_c_name#2093 AS cdepval_customer_c_name_0#2114, cdepval_customer_c_address#2094 AS cdepval_customer_c_address_0#2115, cdepval_customer_c_phone#2095 AS cdepval_customer_c_phone_0#2116, cdepval_customer_c_acctbal#2096 AS cdepval_customer_c_acctbal_0#2117, cdepval_customer_c_comment#2097 AS cdepval_customer_c_comment_0#2118, cdepval_customer_c_mktsegment#2098 AS cdepval_customer_c_mktsegment_0#2119, cc_name#2099 AS cc_name_0#2120, cc_address#2100 AS cc_address_0#2121, cc_phone#2101 AS cc_phone_0#2122, cc_acctbal#2102 AS cc_acctbal_0#2123, cc_comment#2103 AS cc_comment_0#2124, cc_mktsegment#2104 AS cc_mktsegment_0#2125]
            :  :     +- Relation[rid#2084,cpfk_nation_customer#2085,cfpk_customer_nation#2086,cval_customer_c_name#2087,cval_customer_c_address#2088,cval_customer_c_phone#2089,cval_customer_c_acctbal#2090,cval_customer_c_comment#2091,cval_customer_c_mktsegment#2092,cdepval_customer_c_name#2093,cdepval_customer_c_address#2094,cdepval_customer_c_phone#2095,cdepval_customer_c_acctbal#2096,cdepval_customer_c_comment#2097,cdepval_customer_c_mktsegment#2098,cc_name#2099,cc_address#2100,cc_phone#2101,cc_acctbal#2102,cc_comment#2103,cc_mktsegment#2104] JDBCRelation(tcustomer) [numPartitions=1]
            :  +- 'Project ['cpfk_customer_orders_1, 'rid_1]
            :     +- Project [rid#2258 AS rid_1#2282, cpfk_customer_orders#2259 AS cpfk_customer_orders_1#2283, cfpk_orders_customer#2260 AS cfpk_orders_customer_1#2284, cval_orders_o_orderstatus#2261 AS cval_orders_o_orderstatus_1#2285, cval_orders_o_totalprice#2262 AS cval_orders_o_totalprice_1#2286, cval_orders_o_orderpriority#2263 AS cval_orders_o_orderpriority_1#2287, cval_orders_o_clerk#2264 AS cval_orders_o_clerk_1#2288, cval_orders_o_shippriority#2265 AS cval_orders_o_shippriority_1#2289, cval_orders_o_comment#2266 AS cval_orders_o_comment_1#2290, cval_orders_o_orderdate#2267 AS cval_orders_o_orderdate_1#2291, cdepval_orders_o_orderstatus#2268 AS cdepval_orders_o_orderstatus_1#2292, cdepval_orders_o_totalprice#2269 AS cdepval_orders_o_totalprice_1#2293, cdepval_orders_o_orderpriority#2270 AS cdepval_orders_o_orderpriority_1#2294, cdepval_orders_o_clerk#2271 AS cdepval_orders_o_clerk_1#2295, cdepval_orders_o_shippriority#2272 AS cdepval_orders_o_shippriority_1#2296, cdepval_orders_o_comment#2273 AS cdepval_orders_o_comment_1#2297, cdepval_orders_o_orderdate#2274 AS cdepval_orders_o_orderdate_1#2298, co_orderstatus#2275 AS co_orderstatus_1#2299, co_totalprice#2276 AS co_totalprice_1#2300, co_orderpriority#2277 AS co_orderpriority_1#2301, co_clerk#2278 AS co_clerk_1#2302, co_shippriority#2279 AS co_shippriority_1#2303, co_comment#2280 AS co_comment_1#2304, co_orderdate#2281 AS co_orderdate_1#2305]
            :        +- Relation[rid#2258,cpfk_customer_orders#2259,cfpk_orders_customer#2260,cval_orders_o_orderstatus#2261,cval_orders_o_totalprice#2262,cval_orders_o_orderpriority#2263,cval_orders_o_clerk#2264,cval_orders_o_shippriority#2265,cval_orders_o_comment#2266,cval_orders_o_orderdate#2267,cdepval_orders_o_orderstatus#2268,cdepval_orders_o_totalprice#2269,cdepval_orders_o_orderpriority#2270,cdepval_orders_o_clerk#2271,cdepval_orders_o_shippriority#2272,cdepval_orders_o_comment#2273,cdepval_orders_o_orderdate#2274,co_orderstatus#2275,co_totalprice#2276,co_orderpriority#2277,co_clerk#2278,co_shippriority#2279,co_comment#2280,co_orderdate#2281] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#2168 AS rid_1#2192, cpfk_customer_orders#2169 AS cpfk_customer_orders_1#2193, cfpk_orders_customer#2170 AS cfpk_orders_customer_1#2194, cval_orders_o_orderstatus#2171 AS cval_orders_o_orderstatus_1#2195, cval_orders_o_totalprice#2172 AS cval_orders_o_totalprice_1#2196, cval_orders_o_orderpriority#2173 AS cval_orders_o_orderpriority_1#2197, cval_orders_o_clerk#2174 AS cval_orders_o_clerk_1#2198, cval_orders_o_shippriority#2175 AS cval_orders_o_shippriority_1#2199, cval_orders_o_comment#2176 AS cval_orders_o_comment_1#2200, cval_orders_o_orderdate#2177 AS cval_orders_o_orderdate_1#2201, cdepval_orders_o_orderstatus#2178 AS cdepval_orders_o_orderstatus_1#2202, cdepval_orders_o_totalprice#2179 AS cdepval_orders_o_totalprice_1#2203, cdepval_orders_o_orderpriority#2180 AS cdepval_orders_o_orderpriority_1#2204, cdepval_orders_o_clerk#2181 AS cdepval_orders_o_clerk_1#2205, cdepval_orders_o_shippriority#2182 AS cdepval_orders_o_shippriority_1#2206, cdepval_orders_o_comment#2183 AS cdepval_orders_o_comment_1#2207, cdepval_orders_o_orderdate#2184 AS cdepval_orders_o_orderdate_1#2208, co_orderstatus#2185 AS co_orderstatus_1#2209, co_totalprice#2186 AS co_totalprice_1#2210, co_orderpriority#2187 AS co_orderpriority_1#2211, co_clerk#2188 AS co_clerk_1#2212, co_shippriority#2189 AS co_shippriority_1#2213, co_comment#2190 AS co_comment_1#2214, co_orderdate#2191 AS co_orderdate_1#2215]
               +- Relation[rid#2168,cpfk_customer_orders#2169,cfpk_orders_customer#2170,cval_orders_o_orderstatus#2171,cval_orders_o_totalprice#2172,cval_orders_o_orderpriority#2173,cval_orders_o_clerk#2174,cval_orders_o_shippriority#2175,cval_orders_o_comment#2176,cval_orders_o_orderdate#2177,cdepval_orders_o_orderstatus#2178,cdepval_orders_o_totalprice#2179,cdepval_orders_o_orderpriority#2180,cdepval_orders_o_clerk#2181,cdepval_orders_o_shippriority#2182,cdepval_orders_o_comment#2183,cdepval_orders_o_orderdate#2184,co_orderstatus#2185,co_totalprice#2186,co_orderpriority#2187,co_clerk#2188,co_shippriority#2189,co_comment#2190,co_orderdate#2191] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=1214743
Elapsed time: 24475ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
20/04/26 21:31:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:31:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2490L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:31:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2490L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_4, BinaryType)), 'cfpk_partsupp_supplier_4) = 'rid_2)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#2631, cval_part_p_name_3#2632, cval_part_p_mfgr_3#2633, cval_part_p_type_3#2634, cval_part_p_size_3#2635, cval_part_p_container_3#2636, cval_part_p_retailprice_3#2637, cval_part_p_comment_3#2638, cval_part_p_brand_3#2639, cdepval_part_p_name_3#2640, cdepval_part_p_mfgr_3#2641, cdepval_part_p_type_3#2642, cdepval_part_p_size_3#2643, cdepval_part_p_container_3#2644, cdepval_part_p_retailprice_3#2645, cdepval_part_p_comment_3#2646, cdepval_part_p_brand_3#2647, cp_name_3#2648, cp_mfgr_3#2649, cp_type_3#2650, cp_size_3#2651, cp_container_3#2652, cp_retailprice_3#2653, cp_comment_3#2654, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_3, tpart
         :  :  :  +- Project [rid#2606 AS rid_3#2631, cval_part_p_name#2607 AS cval_part_p_name_3#2632, cval_part_p_mfgr#2608 AS cval_part_p_mfgr_3#2633, cval_part_p_type#2609 AS cval_part_p_type_3#2634, cval_part_p_size#2610 AS cval_part_p_size_3#2635, cval_part_p_container#2611 AS cval_part_p_container_3#2636, cval_part_p_retailprice#2612 AS cval_part_p_retailprice_3#2637, cval_part_p_comment#2613 AS cval_part_p_comment_3#2638, cval_part_p_brand#2614 AS cval_part_p_brand_3#2639, cdepval_part_p_name#2615 AS cdepval_part_p_name_3#2640, cdepval_part_p_mfgr#2616 AS cdepval_part_p_mfgr_3#2641, cdepval_part_p_type#2617 AS cdepval_part_p_type_3#2642, cdepval_part_p_size#2618 AS cdepval_part_p_size_3#2643, cdepval_part_p_container#2619 AS cdepval_part_p_container_3#2644, cdepval_part_p_retailprice#2620 AS cdepval_part_p_retailprice_3#2645, cdepval_part_p_comment#2621 AS cdepval_part_p_comment_3#2646, cdepval_part_p_brand#2622 AS cdepval_part_p_brand_3#2647, cp_name#2623 AS cp_name_3#2648, cp_mfgr#2624 AS cp_mfgr_3#2649, cp_type#2625 AS cp_type_3#2650, cp_size#2626 AS cp_size_3#2651, cp_container#2627 AS cp_container_3#2652, cp_retailprice#2628 AS cp_retailprice_3#2653, cp_comment#2629 AS cp_comment_3#2654, cp_brand#2630 AS cp_brand_3#2655]
         :  :  :     +- Relation[rid#2606,cval_part_p_name#2607,cval_part_p_mfgr#2608,cval_part_p_type#2609,cval_part_p_size#2610,cval_part_p_container#2611,cval_part_p_retailprice#2612,cval_part_p_comment#2613,cval_part_p_brand#2614,cdepval_part_p_name#2615,cdepval_part_p_mfgr#2616,cdepval_part_p_type#2617,cdepval_part_p_size#2618,cdepval_part_p_container#2619,cdepval_part_p_retailprice#2620,cdepval_part_p_comment#2621,cdepval_part_p_brand#2622,cp_name#2623,cp_mfgr#2624,cp_type#2625,cp_size#2626,cp_container#2627,cp_retailprice#2628,cp_comment#2629,cp_brand#2630] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_4, 'rid_4]
         :  :     +- Project [rid#2784 AS rid_4#2798, cpfk_part_partsupp#2785 AS cpfk_part_partsupp_4#2799, cfpk_partsupp_part#2786 AS cfpk_partsupp_part_4#2800, cpfk_supplier_partsupp#2787 AS cpfk_supplier_partsupp_4#2801, cfpk_partsupp_supplier#2788 AS cfpk_partsupp_supplier_4#2802, cval_partsupp_ps_availqty#2789 AS cval_partsupp_ps_availqty_4#2803, cval_partsupp_ps_supplycost#2790 AS cval_partsupp_ps_supplycost_4#2804, cval_partsupp_ps_comment#2791 AS cval_partsupp_ps_comment_4#2805, cdepval_partsupp_ps_availqty#2792 AS cdepval_partsupp_ps_availqty_4#2806, cdepval_partsupp_ps_supplycost#2793 AS cdepval_partsupp_ps_supplycost_4#2807, cdepval_partsupp_ps_comment#2794 AS cdepval_partsupp_ps_comment_4#2808, cps_availqty#2795 AS cps_availqty_4#2809, cps_supplycost#2796 AS cps_supplycost_4#2810, cps_comment#2797 AS cps_comment_4#2811]
         :  :        +- Relation[rid#2784,cpfk_part_partsupp#2785,cfpk_partsupp_part#2786,cpfk_supplier_partsupp#2787,cfpk_partsupp_supplier#2788,cval_partsupp_ps_availqty#2789,cval_partsupp_ps_supplycost#2790,cval_partsupp_ps_comment#2791,cdepval_partsupp_ps_availqty#2792,cdepval_partsupp_ps_supplycost#2793,cdepval_partsupp_ps_comment#2794,cps_availqty#2795,cps_supplycost#2796,cps_comment#2797] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#2706 AS rid_4#2720, cpfk_part_partsupp#2707 AS cpfk_part_partsupp_4#2721, cfpk_partsupp_part#2708 AS cfpk_partsupp_part_4#2722, cpfk_supplier_partsupp#2709 AS cpfk_supplier_partsupp_4#2723, cfpk_partsupp_supplier#2710 AS cfpk_partsupp_supplier_4#2724, cval_partsupp_ps_availqty#2711 AS cval_partsupp_ps_availqty_4#2725, cval_partsupp_ps_supplycost#2712 AS cval_partsupp_ps_supplycost_4#2726, cval_partsupp_ps_comment#2713 AS cval_partsupp_ps_comment_4#2727, cdepval_partsupp_ps_availqty#2714 AS cdepval_partsupp_ps_availqty_4#2728, cdepval_partsupp_ps_supplycost#2715 AS cdepval_partsupp_ps_supplycost_4#2729, cdepval_partsupp_ps_comment#2716 AS cdepval_partsupp_ps_comment_4#2730, cps_availqty#2717 AS cps_availqty_4#2731, cps_supplycost#2718 AS cps_supplycost_4#2732, cps_comment#2719 AS cps_comment_4#2733]
         :     +- Relation[rid#2706,cpfk_part_partsupp#2707,cfpk_partsupp_part#2708,cpfk_supplier_partsupp#2709,cfpk_partsupp_supplier#2710,cval_partsupp_ps_availqty#2711,cval_partsupp_ps_supplycost#2712,cval_partsupp_ps_comment#2713,cdepval_partsupp_ps_availqty#2714,cdepval_partsupp_ps_supplycost#2715,cdepval_partsupp_ps_comment#2716,cps_availqty#2717,cps_supplycost#2718,cps_comment#2719] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_1)
            :- Project [rid#2570 AS rid_2#2588, cpfk_nation_supplier#2571 AS cpfk_nation_supplier_2#2589, cfpk_supplier_nation#2572 AS cfpk_supplier_nation_2#2590, cval_supplier_s_name#2573 AS cval_supplier_s_name_2#2591, cval_supplier_s_address#2574 AS cval_supplier_s_address_2#2592, cval_supplier_s_phone#2575 AS cval_supplier_s_phone_2#2593, cval_supplier_s_acctbal#2576 AS cval_supplier_s_acctbal_2#2594, cval_supplier_s_comment#2577 AS cval_supplier_s_comment_2#2595, cdepval_supplier_s_name#2578 AS cdepval_supplier_s_name_2#2596, cdepval_supplier_s_address#2579 AS cdepval_supplier_s_address_2#2597, cdepval_supplier_s_phone#2580 AS cdepval_supplier_s_phone_2#2598, cdepval_supplier_s_acctbal#2581 AS cdepval_supplier_s_acctbal_2#2599, cdepval_supplier_s_comment#2582 AS cdepval_supplier_s_comment_2#2600, cs_name#2583 AS cs_name_2#2601, cs_address#2584 AS cs_address_2#2602, cs_phone#2585 AS cs_phone_2#2603, cs_acctbal#2586 AS cs_acctbal_2#2604, cs_comment#2587 AS cs_comment_2#2605]
            :  +- Relation[rid#2570,cpfk_nation_supplier#2571,cfpk_supplier_nation#2572,cval_supplier_s_name#2573,cval_supplier_s_address#2574,cval_supplier_s_phone#2575,cval_supplier_s_acctbal#2576,cval_supplier_s_comment#2577,cdepval_supplier_s_name#2578,cdepval_supplier_s_address#2579,cdepval_supplier_s_phone#2580,cdepval_supplier_s_acctbal#2581,cdepval_supplier_s_comment#2582,cs_name#2583,cs_address#2584,cs_phone#2585,cs_acctbal#2586,cs_comment#2587] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_1))
               :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#2499, cval_region_r_name_0#2500, cval_region_r_comment_0#2501, cdepval_region_r_name_0#2502, cdepval_region_r_comment_0#2503, cr_name_0#2504, cr_comment_0#2505, 'rid_1]
               :  :- 'DexPseudoPrimaryKeyFilter region~r_name~EUROPE, cval_region_r_name, 'cval_region_r_name_0, tregion
               :  :  +- Project [rid#2492 AS rid_0#2499, cval_region_r_name#2493 AS cval_region_r_name_0#2500, cval_region_r_comment#2494 AS cval_region_r_comment_0#2501, cdepval_region_r_name#2495 AS cdepval_region_r_name_0#2502, cdepval_region_r_comment#2496 AS cdepval_region_r_comment_0#2503, cr_name#2497 AS cr_name_0#2504, cr_comment#2498 AS cr_comment_0#2505]
               :  :     +- Relation[rid#2492,cval_region_r_name#2493,cval_region_r_comment#2494,cdepval_region_r_name#2495,cdepval_region_r_comment#2496,cr_name#2497,cr_comment#2498] JDBCRelation(tregion) [numPartitions=1]
               :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
               :     +- Project [rid#2552 AS rid_1#2561, cpfk_region_nation#2553 AS cpfk_region_nation_1#2562, cfpk_nation_region#2554 AS cfpk_nation_region_1#2563, cval_nation_n_name#2555 AS cval_nation_n_name_1#2564, cval_nation_n_comment#2556 AS cval_nation_n_comment_1#2565, cdepval_nation_n_name#2557 AS cdepval_nation_n_name_1#2566, cdepval_nation_n_comment#2558 AS cdepval_nation_n_comment_1#2567, cn_name#2559 AS cn_name_1#2568, cn_comment#2560 AS cn_comment_1#2569]
               :        +- Relation[rid#2552,cpfk_region_nation#2553,cfpk_nation_region#2554,cval_nation_n_name#2555,cval_nation_n_comment#2556,cdepval_nation_n_name#2557,cdepval_nation_n_comment#2558,cn_name#2559,cn_comment#2560] JDBCRelation(tnation) [numPartitions=1]
               +- Project [rid#2520 AS rid_1#2529, cpfk_region_nation#2521 AS cpfk_region_nation_1#2530, cfpk_nation_region#2522 AS cfpk_nation_region_1#2531, cval_nation_n_name#2523 AS cval_nation_n_name_1#2532, cval_nation_n_comment#2524 AS cval_nation_n_comment_1#2533, cdepval_nation_n_name#2525 AS cdepval_nation_n_name_1#2534, cdepval_nation_n_comment#2526 AS cdepval_nation_n_comment_1#2535, cn_name#2527 AS cn_name_1#2536, cn_comment#2528 AS cn_comment_1#2537]
                  +- Relation[rid#2520,cpfk_region_nation#2521,cfpk_nation_region#2522,cval_nation_n_name#2523,cval_nation_n_comment#2524,cdepval_nation_n_name#2525,cdepval_nation_n_comment#2526,cn_name#2527,cn_comment#2528] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=3162
Elapsed time: 890ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
20/04/26 21:31:20 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:31:20 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2892L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:31:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:20 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:20 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2892L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_0)
         :- Project [rid#2930 AS rid_1#2975, cpfk_orders_lineitem#2931 AS cpfk_orders_lineitem_1#2976, cpfk_supplier_lineitem#2932 AS cpfk_supplier_lineitem_1#2977, cfpk_lineitem_supplier#2933 AS cfpk_lineitem_supplier_1#2978, cfpk_lineitem_partsupp#2934 AS cfpk_lineitem_partsupp_1#2979, cpfk_part_lineitem#2935 AS cpfk_part_lineitem_1#2980, cfpk_lineitem_part#2936 AS cfpk_lineitem_part_1#2981, cpfk_partsupp_lineitem#2937 AS cpfk_partsupp_lineitem_1#2982, cfpk_lineitem_orders#2938 AS cfpk_lineitem_orders_1#2983, cval_lineitem_l_quantity#2939 AS cval_lineitem_l_quantity_1#2984, cval_lineitem_l_extendedprice#2940 AS cval_lineitem_l_extendedprice_1#2985, cval_lineitem_l_discount#2941 AS cval_lineitem_l_discount_1#2986, cval_lineitem_l_tax#2942 AS cval_lineitem_l_tax_1#2987, cval_lineitem_l_returnflag#2943 AS cval_lineitem_l_returnflag_1#2988, cval_lineitem_l_linestatus#2944 AS cval_lineitem_l_linestatus_1#2989, cval_lineitem_l_commitdate#2945 AS cval_lineitem_l_commitdate_1#2990, cval_lineitem_l_receiptdate#2946 AS cval_lineitem_l_receiptdate_1#2991, cval_lineitem_l_shipinstruct#2947 AS cval_lineitem_l_shipinstruct_1#2992, cval_lineitem_l_shipmode#2948 AS cval_lineitem_l_shipmode_1#2993, cval_lineitem_l_comment#2949 AS cval_lineitem_l_comment_1#2994, cval_lineitem_l_shipdate#2950 AS cval_lineitem_l_shipdate_1#2995, cdepval_lineitem_l_quantity#2951 AS cdepval_lineitem_l_quantity_1#2996, cdepval_lineitem_l_extendedprice#2952 AS cdepval_lineitem_l_extendedprice_1#2997, cdepval_lineitem_l_discount#2953 AS cdepval_lineitem_l_discount_1#2998, ... 21 more fields]
         :  +- Relation[rid#2930,cpfk_orders_lineitem#2931,cpfk_supplier_lineitem#2932,cfpk_lineitem_supplier#2933,cfpk_lineitem_partsupp#2934,cpfk_part_lineitem#2935,cfpk_lineitem_part#2936,cpfk_partsupp_lineitem#2937,cfpk_lineitem_orders#2938,cval_lineitem_l_quantity#2939,cval_lineitem_l_extendedprice#2940,cval_lineitem_l_discount#2941,cval_lineitem_l_tax#2942,cval_lineitem_l_returnflag#2943,cval_lineitem_l_linestatus#2944,cval_lineitem_l_commitdate#2945,cval_lineitem_l_receiptdate#2946,cval_lineitem_l_shipinstruct#2947,cval_lineitem_l_shipmode#2948,cval_lineitem_l_comment#2949,cval_lineitem_l_shipdate#2950,cdepval_lineitem_l_quantity#2951,cdepval_lineitem_l_extendedprice#2952,cdepval_lineitem_l_discount#2953,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#2894 AS rid_0#2912, cpfk_nation_supplier#2895 AS cpfk_nation_supplier_0#2913, cfpk_supplier_nation#2896 AS cfpk_supplier_nation_0#2914, cval_supplier_s_name#2897 AS cval_supplier_s_name_0#2915, cval_supplier_s_address#2898 AS cval_supplier_s_address_0#2916, cval_supplier_s_phone#2899 AS cval_supplier_s_phone_0#2917, cval_supplier_s_acctbal#2900 AS cval_supplier_s_acctbal_0#2918, cval_supplier_s_comment#2901 AS cval_supplier_s_comment_0#2919, cdepval_supplier_s_name#2902 AS cdepval_supplier_s_name_0#2920, cdepval_supplier_s_address#2903 AS cdepval_supplier_s_address_0#2921, cdepval_supplier_s_phone#2904 AS cdepval_supplier_s_phone_0#2922, cdepval_supplier_s_acctbal#2905 AS cdepval_supplier_s_acctbal_0#2923, cdepval_supplier_s_comment#2906 AS cdepval_supplier_s_comment_0#2924, cs_name#2907 AS cs_name_0#2925, cs_address#2908 AS cs_address_0#2926, cs_phone#2909 AS cs_phone_0#2927, cs_acctbal#2910 AS cs_acctbal_0#2928, cs_comment#2911 AS cs_comment_0#2929]
            +- Relation[rid#2894,cpfk_nation_supplier#2895,cfpk_supplier_nation#2896,cval_supplier_s_name#2897,cval_supplier_s_address#2898,cval_supplier_s_phone#2899,cval_supplier_s_acctbal#2900,cval_supplier_s_comment#2901,cdepval_supplier_s_name#2902,cdepval_supplier_s_address#2903,cdepval_supplier_s_phone#2904,cdepval_supplier_s_acctbal#2905,cdepval_supplier_s_comment#2906,cs_name#2907,cs_address#2908,cs_phone#2909,cs_acctbal#2910,cs_comment#2911] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17220ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
20/04/26 21:31:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:31:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3087L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:31:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3087L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#3089 AS rid_0#3113, cpfk_customer_orders#3090 AS cpfk_customer_orders_0#3114, cfpk_orders_customer#3091 AS cfpk_orders_customer_0#3115, cval_orders_o_orderstatus#3092 AS cval_orders_o_orderstatus_0#3116, cval_orders_o_totalprice#3093 AS cval_orders_o_totalprice_0#3117, cval_orders_o_orderpriority#3094 AS cval_orders_o_orderpriority_0#3118, cval_orders_o_clerk#3095 AS cval_orders_o_clerk_0#3119, cval_orders_o_shippriority#3096 AS cval_orders_o_shippriority_0#3120, cval_orders_o_comment#3097 AS cval_orders_o_comment_0#3121, cval_orders_o_orderdate#3098 AS cval_orders_o_orderdate_0#3122, cdepval_orders_o_orderstatus#3099 AS cdepval_orders_o_orderstatus_0#3123, cdepval_orders_o_totalprice#3100 AS cdepval_orders_o_totalprice_0#3124, cdepval_orders_o_orderpriority#3101 AS cdepval_orders_o_orderpriority_0#3125, cdepval_orders_o_clerk#3102 AS cdepval_orders_o_clerk_0#3126, cdepval_orders_o_shippriority#3103 AS cdepval_orders_o_shippriority_0#3127, cdepval_orders_o_comment#3104 AS cdepval_orders_o_comment_0#3128, cdepval_orders_o_orderdate#3105 AS cdepval_orders_o_orderdate_0#3129, co_orderstatus#3106 AS co_orderstatus_0#3130, co_totalprice#3107 AS co_totalprice_0#3131, co_orderpriority#3108 AS co_orderpriority_0#3132, co_clerk#3109 AS co_clerk_0#3133, co_shippriority#3110 AS co_shippriority_0#3134, co_comment#3111 AS co_comment_0#3135, co_orderdate#3112 AS co_orderdate_0#3136]
         :  +- Relation[rid#3089,cpfk_customer_orders#3090,cfpk_orders_customer#3091,cval_orders_o_orderstatus#3092,cval_orders_o_totalprice#3093,cval_orders_o_orderpriority#3094,cval_orders_o_clerk#3095,cval_orders_o_shippriority#3096,cval_orders_o_comment#3097,cval_orders_o_orderdate#3098,cdepval_orders_o_orderstatus#3099,cdepval_orders_o_totalprice#3100,cdepval_orders_o_orderpriority#3101,cdepval_orders_o_clerk#3102,cdepval_orders_o_shippriority#3103,cdepval_orders_o_comment#3104,cdepval_orders_o_orderdate#3105,co_orderstatus#3106,co_totalprice#3107,co_orderpriority#3108,co_clerk#3109,co_shippriority#3110,co_comment#3111,co_orderdate#3112] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#3137 AS rid_1#3158, cpfk_nation_customer#3138 AS cpfk_nation_customer_1#3159, cfpk_customer_nation#3139 AS cfpk_customer_nation_1#3160, cval_customer_c_name#3140 AS cval_customer_c_name_1#3161, cval_customer_c_address#3141 AS cval_customer_c_address_1#3162, cval_customer_c_phone#3142 AS cval_customer_c_phone_1#3163, cval_customer_c_acctbal#3143 AS cval_customer_c_acctbal_1#3164, cval_customer_c_comment#3144 AS cval_customer_c_comment_1#3165, cval_customer_c_mktsegment#3145 AS cval_customer_c_mktsegment_1#3166, cdepval_customer_c_name#3146 AS cdepval_customer_c_name_1#3167, cdepval_customer_c_address#3147 AS cdepval_customer_c_address_1#3168, cdepval_customer_c_phone#3148 AS cdepval_customer_c_phone_1#3169, cdepval_customer_c_acctbal#3149 AS cdepval_customer_c_acctbal_1#3170, cdepval_customer_c_comment#3150 AS cdepval_customer_c_comment_1#3171, cdepval_customer_c_mktsegment#3151 AS cdepval_customer_c_mktsegment_1#3172, cc_name#3152 AS cc_name_1#3173, cc_address#3153 AS cc_address_1#3174, cc_phone#3154 AS cc_phone_1#3175, cc_acctbal#3155 AS cc_acctbal_1#3176, cc_comment#3156 AS cc_comment_1#3177, cc_mktsegment#3157 AS cc_mktsegment_1#3178]
            +- Relation[rid#3137,cpfk_nation_customer#3138,cfpk_customer_nation#3139,cval_customer_c_name#3140,cval_customer_c_address#3141,cval_customer_c_phone#3142,cval_customer_c_acctbal#3143,cval_customer_c_comment#3144,cval_customer_c_mktsegment#3145,cdepval_customer_c_name#3146,cdepval_customer_c_address#3147,cdepval_customer_c_phone#3148,cdepval_customer_c_acctbal#3149,cdepval_customer_c_comment#3150,cdepval_customer_c_mktsegment#3151,cc_name#3152,cc_address#3153,cc_phone#3154,cc_acctbal#3155,cc_comment#3156,cc_mktsegment#3157] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4366ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
20/04/26 21:31:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:31:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3229L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:31:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3229L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#3231 AS rid_0#3276, cpfk_orders_lineitem#3232 AS cpfk_orders_lineitem_0#3277, cpfk_supplier_lineitem#3233 AS cpfk_supplier_lineitem_0#3278, cfpk_lineitem_supplier#3234 AS cfpk_lineitem_supplier_0#3279, cfpk_lineitem_partsupp#3235 AS cfpk_lineitem_partsupp_0#3280, cpfk_part_lineitem#3236 AS cpfk_part_lineitem_0#3281, cfpk_lineitem_part#3237 AS cfpk_lineitem_part_0#3282, cpfk_partsupp_lineitem#3238 AS cpfk_partsupp_lineitem_0#3283, cfpk_lineitem_orders#3239 AS cfpk_lineitem_orders_0#3284, cval_lineitem_l_quantity#3240 AS cval_lineitem_l_quantity_0#3285, cval_lineitem_l_extendedprice#3241 AS cval_lineitem_l_extendedprice_0#3286, cval_lineitem_l_discount#3242 AS cval_lineitem_l_discount_0#3287, cval_lineitem_l_tax#3243 AS cval_lineitem_l_tax_0#3288, cval_lineitem_l_returnflag#3244 AS cval_lineitem_l_returnflag_0#3289, cval_lineitem_l_linestatus#3245 AS cval_lineitem_l_linestatus_0#3290, cval_lineitem_l_commitdate#3246 AS cval_lineitem_l_commitdate_0#3291, cval_lineitem_l_receiptdate#3247 AS cval_lineitem_l_receiptdate_0#3292, cval_lineitem_l_shipinstruct#3248 AS cval_lineitem_l_shipinstruct_0#3293, cval_lineitem_l_shipmode#3249 AS cval_lineitem_l_shipmode_0#3294, cval_lineitem_l_comment#3250 AS cval_lineitem_l_comment_0#3295, cval_lineitem_l_shipdate#3251 AS cval_lineitem_l_shipdate_0#3296, cdepval_lineitem_l_quantity#3252 AS cdepval_lineitem_l_quantity_0#3297, cdepval_lineitem_l_extendedprice#3253 AS cdepval_lineitem_l_extendedprice_0#3298, cdepval_lineitem_l_discount#3254 AS cdepval_lineitem_l_discount_0#3299, ... 21 more fields]
         +- Relation[rid#3231,cpfk_orders_lineitem#3232,cpfk_supplier_lineitem#3233,cfpk_lineitem_supplier#3234,cfpk_lineitem_partsupp#3235,cpfk_part_lineitem#3236,cfpk_lineitem_part#3237,cpfk_partsupp_lineitem#3238,cfpk_lineitem_orders#3239,cval_lineitem_l_quantity#3240,cval_lineitem_l_extendedprice#3241,cval_lineitem_l_discount#3242,cval_lineitem_l_tax#3243,cval_lineitem_l_returnflag#3244,cval_lineitem_l_linestatus#3245,cval_lineitem_l_commitdate#3246,cval_lineitem_l_receiptdate#3247,cval_lineitem_l_shipinstruct#3248,cval_lineitem_l_shipmode#3249,cval_lineitem_l_comment#3250,cval_lineitem_l_shipdate#3251,cdepval_lineitem_l_quantity#3252,cdepval_lineitem_l_extendedprice#3253,cdepval_lineitem_l_discount#3254,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2370ms

q5=

select
  n_name,
  l_extendedprice,
  l_discount
from
  customer, orders, lineitem, supplier, nation, region
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_suppkey = s_suppkey
  and c_nationkey = s_nationkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'ASIA'
        
20/04/26 21:31:44 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:31:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3372L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, ((l_suppkey#308L = s_suppkey#18L) && (n_nationkey#108L = s_nationkey#21L))
         :- Project [n_nationkey#108L, l_suppkey#308L]
         :  +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :     :- Project [n_nationkey#108L, o_orderkey#342L]
         :     :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :     :- Project [n_nationkey#108L, c_custkey#290L]
         :     :     :  +- Join Inner, (n_nationkey#108L = c_nationkey#293L)
         :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :     :     :- Project [r_regionkey#116L]
         :     :     :     :     :  +- Filter (r_name#117 = ASIA)
         :     :     :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :     :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     +- Project [c_custkey#290L, c_nationkey#293L]
         :     :     :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [s_suppkey#18L, s_nationkey#21L]
            +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:31:44 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:31:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3372L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Filter (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_5, BinaryType)), 'cfpk_supplier_nation_5) = 'rid_1)
         +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_supplier_4) = 'rid_5)
            :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_3)
            :  :- Project [rid#3542 AS rid_4#3587, cpfk_orders_lineitem#3543 AS cpfk_orders_lineitem_4#3588, cpfk_supplier_lineitem#3544 AS cpfk_supplier_lineitem_4#3589, cfpk_lineitem_supplier#3545 AS cfpk_lineitem_supplier_4#3590, cfpk_lineitem_partsupp#3546 AS cfpk_lineitem_partsupp_4#3591, cpfk_part_lineitem#3547 AS cpfk_part_lineitem_4#3592, cfpk_lineitem_part#3548 AS cfpk_lineitem_part_4#3593, cpfk_partsupp_lineitem#3549 AS cpfk_partsupp_lineitem_4#3594, cfpk_lineitem_orders#3550 AS cfpk_lineitem_orders_4#3595, cval_lineitem_l_quantity#3551 AS cval_lineitem_l_quantity_4#3596, cval_lineitem_l_extendedprice#3552 AS cval_lineitem_l_extendedprice_4#3597, cval_lineitem_l_discount#3553 AS cval_lineitem_l_discount_4#3598, cval_lineitem_l_tax#3554 AS cval_lineitem_l_tax_4#3599, cval_lineitem_l_returnflag#3555 AS cval_lineitem_l_returnflag_4#3600, cval_lineitem_l_linestatus#3556 AS cval_lineitem_l_linestatus_4#3601, cval_lineitem_l_commitdate#3557 AS cval_lineitem_l_commitdate_4#3602, cval_lineitem_l_receiptdate#3558 AS cval_lineitem_l_receiptdate_4#3603, cval_lineitem_l_shipinstruct#3559 AS cval_lineitem_l_shipinstruct_4#3604, cval_lineitem_l_shipmode#3560 AS cval_lineitem_l_shipmode_4#3605, cval_lineitem_l_comment#3561 AS cval_lineitem_l_comment_4#3606, cval_lineitem_l_shipdate#3562 AS cval_lineitem_l_shipdate_4#3607, cdepval_lineitem_l_quantity#3563 AS cdepval_lineitem_l_quantity_4#3608, cdepval_lineitem_l_extendedprice#3564 AS cdepval_lineitem_l_extendedprice_4#3609, cdepval_lineitem_l_discount#3565 AS cdepval_lineitem_l_discount_4#3610, ... 21 more fields]
            :  :  +- Relation[rid#3542,cpfk_orders_lineitem#3543,cpfk_supplier_lineitem#3544,cfpk_lineitem_supplier#3545,cfpk_lineitem_partsupp#3546,cpfk_part_lineitem#3547,cfpk_lineitem_part#3548,cpfk_partsupp_lineitem#3549,cfpk_lineitem_orders#3550,cval_lineitem_l_quantity#3551,cval_lineitem_l_extendedprice#3552,cval_lineitem_l_discount#3553,cval_lineitem_l_tax#3554,cval_lineitem_l_returnflag#3555,cval_lineitem_l_linestatus#3556,cval_lineitem_l_commitdate#3557,cval_lineitem_l_receiptdate#3558,cval_lineitem_l_shipinstruct#3559,cval_lineitem_l_shipmode#3560,cval_lineitem_l_comment#3561,cval_lineitem_l_shipdate#3562,cdepval_lineitem_l_quantity#3563,cdepval_lineitem_l_extendedprice#3564,cdepval_lineitem_l_discount#3565,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
            :  +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_3, BinaryType)), 'cfpk_orders_customer_3) = 'rid_2)
            :     :- Project [rid#3494 AS rid_3#3518, cpfk_customer_orders#3495 AS cpfk_customer_orders_3#3519, cfpk_orders_customer#3496 AS cfpk_orders_customer_3#3520, cval_orders_o_orderstatus#3497 AS cval_orders_o_orderstatus_3#3521, cval_orders_o_totalprice#3498 AS cval_orders_o_totalprice_3#3522, cval_orders_o_orderpriority#3499 AS cval_orders_o_orderpriority_3#3523, cval_orders_o_clerk#3500 AS cval_orders_o_clerk_3#3524, cval_orders_o_shippriority#3501 AS cval_orders_o_shippriority_3#3525, cval_orders_o_comment#3502 AS cval_orders_o_comment_3#3526, cval_orders_o_orderdate#3503 AS cval_orders_o_orderdate_3#3527, cdepval_orders_o_orderstatus#3504 AS cdepval_orders_o_orderstatus_3#3528, cdepval_orders_o_totalprice#3505 AS cdepval_orders_o_totalprice_3#3529, cdepval_orders_o_orderpriority#3506 AS cdepval_orders_o_orderpriority_3#3530, cdepval_orders_o_clerk#3507 AS cdepval_orders_o_clerk_3#3531, cdepval_orders_o_shippriority#3508 AS cdepval_orders_o_shippriority_3#3532, cdepval_orders_o_comment#3509 AS cdepval_orders_o_comment_3#3533, cdepval_orders_o_orderdate#3510 AS cdepval_orders_o_orderdate_3#3534, co_orderstatus#3511 AS co_orderstatus_3#3535, co_totalprice#3512 AS co_totalprice_3#3536, co_orderpriority#3513 AS co_orderpriority_3#3537, co_clerk#3514 AS co_clerk_3#3538, co_shippriority#3515 AS co_shippriority_3#3539, co_comment#3516 AS co_comment_3#3540, co_orderdate#3517 AS co_orderdate_3#3541]
            :     :  +- Relation[rid#3494,cpfk_customer_orders#3495,cfpk_orders_customer#3496,cval_orders_o_orderstatus#3497,cval_orders_o_totalprice#3498,cval_orders_o_orderpriority#3499,cval_orders_o_clerk#3500,cval_orders_o_shippriority#3501,cval_orders_o_comment#3502,cval_orders_o_orderdate#3503,cdepval_orders_o_orderstatus#3504,cdepval_orders_o_totalprice#3505,cdepval_orders_o_orderpriority#3506,cdepval_orders_o_clerk#3507,cdepval_orders_o_shippriority#3508,cdepval_orders_o_comment#3509,cdepval_orders_o_orderdate#3510,co_orderstatus#3511,co_totalprice#3512,co_orderpriority#3513,co_clerk#3514,co_shippriority#3515,co_comment#3516,co_orderdate#3517] JDBCRelation(torders) [numPartitions=1]
            :     +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_1)
            :        :- Project [rid#3452 AS rid_2#3473, cpfk_nation_customer#3453 AS cpfk_nation_customer_2#3474, cfpk_customer_nation#3454 AS cfpk_customer_nation_2#3475, cval_customer_c_name#3455 AS cval_customer_c_name_2#3476, cval_customer_c_address#3456 AS cval_customer_c_address_2#3477, cval_customer_c_phone#3457 AS cval_customer_c_phone_2#3478, cval_customer_c_acctbal#3458 AS cval_customer_c_acctbal_2#3479, cval_customer_c_comment#3459 AS cval_customer_c_comment_2#3480, cval_customer_c_mktsegment#3460 AS cval_customer_c_mktsegment_2#3481, cdepval_customer_c_name#3461 AS cdepval_customer_c_name_2#3482, cdepval_customer_c_address#3462 AS cdepval_customer_c_address_2#3483, cdepval_customer_c_phone#3463 AS cdepval_customer_c_phone_2#3484, cdepval_customer_c_acctbal#3464 AS cdepval_customer_c_acctbal_2#3485, cdepval_customer_c_comment#3465 AS cdepval_customer_c_comment_2#3486, cdepval_customer_c_mktsegment#3466 AS cdepval_customer_c_mktsegment_2#3487, cc_name#3467 AS cc_name_2#3488, cc_address#3468 AS cc_address_2#3489, cc_phone#3469 AS cc_phone_2#3490, cc_acctbal#3470 AS cc_acctbal_2#3491, cc_comment#3471 AS cc_comment_2#3492, cc_mktsegment#3472 AS cc_mktsegment_2#3493]
            :        :  +- Relation[rid#3452,cpfk_nation_customer#3453,cfpk_customer_nation#3454,cval_customer_c_name#3455,cval_customer_c_address#3456,cval_customer_c_phone#3457,cval_customer_c_acctbal#3458,cval_customer_c_comment#3459,cval_customer_c_mktsegment#3460,cdepval_customer_c_name#3461,cdepval_customer_c_address#3462,cdepval_customer_c_phone#3463,cdepval_customer_c_acctbal#3464,cdepval_customer_c_comment#3465,cdepval_customer_c_mktsegment#3466,cc_name#3467,cc_address#3468,cc_phone#3469,cc_acctbal#3470,cc_comment#3471,cc_mktsegment#3472] JDBCRelation(tcustomer) [numPartitions=1]
            :        +- 'Join UsingJoin(Inner,List(rid_1))
            :           :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3381, cval_region_r_name_0#3382, cval_region_r_comment_0#3383, cdepval_region_r_name_0#3384, cdepval_region_r_comment_0#3385, cr_name_0#3386, cr_comment_0#3387, 'rid_1]
            :           :  :- 'DexPseudoPrimaryKeyFilter region~r_name~ASIA, cval_region_r_name, 'cval_region_r_name_0, tregion
            :           :  :  +- Project [rid#3374 AS rid_0#3381, cval_region_r_name#3375 AS cval_region_r_name_0#3382, cval_region_r_comment#3376 AS cval_region_r_comment_0#3383, cdepval_region_r_name#3377 AS cdepval_region_r_name_0#3384, cdepval_region_r_comment#3378 AS cdepval_region_r_comment_0#3385, cr_name#3379 AS cr_name_0#3386, cr_comment#3380 AS cr_comment_0#3387]
            :           :  :     +- Relation[rid#3374,cval_region_r_name#3375,cval_region_r_comment#3376,cdepval_region_r_name#3377,cdepval_region_r_comment#3378,cr_name#3379,cr_comment#3380] JDBCRelation(tregion) [numPartitions=1]
            :           :  +- 'Project ['cpfk_region_nation_1, 'rid_1]
            :           :     +- Project [rid#3434 AS rid_1#3443, cpfk_region_nation#3435 AS cpfk_region_nation_1#3444, cfpk_nation_region#3436 AS cfpk_nation_region_1#3445, cval_nation_n_name#3437 AS cval_nation_n_name_1#3446, cval_nation_n_comment#3438 AS cval_nation_n_comment_1#3447, cdepval_nation_n_name#3439 AS cdepval_nation_n_name_1#3448, cdepval_nation_n_comment#3440 AS cdepval_nation_n_comment_1#3449, cn_name#3441 AS cn_name_1#3450, cn_comment#3442 AS cn_comment_1#3451]
            :           :        +- Relation[rid#3434,cpfk_region_nation#3435,cfpk_nation_region#3436,cval_nation_n_name#3437,cval_nation_n_comment#3438,cdepval_nation_n_name#3439,cdepval_nation_n_comment#3440,cn_name#3441,cn_comment#3442] JDBCRelation(tnation) [numPartitions=1]
            :           +- Project [rid#3402 AS rid_1#3411, cpfk_region_nation#3403 AS cpfk_region_nation_1#3412, cfpk_nation_region#3404 AS cfpk_nation_region_1#3413, cval_nation_n_name#3405 AS cval_nation_n_name_1#3414, cval_nation_n_comment#3406 AS cval_nation_n_comment_1#3415, cdepval_nation_n_name#3407 AS cdepval_nation_n_name_1#3416, cdepval_nation_n_comment#3408 AS cdepval_nation_n_comment_1#3417, cn_name#3409 AS cn_name_1#3418, cn_comment#3410 AS cn_comment_1#3419]
            :              +- Relation[rid#3402,cpfk_region_nation#3403,cfpk_nation_region#3404,cval_nation_n_name#3405,cval_nation_n_comment#3406,cdepval_nation_n_name#3407,cdepval_nation_n_comment#3408,cn_name#3409,cn_comment#3410] JDBCRelation(tnation) [numPartitions=1]
            +- Project [rid#3632 AS rid_5#3650, cpfk_nation_supplier#3633 AS cpfk_nation_supplier_5#3651, cfpk_supplier_nation#3634 AS cfpk_supplier_nation_5#3652, cval_supplier_s_name#3635 AS cval_supplier_s_name_5#3653, cval_supplier_s_address#3636 AS cval_supplier_s_address_5#3654, cval_supplier_s_phone#3637 AS cval_supplier_s_phone_5#3655, cval_supplier_s_acctbal#3638 AS cval_supplier_s_acctbal_5#3656, cval_supplier_s_comment#3639 AS cval_supplier_s_comment_5#3657, cdepval_supplier_s_name#3640 AS cdepval_supplier_s_name_5#3658, cdepval_supplier_s_address#3641 AS cdepval_supplier_s_address_5#3659, cdepval_supplier_s_phone#3642 AS cdepval_supplier_s_phone_5#3660, cdepval_supplier_s_acctbal#3643 AS cdepval_supplier_s_acctbal_5#3661, cdepval_supplier_s_comment#3644 AS cdepval_supplier_s_comment_5#3662, cs_name#3645 AS cs_name_5#3663, cs_address#3646 AS cs_address_5#3664, cs_phone#3647 AS cs_phone_5#3665, cs_acctbal#3648 AS cs_acctbal_5#3666, cs_comment#3649 AS cs_comment_5#3667]
               +- Relation[rid#3632,cpfk_nation_supplier#3633,cfpk_supplier_nation#3634,cval_supplier_s_name#3635,cval_supplier_s_address#3636,cval_supplier_s_phone#3637,cval_supplier_s_acctbal#3638,cval_supplier_s_comment#3639,cdepval_supplier_s_name#3640,cdepval_supplier_s_address#3641,cdepval_supplier_s_phone#3642,cdepval_supplier_s_acctbal#3643,cdepval_supplier_s_comment#3644,cs_name#3645,cs_address#3646,cs_phone#3647,cs_acctbal#3648,cs_comment#3649] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=48089
Elapsed time: 29514ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
20/04/26 21:32:13 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:32:13 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3796L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:32:13 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3796L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#3823, cval_part_p_name_0#3824, cval_part_p_mfgr_0#3825, cval_part_p_type_0#3826, cval_part_p_size_0#3827, cval_part_p_container_0#3828, cval_part_p_retailprice_0#3829, cval_part_p_comment_0#3830, cval_part_p_brand_0#3831, cdepval_part_p_name_0#3832, cdepval_part_p_mfgr_0#3833, cdepval_part_p_type_0#3834, cdepval_part_p_size_0#3835, cdepval_part_p_container_0#3836, cdepval_part_p_retailprice_0#3837, cdepval_part_p_comment_0#3838, cdepval_part_p_brand_0#3839, cp_name_0#3840, cp_mfgr_0#3841, cp_type_0#3842, cp_size_0#3843, cp_container_0#3844, cp_retailprice_0#3845, cp_comment_0#3846, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0xBB1C49090DA3AB8B86347BF7333E609A443668C2481E86AFBC91B5646AD12AF7, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#23, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#3798 AS rid_0#3823, cval_part_p_name#3799 AS cval_part_p_name_0#3824, cval_part_p_mfgr#3800 AS cval_part_p_mfgr_0#3825, cval_part_p_type#3801 AS cval_part_p_type_0#3826, cval_part_p_size#3802 AS cval_part_p_size_0#3827, cval_part_p_container#3803 AS cval_part_p_container_0#3828, cval_part_p_retailprice#3804 AS cval_part_p_retailprice_0#3829, cval_part_p_comment#3805 AS cval_part_p_comment_0#3830, cval_part_p_brand#3806 AS cval_part_p_brand_0#3831, cdepval_part_p_name#3807 AS cdepval_part_p_name_0#3832, cdepval_part_p_mfgr#3808 AS cdepval_part_p_mfgr_0#3833, cdepval_part_p_type#3809 AS cdepval_part_p_type_0#3834, cdepval_part_p_size#3810 AS cdepval_part_p_size_0#3835, cdepval_part_p_container#3811 AS cdepval_part_p_container_0#3836, cdepval_part_p_retailprice#3812 AS cdepval_part_p_retailprice_0#3837, cdepval_part_p_comment#3813 AS cdepval_part_p_comment_0#3838, cdepval_part_p_brand#3814 AS cdepval_part_p_brand_0#3839, cp_name#3815 AS cp_name_0#3840, cp_mfgr#3816 AS cp_mfgr_0#3841, cp_type#3817 AS cp_type_0#3842, cp_size#3818 AS cp_size_0#3843, cp_container#3819 AS cp_container_0#3844, cp_retailprice#3820 AS cp_retailprice_0#3845, cp_comment#3821 AS cp_comment_0#3846, cp_brand#3822 AS cp_brand_0#3847]
         :  :        +- Relation[rid#3798,cval_part_p_name#3799,cval_part_p_mfgr#3800,cval_part_p_type#3801,cval_part_p_size#3802,cval_part_p_container#3803,cval_part_p_retailprice#3804,cval_part_p_comment#3805,cval_part_p_brand#3806,cdepval_part_p_name#3807,cdepval_part_p_mfgr#3808,cdepval_part_p_type#3809,cdepval_part_p_size#3810,cdepval_part_p_container#3811,cdepval_part_p_retailprice#3812,cdepval_part_p_comment#3813,cdepval_part_p_brand#3814,cp_name#3815,cp_mfgr#3816,cp_type#3817,cp_size#3818,cp_container#3819,cp_retailprice#3820,cp_comment#3821,cp_brand#3822] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#4088 AS rid_1#4133, cpfk_orders_lineitem#4089 AS cpfk_orders_lineitem_1#4134, cpfk_supplier_lineitem#4090 AS cpfk_supplier_lineitem_1#4135, cfpk_lineitem_supplier#4091 AS cfpk_lineitem_supplier_1#4136, cfpk_lineitem_partsupp#4092 AS cfpk_lineitem_partsupp_1#4137, cpfk_part_lineitem#4093 AS cpfk_part_lineitem_1#4138, cfpk_lineitem_part#4094 AS cfpk_lineitem_part_1#4139, cpfk_partsupp_lineitem#4095 AS cpfk_partsupp_lineitem_1#4140, cfpk_lineitem_orders#4096 AS cfpk_lineitem_orders_1#4141, cval_lineitem_l_quantity#4097 AS cval_lineitem_l_quantity_1#4142, cval_lineitem_l_extendedprice#4098 AS cval_lineitem_l_extendedprice_1#4143, cval_lineitem_l_discount#4099 AS cval_lineitem_l_discount_1#4144, cval_lineitem_l_tax#4100 AS cval_lineitem_l_tax_1#4145, cval_lineitem_l_returnflag#4101 AS cval_lineitem_l_returnflag_1#4146, cval_lineitem_l_linestatus#4102 AS cval_lineitem_l_linestatus_1#4147, cval_lineitem_l_commitdate#4103 AS cval_lineitem_l_commitdate_1#4148, cval_lineitem_l_receiptdate#4104 AS cval_lineitem_l_receiptdate_1#4149, cval_lineitem_l_shipinstruct#4105 AS cval_lineitem_l_shipinstruct_1#4150, cval_lineitem_l_shipmode#4106 AS cval_lineitem_l_shipmode_1#4151, cval_lineitem_l_comment#4107 AS cval_lineitem_l_comment_1#4152, cval_lineitem_l_shipdate#4108 AS cval_lineitem_l_shipdate_1#4153, cdepval_lineitem_l_quantity#4109 AS cdepval_lineitem_l_quantity_1#4154, cdepval_lineitem_l_extendedprice#4110 AS cdepval_lineitem_l_extendedprice_1#4155, cdepval_lineitem_l_discount#4111 AS cdepval_lineitem_l_discount_1#4156, ... 21 more fields]
         :        +- Relation[rid#4088,cpfk_orders_lineitem#4089,cpfk_supplier_lineitem#4090,cfpk_lineitem_supplier#4091,cfpk_lineitem_partsupp#4092,cpfk_part_lineitem#4093,cfpk_lineitem_part#4094,cpfk_partsupp_lineitem#4095,cfpk_lineitem_orders#4096,cval_lineitem_l_quantity#4097,cval_lineitem_l_extendedprice#4098,cval_lineitem_l_discount#4099,cval_lineitem_l_tax#4100,cval_lineitem_l_returnflag#4101,cval_lineitem_l_linestatus#4102,cval_lineitem_l_commitdate#4103,cval_lineitem_l_receiptdate#4104,cval_lineitem_l_shipinstruct#4105,cval_lineitem_l_shipmode#4106,cval_lineitem_l_comment#4107,cval_lineitem_l_shipdate#4108,cdepval_lineitem_l_quantity#4109,cdepval_lineitem_l_extendedprice#4110,cdepval_lineitem_l_discount#4111,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#3948 AS rid_1#3993, cpfk_orders_lineitem#3949 AS cpfk_orders_lineitem_1#3994, cpfk_supplier_lineitem#3950 AS cpfk_supplier_lineitem_1#3995, cfpk_lineitem_supplier#3951 AS cfpk_lineitem_supplier_1#3996, cfpk_lineitem_partsupp#3952 AS cfpk_lineitem_partsupp_1#3997, cpfk_part_lineitem#3953 AS cpfk_part_lineitem_1#3998, cfpk_lineitem_part#3954 AS cfpk_lineitem_part_1#3999, cpfk_partsupp_lineitem#3955 AS cpfk_partsupp_lineitem_1#4000, cfpk_lineitem_orders#3956 AS cfpk_lineitem_orders_1#4001, cval_lineitem_l_quantity#3957 AS cval_lineitem_l_quantity_1#4002, cval_lineitem_l_extendedprice#3958 AS cval_lineitem_l_extendedprice_1#4003, cval_lineitem_l_discount#3959 AS cval_lineitem_l_discount_1#4004, cval_lineitem_l_tax#3960 AS cval_lineitem_l_tax_1#4005, cval_lineitem_l_returnflag#3961 AS cval_lineitem_l_returnflag_1#4006, cval_lineitem_l_linestatus#3962 AS cval_lineitem_l_linestatus_1#4007, cval_lineitem_l_commitdate#3963 AS cval_lineitem_l_commitdate_1#4008, cval_lineitem_l_receiptdate#3964 AS cval_lineitem_l_receiptdate_1#4009, cval_lineitem_l_shipinstruct#3965 AS cval_lineitem_l_shipinstruct_1#4010, cval_lineitem_l_shipmode#3966 AS cval_lineitem_l_shipmode_1#4011, cval_lineitem_l_comment#3967 AS cval_lineitem_l_comment_1#4012, cval_lineitem_l_shipdate#3968 AS cval_lineitem_l_shipdate_1#4013, cdepval_lineitem_l_quantity#3969 AS cdepval_lineitem_l_quantity_1#4014, cdepval_lineitem_l_extendedprice#3970 AS cdepval_lineitem_l_extendedprice_1#4015, cdepval_lineitem_l_discount#3971 AS cdepval_lineitem_l_discount_1#4016, ... 21 more fields]
            +- Relation[rid#3948,cpfk_orders_lineitem#3949,cpfk_supplier_lineitem#3950,cfpk_lineitem_supplier#3951,cfpk_lineitem_partsupp#3952,cpfk_part_lineitem#3953,cfpk_lineitem_part#3954,cpfk_partsupp_lineitem#3955,cfpk_lineitem_orders#3956,cval_lineitem_l_quantity#3957,cval_lineitem_l_extendedprice#3958,cval_lineitem_l_discount#3959,cval_lineitem_l_tax#3960,cval_lineitem_l_returnflag#3961,cval_lineitem_l_linestatus#3962,cval_lineitem_l_commitdate#3963,cval_lineitem_l_receiptdate#3964,cval_lineitem_l_shipinstruct#3965,cval_lineitem_l_shipmode#3966,cval_lineitem_l_comment#3967,cval_lineitem_l_shipdate#3968,cdepval_lineitem_l_quantity#3969,cdepval_lineitem_l_extendedprice#3970,cdepval_lineitem_l_discount#3971,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6088
Elapsed time: 499ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
20/04/26 21:32:14 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:32:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4253L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:32:14 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4253L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_1, BinaryType)), 'cfpk_partsupp_supplier_1) = 'rid_3)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#4280, cval_part_p_name_0#4281, cval_part_p_mfgr_0#4282, cval_part_p_type_0#4283, cval_part_p_size_0#4284, cval_part_p_container_0#4285, cval_part_p_retailprice_0#4286, cval_part_p_comment_0#4287, cval_part_p_brand_0#4288, cdepval_part_p_name_0#4289, cdepval_part_p_mfgr_0#4290, cdepval_part_p_type_0#4291, cdepval_part_p_size_0#4292, cdepval_part_p_container_0#4293, cdepval_part_p_retailprice_0#4294, cdepval_part_p_comment_0#4295, cdepval_part_p_brand_0#4296, cp_name_0#4297, cp_mfgr_0#4298, cp_type_0#4299, cp_size_0#4300, cp_container_0#4301, cp_retailprice_0#4302, cp_comment_0#4303, ... 2 more fields]
         :  :  :- 'DexPseudoPrimaryKeyFilter part~p_size~15, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  :  +- Project [rid#4255 AS rid_0#4280, cval_part_p_name#4256 AS cval_part_p_name_0#4281, cval_part_p_mfgr#4257 AS cval_part_p_mfgr_0#4282, cval_part_p_type#4258 AS cval_part_p_type_0#4283, cval_part_p_size#4259 AS cval_part_p_size_0#4284, cval_part_p_container#4260 AS cval_part_p_container_0#4285, cval_part_p_retailprice#4261 AS cval_part_p_retailprice_0#4286, cval_part_p_comment#4262 AS cval_part_p_comment_0#4287, cval_part_p_brand#4263 AS cval_part_p_brand_0#4288, cdepval_part_p_name#4264 AS cdepval_part_p_name_0#4289, cdepval_part_p_mfgr#4265 AS cdepval_part_p_mfgr_0#4290, cdepval_part_p_type#4266 AS cdepval_part_p_type_0#4291, cdepval_part_p_size#4267 AS cdepval_part_p_size_0#4292, cdepval_part_p_container#4268 AS cdepval_part_p_container_0#4293, cdepval_part_p_retailprice#4269 AS cdepval_part_p_retailprice_0#4294, cdepval_part_p_comment#4270 AS cdepval_part_p_comment_0#4295, cdepval_part_p_brand#4271 AS cdepval_part_p_brand_0#4296, cp_name#4272 AS cp_name_0#4297, cp_mfgr#4273 AS cp_mfgr_0#4298, cp_type#4274 AS cp_type_0#4299, cp_size#4275 AS cp_size_0#4300, cp_container#4276 AS cp_container_0#4301, cp_retailprice#4277 AS cp_retailprice_0#4302, cp_comment#4278 AS cp_comment_0#4303, cp_brand#4279 AS cp_brand_0#4304]
         :  :  :     +- Relation[rid#4255,cval_part_p_name#4256,cval_part_p_mfgr#4257,cval_part_p_type#4258,cval_part_p_size#4259,cval_part_p_container#4260,cval_part_p_retailprice#4261,cval_part_p_comment#4262,cval_part_p_brand#4263,cdepval_part_p_name#4264,cdepval_part_p_mfgr#4265,cdepval_part_p_type#4266,cdepval_part_p_size#4267,cdepval_part_p_container#4268,cdepval_part_p_retailprice#4269,cdepval_part_p_comment#4270,cdepval_part_p_brand#4271,cp_name#4272,cp_mfgr#4273,cp_type#4274,cp_size#4275,cp_container#4276,cp_retailprice#4277,cp_comment#4278,cp_brand#4279] JDBCRelation(tpart) [numPartitions=1]
         :  :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :  :     +- Project [rid#4433 AS rid_1#4447, cpfk_part_partsupp#4434 AS cpfk_part_partsupp_1#4448, cfpk_partsupp_part#4435 AS cfpk_partsupp_part_1#4449, cpfk_supplier_partsupp#4436 AS cpfk_supplier_partsupp_1#4450, cfpk_partsupp_supplier#4437 AS cfpk_partsupp_supplier_1#4451, cval_partsupp_ps_availqty#4438 AS cval_partsupp_ps_availqty_1#4452, cval_partsupp_ps_supplycost#4439 AS cval_partsupp_ps_supplycost_1#4453, cval_partsupp_ps_comment#4440 AS cval_partsupp_ps_comment_1#4454, cdepval_partsupp_ps_availqty#4441 AS cdepval_partsupp_ps_availqty_1#4455, cdepval_partsupp_ps_supplycost#4442 AS cdepval_partsupp_ps_supplycost_1#4456, cdepval_partsupp_ps_comment#4443 AS cdepval_partsupp_ps_comment_1#4457, cps_availqty#4444 AS cps_availqty_1#4458, cps_supplycost#4445 AS cps_supplycost_1#4459, cps_comment#4446 AS cps_comment_1#4460]
         :  :        +- Relation[rid#4433,cpfk_part_partsupp#4434,cfpk_partsupp_part#4435,cpfk_supplier_partsupp#4436,cfpk_partsupp_supplier#4437,cval_partsupp_ps_availqty#4438,cval_partsupp_ps_supplycost#4439,cval_partsupp_ps_comment#4440,cdepval_partsupp_ps_availqty#4441,cdepval_partsupp_ps_supplycost#4442,cdepval_partsupp_ps_comment#4443,cps_availqty#4444,cps_supplycost#4445,cps_comment#4446] JDBCRelation(tpartsupp) [numPartitions=1]
         :  +- Project [rid#4355 AS rid_1#4369, cpfk_part_partsupp#4356 AS cpfk_part_partsupp_1#4370, cfpk_partsupp_part#4357 AS cfpk_partsupp_part_1#4371, cpfk_supplier_partsupp#4358 AS cpfk_supplier_partsupp_1#4372, cfpk_partsupp_supplier#4359 AS cfpk_partsupp_supplier_1#4373, cval_partsupp_ps_availqty#4360 AS cval_partsupp_ps_availqty_1#4374, cval_partsupp_ps_supplycost#4361 AS cval_partsupp_ps_supplycost_1#4375, cval_partsupp_ps_comment#4362 AS cval_partsupp_ps_comment_1#4376, cdepval_partsupp_ps_availqty#4363 AS cdepval_partsupp_ps_availqty_1#4377, cdepval_partsupp_ps_supplycost#4364 AS cdepval_partsupp_ps_supplycost_1#4378, cdepval_partsupp_ps_comment#4365 AS cdepval_partsupp_ps_comment_1#4379, cps_availqty#4366 AS cps_availqty_1#4380, cps_supplycost#4367 AS cps_supplycost_1#4381, cps_comment#4368 AS cps_comment_1#4382]
         :     +- Relation[rid#4355,cpfk_part_partsupp#4356,cfpk_partsupp_part#4357,cpfk_supplier_partsupp#4358,cfpk_partsupp_supplier#4359,cval_partsupp_ps_availqty#4360,cval_partsupp_ps_supplycost#4361,cval_partsupp_ps_comment#4362,cdepval_partsupp_ps_availqty#4363,cdepval_partsupp_ps_supplycost#4364,cdepval_partsupp_ps_comment#4365,cps_availqty#4366,cps_supplycost#4367,cps_comment#4368] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_2, NotMaterialized, NotMaterialized, [rid_2#4470, cpfk_region_nation_2#4471, cfpk_nation_region_2#4472, cval_nation_n_name_2#4473, cval_nation_n_comment_2#4474, cdepval_nation_n_name_2#4475, cdepval_nation_n_comment_2#4476, cn_name_2#4477, cn_comment_2#4478, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~CANADA, cval_nation_n_name, 'cval_nation_n_name_2, tnation
            :  :  +- Project [rid#4461 AS rid_2#4470, cpfk_region_nation#4462 AS cpfk_region_nation_2#4471, cfpk_nation_region#4463 AS cfpk_nation_region_2#4472, cval_nation_n_name#4464 AS cval_nation_n_name_2#4473, cval_nation_n_comment#4465 AS cval_nation_n_comment_2#4474, cdepval_nation_n_name#4466 AS cdepval_nation_n_name_2#4475, cdepval_nation_n_comment#4467 AS cdepval_nation_n_comment_2#4476, cn_name#4468 AS cn_name_2#4477, cn_comment#4469 AS cn_comment_2#4478]
            :  :     +- Relation[rid#4461,cpfk_region_nation#4462,cfpk_nation_region#4463,cval_nation_n_name#4464,cval_nation_n_comment#4465,cdepval_nation_n_name#4466,cdepval_nation_n_comment#4467,cn_name#4468,cn_comment#4469] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#4551 AS rid_3#4569, cpfk_nation_supplier#4552 AS cpfk_nation_supplier_3#4570, cfpk_supplier_nation#4553 AS cfpk_supplier_nation_3#4571, cval_supplier_s_name#4554 AS cval_supplier_s_name_3#4572, cval_supplier_s_address#4555 AS cval_supplier_s_address_3#4573, cval_supplier_s_phone#4556 AS cval_supplier_s_phone_3#4574, cval_supplier_s_acctbal#4557 AS cval_supplier_s_acctbal_3#4575, cval_supplier_s_comment#4558 AS cval_supplier_s_comment_3#4576, cdepval_supplier_s_name#4559 AS cdepval_supplier_s_name_3#4577, cdepval_supplier_s_address#4560 AS cdepval_supplier_s_address_3#4578, cdepval_supplier_s_phone#4561 AS cdepval_supplier_s_phone_3#4579, cdepval_supplier_s_acctbal#4562 AS cdepval_supplier_s_acctbal_3#4580, cdepval_supplier_s_comment#4563 AS cdepval_supplier_s_comment_3#4581, cs_name#4564 AS cs_name_3#4582, cs_address#4565 AS cs_address_3#4583, cs_phone#4566 AS cs_phone_3#4584, cs_acctbal#4567 AS cs_acctbal_3#4585, cs_comment#4568 AS cs_comment_3#4586]
            :        +- Relation[rid#4551,cpfk_nation_supplier#4552,cfpk_supplier_nation#4553,cval_supplier_s_name#4554,cval_supplier_s_address#4555,cval_supplier_s_phone#4556,cval_supplier_s_acctbal#4557,cval_supplier_s_comment#4558,cdepval_supplier_s_name#4559,cdepval_supplier_s_address#4560,cdepval_supplier_s_phone#4561,cdepval_supplier_s_acctbal#4562,cdepval_supplier_s_comment#4563,cs_name#4564,cs_address#4565,cs_phone#4566,cs_acctbal#4567,cs_comment#4568] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#4497 AS rid_3#4515, cpfk_nation_supplier#4498 AS cpfk_nation_supplier_3#4516, cfpk_supplier_nation#4499 AS cfpk_supplier_nation_3#4517, cval_supplier_s_name#4500 AS cval_supplier_s_name_3#4518, cval_supplier_s_address#4501 AS cval_supplier_s_address_3#4519, cval_supplier_s_phone#4502 AS cval_supplier_s_phone_3#4520, cval_supplier_s_acctbal#4503 AS cval_supplier_s_acctbal_3#4521, cval_supplier_s_comment#4504 AS cval_supplier_s_comment_3#4522, cdepval_supplier_s_name#4505 AS cdepval_supplier_s_name_3#4523, cdepval_supplier_s_address#4506 AS cdepval_supplier_s_address_3#4524, cdepval_supplier_s_phone#4507 AS cdepval_supplier_s_phone_3#4525, cdepval_supplier_s_acctbal#4508 AS cdepval_supplier_s_acctbal_3#4526, cdepval_supplier_s_comment#4509 AS cdepval_supplier_s_comment_3#4527, cs_name#4510 AS cs_name_3#4528, cs_address#4511 AS cs_address_3#4529, cs_phone#4512 AS cs_phone_3#4530, cs_acctbal#4513 AS cs_acctbal_3#4531, cs_comment#4514 AS cs_comment_3#4532]
               +- Relation[rid#4497,cpfk_nation_supplier#4498,cfpk_supplier_nation#4499,cval_supplier_s_name#4500,cval_supplier_s_address#4501,cval_supplier_s_phone#4502,cval_supplier_s_acctbal#4503,cval_supplier_s_comment#4504,cdepval_supplier_s_name#4505,cdepval_supplier_s_address#4506,cdepval_supplier_s_phone#4507,cdepval_supplier_s_acctbal#4508,cdepval_supplier_s_comment#4509,cs_name#4510,cs_address#4511,cs_phone#4512,cs_acctbal#4513,cs_comment#4514] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=632
Elapsed time: 816ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
20/04/26 21:32:15 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:32:15 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4657L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:32:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4657L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~MAIL, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_0, tlineitem
         :  +- Project [rid#4659 AS rid_0#4704, cpfk_orders_lineitem#4660 AS cpfk_orders_lineitem_0#4705, cpfk_supplier_lineitem#4661 AS cpfk_supplier_lineitem_0#4706, cfpk_lineitem_supplier#4662 AS cfpk_lineitem_supplier_0#4707, cfpk_lineitem_partsupp#4663 AS cfpk_lineitem_partsupp_0#4708, cpfk_part_lineitem#4664 AS cpfk_part_lineitem_0#4709, cfpk_lineitem_part#4665 AS cfpk_lineitem_part_0#4710, cpfk_partsupp_lineitem#4666 AS cpfk_partsupp_lineitem_0#4711, cfpk_lineitem_orders#4667 AS cfpk_lineitem_orders_0#4712, cval_lineitem_l_quantity#4668 AS cval_lineitem_l_quantity_0#4713, cval_lineitem_l_extendedprice#4669 AS cval_lineitem_l_extendedprice_0#4714, cval_lineitem_l_discount#4670 AS cval_lineitem_l_discount_0#4715, cval_lineitem_l_tax#4671 AS cval_lineitem_l_tax_0#4716, cval_lineitem_l_returnflag#4672 AS cval_lineitem_l_returnflag_0#4717, cval_lineitem_l_linestatus#4673 AS cval_lineitem_l_linestatus_0#4718, cval_lineitem_l_commitdate#4674 AS cval_lineitem_l_commitdate_0#4719, cval_lineitem_l_receiptdate#4675 AS cval_lineitem_l_receiptdate_0#4720, cval_lineitem_l_shipinstruct#4676 AS cval_lineitem_l_shipinstruct_0#4721, cval_lineitem_l_shipmode#4677 AS cval_lineitem_l_shipmode_0#4722, cval_lineitem_l_comment#4678 AS cval_lineitem_l_comment_0#4723, cval_lineitem_l_shipdate#4679 AS cval_lineitem_l_shipdate_0#4724, cdepval_lineitem_l_quantity#4680 AS cdepval_lineitem_l_quantity_0#4725, cdepval_lineitem_l_extendedprice#4681 AS cdepval_lineitem_l_extendedprice_0#4726, cdepval_lineitem_l_discount#4682 AS cdepval_lineitem_l_discount_0#4727, ... 21 more fields]
         :     +- Relation[rid#4659,cpfk_orders_lineitem#4660,cpfk_supplier_lineitem#4661,cfpk_lineitem_supplier#4662,cfpk_lineitem_partsupp#4663,cpfk_part_lineitem#4664,cfpk_lineitem_part#4665,cpfk_partsupp_lineitem#4666,cfpk_lineitem_orders#4667,cval_lineitem_l_quantity#4668,cval_lineitem_l_extendedprice#4669,cval_lineitem_l_discount#4670,cval_lineitem_l_tax#4671,cval_lineitem_l_returnflag#4672,cval_lineitem_l_linestatus#4673,cval_lineitem_l_commitdate#4674,cval_lineitem_l_receiptdate#4675,cval_lineitem_l_shipinstruct#4676,cval_lineitem_l_shipmode#4677,cval_lineitem_l_comment#4678,cval_lineitem_l_shipdate#4679,cdepval_lineitem_l_quantity#4680,cdepval_lineitem_l_extendedprice#4681,cdepval_lineitem_l_discount#4682,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#4839 AS rid_1#4863, cpfk_customer_orders#4840 AS cpfk_customer_orders_1#4864, cfpk_orders_customer#4841 AS cfpk_orders_customer_1#4865, cval_orders_o_orderstatus#4842 AS cval_orders_o_orderstatus_1#4866, cval_orders_o_totalprice#4843 AS cval_orders_o_totalprice_1#4867, cval_orders_o_orderpriority#4844 AS cval_orders_o_orderpriority_1#4868, cval_orders_o_clerk#4845 AS cval_orders_o_clerk_1#4869, cval_orders_o_shippriority#4846 AS cval_orders_o_shippriority_1#4870, cval_orders_o_comment#4847 AS cval_orders_o_comment_1#4871, cval_orders_o_orderdate#4848 AS cval_orders_o_orderdate_1#4872, cdepval_orders_o_orderstatus#4849 AS cdepval_orders_o_orderstatus_1#4873, cdepval_orders_o_totalprice#4850 AS cdepval_orders_o_totalprice_1#4874, cdepval_orders_o_orderpriority#4851 AS cdepval_orders_o_orderpriority_1#4875, cdepval_orders_o_clerk#4852 AS cdepval_orders_o_clerk_1#4876, cdepval_orders_o_shippriority#4853 AS cdepval_orders_o_shippriority_1#4877, cdepval_orders_o_comment#4854 AS cdepval_orders_o_comment_1#4878, cdepval_orders_o_orderdate#4855 AS cdepval_orders_o_orderdate_1#4879, co_orderstatus#4856 AS co_orderstatus_1#4880, co_totalprice#4857 AS co_totalprice_1#4881, co_orderpriority#4858 AS co_orderpriority_1#4882, co_clerk#4859 AS co_clerk_1#4883, co_shippriority#4860 AS co_shippriority_1#4884, co_comment#4861 AS co_comment_1#4885, co_orderdate#4862 AS co_orderdate_1#4886]
            +- Relation[rid#4839,cpfk_customer_orders#4840,cfpk_orders_customer#4841,cval_orders_o_orderstatus#4842,cval_orders_o_totalprice#4843,cval_orders_o_orderpriority#4844,cval_orders_o_clerk#4845,cval_orders_o_shippriority#4846,cval_orders_o_comment#4847,cval_orders_o_orderdate#4848,cdepval_orders_o_orderstatus#4849,cdepval_orders_o_totalprice#4850,cdepval_orders_o_orderpriority#4851,cdepval_orders_o_clerk#4852,cdepval_orders_o_shippriority#4853,cdepval_orders_o_comment#4854,cdepval_orders_o_orderdate#4855,co_orderstatus#4856,co_totalprice#4857,co_orderpriority#4858,co_clerk#4859,co_shippriority#4860,co_comment#4861,co_orderdate#4862] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=857401
Elapsed time: 22307ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
20/04/26 21:32:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:32:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4960L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1902L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1902L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1900L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1900L, l_suppkey#1902L]
               :     :        +- Relation[l_orderkey#1900L,l_partkey#1901L,l_suppkey#1902L,l_linenumber#1903,l_quantity#1904,l_extendedprice#1905,l_discount#1906,l_tax#1907,l_returnflag#1908,l_linestatus#1909,l_commitdate#1910,l_receiptdate#1911,l_shipinstruct#1912,l_shipmode#1913,l_comment#1914,l_shipdate#1915] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:32:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:32:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4960L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#4962 AS rid_0#5007, cpfk_orders_lineitem#4963 AS cpfk_orders_lineitem_0#5008, cpfk_supplier_lineitem#4964 AS cpfk_supplier_lineitem_0#5009, cfpk_lineitem_supplier#4965 AS cfpk_lineitem_supplier_0#5010, cfpk_lineitem_partsupp#4966 AS cfpk_lineitem_partsupp_0#5011, cpfk_part_lineitem#4967 AS cpfk_part_lineitem_0#5012, cfpk_lineitem_part#4968 AS cfpk_lineitem_part_0#5013, cpfk_partsupp_lineitem#4969 AS cpfk_partsupp_lineitem_0#5014, cfpk_lineitem_orders#4970 AS cfpk_lineitem_orders_0#5015, cval_lineitem_l_quantity#4971 AS cval_lineitem_l_quantity_0#5016, cval_lineitem_l_extendedprice#4972 AS cval_lineitem_l_extendedprice_0#5017, cval_lineitem_l_discount#4973 AS cval_lineitem_l_discount_0#5018, cval_lineitem_l_tax#4974 AS cval_lineitem_l_tax_0#5019, cval_lineitem_l_returnflag#4975 AS cval_lineitem_l_returnflag_0#5020, cval_lineitem_l_linestatus#4976 AS cval_lineitem_l_linestatus_0#5021, cval_lineitem_l_commitdate#4977 AS cval_lineitem_l_commitdate_0#5022, cval_lineitem_l_receiptdate#4978 AS cval_lineitem_l_receiptdate_0#5023, cval_lineitem_l_shipinstruct#4979 AS cval_lineitem_l_shipinstruct_0#5024, cval_lineitem_l_shipmode#4980 AS cval_lineitem_l_shipmode_0#5025, cval_lineitem_l_comment#4981 AS cval_lineitem_l_comment_0#5026, cval_lineitem_l_shipdate#4982 AS cval_lineitem_l_shipdate_0#5027, cdepval_lineitem_l_quantity#4983 AS cdepval_lineitem_l_quantity_0#5028, cdepval_lineitem_l_extendedprice#4984 AS cdepval_lineitem_l_extendedprice_0#5029, cdepval_lineitem_l_discount#4985 AS cdepval_lineitem_l_discount_0#5030, ... 21 more fields]
         :  +- Relation[rid#4962,cpfk_orders_lineitem#4963,cpfk_supplier_lineitem#4964,cfpk_lineitem_supplier#4965,cfpk_lineitem_partsupp#4966,cpfk_part_lineitem#4967,cfpk_lineitem_part#4968,cpfk_partsupp_lineitem#4969,cfpk_lineitem_orders#4970,cval_lineitem_l_quantity#4971,cval_lineitem_l_extendedprice#4972,cval_lineitem_l_discount#4973,cval_lineitem_l_tax#4974,cval_lineitem_l_returnflag#4975,cval_lineitem_l_linestatus#4976,cval_lineitem_l_commitdate#4977,cval_lineitem_l_receiptdate#4978,cval_lineitem_l_shipinstruct#4979,cval_lineitem_l_shipmode#4980,cval_lineitem_l_comment#4981,cval_lineitem_l_shipdate#4982,cdepval_lineitem_l_quantity#4983,cdepval_lineitem_l_extendedprice#4984,cdepval_lineitem_l_discount#4985,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_3))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_3, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#5421, cpfk_region_nation_4#5422, cfpk_nation_region_4#5423, cval_nation_n_name_4#5424, cval_nation_n_comment_4#5425, cdepval_nation_n_name_4#5426, cdepval_nation_n_comment_4#5427, cn_name_4#5428, cn_comment_4#5429, 'rid_3]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~SAUDI ARABIA, cval_nation_n_name, 'cval_nation_n_name_4, tnation
            :  :  +- Project [rid#5412 AS rid_4#5421, cpfk_region_nation#5413 AS cpfk_region_nation_4#5422, cfpk_nation_region#5414 AS cfpk_nation_region_4#5423, cval_nation_n_name#5415 AS cval_nation_n_name_4#5424, cval_nation_n_comment#5416 AS cval_nation_n_comment_4#5425, cdepval_nation_n_name#5417 AS cdepval_nation_n_name_4#5426, cdepval_nation_n_comment#5418 AS cdepval_nation_n_comment_4#5427, cn_name#5419 AS cn_name_4#5428, cn_comment#5420 AS cn_comment_4#5429]
            :  :     +- Relation[rid#5412,cpfk_region_nation#5413,cfpk_nation_region#5414,cval_nation_n_name#5415,cval_nation_n_comment#5416,cdepval_nation_n_name#5417,cdepval_nation_n_comment#5418,cn_name#5419,cn_comment#5420] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_3, 'rid_3]
            :     +- Project [rid#5466 AS rid_3#5484, cpfk_nation_supplier#5467 AS cpfk_nation_supplier_3#5485, cfpk_supplier_nation#5468 AS cfpk_supplier_nation_3#5486, cval_supplier_s_name#5469 AS cval_supplier_s_name_3#5487, cval_supplier_s_address#5470 AS cval_supplier_s_address_3#5488, cval_supplier_s_phone#5471 AS cval_supplier_s_phone_3#5489, cval_supplier_s_acctbal#5472 AS cval_supplier_s_acctbal_3#5490, cval_supplier_s_comment#5473 AS cval_supplier_s_comment_3#5491, cdepval_supplier_s_name#5474 AS cdepval_supplier_s_name_3#5492, cdepval_supplier_s_address#5475 AS cdepval_supplier_s_address_3#5493, cdepval_supplier_s_phone#5476 AS cdepval_supplier_s_phone_3#5494, cdepval_supplier_s_acctbal#5477 AS cdepval_supplier_s_acctbal_3#5495, cdepval_supplier_s_comment#5478 AS cdepval_supplier_s_comment_3#5496, cs_name#5479 AS cs_name_3#5497, cs_address#5480 AS cs_address_3#5498, cs_phone#5481 AS cs_phone_3#5499, cs_acctbal#5482 AS cs_acctbal_3#5500, cs_comment#5483 AS cs_comment_3#5501]
            :        +- Relation[rid#5466,cpfk_nation_supplier#5467,cfpk_supplier_nation#5468,cval_supplier_s_name#5469,cval_supplier_s_address#5470,cval_supplier_s_phone#5471,cval_supplier_s_acctbal#5472,cval_supplier_s_comment#5473,cdepval_supplier_s_name#5474,cdepval_supplier_s_address#5475,cdepval_supplier_s_phone#5476,cdepval_supplier_s_acctbal#5477,cdepval_supplier_s_comment#5478,cs_name#5479,cs_address#5480,cs_phone#5481,cs_acctbal#5482,cs_comment#5483] JDBCRelation(tsupplier) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_3)
               :- 'Join UsingJoin(Inner,List(rid_2))
               :  :- 'DexPkfkMaterializationAwareJoin orders~lineitem, 'cpfk_orders_lineitem_2, 'rid_1, NotMaterialized, NotMaterialized, [rid_1#5076, cpfk_customer_orders_1#5077, cfpk_orders_customer_1#5078, cval_orders_o_orderstatus_1#5079, cval_orders_o_totalprice_1#5080, cval_orders_o_orderpriority_1#5081, cval_orders_o_clerk_1#5082, cval_orders_o_shippriority_1#5083, cval_orders_o_comment_1#5084, cval_orders_o_orderdate_1#5085, cdepval_orders_o_orderstatus_1#5086, cdepval_orders_o_totalprice_1#5087, cdepval_orders_o_orderpriority_1#5088, cdepval_orders_o_clerk_1#5089, cdepval_orders_o_shippriority_1#5090, cdepval_orders_o_comment_1#5091, cdepval_orders_o_orderdate_1#5092, co_orderstatus_1#5093, co_totalprice_1#5094, co_orderpriority_1#5095, co_clerk_1#5096, co_shippriority_1#5097, co_comment_1#5098, co_orderdate_1#5099, 'rid_2]
               :  :  :- 'DexPseudoPrimaryKeyFilter orders~o_orderstatus~F, cval_orders_o_orderstatus, 'cval_orders_o_orderstatus_1, torders
               :  :  :  +- Project [rid#5052 AS rid_1#5076, cpfk_customer_orders#5053 AS cpfk_customer_orders_1#5077, cfpk_orders_customer#5054 AS cfpk_orders_customer_1#5078, cval_orders_o_orderstatus#5055 AS cval_orders_o_orderstatus_1#5079, cval_orders_o_totalprice#5056 AS cval_orders_o_totalprice_1#5080, cval_orders_o_orderpriority#5057 AS cval_orders_o_orderpriority_1#5081, cval_orders_o_clerk#5058 AS cval_orders_o_clerk_1#5082, cval_orders_o_shippriority#5059 AS cval_orders_o_shippriority_1#5083, cval_orders_o_comment#5060 AS cval_orders_o_comment_1#5084, cval_orders_o_orderdate#5061 AS cval_orders_o_orderdate_1#5085, cdepval_orders_o_orderstatus#5062 AS cdepval_orders_o_orderstatus_1#5086, cdepval_orders_o_totalprice#5063 AS cdepval_orders_o_totalprice_1#5087, cdepval_orders_o_orderpriority#5064 AS cdepval_orders_o_orderpriority_1#5088, cdepval_orders_o_clerk#5065 AS cdepval_orders_o_clerk_1#5089, cdepval_orders_o_shippriority#5066 AS cdepval_orders_o_shippriority_1#5090, cdepval_orders_o_comment#5067 AS cdepval_orders_o_comment_1#5091, cdepval_orders_o_orderdate#5068 AS cdepval_orders_o_orderdate_1#5092, co_orderstatus#5069 AS co_orderstatus_1#5093, co_totalprice#5070 AS co_totalprice_1#5094, co_orderpriority#5071 AS co_orderpriority_1#5095, co_clerk#5072 AS co_clerk_1#5096, co_shippriority#5073 AS co_shippriority_1#5097, co_comment#5074 AS co_comment_1#5098, co_orderdate#5075 AS co_orderdate_1#5099]
               :  :  :     +- Relation[rid#5052,cpfk_customer_orders#5053,cfpk_orders_customer#5054,cval_orders_o_orderstatus#5055,cval_orders_o_totalprice#5056,cval_orders_o_orderpriority#5057,cval_orders_o_clerk#5058,cval_orders_o_shippriority#5059,cval_orders_o_comment#5060,cval_orders_o_orderdate#5061,cdepval_orders_o_orderstatus#5062,cdepval_orders_o_totalprice#5063,cdepval_orders_o_orderpriority#5064,cdepval_orders_o_clerk#5065,cdepval_orders_o_shippriority#5066,cdepval_orders_o_comment#5067,cdepval_orders_o_orderdate#5068,co_orderstatus#5069,co_totalprice#5070,co_orderpriority#5071,co_clerk#5072,co_shippriority#5073,co_comment#5074,co_orderdate#5075] JDBCRelation(torders) [numPartitions=1]
               :  :  +- 'Project ['cpfk_orders_lineitem_2, 'rid_2]
               :  :     +- Project [rid#5286 AS rid_2#5331, cpfk_orders_lineitem#5287 AS cpfk_orders_lineitem_2#5332, cpfk_supplier_lineitem#5288 AS cpfk_supplier_lineitem_2#5333, cfpk_lineitem_supplier#5289 AS cfpk_lineitem_supplier_2#5334, cfpk_lineitem_partsupp#5290 AS cfpk_lineitem_partsupp_2#5335, cpfk_part_lineitem#5291 AS cpfk_part_lineitem_2#5336, cfpk_lineitem_part#5292 AS cfpk_lineitem_part_2#5337, cpfk_partsupp_lineitem#5293 AS cpfk_partsupp_lineitem_2#5338, cfpk_lineitem_orders#5294 AS cfpk_lineitem_orders_2#5339, cval_lineitem_l_quantity#5295 AS cval_lineitem_l_quantity_2#5340, cval_lineitem_l_extendedprice#5296 AS cval_lineitem_l_extendedprice_2#5341, cval_lineitem_l_discount#5297 AS cval_lineitem_l_discount_2#5342, cval_lineitem_l_tax#5298 AS cval_lineitem_l_tax_2#5343, cval_lineitem_l_returnflag#5299 AS cval_lineitem_l_returnflag_2#5344, cval_lineitem_l_linestatus#5300 AS cval_lineitem_l_linestatus_2#5345, cval_lineitem_l_commitdate#5301 AS cval_lineitem_l_commitdate_2#5346, cval_lineitem_l_receiptdate#5302 AS cval_lineitem_l_receiptdate_2#5347, cval_lineitem_l_shipinstruct#5303 AS cval_lineitem_l_shipinstruct_2#5348, cval_lineitem_l_shipmode#5304 AS cval_lineitem_l_shipmode_2#5349, cval_lineitem_l_comment#5305 AS cval_lineitem_l_comment_2#5350, cval_lineitem_l_shipdate#5306 AS cval_lineitem_l_shipdate_2#5351, cdepval_lineitem_l_quantity#5307 AS cdepval_lineitem_l_quantity_2#5352, cdepval_lineitem_l_extendedprice#5308 AS cdepval_lineitem_l_extendedprice_2#5353, cdepval_lineitem_l_discount#5309 AS cdepval_lineitem_l_discount_2#5354, ... 21 more fields]
               :  :        +- Relation[rid#5286,cpfk_orders_lineitem#5287,cpfk_supplier_lineitem#5288,cfpk_lineitem_supplier#5289,cfpk_lineitem_partsupp#5290,cpfk_part_lineitem#5291,cfpk_lineitem_part#5292,cpfk_partsupp_lineitem#5293,cfpk_lineitem_orders#5294,cval_lineitem_l_quantity#5295,cval_lineitem_l_extendedprice#5296,cval_lineitem_l_discount#5297,cval_lineitem_l_tax#5298,cval_lineitem_l_returnflag#5299,cval_lineitem_l_linestatus#5300,cval_lineitem_l_commitdate#5301,cval_lineitem_l_receiptdate#5302,cval_lineitem_l_shipinstruct#5303,cval_lineitem_l_shipmode#5304,cval_lineitem_l_comment#5305,cval_lineitem_l_shipdate#5306,cdepval_lineitem_l_quantity#5307,cdepval_lineitem_l_extendedprice#5308,cdepval_lineitem_l_discount#5309,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               :  +- Project [rid#5148 AS rid_2#5193, cpfk_orders_lineitem#5149 AS cpfk_orders_lineitem_2#5194, cpfk_supplier_lineitem#5150 AS cpfk_supplier_lineitem_2#5195, cfpk_lineitem_supplier#5151 AS cfpk_lineitem_supplier_2#5196, cfpk_lineitem_partsupp#5152 AS cfpk_lineitem_partsupp_2#5197, cpfk_part_lineitem#5153 AS cpfk_part_lineitem_2#5198, cfpk_lineitem_part#5154 AS cfpk_lineitem_part_2#5199, cpfk_partsupp_lineitem#5155 AS cpfk_partsupp_lineitem_2#5200, cfpk_lineitem_orders#5156 AS cfpk_lineitem_orders_2#5201, cval_lineitem_l_quantity#5157 AS cval_lineitem_l_quantity_2#5202, cval_lineitem_l_extendedprice#5158 AS cval_lineitem_l_extendedprice_2#5203, cval_lineitem_l_discount#5159 AS cval_lineitem_l_discount_2#5204, cval_lineitem_l_tax#5160 AS cval_lineitem_l_tax_2#5205, cval_lineitem_l_returnflag#5161 AS cval_lineitem_l_returnflag_2#5206, cval_lineitem_l_linestatus#5162 AS cval_lineitem_l_linestatus_2#5207, cval_lineitem_l_commitdate#5163 AS cval_lineitem_l_commitdate_2#5208, cval_lineitem_l_receiptdate#5164 AS cval_lineitem_l_receiptdate_2#5209, cval_lineitem_l_shipinstruct#5165 AS cval_lineitem_l_shipinstruct_2#5210, cval_lineitem_l_shipmode#5166 AS cval_lineitem_l_shipmode_2#5211, cval_lineitem_l_comment#5167 AS cval_lineitem_l_comment_2#5212, cval_lineitem_l_shipdate#5168 AS cval_lineitem_l_shipdate_2#5213, cdepval_lineitem_l_quantity#5169 AS cdepval_lineitem_l_quantity_2#5214, cdepval_lineitem_l_extendedprice#5170 AS cdepval_lineitem_l_extendedprice_2#5215, cdepval_lineitem_l_discount#5171 AS cdepval_lineitem_l_discount_2#5216, ... 21 more fields]
               :     +- Relation[rid#5148,cpfk_orders_lineitem#5149,cpfk_supplier_lineitem#5150,cfpk_lineitem_supplier#5151,cfpk_lineitem_partsupp#5152,cpfk_part_lineitem#5153,cfpk_lineitem_part#5154,cpfk_partsupp_lineitem#5155,cfpk_lineitem_orders#5156,cval_lineitem_l_quantity#5157,cval_lineitem_l_extendedprice#5158,cval_lineitem_l_discount#5159,cval_lineitem_l_tax#5160,cval_lineitem_l_returnflag#5161,cval_lineitem_l_linestatus#5162,cval_lineitem_l_commitdate#5163,cval_lineitem_l_receiptdate#5164,cval_lineitem_l_shipinstruct#5165,cval_lineitem_l_shipmode#5166,cval_lineitem_l_comment#5167,cval_lineitem_l_shipdate#5168,cdepval_lineitem_l_quantity#5169,cdepval_lineitem_l_extendedprice#5170,cdepval_lineitem_l_discount#5171,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
               +- Project [rid#5376 AS rid_3#5394, cpfk_nation_supplier#5377 AS cpfk_nation_supplier_3#5395, cfpk_supplier_nation#5378 AS cfpk_supplier_nation_3#5396, cval_supplier_s_name#5379 AS cval_supplier_s_name_3#5397, cval_supplier_s_address#5380 AS cval_supplier_s_address_3#5398, cval_supplier_s_phone#5381 AS cval_supplier_s_phone_3#5399, cval_supplier_s_acctbal#5382 AS cval_supplier_s_acctbal_3#5400, cval_supplier_s_comment#5383 AS cval_supplier_s_comment_3#5401, cdepval_supplier_s_name#5384 AS cdepval_supplier_s_name_3#5402, cdepval_supplier_s_address#5385 AS cdepval_supplier_s_address_3#5403, cdepval_supplier_s_phone#5386 AS cdepval_supplier_s_phone_3#5404, cdepval_supplier_s_acctbal#5387 AS cdepval_supplier_s_acctbal_3#5405, cdepval_supplier_s_comment#5388 AS cdepval_supplier_s_comment_3#5406, cs_name#5389 AS cs_name_3#5407, cs_address#5390 AS cs_address_3#5408, cs_phone#5391 AS cs_phone_3#5409, cs_acctbal#5392 AS cs_acctbal_3#5410, cs_comment#5393 AS cs_comment_3#5411]
                  +- Relation[rid#5376,cpfk_nation_supplier#5377,cfpk_supplier_nation#5378,cval_supplier_s_name#5379,cval_supplier_s_address#5380,cval_supplier_s_phone#5381,cval_supplier_s_acctbal#5382,cval_supplier_s_comment#5383,cdepval_supplier_s_name#5384,cdepval_supplier_s_address#5385,cdepval_supplier_s_phone#5386,cdepval_supplier_s_acctbal#5387,cdepval_supplier_s_comment#5388,cs_name#5389,cs_address#5390,cs_phone#5391,cs_acctbal#5392,cs_comment#5393] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=597422
Elapsed time: 158873ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
20/04/26 21:35:16 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:35:16 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5649L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:16 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:35:16 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5649L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :- Project [rid#5777 AS rid_2#5791, cpfk_part_partsupp#5778 AS cpfk_part_partsupp_2#5792, cfpk_partsupp_part#5779 AS cfpk_partsupp_part_2#5793, cpfk_supplier_partsupp#5780 AS cpfk_supplier_partsupp_2#5794, cfpk_partsupp_supplier#5781 AS cfpk_partsupp_supplier_2#5795, cval_partsupp_ps_availqty#5782 AS cval_partsupp_ps_availqty_2#5796, cval_partsupp_ps_supplycost#5783 AS cval_partsupp_ps_supplycost_2#5797, cval_partsupp_ps_comment#5784 AS cval_partsupp_ps_comment_2#5798, cdepval_partsupp_ps_availqty#5785 AS cdepval_partsupp_ps_availqty_2#5799, cdepval_partsupp_ps_supplycost#5786 AS cdepval_partsupp_ps_supplycost_2#5800, cdepval_partsupp_ps_comment#5787 AS cdepval_partsupp_ps_comment_2#5801, cps_availqty#5788 AS cps_availqty_2#5802, cps_supplycost#5789 AS cps_supplycost_2#5803, cps_comment#5790 AS cps_comment_2#5804]
         :  +- Relation[rid#5777,cpfk_part_partsupp#5778,cfpk_partsupp_part#5779,cpfk_supplier_partsupp#5780,cfpk_partsupp_supplier#5781,cval_partsupp_ps_availqty#5782,cval_partsupp_ps_supplycost#5783,cval_partsupp_ps_comment#5784,cdepval_partsupp_ps_availqty#5785,cdepval_partsupp_ps_supplycost#5786,cdepval_partsupp_ps_comment#5787,cps_availqty#5788,cps_supplycost#5789,cps_comment#5790] JDBCRelation(tpartsupp) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_1))
            :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#5660, cpfk_region_nation_0#5661, cfpk_nation_region_0#5662, cval_nation_n_name_0#5663, cval_nation_n_comment_0#5664, cdepval_nation_n_name_0#5665, cdepval_nation_n_comment_0#5666, cn_name_0#5667, cn_comment_0#5668, 'rid_1]
            :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_0, tnation
            :  :  +- Project [rid#5651 AS rid_0#5660, cpfk_region_nation#5652 AS cpfk_region_nation_0#5661, cfpk_nation_region#5653 AS cfpk_nation_region_0#5662, cval_nation_n_name#5654 AS cval_nation_n_name_0#5663, cval_nation_n_comment#5655 AS cval_nation_n_comment_0#5664, cdepval_nation_n_name#5656 AS cdepval_nation_n_name_0#5665, cdepval_nation_n_comment#5657 AS cdepval_nation_n_comment_0#5666, cn_name#5658 AS cn_name_0#5667, cn_comment#5659 AS cn_comment_0#5668]
            :  :     +- Relation[rid#5651,cpfk_region_nation#5652,cfpk_nation_region#5653,cval_nation_n_name#5654,cval_nation_n_comment#5655,cdepval_nation_n_name#5656,cdepval_nation_n_comment#5657,cn_name#5658,cn_comment#5659] JDBCRelation(tnation) [numPartitions=1]
            :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
            :     +- Project [rid#5741 AS rid_1#5759, cpfk_nation_supplier#5742 AS cpfk_nation_supplier_1#5760, cfpk_supplier_nation#5743 AS cfpk_supplier_nation_1#5761, cval_supplier_s_name#5744 AS cval_supplier_s_name_1#5762, cval_supplier_s_address#5745 AS cval_supplier_s_address_1#5763, cval_supplier_s_phone#5746 AS cval_supplier_s_phone_1#5764, cval_supplier_s_acctbal#5747 AS cval_supplier_s_acctbal_1#5765, cval_supplier_s_comment#5748 AS cval_supplier_s_comment_1#5766, cdepval_supplier_s_name#5749 AS cdepval_supplier_s_name_1#5767, cdepval_supplier_s_address#5750 AS cdepval_supplier_s_address_1#5768, cdepval_supplier_s_phone#5751 AS cdepval_supplier_s_phone_1#5769, cdepval_supplier_s_acctbal#5752 AS cdepval_supplier_s_acctbal_1#5770, cdepval_supplier_s_comment#5753 AS cdepval_supplier_s_comment_1#5771, cs_name#5754 AS cs_name_1#5772, cs_address#5755 AS cs_address_1#5773, cs_phone#5756 AS cs_phone_1#5774, cs_acctbal#5757 AS cs_acctbal_1#5775, cs_comment#5758 AS cs_comment_1#5776]
            :        +- Relation[rid#5741,cpfk_nation_supplier#5742,cfpk_supplier_nation#5743,cval_supplier_s_name#5744,cval_supplier_s_address#5745,cval_supplier_s_phone#5746,cval_supplier_s_acctbal#5747,cval_supplier_s_comment#5748,cdepval_supplier_s_name#5749,cdepval_supplier_s_address#5750,cdepval_supplier_s_phone#5751,cdepval_supplier_s_acctbal#5752,cdepval_supplier_s_comment#5753,cs_name#5754,cs_address#5755,cs_phone#5756,cs_acctbal#5757,cs_comment#5758] JDBCRelation(tsupplier) [numPartitions=1]
            +- Project [rid#5687 AS rid_1#5705, cpfk_nation_supplier#5688 AS cpfk_nation_supplier_1#5706, cfpk_supplier_nation#5689 AS cfpk_supplier_nation_1#5707, cval_supplier_s_name#5690 AS cval_supplier_s_name_1#5708, cval_supplier_s_address#5691 AS cval_supplier_s_address_1#5709, cval_supplier_s_phone#5692 AS cval_supplier_s_phone_1#5710, cval_supplier_s_acctbal#5693 AS cval_supplier_s_acctbal_1#5711, cval_supplier_s_comment#5694 AS cval_supplier_s_comment_1#5712, cdepval_supplier_s_name#5695 AS cdepval_supplier_s_name_1#5713, cdepval_supplier_s_address#5696 AS cdepval_supplier_s_address_1#5714, cdepval_supplier_s_phone#5697 AS cdepval_supplier_s_phone_1#5715, cdepval_supplier_s_acctbal#5698 AS cdepval_supplier_s_acctbal_1#5716, cdepval_supplier_s_comment#5699 AS cdepval_supplier_s_comment_1#5717, cs_name#5700 AS cs_name_1#5718, cs_address#5701 AS cs_address_1#5719, cs_phone#5702 AS cs_phone_1#5720, cs_acctbal#5703 AS cs_acctbal_1#5721, cs_comment#5704 AS cs_comment_1#5722]
               +- Relation[rid#5687,cpfk_nation_supplier#5688,cfpk_supplier_nation#5689,cval_supplier_s_name#5690,cval_supplier_s_address#5691,cval_supplier_s_phone#5692,cval_supplier_s_acctbal#5693,cval_supplier_s_comment#5694,cdepval_supplier_s_name#5695,cdepval_supplier_s_address#5696,cdepval_supplier_s_phone#5697,cdepval_supplier_s_acctbal#5698,cdepval_supplier_s_comment#5699,cs_name#5700,cs_address#5701,cs_phone#5702,cs_acctbal#5703,cs_comment#5704] JDBCRelation(tsupplier) [numPartitions=1]

DexPkFk$ result size=31680
Elapsed time: 2542ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
20/04/26 21:35:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:35:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#5874L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:35:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#5874L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :- Project [rid#5876 AS rid_0#5921, cpfk_orders_lineitem#5877 AS cpfk_orders_lineitem_0#5922, cpfk_supplier_lineitem#5878 AS cpfk_supplier_lineitem_0#5923, cfpk_lineitem_supplier#5879 AS cfpk_lineitem_supplier_0#5924, cfpk_lineitem_partsupp#5880 AS cfpk_lineitem_partsupp_0#5925, cpfk_part_lineitem#5881 AS cpfk_part_lineitem_0#5926, cfpk_lineitem_part#5882 AS cfpk_lineitem_part_0#5927, cpfk_partsupp_lineitem#5883 AS cpfk_partsupp_lineitem_0#5928, cfpk_lineitem_orders#5884 AS cfpk_lineitem_orders_0#5929, cval_lineitem_l_quantity#5885 AS cval_lineitem_l_quantity_0#5930, cval_lineitem_l_extendedprice#5886 AS cval_lineitem_l_extendedprice_0#5931, cval_lineitem_l_discount#5887 AS cval_lineitem_l_discount_0#5932, cval_lineitem_l_tax#5888 AS cval_lineitem_l_tax_0#5933, cval_lineitem_l_returnflag#5889 AS cval_lineitem_l_returnflag_0#5934, cval_lineitem_l_linestatus#5890 AS cval_lineitem_l_linestatus_0#5935, cval_lineitem_l_commitdate#5891 AS cval_lineitem_l_commitdate_0#5936, cval_lineitem_l_receiptdate#5892 AS cval_lineitem_l_receiptdate_0#5937, cval_lineitem_l_shipinstruct#5893 AS cval_lineitem_l_shipinstruct_0#5938, cval_lineitem_l_shipmode#5894 AS cval_lineitem_l_shipmode_0#5939, cval_lineitem_l_comment#5895 AS cval_lineitem_l_comment_0#5940, cval_lineitem_l_shipdate#5896 AS cval_lineitem_l_shipdate_0#5941, cdepval_lineitem_l_quantity#5897 AS cdepval_lineitem_l_quantity_0#5942, cdepval_lineitem_l_extendedprice#5898 AS cdepval_lineitem_l_extendedprice_0#5943, cdepval_lineitem_l_discount#5899 AS cdepval_lineitem_l_discount_0#5944, ... 21 more fields]
         :  +- Relation[rid#5876,cpfk_orders_lineitem#5877,cpfk_supplier_lineitem#5878,cfpk_lineitem_supplier#5879,cfpk_lineitem_partsupp#5880,cpfk_part_lineitem#5881,cfpk_lineitem_part#5882,cpfk_partsupp_lineitem#5883,cfpk_lineitem_orders#5884,cval_lineitem_l_quantity#5885,cval_lineitem_l_extendedprice#5886,cval_lineitem_l_discount#5887,cval_lineitem_l_tax#5888,cval_lineitem_l_returnflag#5889,cval_lineitem_l_linestatus#5890,cval_lineitem_l_commitdate#5891,cval_lineitem_l_receiptdate#5892,cval_lineitem_l_shipinstruct#5893,cval_lineitem_l_shipmode#5894,cval_lineitem_l_comment#5895,cval_lineitem_l_shipdate#5896,cdepval_lineitem_l_quantity#5897,cdepval_lineitem_l_extendedprice#5898,cdepval_lineitem_l_discount#5899,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#5966 AS rid_1#5990, cpfk_customer_orders#5967 AS cpfk_customer_orders_1#5991, cfpk_orders_customer#5968 AS cfpk_orders_customer_1#5992, cval_orders_o_orderstatus#5969 AS cval_orders_o_orderstatus_1#5993, cval_orders_o_totalprice#5970 AS cval_orders_o_totalprice_1#5994, cval_orders_o_orderpriority#5971 AS cval_orders_o_orderpriority_1#5995, cval_orders_o_clerk#5972 AS cval_orders_o_clerk_1#5996, cval_orders_o_shippriority#5973 AS cval_orders_o_shippriority_1#5997, cval_orders_o_comment#5974 AS cval_orders_o_comment_1#5998, cval_orders_o_orderdate#5975 AS cval_orders_o_orderdate_1#5999, cdepval_orders_o_orderstatus#5976 AS cdepval_orders_o_orderstatus_1#6000, cdepval_orders_o_totalprice#5977 AS cdepval_orders_o_totalprice_1#6001, cdepval_orders_o_orderpriority#5978 AS cdepval_orders_o_orderpriority_1#6002, cdepval_orders_o_clerk#5979 AS cdepval_orders_o_clerk_1#6003, cdepval_orders_o_shippriority#5980 AS cdepval_orders_o_shippriority_1#6004, cdepval_orders_o_comment#5981 AS cdepval_orders_o_comment_1#6005, cdepval_orders_o_orderdate#5982 AS cdepval_orders_o_orderdate_1#6006, co_orderstatus#5983 AS co_orderstatus_1#6007, co_totalprice#5984 AS co_totalprice_1#6008, co_orderpriority#5985 AS co_orderpriority_1#6009, co_clerk#5986 AS co_clerk_1#6010, co_shippriority#5987 AS co_shippriority_1#6011, co_comment#5988 AS co_comment_1#6012, co_orderdate#5989 AS co_orderdate_1#6013]
            +- Relation[rid#5966,cpfk_customer_orders#5967,cfpk_orders_customer#5968,cval_orders_o_orderstatus#5969,cval_orders_o_totalprice#5970,cval_orders_o_orderpriority#5971,cval_orders_o_clerk#5972,cval_orders_o_shippriority#5973,cval_orders_o_comment#5974,cval_orders_o_orderdate#5975,cdepval_orders_o_orderstatus#5976,cdepval_orders_o_totalprice#5977,cdepval_orders_o_orderpriority#5978,cdepval_orders_o_clerk#5979,cdepval_orders_o_shippriority#5980,cdepval_orders_o_comment#5981,cdepval_orders_o_orderdate#5982,co_orderstatus#5983,co_totalprice#5984,co_orderpriority#5985,co_clerk#5986,co_shippriority#5987,co_comment#5988,co_orderdate#5989] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 18378ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
20/04/26 21:35:37 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:35:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6090L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#946L = c_nationkey#293L)
               :     :- Project [n_nationkey#946L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#948L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#946L, n_regionkey#948L]
               :     :        +- Relation[n_nationkey#946L,n_name#947,n_regionkey#948L,n_comment#949] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=region
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:37 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:35:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6090L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_orders_1) = 'rid_7)
         :- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_2, BinaryType)), 'cfpk_supplier_nation_2) = 'rid_3)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_supplier_1) = 'rid_2)
         :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6117, cval_part_p_name_0#6118, cval_part_p_mfgr_0#6119, cval_part_p_type_0#6120, cval_part_p_size_0#6121, cval_part_p_container_0#6122, cval_part_p_retailprice_0#6123, cval_part_p_comment_0#6124, cval_part_p_brand_0#6125, cdepval_part_p_name_0#6126, cdepval_part_p_mfgr_0#6127, cdepval_part_p_type_0#6128, cdepval_part_p_size_0#6129, cdepval_part_p_container_0#6130, cdepval_part_p_retailprice_0#6131, cdepval_part_p_comment_0#6132, cdepval_part_p_brand_0#6133, cp_name_0#6134, cp_mfgr_0#6135, cp_type_0#6136, cp_size_0#6137, cp_container_0#6138, cp_retailprice_0#6139, cp_comment_0#6140, ... 2 more fields]
         :  :  :  :  :- 'DexPseudoPrimaryKeyFilter part~p_type~ECONOMY ANODIZED STEEL, cval_part_p_type, 'cval_part_p_type_0, tpart
         :  :  :  :  :  +- Project [rid#6092 AS rid_0#6117, cval_part_p_name#6093 AS cval_part_p_name_0#6118, cval_part_p_mfgr#6094 AS cval_part_p_mfgr_0#6119, cval_part_p_type#6095 AS cval_part_p_type_0#6120, cval_part_p_size#6096 AS cval_part_p_size_0#6121, cval_part_p_container#6097 AS cval_part_p_container_0#6122, cval_part_p_retailprice#6098 AS cval_part_p_retailprice_0#6123, cval_part_p_comment#6099 AS cval_part_p_comment_0#6124, cval_part_p_brand#6100 AS cval_part_p_brand_0#6125, cdepval_part_p_name#6101 AS cdepval_part_p_name_0#6126, cdepval_part_p_mfgr#6102 AS cdepval_part_p_mfgr_0#6127, cdepval_part_p_type#6103 AS cdepval_part_p_type_0#6128, cdepval_part_p_size#6104 AS cdepval_part_p_size_0#6129, cdepval_part_p_container#6105 AS cdepval_part_p_container_0#6130, cdepval_part_p_retailprice#6106 AS cdepval_part_p_retailprice_0#6131, cdepval_part_p_comment#6107 AS cdepval_part_p_comment_0#6132, cdepval_part_p_brand#6108 AS cdepval_part_p_brand_0#6133, cp_name#6109 AS cp_name_0#6134, cp_mfgr#6110 AS cp_mfgr_0#6135, cp_type#6111 AS cp_type_0#6136, cp_size#6112 AS cp_size_0#6137, cp_container#6113 AS cp_container_0#6138, cp_retailprice#6114 AS cp_retailprice_0#6139, cp_comment#6115 AS cp_comment_0#6140, cp_brand#6116 AS cp_brand_0#6141]
         :  :  :  :  :     +- Relation[rid#6092,cval_part_p_name#6093,cval_part_p_mfgr#6094,cval_part_p_type#6095,cval_part_p_size#6096,cval_part_p_container#6097,cval_part_p_retailprice#6098,cval_part_p_comment#6099,cval_part_p_brand#6100,cdepval_part_p_name#6101,cdepval_part_p_mfgr#6102,cdepval_part_p_type#6103,cdepval_part_p_size#6104,cdepval_part_p_container#6105,cdepval_part_p_retailprice#6106,cdepval_part_p_comment#6107,cdepval_part_p_brand#6108,cp_name#6109,cp_mfgr#6110,cp_type#6111,cp_size#6112,cp_container#6113,cp_retailprice#6114,cp_comment#6115,cp_brand#6116] JDBCRelation(tpart) [numPartitions=1]
         :  :  :  :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :  :  :  :     +- Project [rid#6332 AS rid_1#6377, cpfk_orders_lineitem#6333 AS cpfk_orders_lineitem_1#6378, cpfk_supplier_lineitem#6334 AS cpfk_supplier_lineitem_1#6379, cfpk_lineitem_supplier#6335 AS cfpk_lineitem_supplier_1#6380, cfpk_lineitem_partsupp#6336 AS cfpk_lineitem_partsupp_1#6381, cpfk_part_lineitem#6337 AS cpfk_part_lineitem_1#6382, cfpk_lineitem_part#6338 AS cfpk_lineitem_part_1#6383, cpfk_partsupp_lineitem#6339 AS cpfk_partsupp_lineitem_1#6384, cfpk_lineitem_orders#6340 AS cfpk_lineitem_orders_1#6385, cval_lineitem_l_quantity#6341 AS cval_lineitem_l_quantity_1#6386, cval_lineitem_l_extendedprice#6342 AS cval_lineitem_l_extendedprice_1#6387, cval_lineitem_l_discount#6343 AS cval_lineitem_l_discount_1#6388, cval_lineitem_l_tax#6344 AS cval_lineitem_l_tax_1#6389, cval_lineitem_l_returnflag#6345 AS cval_lineitem_l_returnflag_1#6390, cval_lineitem_l_linestatus#6346 AS cval_lineitem_l_linestatus_1#6391, cval_lineitem_l_commitdate#6347 AS cval_lineitem_l_commitdate_1#6392, cval_lineitem_l_receiptdate#6348 AS cval_lineitem_l_receiptdate_1#6393, cval_lineitem_l_shipinstruct#6349 AS cval_lineitem_l_shipinstruct_1#6394, cval_lineitem_l_shipmode#6350 AS cval_lineitem_l_shipmode_1#6395, cval_lineitem_l_comment#6351 AS cval_lineitem_l_comment_1#6396, cval_lineitem_l_shipdate#6352 AS cval_lineitem_l_shipdate_1#6397, cdepval_lineitem_l_quantity#6353 AS cdepval_lineitem_l_quantity_1#6398, cdepval_lineitem_l_extendedprice#6354 AS cdepval_lineitem_l_extendedprice_1#6399, cdepval_lineitem_l_discount#6355 AS cdepval_lineitem_l_discount_1#6400, ... 21 more fields]
         :  :  :  :        +- Relation[rid#6332,cpfk_orders_lineitem#6333,cpfk_supplier_lineitem#6334,cfpk_lineitem_supplier#6335,cfpk_lineitem_partsupp#6336,cpfk_part_lineitem#6337,cfpk_lineitem_part#6338,cpfk_partsupp_lineitem#6339,cfpk_lineitem_orders#6340,cval_lineitem_l_quantity#6341,cval_lineitem_l_extendedprice#6342,cval_lineitem_l_discount#6343,cval_lineitem_l_tax#6344,cval_lineitem_l_returnflag#6345,cval_lineitem_l_linestatus#6346,cval_lineitem_l_commitdate#6347,cval_lineitem_l_receiptdate#6348,cval_lineitem_l_shipinstruct#6349,cval_lineitem_l_shipmode#6350,cval_lineitem_l_comment#6351,cval_lineitem_l_shipdate#6352,cdepval_lineitem_l_quantity#6353,cdepval_lineitem_l_extendedprice#6354,cdepval_lineitem_l_discount#6355,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- Project [rid#6192 AS rid_1#6237, cpfk_orders_lineitem#6193 AS cpfk_orders_lineitem_1#6238, cpfk_supplier_lineitem#6194 AS cpfk_supplier_lineitem_1#6239, cfpk_lineitem_supplier#6195 AS cfpk_lineitem_supplier_1#6240, cfpk_lineitem_partsupp#6196 AS cfpk_lineitem_partsupp_1#6241, cpfk_part_lineitem#6197 AS cpfk_part_lineitem_1#6242, cfpk_lineitem_part#6198 AS cfpk_lineitem_part_1#6243, cpfk_partsupp_lineitem#6199 AS cpfk_partsupp_lineitem_1#6244, cfpk_lineitem_orders#6200 AS cfpk_lineitem_orders_1#6245, cval_lineitem_l_quantity#6201 AS cval_lineitem_l_quantity_1#6246, cval_lineitem_l_extendedprice#6202 AS cval_lineitem_l_extendedprice_1#6247, cval_lineitem_l_discount#6203 AS cval_lineitem_l_discount_1#6248, cval_lineitem_l_tax#6204 AS cval_lineitem_l_tax_1#6249, cval_lineitem_l_returnflag#6205 AS cval_lineitem_l_returnflag_1#6250, cval_lineitem_l_linestatus#6206 AS cval_lineitem_l_linestatus_1#6251, cval_lineitem_l_commitdate#6207 AS cval_lineitem_l_commitdate_1#6252, cval_lineitem_l_receiptdate#6208 AS cval_lineitem_l_receiptdate_1#6253, cval_lineitem_l_shipinstruct#6209 AS cval_lineitem_l_shipinstruct_1#6254, cval_lineitem_l_shipmode#6210 AS cval_lineitem_l_shipmode_1#6255, cval_lineitem_l_comment#6211 AS cval_lineitem_l_comment_1#6256, cval_lineitem_l_shipdate#6212 AS cval_lineitem_l_shipdate_1#6257, cdepval_lineitem_l_quantity#6213 AS cdepval_lineitem_l_quantity_1#6258, cdepval_lineitem_l_extendedprice#6214 AS cdepval_lineitem_l_extendedprice_1#6259, cdepval_lineitem_l_discount#6215 AS cdepval_lineitem_l_discount_1#6260, ... 21 more fields]
         :  :  :     +- Relation[rid#6192,cpfk_orders_lineitem#6193,cpfk_supplier_lineitem#6194,cfpk_lineitem_supplier#6195,cfpk_lineitem_partsupp#6196,cpfk_part_lineitem#6197,cfpk_lineitem_part#6198,cpfk_partsupp_lineitem#6199,cfpk_lineitem_orders#6200,cval_lineitem_l_quantity#6201,cval_lineitem_l_extendedprice#6202,cval_lineitem_l_discount#6203,cval_lineitem_l_tax#6204,cval_lineitem_l_returnflag#6205,cval_lineitem_l_linestatus#6206,cval_lineitem_l_commitdate#6207,cval_lineitem_l_receiptdate#6208,cval_lineitem_l_shipinstruct#6209,cval_lineitem_l_shipmode#6210,cval_lineitem_l_comment#6211,cval_lineitem_l_shipdate#6212,cdepval_lineitem_l_quantity#6213,cdepval_lineitem_l_extendedprice#6214,cdepval_lineitem_l_discount#6215,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#6422 AS rid_2#6440, cpfk_nation_supplier#6423 AS cpfk_nation_supplier_2#6441, cfpk_supplier_nation#6424 AS cfpk_supplier_nation_2#6442, cval_supplier_s_name#6425 AS cval_supplier_s_name_2#6443, cval_supplier_s_address#6426 AS cval_supplier_s_address_2#6444, cval_supplier_s_phone#6427 AS cval_supplier_s_phone_2#6445, cval_supplier_s_acctbal#6428 AS cval_supplier_s_acctbal_2#6446, cval_supplier_s_comment#6429 AS cval_supplier_s_comment_2#6447, cdepval_supplier_s_name#6430 AS cdepval_supplier_s_name_2#6448, cdepval_supplier_s_address#6431 AS cdepval_supplier_s_address_2#6449, cdepval_supplier_s_phone#6432 AS cdepval_supplier_s_phone_2#6450, cdepval_supplier_s_acctbal#6433 AS cdepval_supplier_s_acctbal_2#6451, cdepval_supplier_s_comment#6434 AS cdepval_supplier_s_comment_2#6452, cs_name#6435 AS cs_name_2#6453, cs_address#6436 AS cs_address_2#6454, cs_phone#6437 AS cs_phone_2#6455, cs_acctbal#6438 AS cs_acctbal_2#6456, cs_comment#6439 AS cs_comment_2#6457]
         :  :     +- Relation[rid#6422,cpfk_nation_supplier#6423,cfpk_supplier_nation#6424,cval_supplier_s_name#6425,cval_supplier_s_address#6426,cval_supplier_s_phone#6427,cval_supplier_s_acctbal#6428,cval_supplier_s_comment#6429,cdepval_supplier_s_name#6430,cdepval_supplier_s_address#6431,cdepval_supplier_s_phone#6432,cdepval_supplier_s_acctbal#6433,cdepval_supplier_s_comment#6434,cs_name#6435,cs_address#6436,cs_phone#6437,cs_acctbal#6438,cs_comment#6439] JDBCRelation(tsupplier) [numPartitions=1]
         :  +- Project [rid#6458 AS rid_3#6467, cpfk_region_nation#6459 AS cpfk_region_nation_3#6468, cfpk_nation_region#6460 AS cfpk_nation_region_3#6469, cval_nation_n_name#6461 AS cval_nation_n_name_3#6470, cval_nation_n_comment#6462 AS cval_nation_n_comment_3#6471, cdepval_nation_n_name#6463 AS cdepval_nation_n_name_3#6472, cdepval_nation_n_comment#6464 AS cdepval_nation_n_comment_3#6473, cn_name#6465 AS cn_name_3#6474, cn_comment#6466 AS cn_comment_3#6475]
         :     +- Relation[rid#6458,cpfk_region_nation#6459,cfpk_nation_region#6460,cval_nation_n_name#6461,cval_nation_n_comment#6462,cdepval_nation_n_name#6463,cdepval_nation_n_comment#6464,cn_name#6465,cn_comment#6466] JDBCRelation(tnation) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_7, BinaryType)), 'cfpk_orders_customer_7) = 'rid_6)
            :- Project [rid#6596 AS rid_7#6620, cpfk_customer_orders#6597 AS cpfk_customer_orders_7#6621, cfpk_orders_customer#6598 AS cfpk_orders_customer_7#6622, cval_orders_o_orderstatus#6599 AS cval_orders_o_orderstatus_7#6623, cval_orders_o_totalprice#6600 AS cval_orders_o_totalprice_7#6624, cval_orders_o_orderpriority#6601 AS cval_orders_o_orderpriority_7#6625, cval_orders_o_clerk#6602 AS cval_orders_o_clerk_7#6626, cval_orders_o_shippriority#6603 AS cval_orders_o_shippriority_7#6627, cval_orders_o_comment#6604 AS cval_orders_o_comment_7#6628, cval_orders_o_orderdate#6605 AS cval_orders_o_orderdate_7#6629, cdepval_orders_o_orderstatus#6606 AS cdepval_orders_o_orderstatus_7#6630, cdepval_orders_o_totalprice#6607 AS cdepval_orders_o_totalprice_7#6631, cdepval_orders_o_orderpriority#6608 AS cdepval_orders_o_orderpriority_7#6632, cdepval_orders_o_clerk#6609 AS cdepval_orders_o_clerk_7#6633, cdepval_orders_o_shippriority#6610 AS cdepval_orders_o_shippriority_7#6634, cdepval_orders_o_comment#6611 AS cdepval_orders_o_comment_7#6635, cdepval_orders_o_orderdate#6612 AS cdepval_orders_o_orderdate_7#6636, co_orderstatus#6613 AS co_orderstatus_7#6637, co_totalprice#6614 AS co_totalprice_7#6638, co_orderpriority#6615 AS co_orderpriority_7#6639, co_clerk#6616 AS co_clerk_7#6640, co_shippriority#6617 AS co_shippriority_7#6641, co_comment#6618 AS co_comment_7#6642, co_orderdate#6619 AS co_orderdate_7#6643]
            :  +- Relation[rid#6596,cpfk_customer_orders#6597,cfpk_orders_customer#6598,cval_orders_o_orderstatus#6599,cval_orders_o_totalprice#6600,cval_orders_o_orderpriority#6601,cval_orders_o_clerk#6602,cval_orders_o_shippriority#6603,cval_orders_o_comment#6604,cval_orders_o_orderdate#6605,cdepval_orders_o_orderstatus#6606,cdepval_orders_o_totalprice#6607,cdepval_orders_o_orderpriority#6608,cdepval_orders_o_clerk#6609,cdepval_orders_o_shippriority#6610,cdepval_orders_o_comment#6611,cdepval_orders_o_orderdate#6612,co_orderstatus#6613,co_totalprice#6614,co_orderpriority#6615,co_clerk#6616,co_shippriority#6617,co_comment#6618,co_orderdate#6619] JDBCRelation(torders) [numPartitions=1]
            +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_6, BinaryType)), 'cfpk_customer_nation_6) = 'rid_5)
               :- Project [rid#6554 AS rid_6#6575, cpfk_nation_customer#6555 AS cpfk_nation_customer_6#6576, cfpk_customer_nation#6556 AS cfpk_customer_nation_6#6577, cval_customer_c_name#6557 AS cval_customer_c_name_6#6578, cval_customer_c_address#6558 AS cval_customer_c_address_6#6579, cval_customer_c_phone#6559 AS cval_customer_c_phone_6#6580, cval_customer_c_acctbal#6560 AS cval_customer_c_acctbal_6#6581, cval_customer_c_comment#6561 AS cval_customer_c_comment_6#6582, cval_customer_c_mktsegment#6562 AS cval_customer_c_mktsegment_6#6583, cdepval_customer_c_name#6563 AS cdepval_customer_c_name_6#6584, cdepval_customer_c_address#6564 AS cdepval_customer_c_address_6#6585, cdepval_customer_c_phone#6565 AS cdepval_customer_c_phone_6#6586, cdepval_customer_c_acctbal#6566 AS cdepval_customer_c_acctbal_6#6587, cdepval_customer_c_comment#6567 AS cdepval_customer_c_comment_6#6588, cdepval_customer_c_mktsegment#6568 AS cdepval_customer_c_mktsegment_6#6589, cc_name#6569 AS cc_name_6#6590, cc_address#6570 AS cc_address_6#6591, cc_phone#6571 AS cc_phone_6#6592, cc_acctbal#6572 AS cc_acctbal_6#6593, cc_comment#6573 AS cc_comment_6#6594, cc_mktsegment#6574 AS cc_mktsegment_6#6595]
               :  +- Relation[rid#6554,cpfk_nation_customer#6555,cfpk_customer_nation#6556,cval_customer_c_name#6557,cval_customer_c_address#6558,cval_customer_c_phone#6559,cval_customer_c_acctbal#6560,cval_customer_c_comment#6561,cval_customer_c_mktsegment#6562,cdepval_customer_c_name#6563,cdepval_customer_c_address#6564,cdepval_customer_c_phone#6565,cdepval_customer_c_acctbal#6566,cdepval_customer_c_comment#6567,cdepval_customer_c_mktsegment#6568,cc_name#6569,cc_address#6570,cc_phone#6571,cc_acctbal#6572,cc_comment#6573,cc_mktsegment#6574] JDBCRelation(tcustomer) [numPartitions=1]
               +- 'Join UsingJoin(Inner,List(rid_5))
                  :- 'DexPkfkMaterializationAwareJoin region~nation, 'cpfk_region_nation_5, 'rid_4, NotMaterialized, NotMaterialized, [rid_4#6483, cval_region_r_name_4#6484, cval_region_r_comment_4#6485, cdepval_region_r_name_4#6486, cdepval_region_r_comment_4#6487, cr_name_4#6488, cr_comment_4#6489, 'rid_5]
                  :  :- 'DexPseudoPrimaryKeyFilter region~r_name~AMERICA, cval_region_r_name, 'cval_region_r_name_4, tregion
                  :  :  +- Project [rid#6476 AS rid_4#6483, cval_region_r_name#6477 AS cval_region_r_name_4#6484, cval_region_r_comment#6478 AS cval_region_r_comment_4#6485, cdepval_region_r_name#6479 AS cdepval_region_r_name_4#6486, cdepval_region_r_comment#6480 AS cdepval_region_r_comment_4#6487, cr_name#6481 AS cr_name_4#6488, cr_comment#6482 AS cr_comment_4#6489]
                  :  :     +- Relation[rid#6476,cval_region_r_name#6477,cval_region_r_comment#6478,cdepval_region_r_name#6479,cdepval_region_r_comment#6480,cr_name#6481,cr_comment#6482] JDBCRelation(tregion) [numPartitions=1]
                  :  +- 'Project ['cpfk_region_nation_5, 'rid_5]
                  :     +- Project [rid#6536 AS rid_5#6545, cpfk_region_nation#6537 AS cpfk_region_nation_5#6546, cfpk_nation_region#6538 AS cfpk_nation_region_5#6547, cval_nation_n_name#6539 AS cval_nation_n_name_5#6548, cval_nation_n_comment#6540 AS cval_nation_n_comment_5#6549, cdepval_nation_n_name#6541 AS cdepval_nation_n_name_5#6550, cdepval_nation_n_comment#6542 AS cdepval_nation_n_comment_5#6551, cn_name#6543 AS cn_name_5#6552, cn_comment#6544 AS cn_comment_5#6553]
                  :        +- Relation[rid#6536,cpfk_region_nation#6537,cfpk_nation_region#6538,cval_nation_n_name#6539,cval_nation_n_comment#6540,cdepval_nation_n_name#6541,cdepval_nation_n_comment#6542,cn_name#6543,cn_comment#6544] JDBCRelation(tnation) [numPartitions=1]
                  +- Project [rid#6504 AS rid_5#6513, cpfk_region_nation#6505 AS cpfk_region_nation_5#6514, cfpk_nation_region#6506 AS cfpk_nation_region_5#6515, cval_nation_n_name#6507 AS cval_nation_n_name_5#6516, cval_nation_n_comment#6508 AS cval_nation_n_comment_5#6517, cdepval_nation_n_name#6509 AS cdepval_nation_n_name_5#6518, cdepval_nation_n_comment#6510 AS cdepval_nation_n_comment_5#6519, cn_name#6511 AS cn_name_5#6520, cn_comment#6512 AS cn_comment_5#6521]
                     +- Relation[rid#6504,cpfk_region_nation#6505,cfpk_nation_region#6506,cval_nation_n_name#6507,cval_nation_n_comment#6508,cdepval_nation_n_name#6509,cdepval_nation_n_comment#6510,cn_name#6511,cn_comment#6512] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=8716
Elapsed time: 3388ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
20/04/26 21:35:40 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:35:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#6809L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

20/04/26 21:35:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:35:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:35:40 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:35:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#6809L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~partsupp, 'cpfk_part_partsupp_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#6836, cval_part_p_name_0#6837, cval_part_p_mfgr_0#6838, cval_part_p_type_0#6839, cval_part_p_size_0#6840, cval_part_p_container_0#6841, cval_part_p_retailprice_0#6842, cval_part_p_comment_0#6843, cval_part_p_brand_0#6844, cdepval_part_p_name_0#6845, cdepval_part_p_mfgr_0#6846, cdepval_part_p_type_0#6847, cdepval_part_p_size_0#6848, cdepval_part_p_container_0#6849, cdepval_part_p_retailprice_0#6850, cdepval_part_p_comment_0#6851, cdepval_part_p_brand_0#6852, cp_name_0#6853, cp_mfgr_0#6854, cp_type_0#6855, cp_size_0#6856, cp_container_0#6857, cp_retailprice_0#6858, cp_comment_0#6859, ... 2 more fields]
         :  :- 'DexPseudoPrimaryKeyFilter part~p_size~49, cval_part_p_size, 'cval_part_p_size_0, tpart
         :  :  +- Project [rid#6811 AS rid_0#6836, cval_part_p_name#6812 AS cval_part_p_name_0#6837, cval_part_p_mfgr#6813 AS cval_part_p_mfgr_0#6838, cval_part_p_type#6814 AS cval_part_p_type_0#6839, cval_part_p_size#6815 AS cval_part_p_size_0#6840, cval_part_p_container#6816 AS cval_part_p_container_0#6841, cval_part_p_retailprice#6817 AS cval_part_p_retailprice_0#6842, cval_part_p_comment#6818 AS cval_part_p_comment_0#6843, cval_part_p_brand#6819 AS cval_part_p_brand_0#6844, cdepval_part_p_name#6820 AS cdepval_part_p_name_0#6845, cdepval_part_p_mfgr#6821 AS cdepval_part_p_mfgr_0#6846, cdepval_part_p_type#6822 AS cdepval_part_p_type_0#6847, cdepval_part_p_size#6823 AS cdepval_part_p_size_0#6848, cdepval_part_p_container#6824 AS cdepval_part_p_container_0#6849, cdepval_part_p_retailprice#6825 AS cdepval_part_p_retailprice_0#6850, cdepval_part_p_comment#6826 AS cdepval_part_p_comment_0#6851, cdepval_part_p_brand#6827 AS cdepval_part_p_brand_0#6852, cp_name#6828 AS cp_name_0#6853, cp_mfgr#6829 AS cp_mfgr_0#6854, cp_type#6830 AS cp_type_0#6855, cp_size#6831 AS cp_size_0#6856, cp_container#6832 AS cp_container_0#6857, cp_retailprice#6833 AS cp_retailprice_0#6858, cp_comment#6834 AS cp_comment_0#6859, cp_brand#6835 AS cp_brand_0#6860]
         :  :     +- Relation[rid#6811,cval_part_p_name#6812,cval_part_p_mfgr#6813,cval_part_p_type#6814,cval_part_p_size#6815,cval_part_p_container#6816,cval_part_p_retailprice#6817,cval_part_p_comment#6818,cval_part_p_brand#6819,cdepval_part_p_name#6820,cdepval_part_p_mfgr#6821,cdepval_part_p_type#6822,cdepval_part_p_size#6823,cdepval_part_p_container#6824,cdepval_part_p_retailprice#6825,cdepval_part_p_comment#6826,cdepval_part_p_brand#6827,cp_name#6828,cp_mfgr#6829,cp_type#6830,cp_size#6831,cp_container#6832,cp_retailprice#6833,cp_comment#6834,cp_brand#6835] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_partsupp_1, 'rid_1]
         :     +- Project [rid#6989 AS rid_1#7003, cpfk_part_partsupp#6990 AS cpfk_part_partsupp_1#7004, cfpk_partsupp_part#6991 AS cfpk_partsupp_part_1#7005, cpfk_supplier_partsupp#6992 AS cpfk_supplier_partsupp_1#7006, cfpk_partsupp_supplier#6993 AS cfpk_partsupp_supplier_1#7007, cval_partsupp_ps_availqty#6994 AS cval_partsupp_ps_availqty_1#7008, cval_partsupp_ps_supplycost#6995 AS cval_partsupp_ps_supplycost_1#7009, cval_partsupp_ps_comment#6996 AS cval_partsupp_ps_comment_1#7010, cdepval_partsupp_ps_availqty#6997 AS cdepval_partsupp_ps_availqty_1#7011, cdepval_partsupp_ps_supplycost#6998 AS cdepval_partsupp_ps_supplycost_1#7012, cdepval_partsupp_ps_comment#6999 AS cdepval_partsupp_ps_comment_1#7013, cps_availqty#7000 AS cps_availqty_1#7014, cps_supplycost#7001 AS cps_supplycost_1#7015, cps_comment#7002 AS cps_comment_1#7016]
         :        +- Relation[rid#6989,cpfk_part_partsupp#6990,cfpk_partsupp_part#6991,cpfk_supplier_partsupp#6992,cfpk_partsupp_supplier#6993,cval_partsupp_ps_availqty#6994,cval_partsupp_ps_supplycost#6995,cval_partsupp_ps_comment#6996,cdepval_partsupp_ps_availqty#6997,cdepval_partsupp_ps_supplycost#6998,cdepval_partsupp_ps_comment#6999,cps_availqty#7000,cps_supplycost#7001,cps_comment#7002] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#6911 AS rid_1#6925, cpfk_part_partsupp#6912 AS cpfk_part_partsupp_1#6926, cfpk_partsupp_part#6913 AS cfpk_partsupp_part_1#6927, cpfk_supplier_partsupp#6914 AS cpfk_supplier_partsupp_1#6928, cfpk_partsupp_supplier#6915 AS cfpk_partsupp_supplier_1#6929, cval_partsupp_ps_availqty#6916 AS cval_partsupp_ps_availqty_1#6930, cval_partsupp_ps_supplycost#6917 AS cval_partsupp_ps_supplycost_1#6931, cval_partsupp_ps_comment#6918 AS cval_partsupp_ps_comment_1#6932, cdepval_partsupp_ps_availqty#6919 AS cdepval_partsupp_ps_availqty_1#6933, cdepval_partsupp_ps_supplycost#6920 AS cdepval_partsupp_ps_supplycost_1#6934, cdepval_partsupp_ps_comment#6921 AS cdepval_partsupp_ps_comment_1#6935, cps_availqty#6922 AS cps_availqty_1#6936, cps_supplycost#6923 AS cps_supplycost_1#6937, cps_comment#6924 AS cps_comment_1#6938]
            +- Relation[rid#6911,cpfk_part_partsupp#6912,cfpk_partsupp_part#6913,cpfk_supplier_partsupp#6914,cfpk_partsupp_supplier#6915,cval_partsupp_ps_availqty#6916,cval_partsupp_ps_supplycost#6917,cval_partsupp_ps_comment#6918,cdepval_partsupp_ps_availqty#6919,cdepval_partsupp_ps_supplycost#6920,cdepval_partsupp_ps_comment#6921,cps_availqty#6922,cps_supplycost#6923,cps_comment#6924] JDBCRelation(tpartsupp) [numPartitions=1]

DexPkFk$ result size=15780
Elapsed time: 627ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
20/04/26 21:35:41 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:35:41 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7061L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner: InMemoryFileIndex=part
20/04/26 21:35:41 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7061L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join UsingJoin(Inner,List(rid_1))
         :- 'DexPkfkMaterializationAwareJoin part~lineitem, 'cpfk_part_lineitem_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#7088, cval_part_p_name_0#7089, cval_part_p_mfgr_0#7090, cval_part_p_type_0#7091, cval_part_p_size_0#7092, cval_part_p_container_0#7093, cval_part_p_retailprice_0#7094, cval_part_p_comment_0#7095, cval_part_p_brand_0#7096, cdepval_part_p_name_0#7097, cdepval_part_p_mfgr_0#7098, cdepval_part_p_type_0#7099, cdepval_part_p_size_0#7100, cdepval_part_p_container_0#7101, cdepval_part_p_retailprice_0#7102, cdepval_part_p_comment_0#7103, cdepval_part_p_brand_0#7104, cp_name_0#7105, cp_mfgr_0#7106, cp_type_0#7107, cp_size_0#7108, cp_container_0#7109, cp_retailprice_0#7110, cp_comment_0#7111, ... 2 more fields]
         :  :- 'Filter ('cdepval_part_p_container_0 = dexprf(0x25154DF9A19D1007ABEECEF16C16FE2D329E1BBF6F2C274DB4D8D04D18BE9A97, dexencode('rid_0, BinaryType)))
         :  :  +- 'DexPseudoPrimaryKeyFilter part~p_brand~Brand#12, cval_part_p_brand, 'cval_part_p_brand_0, tpart
         :  :     +- Project [rid#7063 AS rid_0#7088, cval_part_p_name#7064 AS cval_part_p_name_0#7089, cval_part_p_mfgr#7065 AS cval_part_p_mfgr_0#7090, cval_part_p_type#7066 AS cval_part_p_type_0#7091, cval_part_p_size#7067 AS cval_part_p_size_0#7092, cval_part_p_container#7068 AS cval_part_p_container_0#7093, cval_part_p_retailprice#7069 AS cval_part_p_retailprice_0#7094, cval_part_p_comment#7070 AS cval_part_p_comment_0#7095, cval_part_p_brand#7071 AS cval_part_p_brand_0#7096, cdepval_part_p_name#7072 AS cdepval_part_p_name_0#7097, cdepval_part_p_mfgr#7073 AS cdepval_part_p_mfgr_0#7098, cdepval_part_p_type#7074 AS cdepval_part_p_type_0#7099, cdepval_part_p_size#7075 AS cdepval_part_p_size_0#7100, cdepval_part_p_container#7076 AS cdepval_part_p_container_0#7101, cdepval_part_p_retailprice#7077 AS cdepval_part_p_retailprice_0#7102, cdepval_part_p_comment#7078 AS cdepval_part_p_comment_0#7103, cdepval_part_p_brand#7079 AS cdepval_part_p_brand_0#7104, cp_name#7080 AS cp_name_0#7105, cp_mfgr#7081 AS cp_mfgr_0#7106, cp_type#7082 AS cp_type_0#7107, cp_size#7083 AS cp_size_0#7108, cp_container#7084 AS cp_container_0#7109, cp_retailprice#7085 AS cp_retailprice_0#7110, cp_comment#7086 AS cp_comment_0#7111, cp_brand#7087 AS cp_brand_0#7112]
         :  :        +- Relation[rid#7063,cval_part_p_name#7064,cval_part_p_mfgr#7065,cval_part_p_type#7066,cval_part_p_size#7067,cval_part_p_container#7068,cval_part_p_retailprice#7069,cval_part_p_comment#7070,cval_part_p_brand#7071,cdepval_part_p_name#7072,cdepval_part_p_mfgr#7073,cdepval_part_p_type#7074,cdepval_part_p_size#7075,cdepval_part_p_container#7076,cdepval_part_p_retailprice#7077,cdepval_part_p_comment#7078,cdepval_part_p_brand#7079,cp_name#7080,cp_mfgr#7081,cp_type#7082,cp_size#7083,cp_container#7084,cp_retailprice#7085,cp_comment#7086,cp_brand#7087] JDBCRelation(tpart) [numPartitions=1]
         :  +- 'Project ['cpfk_part_lineitem_1, 'rid_1]
         :     +- Project [rid#7533 AS rid_1#7578, cpfk_orders_lineitem#7534 AS cpfk_orders_lineitem_1#7579, cpfk_supplier_lineitem#7535 AS cpfk_supplier_lineitem_1#7580, cfpk_lineitem_supplier#7536 AS cfpk_lineitem_supplier_1#7581, cfpk_lineitem_partsupp#7537 AS cfpk_lineitem_partsupp_1#7582, cpfk_part_lineitem#7538 AS cpfk_part_lineitem_1#7583, cfpk_lineitem_part#7539 AS cfpk_lineitem_part_1#7584, cpfk_partsupp_lineitem#7540 AS cpfk_partsupp_lineitem_1#7585, cfpk_lineitem_orders#7541 AS cfpk_lineitem_orders_1#7586, cval_lineitem_l_quantity#7542 AS cval_lineitem_l_quantity_1#7587, cval_lineitem_l_extendedprice#7543 AS cval_lineitem_l_extendedprice_1#7588, cval_lineitem_l_discount#7544 AS cval_lineitem_l_discount_1#7589, cval_lineitem_l_tax#7545 AS cval_lineitem_l_tax_1#7590, cval_lineitem_l_returnflag#7546 AS cval_lineitem_l_returnflag_1#7591, cval_lineitem_l_linestatus#7547 AS cval_lineitem_l_linestatus_1#7592, cval_lineitem_l_commitdate#7548 AS cval_lineitem_l_commitdate_1#7593, cval_lineitem_l_receiptdate#7549 AS cval_lineitem_l_receiptdate_1#7594, cval_lineitem_l_shipinstruct#7550 AS cval_lineitem_l_shipinstruct_1#7595, cval_lineitem_l_shipmode#7551 AS cval_lineitem_l_shipmode_1#7596, cval_lineitem_l_comment#7552 AS cval_lineitem_l_comment_1#7597, cval_lineitem_l_shipdate#7553 AS cval_lineitem_l_shipdate_1#7598, cdepval_lineitem_l_quantity#7554 AS cdepval_lineitem_l_quantity_1#7599, cdepval_lineitem_l_extendedprice#7555 AS cdepval_lineitem_l_extendedprice_1#7600, cdepval_lineitem_l_discount#7556 AS cdepval_lineitem_l_discount_1#7601, ... 21 more fields]
         :        +- Relation[rid#7533,cpfk_orders_lineitem#7534,cpfk_supplier_lineitem#7535,cfpk_lineitem_supplier#7536,cfpk_lineitem_partsupp#7537,cpfk_part_lineitem#7538,cfpk_lineitem_part#7539,cpfk_partsupp_lineitem#7540,cfpk_lineitem_orders#7541,cval_lineitem_l_quantity#7542,cval_lineitem_l_extendedprice#7543,cval_lineitem_l_discount#7544,cval_lineitem_l_tax#7545,cval_lineitem_l_returnflag#7546,cval_lineitem_l_linestatus#7547,cval_lineitem_l_commitdate#7548,cval_lineitem_l_receiptdate#7549,cval_lineitem_l_shipinstruct#7550,cval_lineitem_l_shipmode#7551,cval_lineitem_l_comment#7552,cval_lineitem_l_shipdate#7553,cdepval_lineitem_l_quantity#7554,cdepval_lineitem_l_extendedprice#7555,cdepval_lineitem_l_discount#7556,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Filter ('cdepval_lineitem_l_shipinstruct_1 = dexprf(0x96C174089F6B7FACFA0D45B5895FFE11CFC43FA0D0FC617B41C8B660513115F3, dexencode('rid_1, BinaryType)))
            +- 'DexPseudoPrimaryKeyFilter lineitem~l_shipmode~AIR, cval_lineitem_l_shipmode, 'cval_lineitem_l_shipmode_1, tlineitem
               +- Project [rid#7213 AS rid_1#7258, cpfk_orders_lineitem#7214 AS cpfk_orders_lineitem_1#7259, cpfk_supplier_lineitem#7215 AS cpfk_supplier_lineitem_1#7260, cfpk_lineitem_supplier#7216 AS cfpk_lineitem_supplier_1#7261, cfpk_lineitem_partsupp#7217 AS cfpk_lineitem_partsupp_1#7262, cpfk_part_lineitem#7218 AS cpfk_part_lineitem_1#7263, cfpk_lineitem_part#7219 AS cfpk_lineitem_part_1#7264, cpfk_partsupp_lineitem#7220 AS cpfk_partsupp_lineitem_1#7265, cfpk_lineitem_orders#7221 AS cfpk_lineitem_orders_1#7266, cval_lineitem_l_quantity#7222 AS cval_lineitem_l_quantity_1#7267, cval_lineitem_l_extendedprice#7223 AS cval_lineitem_l_extendedprice_1#7268, cval_lineitem_l_discount#7224 AS cval_lineitem_l_discount_1#7269, cval_lineitem_l_tax#7225 AS cval_lineitem_l_tax_1#7270, cval_lineitem_l_returnflag#7226 AS cval_lineitem_l_returnflag_1#7271, cval_lineitem_l_linestatus#7227 AS cval_lineitem_l_linestatus_1#7272, cval_lineitem_l_commitdate#7228 AS cval_lineitem_l_commitdate_1#7273, cval_lineitem_l_receiptdate#7229 AS cval_lineitem_l_receiptdate_1#7274, cval_lineitem_l_shipinstruct#7230 AS cval_lineitem_l_shipinstruct_1#7275, cval_lineitem_l_shipmode#7231 AS cval_lineitem_l_shipmode_1#7276, cval_lineitem_l_comment#7232 AS cval_lineitem_l_comment_1#7277, cval_lineitem_l_shipdate#7233 AS cval_lineitem_l_shipdate_1#7278, cdepval_lineitem_l_quantity#7234 AS cdepval_lineitem_l_quantity_1#7279, cdepval_lineitem_l_extendedprice#7235 AS cdepval_lineitem_l_extendedprice_1#7280, cdepval_lineitem_l_discount#7236 AS cdepval_lineitem_l_discount_1#7281, ... 21 more fields]
                  +- Relation[rid#7213,cpfk_orders_lineitem#7214,cpfk_supplier_lineitem#7215,cfpk_lineitem_supplier#7216,cfpk_lineitem_partsupp#7217,cpfk_part_lineitem#7218,cfpk_lineitem_part#7219,cpfk_partsupp_lineitem#7220,cfpk_lineitem_orders#7221,cval_lineitem_l_quantity#7222,cval_lineitem_l_extendedprice#7223,cval_lineitem_l_discount#7224,cval_lineitem_l_tax#7225,cval_lineitem_l_returnflag#7226,cval_lineitem_l_linestatus#7227,cval_lineitem_l_commitdate#7228,cval_lineitem_l_receiptdate#7229,cval_lineitem_l_shipinstruct#7230,cval_lineitem_l_shipmode#7231,cval_lineitem_l_comment#7232,cval_lineitem_l_shipdate#7233,cdepval_lineitem_l_quantity#7234,cdepval_lineitem_l_extendedprice#7235,cdepval_lineitem_l_discount#7236,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=205
Elapsed time: 16109ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
20/04/26 21:35:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:35:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7702L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:35:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7702L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_1)
         :- Project [rid#7794 AS rid_2#7839, cpfk_orders_lineitem#7795 AS cpfk_orders_lineitem_2#7840, cpfk_supplier_lineitem#7796 AS cpfk_supplier_lineitem_2#7841, cfpk_lineitem_supplier#7797 AS cfpk_lineitem_supplier_2#7842, cfpk_lineitem_partsupp#7798 AS cfpk_lineitem_partsupp_2#7843, cpfk_part_lineitem#7799 AS cpfk_part_lineitem_2#7844, cfpk_lineitem_part#7800 AS cfpk_lineitem_part_2#7845, cpfk_partsupp_lineitem#7801 AS cpfk_partsupp_lineitem_2#7846, cfpk_lineitem_orders#7802 AS cfpk_lineitem_orders_2#7847, cval_lineitem_l_quantity#7803 AS cval_lineitem_l_quantity_2#7848, cval_lineitem_l_extendedprice#7804 AS cval_lineitem_l_extendedprice_2#7849, cval_lineitem_l_discount#7805 AS cval_lineitem_l_discount_2#7850, cval_lineitem_l_tax#7806 AS cval_lineitem_l_tax_2#7851, cval_lineitem_l_returnflag#7807 AS cval_lineitem_l_returnflag_2#7852, cval_lineitem_l_linestatus#7808 AS cval_lineitem_l_linestatus_2#7853, cval_lineitem_l_commitdate#7809 AS cval_lineitem_l_commitdate_2#7854, cval_lineitem_l_receiptdate#7810 AS cval_lineitem_l_receiptdate_2#7855, cval_lineitem_l_shipinstruct#7811 AS cval_lineitem_l_shipinstruct_2#7856, cval_lineitem_l_shipmode#7812 AS cval_lineitem_l_shipmode_2#7857, cval_lineitem_l_comment#7813 AS cval_lineitem_l_comment_2#7858, cval_lineitem_l_shipdate#7814 AS cval_lineitem_l_shipdate_2#7859, cdepval_lineitem_l_quantity#7815 AS cdepval_lineitem_l_quantity_2#7860, cdepval_lineitem_l_extendedprice#7816 AS cdepval_lineitem_l_extendedprice_2#7861, cdepval_lineitem_l_discount#7817 AS cdepval_lineitem_l_discount_2#7862, ... 21 more fields]
         :  +- Relation[rid#7794,cpfk_orders_lineitem#7795,cpfk_supplier_lineitem#7796,cfpk_lineitem_supplier#7797,cfpk_lineitem_partsupp#7798,cpfk_part_lineitem#7799,cfpk_lineitem_part#7800,cpfk_partsupp_lineitem#7801,cfpk_lineitem_orders#7802,cval_lineitem_l_quantity#7803,cval_lineitem_l_extendedprice#7804,cval_lineitem_l_discount#7805,cval_lineitem_l_tax#7806,cval_lineitem_l_returnflag#7807,cval_lineitem_l_linestatus#7808,cval_lineitem_l_commitdate#7809,cval_lineitem_l_receiptdate#7810,cval_lineitem_l_shipinstruct#7811,cval_lineitem_l_shipmode#7812,cval_lineitem_l_comment#7813,cval_lineitem_l_shipdate#7814,cdepval_lineitem_l_quantity#7815,cdepval_lineitem_l_extendedprice#7816,cdepval_lineitem_l_discount#7817,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_0)
            :- Project [rid#7746 AS rid_1#7770, cpfk_customer_orders#7747 AS cpfk_customer_orders_1#7771, cfpk_orders_customer#7748 AS cfpk_orders_customer_1#7772, cval_orders_o_orderstatus#7749 AS cval_orders_o_orderstatus_1#7773, cval_orders_o_totalprice#7750 AS cval_orders_o_totalprice_1#7774, cval_orders_o_orderpriority#7751 AS cval_orders_o_orderpriority_1#7775, cval_orders_o_clerk#7752 AS cval_orders_o_clerk_1#7776, cval_orders_o_shippriority#7753 AS cval_orders_o_shippriority_1#7777, cval_orders_o_comment#7754 AS cval_orders_o_comment_1#7778, cval_orders_o_orderdate#7755 AS cval_orders_o_orderdate_1#7779, cdepval_orders_o_orderstatus#7756 AS cdepval_orders_o_orderstatus_1#7780, cdepval_orders_o_totalprice#7757 AS cdepval_orders_o_totalprice_1#7781, cdepval_orders_o_orderpriority#7758 AS cdepval_orders_o_orderpriority_1#7782, cdepval_orders_o_clerk#7759 AS cdepval_orders_o_clerk_1#7783, cdepval_orders_o_shippriority#7760 AS cdepval_orders_o_shippriority_1#7784, cdepval_orders_o_comment#7761 AS cdepval_orders_o_comment_1#7785, cdepval_orders_o_orderdate#7762 AS cdepval_orders_o_orderdate_1#7786, co_orderstatus#7763 AS co_orderstatus_1#7787, co_totalprice#7764 AS co_totalprice_1#7788, co_orderpriority#7765 AS co_orderpriority_1#7789, co_clerk#7766 AS co_clerk_1#7790, co_shippriority#7767 AS co_shippriority_1#7791, co_comment#7768 AS co_comment_1#7792, co_orderdate#7769 AS co_orderdate_1#7793]
            :  +- Relation[rid#7746,cpfk_customer_orders#7747,cfpk_orders_customer#7748,cval_orders_o_orderstatus#7749,cval_orders_o_totalprice#7750,cval_orders_o_orderpriority#7751,cval_orders_o_clerk#7752,cval_orders_o_shippriority#7753,cval_orders_o_comment#7754,cval_orders_o_orderdate#7755,cdepval_orders_o_orderstatus#7756,cdepval_orders_o_totalprice#7757,cdepval_orders_o_orderpriority#7758,cdepval_orders_o_clerk#7759,cdepval_orders_o_shippriority#7760,cdepval_orders_o_comment#7761,cdepval_orders_o_orderdate#7762,co_orderstatus#7763,co_totalprice#7764,co_orderpriority#7765,co_clerk#7766,co_shippriority#7767,co_comment#7768,co_orderdate#7769] JDBCRelation(torders) [numPartitions=1]
            +- Project [rid#7704 AS rid_0#7725, cpfk_nation_customer#7705 AS cpfk_nation_customer_0#7726, cfpk_customer_nation#7706 AS cfpk_customer_nation_0#7727, cval_customer_c_name#7707 AS cval_customer_c_name_0#7728, cval_customer_c_address#7708 AS cval_customer_c_address_0#7729, cval_customer_c_phone#7709 AS cval_customer_c_phone_0#7730, cval_customer_c_acctbal#7710 AS cval_customer_c_acctbal_0#7731, cval_customer_c_comment#7711 AS cval_customer_c_comment_0#7732, cval_customer_c_mktsegment#7712 AS cval_customer_c_mktsegment_0#7733, cdepval_customer_c_name#7713 AS cdepval_customer_c_name_0#7734, cdepval_customer_c_address#7714 AS cdepval_customer_c_address_0#7735, cdepval_customer_c_phone#7715 AS cdepval_customer_c_phone_0#7736, cdepval_customer_c_acctbal#7716 AS cdepval_customer_c_acctbal_0#7737, cdepval_customer_c_comment#7717 AS cdepval_customer_c_comment_0#7738, cdepval_customer_c_mktsegment#7718 AS cdepval_customer_c_mktsegment_0#7739, cc_name#7719 AS cc_name_0#7740, cc_address#7720 AS cc_address_0#7741, cc_phone#7721 AS cc_phone_0#7742, cc_acctbal#7722 AS cc_acctbal_0#7743, cc_comment#7723 AS cc_comment_0#7744, cc_mktsegment#7724 AS cc_mktsegment_0#7745]
               +- Relation[rid#7704,cpfk_nation_customer#7705,cfpk_customer_nation#7706,cval_customer_c_name#7707,cval_customer_c_address#7708,cval_customer_c_phone#7709,cval_customer_c_acctbal#7710,cval_customer_c_comment#7711,cval_customer_c_mktsegment#7712,cdepval_customer_c_name#7713,cdepval_customer_c_address#7714,cdepval_customer_c_phone#7715,cdepval_customer_c_acctbal#7716,cdepval_customer_c_comment#7717,cdepval_customer_c_mktsegment#7718,cc_name#7719,cc_address#7720,cc_phone#7721,cc_acctbal#7722,cc_comment#7723,cc_mktsegment#7724] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 22412ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:36:19 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:36:19 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#7983L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:19 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:19 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#7983L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_orders_4) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_4, BinaryType)), 'cfpk_lineitem_partsupp_4) = 'rid_2)
         :  :- Project [rid#8117 AS rid_4#8162, cpfk_orders_lineitem#8118 AS cpfk_orders_lineitem_4#8163, cpfk_supplier_lineitem#8119 AS cpfk_supplier_lineitem_4#8164, cfpk_lineitem_supplier#8120 AS cfpk_lineitem_supplier_4#8165, cfpk_lineitem_partsupp#8121 AS cfpk_lineitem_partsupp_4#8166, cpfk_part_lineitem#8122 AS cpfk_part_lineitem_4#8167, cfpk_lineitem_part#8123 AS cfpk_lineitem_part_4#8168, cpfk_partsupp_lineitem#8124 AS cpfk_partsupp_lineitem_4#8169, cfpk_lineitem_orders#8125 AS cfpk_lineitem_orders_4#8170, cval_lineitem_l_quantity#8126 AS cval_lineitem_l_quantity_4#8171, cval_lineitem_l_extendedprice#8127 AS cval_lineitem_l_extendedprice_4#8172, cval_lineitem_l_discount#8128 AS cval_lineitem_l_discount_4#8173, cval_lineitem_l_tax#8129 AS cval_lineitem_l_tax_4#8174, cval_lineitem_l_returnflag#8130 AS cval_lineitem_l_returnflag_4#8175, cval_lineitem_l_linestatus#8131 AS cval_lineitem_l_linestatus_4#8176, cval_lineitem_l_commitdate#8132 AS cval_lineitem_l_commitdate_4#8177, cval_lineitem_l_receiptdate#8133 AS cval_lineitem_l_receiptdate_4#8178, cval_lineitem_l_shipinstruct#8134 AS cval_lineitem_l_shipinstruct_4#8179, cval_lineitem_l_shipmode#8135 AS cval_lineitem_l_shipmode_4#8180, cval_lineitem_l_comment#8136 AS cval_lineitem_l_comment_4#8181, cval_lineitem_l_shipdate#8137 AS cval_lineitem_l_shipdate_4#8182, cdepval_lineitem_l_quantity#8138 AS cdepval_lineitem_l_quantity_4#8183, cdepval_lineitem_l_extendedprice#8139 AS cdepval_lineitem_l_extendedprice_4#8184, cdepval_lineitem_l_discount#8140 AS cdepval_lineitem_l_discount_4#8185, ... 21 more fields]
         :  :  +- Relation[rid#8117,cpfk_orders_lineitem#8118,cpfk_supplier_lineitem#8119,cfpk_lineitem_supplier#8120,cfpk_lineitem_partsupp#8121,cpfk_part_lineitem#8122,cfpk_lineitem_part#8123,cpfk_partsupp_lineitem#8124,cfpk_lineitem_orders#8125,cval_lineitem_l_quantity#8126,cval_lineitem_l_extendedprice#8127,cval_lineitem_l_discount#8128,cval_lineitem_l_tax#8129,cval_lineitem_l_returnflag#8130,cval_lineitem_l_linestatus#8131,cval_lineitem_l_commitdate#8132,cval_lineitem_l_receiptdate#8133,cval_lineitem_l_shipinstruct#8134,cval_lineitem_l_shipmode#8135,cval_lineitem_l_comment#8136,cval_lineitem_l_shipdate#8137,cdepval_lineitem_l_quantity#8138,cdepval_lineitem_l_extendedprice#8139,cdepval_lineitem_l_discount#8140,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join Inner, (dexdecrypt(dexprf(0x1BC8381043B01B9162548303ADE40F33510F48EE1CB7DB9BD8BAE133B93F0BD0, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_part_2) = 'rid_3)
         :     :- 'Join Inner, (dexdecrypt(dexprf(0xC7CEEE607DB1D4A64A19A9451D3E1FDF2E0E8A02C55F233C7B2F5A5B980AF2CC, dexencode('rid_2, BinaryType)), 'cfpk_partsupp_supplier_2) = 'rid_1)
         :     :  :- Project [rid#8039 AS rid_2#8053, cpfk_part_partsupp#8040 AS cpfk_part_partsupp_2#8054, cfpk_partsupp_part#8041 AS cfpk_partsupp_part_2#8055, cpfk_supplier_partsupp#8042 AS cpfk_supplier_partsupp_2#8056, cfpk_partsupp_supplier#8043 AS cfpk_partsupp_supplier_2#8057, cval_partsupp_ps_availqty#8044 AS cval_partsupp_ps_availqty_2#8058, cval_partsupp_ps_supplycost#8045 AS cval_partsupp_ps_supplycost_2#8059, cval_partsupp_ps_comment#8046 AS cval_partsupp_ps_comment_2#8060, cdepval_partsupp_ps_availqty#8047 AS cdepval_partsupp_ps_availqty_2#8061, cdepval_partsupp_ps_supplycost#8048 AS cdepval_partsupp_ps_supplycost_2#8062, cdepval_partsupp_ps_comment#8049 AS cdepval_partsupp_ps_comment_2#8063, cps_availqty#8050 AS cps_availqty_2#8064, cps_supplycost#8051 AS cps_supplycost_2#8065, cps_comment#8052 AS cps_comment_2#8066]
         :     :  :  +- Relation[rid#8039,cpfk_part_partsupp#8040,cfpk_partsupp_part#8041,cpfk_supplier_partsupp#8042,cfpk_partsupp_supplier#8043,cval_partsupp_ps_availqty#8044,cval_partsupp_ps_supplycost#8045,cval_partsupp_ps_comment#8046,cdepval_partsupp_ps_availqty#8047,cdepval_partsupp_ps_supplycost#8048,cdepval_partsupp_ps_comment#8049,cps_availqty#8050,cps_supplycost#8051,cps_comment#8052] JDBCRelation(tpartsupp) [numPartitions=1]
         :     :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :     :     :- Project [rid#8003 AS rid_1#8021, cpfk_nation_supplier#8004 AS cpfk_nation_supplier_1#8022, cfpk_supplier_nation#8005 AS cfpk_supplier_nation_1#8023, cval_supplier_s_name#8006 AS cval_supplier_s_name_1#8024, cval_supplier_s_address#8007 AS cval_supplier_s_address_1#8025, cval_supplier_s_phone#8008 AS cval_supplier_s_phone_1#8026, cval_supplier_s_acctbal#8009 AS cval_supplier_s_acctbal_1#8027, cval_supplier_s_comment#8010 AS cval_supplier_s_comment_1#8028, cdepval_supplier_s_name#8011 AS cdepval_supplier_s_name_1#8029, cdepval_supplier_s_address#8012 AS cdepval_supplier_s_address_1#8030, cdepval_supplier_s_phone#8013 AS cdepval_supplier_s_phone_1#8031, cdepval_supplier_s_acctbal#8014 AS cdepval_supplier_s_acctbal_1#8032, cdepval_supplier_s_comment#8015 AS cdepval_supplier_s_comment_1#8033, cs_name#8016 AS cs_name_1#8034, cs_address#8017 AS cs_address_1#8035, cs_phone#8018 AS cs_phone_1#8036, cs_acctbal#8019 AS cs_acctbal_1#8037, cs_comment#8020 AS cs_comment_1#8038]
         :     :     :  +- Relation[rid#8003,cpfk_nation_supplier#8004,cfpk_supplier_nation#8005,cval_supplier_s_name#8006,cval_supplier_s_address#8007,cval_supplier_s_phone#8008,cval_supplier_s_acctbal#8009,cval_supplier_s_comment#8010,cdepval_supplier_s_name#8011,cdepval_supplier_s_address#8012,cdepval_supplier_s_phone#8013,cdepval_supplier_s_acctbal#8014,cdepval_supplier_s_comment#8015,cs_name#8016,cs_address#8017,cs_phone#8018,cs_acctbal#8019,cs_comment#8020] JDBCRelation(tsupplier) [numPartitions=1]
         :     :     +- Project [rid#7985 AS rid_0#7994, cpfk_region_nation#7986 AS cpfk_region_nation_0#7995, cfpk_nation_region#7987 AS cfpk_nation_region_0#7996, cval_nation_n_name#7988 AS cval_nation_n_name_0#7997, cval_nation_n_comment#7989 AS cval_nation_n_comment_0#7998, cdepval_nation_n_name#7990 AS cdepval_nation_n_name_0#7999, cdepval_nation_n_comment#7991 AS cdepval_nation_n_comment_0#8000, cn_name#7992 AS cn_name_0#8001, cn_comment#7993 AS cn_comment_0#8002]
         :     :        +- Relation[rid#7985,cpfk_region_nation#7986,cfpk_nation_region#7987,cval_nation_n_name#7988,cval_nation_n_comment#7989,cdepval_nation_n_name#7990,cdepval_nation_n_comment#7991,cn_name#7992,cn_comment#7993] JDBCRelation(tnation) [numPartitions=1]
         :     +- Project [rid#8067 AS rid_3#8092, cval_part_p_name#8068 AS cval_part_p_name_3#8093, cval_part_p_mfgr#8069 AS cval_part_p_mfgr_3#8094, cval_part_p_type#8070 AS cval_part_p_type_3#8095, cval_part_p_size#8071 AS cval_part_p_size_3#8096, cval_part_p_container#8072 AS cval_part_p_container_3#8097, cval_part_p_retailprice#8073 AS cval_part_p_retailprice_3#8098, cval_part_p_comment#8074 AS cval_part_p_comment_3#8099, cval_part_p_brand#8075 AS cval_part_p_brand_3#8100, cdepval_part_p_name#8076 AS cdepval_part_p_name_3#8101, cdepval_part_p_mfgr#8077 AS cdepval_part_p_mfgr_3#8102, cdepval_part_p_type#8078 AS cdepval_part_p_type_3#8103, cdepval_part_p_size#8079 AS cdepval_part_p_size_3#8104, cdepval_part_p_container#8080 AS cdepval_part_p_container_3#8105, cdepval_part_p_retailprice#8081 AS cdepval_part_p_retailprice_3#8106, cdepval_part_p_comment#8082 AS cdepval_part_p_comment_3#8107, cdepval_part_p_brand#8083 AS cdepval_part_p_brand_3#8108, cp_name#8084 AS cp_name_3#8109, cp_mfgr#8085 AS cp_mfgr_3#8110, cp_type#8086 AS cp_type_3#8111, cp_size#8087 AS cp_size_3#8112, cp_container#8088 AS cp_container_3#8113, cp_retailprice#8089 AS cp_retailprice_3#8114, cp_comment#8090 AS cp_comment_3#8115, cp_brand#8091 AS cp_brand_3#8116]
         :        +- Relation[rid#8067,cval_part_p_name#8068,cval_part_p_mfgr#8069,cval_part_p_type#8070,cval_part_p_size#8071,cval_part_p_container#8072,cval_part_p_retailprice#8073,cval_part_p_comment#8074,cval_part_p_brand#8075,cdepval_part_p_name#8076,cdepval_part_p_mfgr#8077,cdepval_part_p_type#8078,cdepval_part_p_size#8079,cdepval_part_p_container#8080,cdepval_part_p_retailprice#8081,cdepval_part_p_comment#8082,cdepval_part_p_brand#8083,cp_name#8084,cp_mfgr#8085,cp_type#8086,cp_size#8087,cp_container#8088,cp_retailprice#8089,cp_comment#8090,cp_brand#8091] JDBCRelation(tpart) [numPartitions=1]
         +- Project [rid#8207 AS rid_5#8231, cpfk_customer_orders#8208 AS cpfk_customer_orders_5#8232, cfpk_orders_customer#8209 AS cfpk_orders_customer_5#8233, cval_orders_o_orderstatus#8210 AS cval_orders_o_orderstatus_5#8234, cval_orders_o_totalprice#8211 AS cval_orders_o_totalprice_5#8235, cval_orders_o_orderpriority#8212 AS cval_orders_o_orderpriority_5#8236, cval_orders_o_clerk#8213 AS cval_orders_o_clerk_5#8237, cval_orders_o_shippriority#8214 AS cval_orders_o_shippriority_5#8238, cval_orders_o_comment#8215 AS cval_orders_o_comment_5#8239, cval_orders_o_orderdate#8216 AS cval_orders_o_orderdate_5#8240, cdepval_orders_o_orderstatus#8217 AS cdepval_orders_o_orderstatus_5#8241, cdepval_orders_o_totalprice#8218 AS cdepval_orders_o_totalprice_5#8242, cdepval_orders_o_orderpriority#8219 AS cdepval_orders_o_orderpriority_5#8243, cdepval_orders_o_clerk#8220 AS cdepval_orders_o_clerk_5#8244, cdepval_orders_o_shippriority#8221 AS cdepval_orders_o_shippriority_5#8245, cdepval_orders_o_comment#8222 AS cdepval_orders_o_comment_5#8246, cdepval_orders_o_orderdate#8223 AS cdepval_orders_o_orderdate_5#8247, co_orderstatus#8224 AS co_orderstatus_5#8248, co_totalprice#8225 AS co_totalprice_5#8249, co_orderpriority#8226 AS co_orderpriority_5#8250, co_clerk#8227 AS co_clerk_5#8251, co_shippriority#8228 AS co_shippriority_5#8252, co_comment#8229 AS co_comment_5#8253, co_orderdate#8230 AS co_orderdate_5#8254]
            +- Relation[rid#8207,cpfk_customer_orders#8208,cfpk_orders_customer#8209,cval_orders_o_orderstatus#8210,cval_orders_o_totalprice#8211,cval_orders_o_orderpriority#8212,cval_orders_o_clerk#8213,cval_orders_o_shippriority#8214,cval_orders_o_comment#8215,cval_orders_o_orderdate#8216,cdepval_orders_o_orderstatus#8217,cdepval_orders_o_totalprice#8218,cdepval_orders_o_orderpriority#8219,cdepval_orders_o_clerk#8220,cdepval_orders_o_shippriority#8221,cdepval_orders_o_comment#8222,cdepval_orders_o_orderdate#8223,co_orderstatus#8224,co_totalprice#8225,co_orderpriority#8226,co_clerk#8227,co_shippriority#8228,co_comment#8229,co_orderdate#8230] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 37734ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
20/04/26 21:36:57 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:36:57 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8399L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:57 WARN DexPlanner: InMemoryFileIndex=partsupp
20/04/26 21:36:57 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8399L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x2A0126FB04F5B449E0979E2BEBACE53DA2CE3DDE36A750175C54560907E2F0A4, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_partsupp_2) = 'rid_4)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_part_2) = 'rid_3)
         :  :  :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :  :  :- Project [rid#8455 AS rid_2#8500, cpfk_orders_lineitem#8456 AS cpfk_orders_lineitem_2#8501, cpfk_supplier_lineitem#8457 AS cpfk_supplier_lineitem_2#8502, cfpk_lineitem_supplier#8458 AS cfpk_lineitem_supplier_2#8503, cfpk_lineitem_partsupp#8459 AS cfpk_lineitem_partsupp_2#8504, cpfk_part_lineitem#8460 AS cpfk_part_lineitem_2#8505, cfpk_lineitem_part#8461 AS cfpk_lineitem_part_2#8506, cpfk_partsupp_lineitem#8462 AS cpfk_partsupp_lineitem_2#8507, cfpk_lineitem_orders#8463 AS cfpk_lineitem_orders_2#8508, cval_lineitem_l_quantity#8464 AS cval_lineitem_l_quantity_2#8509, cval_lineitem_l_extendedprice#8465 AS cval_lineitem_l_extendedprice_2#8510, cval_lineitem_l_discount#8466 AS cval_lineitem_l_discount_2#8511, cval_lineitem_l_tax#8467 AS cval_lineitem_l_tax_2#8512, cval_lineitem_l_returnflag#8468 AS cval_lineitem_l_returnflag_2#8513, cval_lineitem_l_linestatus#8469 AS cval_lineitem_l_linestatus_2#8514, cval_lineitem_l_commitdate#8470 AS cval_lineitem_l_commitdate_2#8515, cval_lineitem_l_receiptdate#8471 AS cval_lineitem_l_receiptdate_2#8516, cval_lineitem_l_shipinstruct#8472 AS cval_lineitem_l_shipinstruct_2#8517, cval_lineitem_l_shipmode#8473 AS cval_lineitem_l_shipmode_2#8518, cval_lineitem_l_comment#8474 AS cval_lineitem_l_comment_2#8519, cval_lineitem_l_shipdate#8475 AS cval_lineitem_l_shipdate_2#8520, cdepval_lineitem_l_quantity#8476 AS cdepval_lineitem_l_quantity_2#8521, cdepval_lineitem_l_extendedprice#8477 AS cdepval_lineitem_l_extendedprice_2#8522, cdepval_lineitem_l_discount#8478 AS cdepval_lineitem_l_discount_2#8523, ... 21 more fields]
         :  :  :  :  +- Relation[rid#8455,cpfk_orders_lineitem#8456,cpfk_supplier_lineitem#8457,cfpk_lineitem_supplier#8458,cfpk_lineitem_partsupp#8459,cpfk_part_lineitem#8460,cfpk_lineitem_part#8461,cpfk_partsupp_lineitem#8462,cfpk_lineitem_orders#8463,cval_lineitem_l_quantity#8464,cval_lineitem_l_extendedprice#8465,cval_lineitem_l_discount#8466,cval_lineitem_l_tax#8467,cval_lineitem_l_returnflag#8468,cval_lineitem_l_linestatus#8469,cval_lineitem_l_commitdate#8470,cval_lineitem_l_receiptdate#8471,cval_lineitem_l_shipinstruct#8472,cval_lineitem_l_shipmode#8473,cval_lineitem_l_comment#8474,cval_lineitem_l_shipdate#8475,cdepval_lineitem_l_quantity#8476,cdepval_lineitem_l_extendedprice#8477,cdepval_lineitem_l_discount#8478,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  :  +- 'Join Inner, (dexdecrypt(dexprf(0x6E288E1C323FDF746915F27C80423F1CEF54F4CDAADD0915C56320449B40AB7A, dexencode('rid_1, BinaryType)), 'cfpk_supplier_nation_1) = 'rid_0)
         :  :  :     :- Project [rid#8419 AS rid_1#8437, cpfk_nation_supplier#8420 AS cpfk_nation_supplier_1#8438, cfpk_supplier_nation#8421 AS cfpk_supplier_nation_1#8439, cval_supplier_s_name#8422 AS cval_supplier_s_name_1#8440, cval_supplier_s_address#8423 AS cval_supplier_s_address_1#8441, cval_supplier_s_phone#8424 AS cval_supplier_s_phone_1#8442, cval_supplier_s_acctbal#8425 AS cval_supplier_s_acctbal_1#8443, cval_supplier_s_comment#8426 AS cval_supplier_s_comment_1#8444, cdepval_supplier_s_name#8427 AS cdepval_supplier_s_name_1#8445, cdepval_supplier_s_address#8428 AS cdepval_supplier_s_address_1#8446, cdepval_supplier_s_phone#8429 AS cdepval_supplier_s_phone_1#8447, cdepval_supplier_s_acctbal#8430 AS cdepval_supplier_s_acctbal_1#8448, cdepval_supplier_s_comment#8431 AS cdepval_supplier_s_comment_1#8449, cs_name#8432 AS cs_name_1#8450, cs_address#8433 AS cs_address_1#8451, cs_phone#8434 AS cs_phone_1#8452, cs_acctbal#8435 AS cs_acctbal_1#8453, cs_comment#8436 AS cs_comment_1#8454]
         :  :  :     :  +- Relation[rid#8419,cpfk_nation_supplier#8420,cfpk_supplier_nation#8421,cval_supplier_s_name#8422,cval_supplier_s_address#8423,cval_supplier_s_phone#8424,cval_supplier_s_acctbal#8425,cval_supplier_s_comment#8426,cdepval_supplier_s_name#8427,cdepval_supplier_s_address#8428,cdepval_supplier_s_phone#8429,cdepval_supplier_s_acctbal#8430,cdepval_supplier_s_comment#8431,cs_name#8432,cs_address#8433,cs_phone#8434,cs_acctbal#8435,cs_comment#8436] JDBCRelation(tsupplier) [numPartitions=1]
         :  :  :     +- Project [rid#8401 AS rid_0#8410, cpfk_region_nation#8402 AS cpfk_region_nation_0#8411, cfpk_nation_region#8403 AS cfpk_nation_region_0#8412, cval_nation_n_name#8404 AS cval_nation_n_name_0#8413, cval_nation_n_comment#8405 AS cval_nation_n_comment_0#8414, cdepval_nation_n_name#8406 AS cdepval_nation_n_name_0#8415, cdepval_nation_n_comment#8407 AS cdepval_nation_n_comment_0#8416, cn_name#8408 AS cn_name_0#8417, cn_comment#8409 AS cn_comment_0#8418]
         :  :  :        +- Relation[rid#8401,cpfk_region_nation#8402,cfpk_nation_region#8403,cval_nation_n_name#8404,cval_nation_n_comment#8405,cdepval_nation_n_name#8406,cdepval_nation_n_comment#8407,cn_name#8408,cn_comment#8409] JDBCRelation(tnation) [numPartitions=1]
         :  :  +- Project [rid#8545 AS rid_3#8570, cval_part_p_name#8546 AS cval_part_p_name_3#8571, cval_part_p_mfgr#8547 AS cval_part_p_mfgr_3#8572, cval_part_p_type#8548 AS cval_part_p_type_3#8573, cval_part_p_size#8549 AS cval_part_p_size_3#8574, cval_part_p_container#8550 AS cval_part_p_container_3#8575, cval_part_p_retailprice#8551 AS cval_part_p_retailprice_3#8576, cval_part_p_comment#8552 AS cval_part_p_comment_3#8577, cval_part_p_brand#8553 AS cval_part_p_brand_3#8578, cdepval_part_p_name#8554 AS cdepval_part_p_name_3#8579, cdepval_part_p_mfgr#8555 AS cdepval_part_p_mfgr_3#8580, cdepval_part_p_type#8556 AS cdepval_part_p_type_3#8581, cdepval_part_p_size#8557 AS cdepval_part_p_size_3#8582, cdepval_part_p_container#8558 AS cdepval_part_p_container_3#8583, cdepval_part_p_retailprice#8559 AS cdepval_part_p_retailprice_3#8584, cdepval_part_p_comment#8560 AS cdepval_part_p_comment_3#8585, cdepval_part_p_brand#8561 AS cdepval_part_p_brand_3#8586, cp_name#8562 AS cp_name_3#8587, cp_mfgr#8563 AS cp_mfgr_3#8588, cp_type#8564 AS cp_type_3#8589, cp_size#8565 AS cp_size_3#8590, cp_container#8566 AS cp_container_3#8591, cp_retailprice#8567 AS cp_retailprice_3#8592, cp_comment#8568 AS cp_comment_3#8593, cp_brand#8569 AS cp_brand_3#8594]
         :  :     +- Relation[rid#8545,cval_part_p_name#8546,cval_part_p_mfgr#8547,cval_part_p_type#8548,cval_part_p_size#8549,cval_part_p_container#8550,cval_part_p_retailprice#8551,cval_part_p_comment#8552,cval_part_p_brand#8553,cdepval_part_p_name#8554,cdepval_part_p_mfgr#8555,cdepval_part_p_type#8556,cdepval_part_p_size#8557,cdepval_part_p_container#8558,cdepval_part_p_retailprice#8559,cdepval_part_p_comment#8560,cdepval_part_p_brand#8561,cp_name#8562,cp_mfgr#8563,cp_type#8564,cp_size#8565,cp_container#8566,cp_retailprice#8567,cp_comment#8568,cp_brand#8569] JDBCRelation(tpart) [numPartitions=1]
         :  +- Project [rid#8595 AS rid_4#8609, cpfk_part_partsupp#8596 AS cpfk_part_partsupp_4#8610, cfpk_partsupp_part#8597 AS cfpk_partsupp_part_4#8611, cpfk_supplier_partsupp#8598 AS cpfk_supplier_partsupp_4#8612, cfpk_partsupp_supplier#8599 AS cfpk_partsupp_supplier_4#8613, cval_partsupp_ps_availqty#8600 AS cval_partsupp_ps_availqty_4#8614, cval_partsupp_ps_supplycost#8601 AS cval_partsupp_ps_supplycost_4#8615, cval_partsupp_ps_comment#8602 AS cval_partsupp_ps_comment_4#8616, cdepval_partsupp_ps_availqty#8603 AS cdepval_partsupp_ps_availqty_4#8617, cdepval_partsupp_ps_supplycost#8604 AS cdepval_partsupp_ps_supplycost_4#8618, cdepval_partsupp_ps_comment#8605 AS cdepval_partsupp_ps_comment_4#8619, cps_availqty#8606 AS cps_availqty_4#8620, cps_supplycost#8607 AS cps_supplycost_4#8621, cps_comment#8608 AS cps_comment_4#8622]
         :     +- Relation[rid#8595,cpfk_part_partsupp#8596,cfpk_partsupp_part#8597,cpfk_supplier_partsupp#8598,cfpk_partsupp_supplier#8599,cval_partsupp_ps_availqty#8600,cval_partsupp_ps_supplycost#8601,cval_partsupp_ps_comment#8602,cdepval_partsupp_ps_availqty#8603,cdepval_partsupp_ps_supplycost#8604,cdepval_partsupp_ps_comment#8605,cps_availqty#8606,cps_supplycost#8607,cps_comment#8608] JDBCRelation(tpartsupp) [numPartitions=1]
         +- Project [rid#8623 AS rid_5#8647, cpfk_customer_orders#8624 AS cpfk_customer_orders_5#8648, cfpk_orders_customer#8625 AS cfpk_orders_customer_5#8649, cval_orders_o_orderstatus#8626 AS cval_orders_o_orderstatus_5#8650, cval_orders_o_totalprice#8627 AS cval_orders_o_totalprice_5#8651, cval_orders_o_orderpriority#8628 AS cval_orders_o_orderpriority_5#8652, cval_orders_o_clerk#8629 AS cval_orders_o_clerk_5#8653, cval_orders_o_shippriority#8630 AS cval_orders_o_shippriority_5#8654, cval_orders_o_comment#8631 AS cval_orders_o_comment_5#8655, cval_orders_o_orderdate#8632 AS cval_orders_o_orderdate_5#8656, cdepval_orders_o_orderstatus#8633 AS cdepval_orders_o_orderstatus_5#8657, cdepval_orders_o_totalprice#8634 AS cdepval_orders_o_totalprice_5#8658, cdepval_orders_o_orderpriority#8635 AS cdepval_orders_o_orderpriority_5#8659, cdepval_orders_o_clerk#8636 AS cdepval_orders_o_clerk_5#8660, cdepval_orders_o_shippriority#8637 AS cdepval_orders_o_shippriority_5#8661, cdepval_orders_o_comment#8638 AS cdepval_orders_o_comment_5#8662, cdepval_orders_o_orderdate#8639 AS cdepval_orders_o_orderdate_5#8663, co_orderstatus#8640 AS co_orderstatus_5#8664, co_totalprice#8641 AS co_totalprice_5#8665, co_orderpriority#8642 AS co_orderpriority_5#8666, co_clerk#8643 AS co_clerk_5#8667, co_shippriority#8644 AS co_shippriority_5#8668, co_comment#8645 AS co_comment_5#8669, co_orderdate#8646 AS co_orderdate_5#8670]
            +- Relation[rid#8623,cpfk_customer_orders#8624,cfpk_orders_customer#8625,cval_orders_o_orderstatus#8626,cval_orders_o_totalprice#8627,cval_orders_o_orderpriority#8628,cval_orders_o_clerk#8629,cval_orders_o_shippriority#8630,cval_orders_o_comment#8631,cval_orders_o_orderdate#8632,cdepval_orders_o_orderstatus#8633,cdepval_orders_o_totalprice#8634,cdepval_orders_o_orderpriority#8635,cdepval_orders_o_clerk#8636,cdepval_orders_o_shippriority#8637,cdepval_orders_o_comment#8638,cdepval_orders_o_orderdate#8639,co_orderstatus#8640,co_totalprice#8641,co_orderpriority#8642,co_clerk#8643,co_shippriority#8644,co_comment#8645,co_orderdate#8646] JDBCRelation(torders) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 63085ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
20/04/26 21:38:00 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:38:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#8812L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:38:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#8812L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x90E9756CE9E774979BC7438924415E31F5BE5663870801370EDCFD87198A6779, dexencode('rid_1, BinaryType)), 'cfpk_lineitem_part_1) = 'rid_0)
         :- Project [rid#8864 AS rid_1#8909, cpfk_orders_lineitem#8865 AS cpfk_orders_lineitem_1#8910, cpfk_supplier_lineitem#8866 AS cpfk_supplier_lineitem_1#8911, cfpk_lineitem_supplier#8867 AS cfpk_lineitem_supplier_1#8912, cfpk_lineitem_partsupp#8868 AS cfpk_lineitem_partsupp_1#8913, cpfk_part_lineitem#8869 AS cpfk_part_lineitem_1#8914, cfpk_lineitem_part#8870 AS cfpk_lineitem_part_1#8915, cpfk_partsupp_lineitem#8871 AS cpfk_partsupp_lineitem_1#8916, cfpk_lineitem_orders#8872 AS cfpk_lineitem_orders_1#8917, cval_lineitem_l_quantity#8873 AS cval_lineitem_l_quantity_1#8918, cval_lineitem_l_extendedprice#8874 AS cval_lineitem_l_extendedprice_1#8919, cval_lineitem_l_discount#8875 AS cval_lineitem_l_discount_1#8920, cval_lineitem_l_tax#8876 AS cval_lineitem_l_tax_1#8921, cval_lineitem_l_returnflag#8877 AS cval_lineitem_l_returnflag_1#8922, cval_lineitem_l_linestatus#8878 AS cval_lineitem_l_linestatus_1#8923, cval_lineitem_l_commitdate#8879 AS cval_lineitem_l_commitdate_1#8924, cval_lineitem_l_receiptdate#8880 AS cval_lineitem_l_receiptdate_1#8925, cval_lineitem_l_shipinstruct#8881 AS cval_lineitem_l_shipinstruct_1#8926, cval_lineitem_l_shipmode#8882 AS cval_lineitem_l_shipmode_1#8927, cval_lineitem_l_comment#8883 AS cval_lineitem_l_comment_1#8928, cval_lineitem_l_shipdate#8884 AS cval_lineitem_l_shipdate_1#8929, cdepval_lineitem_l_quantity#8885 AS cdepval_lineitem_l_quantity_1#8930, cdepval_lineitem_l_extendedprice#8886 AS cdepval_lineitem_l_extendedprice_1#8931, cdepval_lineitem_l_discount#8887 AS cdepval_lineitem_l_discount_1#8932, ... 21 more fields]
         :  +- Relation[rid#8864,cpfk_orders_lineitem#8865,cpfk_supplier_lineitem#8866,cfpk_lineitem_supplier#8867,cfpk_lineitem_partsupp#8868,cpfk_part_lineitem#8869,cfpk_lineitem_part#8870,cpfk_partsupp_lineitem#8871,cfpk_lineitem_orders#8872,cval_lineitem_l_quantity#8873,cval_lineitem_l_extendedprice#8874,cval_lineitem_l_discount#8875,cval_lineitem_l_tax#8876,cval_lineitem_l_returnflag#8877,cval_lineitem_l_linestatus#8878,cval_lineitem_l_commitdate#8879,cval_lineitem_l_receiptdate#8880,cval_lineitem_l_shipinstruct#8881,cval_lineitem_l_shipmode#8882,cval_lineitem_l_comment#8883,cval_lineitem_l_shipdate#8884,cdepval_lineitem_l_quantity#8885,cdepval_lineitem_l_extendedprice#8886,cdepval_lineitem_l_discount#8887,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         +- Project [rid#8814 AS rid_0#8839, cval_part_p_name#8815 AS cval_part_p_name_0#8840, cval_part_p_mfgr#8816 AS cval_part_p_mfgr_0#8841, cval_part_p_type#8817 AS cval_part_p_type_0#8842, cval_part_p_size#8818 AS cval_part_p_size_0#8843, cval_part_p_container#8819 AS cval_part_p_container_0#8844, cval_part_p_retailprice#8820 AS cval_part_p_retailprice_0#8845, cval_part_p_comment#8821 AS cval_part_p_comment_0#8846, cval_part_p_brand#8822 AS cval_part_p_brand_0#8847, cdepval_part_p_name#8823 AS cdepval_part_p_name_0#8848, cdepval_part_p_mfgr#8824 AS cdepval_part_p_mfgr_0#8849, cdepval_part_p_type#8825 AS cdepval_part_p_type_0#8850, cdepval_part_p_size#8826 AS cdepval_part_p_size_0#8851, cdepval_part_p_container#8827 AS cdepval_part_p_container_0#8852, cdepval_part_p_retailprice#8828 AS cdepval_part_p_retailprice_0#8853, cdepval_part_p_comment#8829 AS cdepval_part_p_comment_0#8854, cdepval_part_p_brand#8830 AS cdepval_part_p_brand_0#8855, cp_name#8831 AS cp_name_0#8856, cp_mfgr#8832 AS cp_mfgr_0#8857, cp_type#8833 AS cp_type_0#8858, cp_size#8834 AS cp_size_0#8859, cp_container#8835 AS cp_container_0#8860, cp_retailprice#8836 AS cp_retailprice_0#8861, cp_comment#8837 AS cp_comment_0#8862, cp_brand#8838 AS cp_brand_0#8863]
            +- Relation[rid#8814,cval_part_p_name#8815,cval_part_p_mfgr#8816,cval_part_p_type#8817,cval_part_p_size#8818,cval_part_p_container#8819,cval_part_p_retailprice#8820,cval_part_p_comment#8821,cval_part_p_brand#8822,cdepval_part_p_name#8823,cdepval_part_p_mfgr#8824,cdepval_part_p_type#8825,cdepval_part_p_size#8826,cdepval_part_p_container#8827,cdepval_part_p_retailprice#8828,cdepval_part_p_comment#8829,cdepval_part_p_brand#8830,cp_name#8831,cp_mfgr#8832,cp_type#8833,cp_size#8834,cp_container#8835,cp_retailprice#8836,cp_comment#8837,cp_brand#8838] JDBCRelation(tpart) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 17776ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
20/04/26 21:38:18 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:38:18 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9032L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#748L = c_nationkey#293L)
               :     :- Project [n_nationkey#748L]
               :     :  +- Filter (n_name#749 = GERMANY)
               :     :     +- Relation[n_nationkey#748L,n_name#749,n_regionkey#750L,n_comment#751] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=supplier
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:38:18 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9032L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_orders_2) = 'rid_5)
         :- 'Join Inner, (dexdecrypt(dexprf(0x3931CE1B33FE5F43A40C97988128FA62C782E4FDB0686B939E3CC5D2245043C8, dexencode('rid_2, BinaryType)), 'cfpk_lineitem_supplier_2) = 'rid_1)
         :  :- Project [rid#9160 AS rid_2#9205, cpfk_orders_lineitem#9161 AS cpfk_orders_lineitem_2#9206, cpfk_supplier_lineitem#9162 AS cpfk_supplier_lineitem_2#9207, cfpk_lineitem_supplier#9163 AS cfpk_lineitem_supplier_2#9208, cfpk_lineitem_partsupp#9164 AS cfpk_lineitem_partsupp_2#9209, cpfk_part_lineitem#9165 AS cpfk_part_lineitem_2#9210, cfpk_lineitem_part#9166 AS cfpk_lineitem_part_2#9211, cpfk_partsupp_lineitem#9167 AS cpfk_partsupp_lineitem_2#9212, cfpk_lineitem_orders#9168 AS cfpk_lineitem_orders_2#9213, cval_lineitem_l_quantity#9169 AS cval_lineitem_l_quantity_2#9214, cval_lineitem_l_extendedprice#9170 AS cval_lineitem_l_extendedprice_2#9215, cval_lineitem_l_discount#9171 AS cval_lineitem_l_discount_2#9216, cval_lineitem_l_tax#9172 AS cval_lineitem_l_tax_2#9217, cval_lineitem_l_returnflag#9173 AS cval_lineitem_l_returnflag_2#9218, cval_lineitem_l_linestatus#9174 AS cval_lineitem_l_linestatus_2#9219, cval_lineitem_l_commitdate#9175 AS cval_lineitem_l_commitdate_2#9220, cval_lineitem_l_receiptdate#9176 AS cval_lineitem_l_receiptdate_2#9221, cval_lineitem_l_shipinstruct#9177 AS cval_lineitem_l_shipinstruct_2#9222, cval_lineitem_l_shipmode#9178 AS cval_lineitem_l_shipmode_2#9223, cval_lineitem_l_comment#9179 AS cval_lineitem_l_comment_2#9224, cval_lineitem_l_shipdate#9180 AS cval_lineitem_l_shipdate_2#9225, cdepval_lineitem_l_quantity#9181 AS cdepval_lineitem_l_quantity_2#9226, cdepval_lineitem_l_extendedprice#9182 AS cdepval_lineitem_l_extendedprice_2#9227, cdepval_lineitem_l_discount#9183 AS cdepval_lineitem_l_discount_2#9228, ... 21 more fields]
         :  :  +- Relation[rid#9160,cpfk_orders_lineitem#9161,cpfk_supplier_lineitem#9162,cfpk_lineitem_supplier#9163,cfpk_lineitem_partsupp#9164,cpfk_part_lineitem#9165,cfpk_lineitem_part#9166,cpfk_partsupp_lineitem#9167,cfpk_lineitem_orders#9168,cval_lineitem_l_quantity#9169,cval_lineitem_l_extendedprice#9170,cval_lineitem_l_discount#9171,cval_lineitem_l_tax#9172,cval_lineitem_l_returnflag#9173,cval_lineitem_l_linestatus#9174,cval_lineitem_l_commitdate#9175,cval_lineitem_l_receiptdate#9176,cval_lineitem_l_shipinstruct#9177,cval_lineitem_l_shipmode#9178,cval_lineitem_l_comment#9179,cval_lineitem_l_shipdate#9180,cdepval_lineitem_l_quantity#9181,cdepval_lineitem_l_extendedprice#9182,cdepval_lineitem_l_discount#9183,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  +- 'Join UsingJoin(Inner,List(rid_1))
         :     :- 'DexPkfkMaterializationAwareJoin nation~supplier, 'cpfk_nation_supplier_1, 'rid_0, NotMaterialized, NotMaterialized, [rid_0#9043, cpfk_region_nation_0#9044, cfpk_nation_region_0#9045, cval_nation_n_name_0#9046, cval_nation_n_comment_0#9047, cdepval_nation_n_name_0#9048, cdepval_nation_n_comment_0#9049, cn_name_0#9050, cn_comment_0#9051, 'rid_1]
         :     :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~FRANCE, cval_nation_n_name, 'cval_nation_n_name_0, tnation
         :     :  :  +- Project [rid#9034 AS rid_0#9043, cpfk_region_nation#9035 AS cpfk_region_nation_0#9044, cfpk_nation_region#9036 AS cfpk_nation_region_0#9045, cval_nation_n_name#9037 AS cval_nation_n_name_0#9046, cval_nation_n_comment#9038 AS cval_nation_n_comment_0#9047, cdepval_nation_n_name#9039 AS cdepval_nation_n_name_0#9048, cdepval_nation_n_comment#9040 AS cdepval_nation_n_comment_0#9049, cn_name#9041 AS cn_name_0#9050, cn_comment#9042 AS cn_comment_0#9051]
         :     :  :     +- Relation[rid#9034,cpfk_region_nation#9035,cfpk_nation_region#9036,cval_nation_n_name#9037,cval_nation_n_comment#9038,cdepval_nation_n_name#9039,cdepval_nation_n_comment#9040,cn_name#9041,cn_comment#9042] JDBCRelation(tnation) [numPartitions=1]
         :     :  +- 'Project ['cpfk_nation_supplier_1, 'rid_1]
         :     :     +- Project [rid#9124 AS rid_1#9142, cpfk_nation_supplier#9125 AS cpfk_nation_supplier_1#9143, cfpk_supplier_nation#9126 AS cfpk_supplier_nation_1#9144, cval_supplier_s_name#9127 AS cval_supplier_s_name_1#9145, cval_supplier_s_address#9128 AS cval_supplier_s_address_1#9146, cval_supplier_s_phone#9129 AS cval_supplier_s_phone_1#9147, cval_supplier_s_acctbal#9130 AS cval_supplier_s_acctbal_1#9148, cval_supplier_s_comment#9131 AS cval_supplier_s_comment_1#9149, cdepval_supplier_s_name#9132 AS cdepval_supplier_s_name_1#9150, cdepval_supplier_s_address#9133 AS cdepval_supplier_s_address_1#9151, cdepval_supplier_s_phone#9134 AS cdepval_supplier_s_phone_1#9152, cdepval_supplier_s_acctbal#9135 AS cdepval_supplier_s_acctbal_1#9153, cdepval_supplier_s_comment#9136 AS cdepval_supplier_s_comment_1#9154, cs_name#9137 AS cs_name_1#9155, cs_address#9138 AS cs_address_1#9156, cs_phone#9139 AS cs_phone_1#9157, cs_acctbal#9140 AS cs_acctbal_1#9158, cs_comment#9141 AS cs_comment_1#9159]
         :     :        +- Relation[rid#9124,cpfk_nation_supplier#9125,cfpk_supplier_nation#9126,cval_supplier_s_name#9127,cval_supplier_s_address#9128,cval_supplier_s_phone#9129,cval_supplier_s_acctbal#9130,cval_supplier_s_comment#9131,cdepval_supplier_s_name#9132,cdepval_supplier_s_address#9133,cdepval_supplier_s_phone#9134,cdepval_supplier_s_acctbal#9135,cdepval_supplier_s_comment#9136,cs_name#9137,cs_address#9138,cs_phone#9139,cs_acctbal#9140,cs_comment#9141] JDBCRelation(tsupplier) [numPartitions=1]
         :     +- Project [rid#9070 AS rid_1#9088, cpfk_nation_supplier#9071 AS cpfk_nation_supplier_1#9089, cfpk_supplier_nation#9072 AS cfpk_supplier_nation_1#9090, cval_supplier_s_name#9073 AS cval_supplier_s_name_1#9091, cval_supplier_s_address#9074 AS cval_supplier_s_address_1#9092, cval_supplier_s_phone#9075 AS cval_supplier_s_phone_1#9093, cval_supplier_s_acctbal#9076 AS cval_supplier_s_acctbal_1#9094, cval_supplier_s_comment#9077 AS cval_supplier_s_comment_1#9095, cdepval_supplier_s_name#9078 AS cdepval_supplier_s_name_1#9096, cdepval_supplier_s_address#9079 AS cdepval_supplier_s_address_1#9097, cdepval_supplier_s_phone#9080 AS cdepval_supplier_s_phone_1#9098, cdepval_supplier_s_acctbal#9081 AS cdepval_supplier_s_acctbal_1#9099, cdepval_supplier_s_comment#9082 AS cdepval_supplier_s_comment_1#9100, cs_name#9083 AS cs_name_1#9101, cs_address#9084 AS cs_address_1#9102, cs_phone#9085 AS cs_phone_1#9103, cs_acctbal#9086 AS cs_acctbal_1#9104, cs_comment#9087 AS cs_comment_1#9105]
         :        +- Relation[rid#9070,cpfk_nation_supplier#9071,cfpk_supplier_nation#9072,cval_supplier_s_name#9073,cval_supplier_s_address#9074,cval_supplier_s_phone#9075,cval_supplier_s_acctbal#9076,cval_supplier_s_comment#9077,cdepval_supplier_s_name#9078,cdepval_supplier_s_address#9079,cdepval_supplier_s_phone#9080,cdepval_supplier_s_acctbal#9081,cdepval_supplier_s_comment#9082,cs_name#9083,cs_address#9084,cs_phone#9085,cs_acctbal#9086,cs_comment#9087] JDBCRelation(tsupplier) [numPartitions=1]
         +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_5, BinaryType)), 'cfpk_orders_customer_5) = 'rid_4)
            :- Project [rid#9388 AS rid_5#9412, cpfk_customer_orders#9389 AS cpfk_customer_orders_5#9413, cfpk_orders_customer#9390 AS cfpk_orders_customer_5#9414, cval_orders_o_orderstatus#9391 AS cval_orders_o_orderstatus_5#9415, cval_orders_o_totalprice#9392 AS cval_orders_o_totalprice_5#9416, cval_orders_o_orderpriority#9393 AS cval_orders_o_orderpriority_5#9417, cval_orders_o_clerk#9394 AS cval_orders_o_clerk_5#9418, cval_orders_o_shippriority#9395 AS cval_orders_o_shippriority_5#9419, cval_orders_o_comment#9396 AS cval_orders_o_comment_5#9420, cval_orders_o_orderdate#9397 AS cval_orders_o_orderdate_5#9421, cdepval_orders_o_orderstatus#9398 AS cdepval_orders_o_orderstatus_5#9422, cdepval_orders_o_totalprice#9399 AS cdepval_orders_o_totalprice_5#9423, cdepval_orders_o_orderpriority#9400 AS cdepval_orders_o_orderpriority_5#9424, cdepval_orders_o_clerk#9401 AS cdepval_orders_o_clerk_5#9425, cdepval_orders_o_shippriority#9402 AS cdepval_orders_o_shippriority_5#9426, cdepval_orders_o_comment#9403 AS cdepval_orders_o_comment_5#9427, cdepval_orders_o_orderdate#9404 AS cdepval_orders_o_orderdate_5#9428, co_orderstatus#9405 AS co_orderstatus_5#9429, co_totalprice#9406 AS co_totalprice_5#9430, co_orderpriority#9407 AS co_orderpriority_5#9431, co_clerk#9408 AS co_clerk_5#9432, co_shippriority#9409 AS co_shippriority_5#9433, co_comment#9410 AS co_comment_5#9434, co_orderdate#9411 AS co_orderdate_5#9435]
            :  +- Relation[rid#9388,cpfk_customer_orders#9389,cfpk_orders_customer#9390,cval_orders_o_orderstatus#9391,cval_orders_o_totalprice#9392,cval_orders_o_orderpriority#9393,cval_orders_o_clerk#9394,cval_orders_o_shippriority#9395,cval_orders_o_comment#9396,cval_orders_o_orderdate#9397,cdepval_orders_o_orderstatus#9398,cdepval_orders_o_totalprice#9399,cdepval_orders_o_orderpriority#9400,cdepval_orders_o_clerk#9401,cdepval_orders_o_shippriority#9402,cdepval_orders_o_comment#9403,cdepval_orders_o_orderdate#9404,co_orderstatus#9405,co_totalprice#9406,co_orderpriority#9407,co_clerk#9408,co_shippriority#9409,co_comment#9410,co_orderdate#9411] JDBCRelation(torders) [numPartitions=1]
            +- 'Join UsingJoin(Inner,List(rid_4))
               :- 'DexPkfkMaterializationAwareJoin nation~customer, 'cpfk_nation_customer_4, 'rid_3, NotMaterialized, NotMaterialized, [rid_3#9259, cpfk_region_nation_3#9260, cfpk_nation_region_3#9261, cval_nation_n_name_3#9262, cval_nation_n_comment_3#9263, cdepval_nation_n_name_3#9264, cdepval_nation_n_comment_3#9265, cn_name_3#9266, cn_comment_3#9267, 'rid_4]
               :  :- 'DexPseudoPrimaryKeyFilter nation~n_name~GERMANY, cval_nation_n_name, 'cval_nation_n_name_3, tnation
               :  :  +- Project [rid#9250 AS rid_3#9259, cpfk_region_nation#9251 AS cpfk_region_nation_3#9260, cfpk_nation_region#9252 AS cfpk_nation_region_3#9261, cval_nation_n_name#9253 AS cval_nation_n_name_3#9262, cval_nation_n_comment#9254 AS cval_nation_n_comment_3#9263, cdepval_nation_n_name#9255 AS cdepval_nation_n_name_3#9264, cdepval_nation_n_comment#9256 AS cdepval_nation_n_comment_3#9265, cn_name#9257 AS cn_name_3#9266, cn_comment#9258 AS cn_comment_3#9267]
               :  :     +- Relation[rid#9250,cpfk_region_nation#9251,cfpk_nation_region#9252,cval_nation_n_name#9253,cval_nation_n_comment#9254,cdepval_nation_n_name#9255,cdepval_nation_n_comment#9256,cn_name#9257,cn_comment#9258] JDBCRelation(tnation) [numPartitions=1]
               :  +- 'Project ['cpfk_nation_customer_4, 'rid_4]
               :     +- Project [rid#9346 AS rid_4#9367, cpfk_nation_customer#9347 AS cpfk_nation_customer_4#9368, cfpk_customer_nation#9348 AS cfpk_customer_nation_4#9369, cval_customer_c_name#9349 AS cval_customer_c_name_4#9370, cval_customer_c_address#9350 AS cval_customer_c_address_4#9371, cval_customer_c_phone#9351 AS cval_customer_c_phone_4#9372, cval_customer_c_acctbal#9352 AS cval_customer_c_acctbal_4#9373, cval_customer_c_comment#9353 AS cval_customer_c_comment_4#9374, cval_customer_c_mktsegment#9354 AS cval_customer_c_mktsegment_4#9375, cdepval_customer_c_name#9355 AS cdepval_customer_c_name_4#9376, cdepval_customer_c_address#9356 AS cdepval_customer_c_address_4#9377, cdepval_customer_c_phone#9357 AS cdepval_customer_c_phone_4#9378, cdepval_customer_c_acctbal#9358 AS cdepval_customer_c_acctbal_4#9379, cdepval_customer_c_comment#9359 AS cdepval_customer_c_comment_4#9380, cdepval_customer_c_mktsegment#9360 AS cdepval_customer_c_mktsegment_4#9381, cc_name#9361 AS cc_name_4#9382, cc_address#9362 AS cc_address_4#9383, cc_phone#9363 AS cc_phone_4#9384, cc_acctbal#9364 AS cc_acctbal_4#9385, cc_comment#9365 AS cc_comment_4#9386, cc_mktsegment#9366 AS cc_mktsegment_4#9387]
               :        +- Relation[rid#9346,cpfk_nation_customer#9347,cfpk_customer_nation#9348,cval_customer_c_name#9349,cval_customer_c_address#9350,cval_customer_c_phone#9351,cval_customer_c_acctbal#9352,cval_customer_c_comment#9353,cval_customer_c_mktsegment#9354,cdepval_customer_c_name#9355,cdepval_customer_c_address#9356,cdepval_customer_c_phone#9357,cdepval_customer_c_acctbal#9358,cdepval_customer_c_comment#9359,cdepval_customer_c_mktsegment#9360,cc_name#9361,cc_address#9362,cc_phone#9363,cc_acctbal#9364,cc_comment#9365,cc_mktsegment#9366] JDBCRelation(tcustomer) [numPartitions=1]
               +- Project [rid#9286 AS rid_4#9307, cpfk_nation_customer#9287 AS cpfk_nation_customer_4#9308, cfpk_customer_nation#9288 AS cfpk_customer_nation_4#9309, cval_customer_c_name#9289 AS cval_customer_c_name_4#9310, cval_customer_c_address#9290 AS cval_customer_c_address_4#9311, cval_customer_c_phone#9291 AS cval_customer_c_phone_4#9312, cval_customer_c_acctbal#9292 AS cval_customer_c_acctbal_4#9313, cval_customer_c_comment#9293 AS cval_customer_c_comment_4#9314, cval_customer_c_mktsegment#9294 AS cval_customer_c_mktsegment_4#9315, cdepval_customer_c_name#9295 AS cdepval_customer_c_name_4#9316, cdepval_customer_c_address#9296 AS cdepval_customer_c_address_4#9317, cdepval_customer_c_phone#9297 AS cdepval_customer_c_phone_4#9318, cdepval_customer_c_acctbal#9298 AS cdepval_customer_c_acctbal_4#9319, cdepval_customer_c_comment#9299 AS cdepval_customer_c_comment_4#9320, cdepval_customer_c_mktsegment#9300 AS cdepval_customer_c_mktsegment_4#9321, cc_name#9301 AS cc_name_4#9322, cc_address#9302 AS cc_address_4#9323, cc_phone#9303 AS cc_phone_4#9324, cc_acctbal#9304 AS cc_acctbal_4#9325, cc_comment#9305 AS cc_comment_4#9326, cc_mktsegment#9306 AS cc_mktsegment_4#9327]
                  +- Relation[rid#9286,cpfk_nation_customer#9287,cfpk_customer_nation#9288,cval_customer_c_name#9289,cval_customer_c_address#9290,cval_customer_c_phone#9291,cval_customer_c_acctbal#9292,cval_customer_c_comment#9293,cval_customer_c_mktsegment#9294,cdepval_customer_c_name#9295,cdepval_customer_c_address#9296,cdepval_customer_c_phone#9297,cdepval_customer_c_acctbal#9298,cdepval_customer_c_comment#9299,cdepval_customer_c_mktsegment#9300,cc_name#9301,cc_address#9302,cc_phone#9303,cc_acctbal#9304,cc_comment#9305,cc_mktsegment#9306] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=9735
Elapsed time: 40286ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
20/04/26 21:38:58 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:38:58 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9567L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

20/04/26 21:38:58 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9567L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_0, BinaryType)), 'cfpk_orders_customer_0) = 'rid_1)
         :- Project [rid#9569 AS rid_0#9593, cpfk_customer_orders#9570 AS cpfk_customer_orders_0#9594, cfpk_orders_customer#9571 AS cfpk_orders_customer_0#9595, cval_orders_o_orderstatus#9572 AS cval_orders_o_orderstatus_0#9596, cval_orders_o_totalprice#9573 AS cval_orders_o_totalprice_0#9597, cval_orders_o_orderpriority#9574 AS cval_orders_o_orderpriority_0#9598, cval_orders_o_clerk#9575 AS cval_orders_o_clerk_0#9599, cval_orders_o_shippriority#9576 AS cval_orders_o_shippriority_0#9600, cval_orders_o_comment#9577 AS cval_orders_o_comment_0#9601, cval_orders_o_orderdate#9578 AS cval_orders_o_orderdate_0#9602, cdepval_orders_o_orderstatus#9579 AS cdepval_orders_o_orderstatus_0#9603, cdepval_orders_o_totalprice#9580 AS cdepval_orders_o_totalprice_0#9604, cdepval_orders_o_orderpriority#9581 AS cdepval_orders_o_orderpriority_0#9605, cdepval_orders_o_clerk#9582 AS cdepval_orders_o_clerk_0#9606, cdepval_orders_o_shippriority#9583 AS cdepval_orders_o_shippriority_0#9607, cdepval_orders_o_comment#9584 AS cdepval_orders_o_comment_0#9608, cdepval_orders_o_orderdate#9585 AS cdepval_orders_o_orderdate_0#9609, co_orderstatus#9586 AS co_orderstatus_0#9610, co_totalprice#9587 AS co_totalprice_0#9611, co_orderpriority#9588 AS co_orderpriority_0#9612, co_clerk#9589 AS co_clerk_0#9613, co_shippriority#9590 AS co_shippriority_0#9614, co_comment#9591 AS co_comment_0#9615, co_orderdate#9592 AS co_orderdate_0#9616]
         :  +- Relation[rid#9569,cpfk_customer_orders#9570,cfpk_orders_customer#9571,cval_orders_o_orderstatus#9572,cval_orders_o_totalprice#9573,cval_orders_o_orderpriority#9574,cval_orders_o_clerk#9575,cval_orders_o_shippriority#9576,cval_orders_o_comment#9577,cval_orders_o_orderdate#9578,cdepval_orders_o_orderstatus#9579,cdepval_orders_o_totalprice#9580,cdepval_orders_o_orderpriority#9581,cdepval_orders_o_clerk#9582,cdepval_orders_o_shippriority#9583,cdepval_orders_o_comment#9584,cdepval_orders_o_orderdate#9585,co_orderstatus#9586,co_totalprice#9587,co_orderpriority#9588,co_clerk#9589,co_shippriority#9590,co_comment#9591,co_orderdate#9592] JDBCRelation(torders) [numPartitions=1]
         +- Project [rid#9617 AS rid_1#9638, cpfk_nation_customer#9618 AS cpfk_nation_customer_1#9639, cfpk_customer_nation#9619 AS cfpk_customer_nation_1#9640, cval_customer_c_name#9620 AS cval_customer_c_name_1#9641, cval_customer_c_address#9621 AS cval_customer_c_address_1#9642, cval_customer_c_phone#9622 AS cval_customer_c_phone_1#9643, cval_customer_c_acctbal#9623 AS cval_customer_c_acctbal_1#9644, cval_customer_c_comment#9624 AS cval_customer_c_comment_1#9645, cval_customer_c_mktsegment#9625 AS cval_customer_c_mktsegment_1#9646, cdepval_customer_c_name#9626 AS cdepval_customer_c_name_1#9647, cdepval_customer_c_address#9627 AS cdepval_customer_c_address_1#9648, cdepval_customer_c_phone#9628 AS cdepval_customer_c_phone_1#9649, cdepval_customer_c_acctbal#9629 AS cdepval_customer_c_acctbal_1#9650, cdepval_customer_c_comment#9630 AS cdepval_customer_c_comment_1#9651, cdepval_customer_c_mktsegment#9631 AS cdepval_customer_c_mktsegment_1#9652, cc_name#9632 AS cc_name_1#9653, cc_address#9633 AS cc_address_1#9654, cc_phone#9634 AS cc_phone_1#9655, cc_acctbal#9635 AS cc_acctbal_1#9656, cc_comment#9636 AS cc_comment_1#9657, cc_mktsegment#9637 AS cc_mktsegment_1#9658]
            +- Relation[rid#9617,cpfk_nation_customer#9618,cfpk_customer_nation#9619,cval_customer_c_name#9620,cval_customer_c_address#9621,cval_customer_c_phone#9622,cval_customer_c_acctbal#9623,cval_customer_c_comment#9624,cval_customer_c_mktsegment#9625,cdepval_customer_c_name#9626,cdepval_customer_c_address#9627,cdepval_customer_c_phone#9628,cdepval_customer_c_acctbal#9629,cdepval_customer_c_comment#9630,cdepval_customer_c_mktsegment#9631,cc_name#9632,cc_address#9633,cc_phone#9634,cc_acctbal#9635,cc_comment#9636,cc_mktsegment#9637] JDBCRelation(tcustomer) [numPartitions=1]

DexPkFk$ result size=1500000
Elapsed time: 4416ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
20/04/26 21:39:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:39:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#9716L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

20/04/26 21:39:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:39:03 WARN DexPlanner: InMemoryFileIndex=nation
20/04/26 21:39:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#9716L]
+- 'Project
   +- 'DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- 'Join Inner, (dexdecrypt(dexprf(0xE86F0751569DC3D1D3D22BA120ACCA6EEFFB7CED74EE04CA23423A14E04BDDF2, dexencode('rid_2, BinaryType)), 'cfpk_customer_nation_2) = 'rid_3)
         :- 'Join Inner, (dexdecrypt(dexprf(0x85C8B00493467AF7DE7DDEA89F9A4F579FB51E0F45AA4482BF2A4716700325C4, dexencode('rid_1, BinaryType)), 'cfpk_orders_customer_1) = 'rid_2)
         :  :- 'Join Inner, (dexdecrypt(dexprf(0x06EAD44A17B65F5357B33A6C379A162737709FAB1CE0BEAD23C574C7425C6438, dexencode('rid_0, BinaryType)), 'cfpk_lineitem_orders_0) = 'rid_1)
         :  :  :- 'DexPseudoPrimaryKeyFilter lineitem~l_returnflag~R, cval_lineitem_l_returnflag, 'cval_lineitem_l_returnflag_0, tlineitem
         :  :  :  +- Project [rid#9718 AS rid_0#9763, cpfk_orders_lineitem#9719 AS cpfk_orders_lineitem_0#9764, cpfk_supplier_lineitem#9720 AS cpfk_supplier_lineitem_0#9765, cfpk_lineitem_supplier#9721 AS cfpk_lineitem_supplier_0#9766, cfpk_lineitem_partsupp#9722 AS cfpk_lineitem_partsupp_0#9767, cpfk_part_lineitem#9723 AS cpfk_part_lineitem_0#9768, cfpk_lineitem_part#9724 AS cfpk_lineitem_part_0#9769, cpfk_partsupp_lineitem#9725 AS cpfk_partsupp_lineitem_0#9770, cfpk_lineitem_orders#9726 AS cfpk_lineitem_orders_0#9771, cval_lineitem_l_quantity#9727 AS cval_lineitem_l_quantity_0#9772, cval_lineitem_l_extendedprice#9728 AS cval_lineitem_l_extendedprice_0#9773, cval_lineitem_l_discount#9729 AS cval_lineitem_l_discount_0#9774, cval_lineitem_l_tax#9730 AS cval_lineitem_l_tax_0#9775, cval_lineitem_l_returnflag#9731 AS cval_lineitem_l_returnflag_0#9776, cval_lineitem_l_linestatus#9732 AS cval_lineitem_l_linestatus_0#9777, cval_lineitem_l_commitdate#9733 AS cval_lineitem_l_commitdate_0#9778, cval_lineitem_l_receiptdate#9734 AS cval_lineitem_l_receiptdate_0#9779, cval_lineitem_l_shipinstruct#9735 AS cval_lineitem_l_shipinstruct_0#9780, cval_lineitem_l_shipmode#9736 AS cval_lineitem_l_shipmode_0#9781, cval_lineitem_l_comment#9737 AS cval_lineitem_l_comment_0#9782, cval_lineitem_l_shipdate#9738 AS cval_lineitem_l_shipdate_0#9783, cdepval_lineitem_l_quantity#9739 AS cdepval_lineitem_l_quantity_0#9784, cdepval_lineitem_l_extendedprice#9740 AS cdepval_lineitem_l_extendedprice_0#9785, cdepval_lineitem_l_discount#9741 AS cdepval_lineitem_l_discount_0#9786, ... 21 more fields]
         :  :  :     +- Relation[rid#9718,cpfk_orders_lineitem#9719,cpfk_supplier_lineitem#9720,cfpk_lineitem_supplier#9721,cfpk_lineitem_partsupp#9722,cpfk_part_lineitem#9723,cfpk_lineitem_part#9724,cpfk_partsupp_lineitem#9725,cfpk_lineitem_orders#9726,cval_lineitem_l_quantity#9727,cval_lineitem_l_extendedprice#9728,cval_lineitem_l_discount#9729,cval_lineitem_l_tax#9730,cval_lineitem_l_returnflag#9731,cval_lineitem_l_linestatus#9732,cval_lineitem_l_commitdate#9733,cval_lineitem_l_receiptdate#9734,cval_lineitem_l_shipinstruct#9735,cval_lineitem_l_shipmode#9736,cval_lineitem_l_comment#9737,cval_lineitem_l_shipdate#9738,cdepval_lineitem_l_quantity#9739,cdepval_lineitem_l_extendedprice#9740,cdepval_lineitem_l_discount#9741,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]
         :  :  +- Project [rid#9898 AS rid_1#9922, cpfk_customer_orders#9899 AS cpfk_customer_orders_1#9923, cfpk_orders_customer#9900 AS cfpk_orders_customer_1#9924, cval_orders_o_orderstatus#9901 AS cval_orders_o_orderstatus_1#9925, cval_orders_o_totalprice#9902 AS cval_orders_o_totalprice_1#9926, cval_orders_o_orderpriority#9903 AS cval_orders_o_orderpriority_1#9927, cval_orders_o_clerk#9904 AS cval_orders_o_clerk_1#9928, cval_orders_o_shippriority#9905 AS cval_orders_o_shippriority_1#9929, cval_orders_o_comment#9906 AS cval_orders_o_comment_1#9930, cval_orders_o_orderdate#9907 AS cval_orders_o_orderdate_1#9931, cdepval_orders_o_orderstatus#9908 AS cdepval_orders_o_orderstatus_1#9932, cdepval_orders_o_totalprice#9909 AS cdepval_orders_o_totalprice_1#9933, cdepval_orders_o_orderpriority#9910 AS cdepval_orders_o_orderpriority_1#9934, cdepval_orders_o_clerk#9911 AS cdepval_orders_o_clerk_1#9935, cdepval_orders_o_shippriority#9912 AS cdepval_orders_o_shippriority_1#9936, cdepval_orders_o_comment#9913 AS cdepval_orders_o_comment_1#9937, cdepval_orders_o_orderdate#9914 AS cdepval_orders_o_orderdate_1#9938, co_orderstatus#9915 AS co_orderstatus_1#9939, co_totalprice#9916 AS co_totalprice_1#9940, co_orderpriority#9917 AS co_orderpriority_1#9941, co_clerk#9918 AS co_clerk_1#9942, co_shippriority#9919 AS co_shippriority_1#9943, co_comment#9920 AS co_comment_1#9944, co_orderdate#9921 AS co_orderdate_1#9945]
         :  :     +- Relation[rid#9898,cpfk_customer_orders#9899,cfpk_orders_customer#9900,cval_orders_o_orderstatus#9901,cval_orders_o_totalprice#9902,cval_orders_o_orderpriority#9903,cval_orders_o_clerk#9904,cval_orders_o_shippriority#9905,cval_orders_o_comment#9906,cval_orders_o_orderdate#9907,cdepval_orders_o_orderstatus#9908,cdepval_orders_o_totalprice#9909,cdepval_orders_o_orderpriority#9910,cdepval_orders_o_clerk#9911,cdepval_orders_o_shippriority#9912,cdepval_orders_o_comment#9913,cdepval_orders_o_orderdate#9914,co_orderstatus#9915,co_totalprice#9916,co_orderpriority#9917,co_clerk#9918,co_shippriority#9919,co_comment#9920,co_orderdate#9921] JDBCRelation(torders) [numPartitions=1]
         :  +- Project [rid#9946 AS rid_2#9967, cpfk_nation_customer#9947 AS cpfk_nation_customer_2#9968, cfpk_customer_nation#9948 AS cfpk_customer_nation_2#9969, cval_customer_c_name#9949 AS cval_customer_c_name_2#9970, cval_customer_c_address#9950 AS cval_customer_c_address_2#9971, cval_customer_c_phone#9951 AS cval_customer_c_phone_2#9972, cval_customer_c_acctbal#9952 AS cval_customer_c_acctbal_2#9973, cval_customer_c_comment#9953 AS cval_customer_c_comment_2#9974, cval_customer_c_mktsegment#9954 AS cval_customer_c_mktsegment_2#9975, cdepval_customer_c_name#9955 AS cdepval_customer_c_name_2#9976, cdepval_customer_c_address#9956 AS cdepval_customer_c_address_2#9977, cdepval_customer_c_phone#9957 AS cdepval_customer_c_phone_2#9978, cdepval_customer_c_acctbal#9958 AS cdepval_customer_c_acctbal_2#9979, cdepval_customer_c_comment#9959 AS cdepval_customer_c_comment_2#9980, cdepval_customer_c_mktsegment#9960 AS cdepval_customer_c_mktsegment_2#9981, cc_name#9961 AS cc_name_2#9982, cc_address#9962 AS cc_address_2#9983, cc_phone#9963 AS cc_phone_2#9984, cc_acctbal#9964 AS cc_acctbal_2#9985, cc_comment#9965 AS cc_comment_2#9986, cc_mktsegment#9966 AS cc_mktsegment_2#9987]
         :     +- Relation[rid#9946,cpfk_nation_customer#9947,cfpk_customer_nation#9948,cval_customer_c_name#9949,cval_customer_c_address#9950,cval_customer_c_phone#9951,cval_customer_c_acctbal#9952,cval_customer_c_comment#9953,cval_customer_c_mktsegment#9954,cdepval_customer_c_name#9955,cdepval_customer_c_address#9956,cdepval_customer_c_phone#9957,cdepval_customer_c_acctbal#9958,cdepval_customer_c_comment#9959,cdepval_customer_c_mktsegment#9960,cc_name#9961,cc_address#9962,cc_phone#9963,cc_acctbal#9964,cc_comment#9965,cc_mktsegment#9966] JDBCRelation(tcustomer) [numPartitions=1]
         +- Project [rid#9988 AS rid_3#9997, cpfk_region_nation#9989 AS cpfk_region_nation_3#9998, cfpk_nation_region#9990 AS cfpk_nation_region_3#9999, cval_nation_n_name#9991 AS cval_nation_n_name_3#10000, cval_nation_n_comment#9992 AS cval_nation_n_comment_3#10001, cdepval_nation_n_name#9993 AS cdepval_nation_n_name_3#10002, cdepval_nation_n_comment#9994 AS cdepval_nation_n_comment_3#10003, cn_name#9995 AS cn_name_3#10004, cn_comment#9996 AS cn_comment_3#10005]
            +- Relation[rid#9988,cpfk_region_nation#9989,cfpk_nation_region#9990,cval_nation_n_name#9991,cval_nation_n_comment#9992,cdepval_nation_n_name#9993,cdepval_nation_n_comment#9994,cn_name#9995,cn_comment#9996] JDBCRelation(tnation) [numPartitions=1]

DexPkFk$ result size=1478870
Elapsed time: 59276ms

q6=

select
  l_extendedprice,
  l_discount
from
  lineitem
        
20/04/26 21:40:02 WARN DexPlanner: dexPlan=DexPkFkPlan
20/04/26 21:40:02 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#10110L]
+- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

20/04/26 21:40:02 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#10110L]
+- Project
   +- DexPkFkPlan {l_orderkey_and_l_linenumber, ps_partkey_and_ps_suppkey, n_nationkey, r_regionkey, s_suppkey, p_partkey, c_custkey, o_orderkey}, {n_regionkey, o_custkey, s_nationkey, c_nationkey, l_partkey, l_partkey_and_l_suppkey, ps_partkey, l_suppkey, l_orderkey, ps_suppkey}
      +- Project [rid#10112 AS rid_0#10157, cpfk_orders_lineitem#10113 AS cpfk_orders_lineitem_0#10158, cpfk_supplier_lineitem#10114 AS cpfk_supplier_lineitem_0#10159, cfpk_lineitem_supplier#10115 AS cfpk_lineitem_supplier_0#10160, cfpk_lineitem_partsupp#10116 AS cfpk_lineitem_partsupp_0#10161, cpfk_part_lineitem#10117 AS cpfk_part_lineitem_0#10162, cfpk_lineitem_part#10118 AS cfpk_lineitem_part_0#10163, cpfk_partsupp_lineitem#10119 AS cpfk_partsupp_lineitem_0#10164, cfpk_lineitem_orders#10120 AS cfpk_lineitem_orders_0#10165, cval_lineitem_l_quantity#10121 AS cval_lineitem_l_quantity_0#10166, cval_lineitem_l_extendedprice#10122 AS cval_lineitem_l_extendedprice_0#10167, cval_lineitem_l_discount#10123 AS cval_lineitem_l_discount_0#10168, cval_lineitem_l_tax#10124 AS cval_lineitem_l_tax_0#10169, cval_lineitem_l_returnflag#10125 AS cval_lineitem_l_returnflag_0#10170, cval_lineitem_l_linestatus#10126 AS cval_lineitem_l_linestatus_0#10171, cval_lineitem_l_commitdate#10127 AS cval_lineitem_l_commitdate_0#10172, cval_lineitem_l_receiptdate#10128 AS cval_lineitem_l_receiptdate_0#10173, cval_lineitem_l_shipinstruct#10129 AS cval_lineitem_l_shipinstruct_0#10174, cval_lineitem_l_shipmode#10130 AS cval_lineitem_l_shipmode_0#10175, cval_lineitem_l_comment#10131 AS cval_lineitem_l_comment_0#10176, cval_lineitem_l_shipdate#10132 AS cval_lineitem_l_shipdate_0#10177, cdepval_lineitem_l_quantity#10133 AS cdepval_lineitem_l_quantity_0#10178, cdepval_lineitem_l_extendedprice#10134 AS cdepval_lineitem_l_extendedprice_0#10179, cdepval_lineitem_l_discount#10135 AS cdepval_lineitem_l_discount_0#10180, ... 21 more fields]
         +- Relation[rid#10112,cpfk_orders_lineitem#10113,cpfk_supplier_lineitem#10114,cfpk_lineitem_supplier#10115,cfpk_lineitem_partsupp#10116,cpfk_part_lineitem#10117,cfpk_lineitem_part#10118,cpfk_partsupp_lineitem#10119,cfpk_lineitem_orders#10120,cval_lineitem_l_quantity#10121,cval_lineitem_l_extendedprice#10122,cval_lineitem_l_discount#10123,cval_lineitem_l_tax#10124,cval_lineitem_l_returnflag#10125,cval_lineitem_l_linestatus#10126,cval_lineitem_l_commitdate#10127,cval_lineitem_l_receiptdate#10128,cval_lineitem_l_shipinstruct#10129,cval_lineitem_l_shipmode#10130,cval_lineitem_l_comment#10131,cval_lineitem_l_shipdate#10132,cdepval_lineitem_l_quantity#10133,cdepval_lineitem_l_extendedprice#10134,cdepval_lineitem_l_discount#10135,... 21 more fields] JDBCRelation(tlineitem) [numPartitions=1]

DexPkFk$ result size=6001215
Elapsed time: 2423ms
query=q1, count=6001215, duration=2370
query=q10, count=1478870, duration=59276
query=q11, count=31680, duration=2542
query=q12, count=857401, duration=22307
query=q13, count=1500000, duration=4366
query=q14, count=6001215, duration=17776
query=q15, count=6001215, duration=17220
query=q16, count=15780, duration=627
query=q17, count=6088, duration=499
query=q18, count=6001215, duration=22412
query=q19, count=205, duration=16109
query=q2, count=3162, duration=890
query=q20, count=632, duration=816
query=q21a, count=597422, duration=158873
query=q22, count=1500000, duration=4416
query=q3, count=1214743, duration=24475
query=q4, count=6001215, duration=18378
query=q5, count=48089, duration=29514
query=q6, count=6001215, duration=2423
query=q7, count=9735, duration=40286
query=q8, count=8716, duration=3388
query=q9a, count=6001215, duration=63085
query=q9b, count=6001215, duration=37734
