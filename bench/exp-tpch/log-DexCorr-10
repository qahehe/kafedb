19/10/22 02:50:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7220ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 22 02:50:39 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 22 02:50:40 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 22 02:50:40 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 22 02:50:40 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 22 02:50:40 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 22 02:50:43 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 22 02:50:45 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 22 02:50:45 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
19/10/22 02:50:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:50:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1948L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/22 02:50:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:50:46 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:50:46 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
19/10/22 02:50:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1948L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#1993]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#1973: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [l_returnflag_prf#1950 AS l_returnflag_prf_0#1969, l_orderkey_and_l_linenumber_prf#1951 AS l_orderkey_and_l_linenumber_prf_0#1970, l_comment_prf#1952 AS l_comment_prf_0#1971, l_linestatus_prf#1953 AS l_linestatus_prf_0#1972, rid#1954 AS rid_0#1973, l_shipmode_prf#1955 AS l_shipmode_prf_0#1974, l_shipinstruct_prf#1956 AS l_shipinstruct_prf_0#1975, l_quantity_prf#1957 AS l_quantity_prf_0#1976, l_receiptdate_prf#1958 AS l_receiptdate_prf_0#1977, l_linenumber_prf#1959 AS l_linenumber_prf_0#1978, l_tax_prf#1960 AS l_tax_prf_0#1979, l_shipdate_prf#1961 AS l_shipdate_prf_0#1980, l_extendedprice_prf#1962 AS l_extendedprice_prf_0#1981, l_partkey_prf#1963 AS l_partkey_prf_0#1982, l_discount_prf#1964 AS l_discount_prf_0#1983, l_partkey_and_l_suppkey_prf#1965 AS l_partkey_and_l_suppkey_prf_0#1984, l_commitdate_prf#1966 AS l_commitdate_prf_0#1985, l_suppkey_prf#1967 AS l_suppkey_prf_0#1986, l_orderkey_prf#1968 AS l_orderkey_prf_0#1987]
         :     :  :     :  :     :  :  +- Relation[l_returnflag_prf#1950,l_orderkey_and_l_linenumber_prf#1951,l_comment_prf#1952,l_linestatus_prf#1953,rid#1954,l_shipmode_prf#1955,l_shipinstruct_prf#1956,l_quantity_prf#1957,l_receiptdate_prf#1958,l_linenumber_prf#1959,l_tax_prf#1960,l_shipdate_prf#1961,l_extendedprice_prf#1962,l_partkey_prf#1963,l_discount_prf#1964,l_partkey_and_l_suppkey_prf#1965,l_commitdate_prf#1966,l_suppkey_prf#1967,l_orderkey_prf#1968] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#1990]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#1994 AS o_shippriority_prf_1#2004, rid#1995 AS rid_1#2005, o_orderdate_prf#1996 AS o_orderdate_prf_1#2006, o_custkey_prf#1997 AS o_custkey_prf_1#2007, o_orderpriority_prf#1998 AS o_orderpriority_prf_1#2008, o_clerk_prf#1999 AS o_clerk_prf_1#2009, o_orderstatus_prf#2000 AS o_orderstatus_prf_1#2010, o_totalprice_prf#2001 AS o_totalprice_prf_1#2011, o_orderkey_prf#2002 AS o_orderkey_prf_1#2012, o_comment_prf#2003 AS o_comment_prf_1#2013]
         :     :  :     :     +- Relation[o_shippriority_prf#1994,rid#1995,o_orderdate_prf#1996,o_custkey_prf#1997,o_orderpriority_prf#1998,o_clerk_prf#1999,o_orderstatus_prf#2000,o_totalprice_prf#2001,o_orderkey_prf#2002,o_comment_prf#2003] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#2015 AS c_acctbal_prf_2#2024, rid#2016 AS rid_2#2025, c_name_prf#2017 AS c_name_prf_2#2026, c_nationkey_prf#2018 AS c_nationkey_prf_2#2027, c_custkey_prf#2019 AS c_custkey_prf_2#2028, c_comment_prf#2020 AS c_comment_prf_2#2029, c_address_prf#2021 AS c_address_prf_2#2030, c_mktsegment_prf#2022 AS c_mktsegment_prf_2#2031, c_phone_prf#2023 AS c_phone_prf_2#2032]
         :     :     +- Relation[c_acctbal_prf#2015,rid#2016,c_name_prf#2017,c_nationkey_prf#2018,c_custkey_prf#2019,c_comment_prf#2020,c_address_prf#2021,c_mktsegment_prf#2022,c_phone_prf#2023] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#2034 AS rid_3#2039, n_regionkey_prf#2035 AS n_regionkey_prf_3#2040, n_nationkey_prf#2036 AS n_nationkey_prf_3#2041, n_name_prf#2037 AS n_name_prf_3#2042, n_comment_prf#2038 AS n_comment_prf_3#2043]
            +- Relation[rid#2034,n_regionkey_prf#2035,n_nationkey_prf#2036,n_name_prf#2037,n_comment_prf#2038] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 179509ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/22 02:53:46 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:53:46 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2096L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 02:53:46 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2096L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [c_acctbal_prf#2098 AS c_acctbal_prf_0#2107, rid#2099 AS rid_0#2108, c_name_prf#2100 AS c_name_prf_0#2109, c_nationkey_prf#2101 AS c_nationkey_prf_0#2110, c_custkey_prf#2102 AS c_custkey_prf_0#2111, c_comment_prf#2103 AS c_comment_prf_0#2112, c_address_prf#2104 AS c_address_prf_0#2113, c_mktsegment_prf#2105 AS c_mktsegment_prf_0#2114, c_phone_prf#2106 AS c_phone_prf_0#2115]
         :  :  :  :  +- Relation[c_acctbal_prf#2098,rid#2099,c_name_prf#2100,c_nationkey_prf#2101,c_custkey_prf#2102,c_comment_prf#2103,c_address_prf#2104,c_mktsegment_prf#2105,c_phone_prf#2106] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2126]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#2125]
         :  :  :        :  +- Relation[c_acctbal_prf#2116,rid#2117,c_name_prf#2118,c_nationkey_prf#2119,c_custkey_prf#2120,c_comment_prf#2121,c_address_prf#2122,c_mktsegment_prf#2123,c_phone_prf#2124] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#2127 AS o_shippriority_prf_1#2137, rid#2128 AS rid_1#2138, o_orderdate_prf#2129 AS o_orderdate_prf_1#2139, o_custkey_prf#2130 AS o_custkey_prf_1#2140, o_orderpriority_prf#2131 AS o_orderpriority_prf_1#2141, o_clerk_prf#2132 AS o_clerk_prf_1#2142, o_orderstatus_prf#2133 AS o_orderstatus_prf_1#2143, o_totalprice_prf#2134 AS o_totalprice_prf_1#2144, o_orderkey_prf#2135 AS o_orderkey_prf_1#2145, o_comment_prf#2136 AS o_comment_prf_1#2146]
         :  :     +- Relation[o_shippriority_prf#2127,rid#2128,o_orderdate_prf#2129,o_custkey_prf#2130,o_orderpriority_prf#2131,o_clerk_prf#2132,o_orderstatus_prf#2133,o_totalprice_prf#2134,o_orderkey_prf#2135,o_comment_prf#2136] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#2158]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#2157]
         :        :  +- Relation[o_shippriority_prf#2147,rid#2148,o_orderdate_prf#2149,o_custkey_prf#2150,o_orderpriority_prf#2151,o_clerk_prf#2152,o_orderstatus_prf#2153,o_totalprice_prf#2154,o_orderkey_prf#2155,o_comment_prf#2156] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2159 AS l_returnflag_prf_2#2178, l_orderkey_and_l_linenumber_prf#2160 AS l_orderkey_and_l_linenumber_prf_2#2179, l_comment_prf#2161 AS l_comment_prf_2#2180, l_linestatus_prf#2162 AS l_linestatus_prf_2#2181, rid#2163 AS rid_2#2182, l_shipmode_prf#2164 AS l_shipmode_prf_2#2183, l_shipinstruct_prf#2165 AS l_shipinstruct_prf_2#2184, l_quantity_prf#2166 AS l_quantity_prf_2#2185, l_receiptdate_prf#2167 AS l_receiptdate_prf_2#2186, l_linenumber_prf#2168 AS l_linenumber_prf_2#2187, l_tax_prf#2169 AS l_tax_prf_2#2188, l_shipdate_prf#2170 AS l_shipdate_prf_2#2189, l_extendedprice_prf#2171 AS l_extendedprice_prf_2#2190, l_partkey_prf#2172 AS l_partkey_prf_2#2191, l_discount_prf#2173 AS l_discount_prf_2#2192, l_partkey_and_l_suppkey_prf#2174 AS l_partkey_and_l_suppkey_prf_2#2193, l_commitdate_prf#2175 AS l_commitdate_prf_2#2194, l_suppkey_prf#2176 AS l_suppkey_prf_2#2195, l_orderkey_prf#2177 AS l_orderkey_prf_2#2196]
            +- Relation[l_returnflag_prf#2159,l_orderkey_and_l_linenumber_prf#2160,l_comment_prf#2161,l_linestatus_prf#2162,rid#2163,l_shipmode_prf#2164,l_shipinstruct_prf#2165,l_quantity_prf#2166,l_receiptdate_prf#2167,l_linenumber_prf#2168,l_tax_prf#2169,l_shipdate_prf#2170,l_extendedprice_prf#2171,l_partkey_prf#2172,l_discount_prf#2173,l_partkey_and_l_suppkey_prf#2174,l_commitdate_prf#2175,l_suppkey_prf#2176,l_orderkey_prf#2177] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 231547ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
19/10/22 02:57:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:57:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2240L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/22 02:57:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2240L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftAnti)
         :- Project [c_acctbal_prf#2274 AS c_acctbal_prf_1#2283, rid#2275 AS rid_1#2284, c_name_prf#2276 AS c_name_prf_1#2285, c_nationkey_prf#2277 AS c_nationkey_prf_1#2286, c_custkey_prf#2278 AS c_custkey_prf_1#2287, c_comment_prf#2279 AS c_comment_prf_1#2288, c_address_prf#2280 AS c_address_prf_1#2289, c_mktsegment_prf#2281 AS c_mktsegment_prf_1#2290, c_phone_prf#2282 AS c_phone_prf_1#2291]
         :  +- Relation[c_acctbal_prf#2274,rid#2275,c_name_prf#2276,c_nationkey_prf#2277,c_custkey_prf#2278,c_comment_prf#2279,c_address_prf#2280,c_mktsegment_prf#2281,c_phone_prf#2282] JDBCRelation(customer_prf) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [o_shippriority_prf#2242 AS o_shippriority_prf_0#2252, rid#2243 AS rid_0#2253, o_orderdate_prf#2244 AS o_orderdate_prf_0#2254, o_custkey_prf#2245 AS o_custkey_prf_0#2255, o_orderpriority_prf#2246 AS o_orderpriority_prf_0#2256, o_clerk_prf#2247 AS o_clerk_prf_0#2257, o_orderstatus_prf#2248 AS o_orderstatus_prf_0#2258, o_totalprice_prf#2249 AS o_totalprice_prf_0#2259, o_orderkey_prf#2250 AS o_orderkey_prf_0#2260, o_comment_prf#2251 AS o_comment_prf_0#2261]
            :  +- Relation[o_shippriority_prf#2242,rid#2243,o_orderdate_prf#2244,o_custkey_prf#2245,o_orderpriority_prf#2246,o_clerk_prf#2247,o_orderstatus_prf#2248,o_totalprice_prf#2249,o_orderkey_prf#2250,o_comment_prf#2251] JDBCRelation(orders_prf) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2273]
               +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
                  :- 'Project ['rid AS rid_0#2272]
                  :  +- Relation[o_shippriority_prf#2262,rid#2263,o_orderdate_prf#2264,o_custkey_prf#2265,o_orderpriority_prf#2266,o_clerk_prf#2267,o_orderstatus_prf#2268,o_totalprice_prf#2269,o_orderkey_prf#2270,o_comment_prf#2271] JDBCRelation(orders_prf) [numPartitions=1]
                  +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=50004
Elapsed time: 45857ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
19/10/22 02:58:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:58:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2309L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#610L = c_nationkey#293L)
               :     :- Project [n_nationkey#610L]
               :     :  +- Filter (n_name#611 = GERMANY)
               :     :     +- Relation[n_nationkey#610L,n_name#611,n_regionkey#612L,n_comment#613] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:58:23 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 02:58:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2309L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#2339]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2322]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2316: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#2311 AS rid_0#2316, n_regionkey_prf#2312 AS n_regionkey_prf_0#2317, n_nationkey_prf#2313 AS n_nationkey_prf_0#2318, n_name_prf#2314 AS n_name_prf_0#2319, n_comment_prf#2315 AS n_comment_prf_0#2320]
         :     :  :     :  :     :  :  +- Relation[rid#2311,n_regionkey_prf#2312,n_nationkey_prf#2313,n_name_prf#2314,n_comment_prf#2315] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2321]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [s_phone_prf#2323 AS s_phone_prf_1#2331, rid#2324 AS rid_1#2332, s_address_prf#2325 AS s_address_prf_1#2333, s_nationkey_prf#2326 AS s_nationkey_prf_1#2334, s_suppkey_prf#2327 AS s_suppkey_prf_1#2335, s_name_prf#2328 AS s_name_prf_1#2336, s_acctbal_prf#2329 AS s_acctbal_prf_1#2337, s_comment_prf#2330 AS s_comment_prf_1#2338]
         :     :  :     :     +- Relation[s_phone_prf#2323,rid#2324,s_address_prf#2325,s_nationkey_prf#2326,s_suppkey_prf#2327,s_name_prf#2328,s_acctbal_prf#2329,s_comment_prf#2330] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#2340 AS l_returnflag_prf_2#2359, l_orderkey_and_l_linenumber_prf#2341 AS l_orderkey_and_l_linenumber_prf_2#2360, l_comment_prf#2342 AS l_comment_prf_2#2361, l_linestatus_prf#2343 AS l_linestatus_prf_2#2362, rid#2344 AS rid_2#2363, l_shipmode_prf#2345 AS l_shipmode_prf_2#2364, l_shipinstruct_prf#2346 AS l_shipinstruct_prf_2#2365, l_quantity_prf#2347 AS l_quantity_prf_2#2366, l_receiptdate_prf#2348 AS l_receiptdate_prf_2#2367, l_linenumber_prf#2349 AS l_linenumber_prf_2#2368, l_tax_prf#2350 AS l_tax_prf_2#2369, l_shipdate_prf#2351 AS l_shipdate_prf_2#2370, l_extendedprice_prf#2352 AS l_extendedprice_prf_2#2371, l_partkey_prf#2353 AS l_partkey_prf_2#2372, l_discount_prf#2354 AS l_discount_prf_2#2373, l_partkey_and_l_suppkey_prf#2355 AS l_partkey_and_l_suppkey_prf_2#2374, l_commitdate_prf#2356 AS l_commitdate_prf_2#2375, l_suppkey_prf#2357 AS l_suppkey_prf_2#2376, l_orderkey_prf#2358 AS l_orderkey_prf_2#2377]
         :     :     +- Relation[l_returnflag_prf#2340,l_orderkey_and_l_linenumber_prf#2341,l_comment_prf#2342,l_linestatus_prf#2343,rid#2344,l_shipmode_prf#2345,l_shipinstruct_prf#2346,l_quantity_prf#2347,l_receiptdate_prf#2348,l_linenumber_prf#2349,l_tax_prf#2350,l_shipdate_prf#2351,l_extendedprice_prf#2352,l_partkey_prf#2353,l_discount_prf#2354,l_partkey_and_l_suppkey_prf#2355,l_commitdate_prf#2356,l_suppkey_prf#2357,l_orderkey_prf#2358] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'n_regionkey_prf_3, 'n_nationkey_prf_3, 'n_name_prf_3, 'n_comment_prf_3, 'rid_4, 'c_acctbal_prf_4, 'c_name_prf_4, 'c_nationkey_prf_4, 'c_custkey_prf_4, 'c_comment_prf_4, 'c_address_prf_4, 'c_mktsegment_prf_4, 'c_phone_prf_4, dexdecrypt('value_dec_key, value#1992) AS rid_5#2409]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'n_regionkey_prf_3, 'n_nationkey_prf_3, 'n_name_prf_3, 'n_comment_prf_3, dexdecrypt('value_dec_key, value#1992) AS rid_4#2390]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#2384: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#2379 AS rid_3#2384, n_regionkey_prf#2380 AS n_regionkey_prf_3#2385, n_nationkey_prf#2381 AS n_nationkey_prf_3#2386, n_name_prf#2382 AS n_name_prf_3#2387, n_comment_prf#2383 AS n_comment_prf_3#2388]
            :     :  :     :  :  +- Relation[rid#2379,n_regionkey_prf#2380,n_nationkey_prf#2381,n_name_prf#2382,n_comment_prf#2383] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#2389]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#2391 AS c_acctbal_prf_4#2400, rid#2392 AS rid_4#2401, c_name_prf#2393 AS c_name_prf_4#2402, c_nationkey_prf#2394 AS c_nationkey_prf_4#2403, c_custkey_prf#2395 AS c_custkey_prf_4#2404, c_comment_prf#2396 AS c_comment_prf_4#2405, c_address_prf#2397 AS c_address_prf_4#2406, c_mktsegment_prf#2398 AS c_mktsegment_prf_4#2407, c_phone_prf#2399 AS c_phone_prf_4#2408]
            :     :     +- Relation[c_acctbal_prf#2391,rid#2392,c_name_prf#2393,c_nationkey_prf#2394,c_custkey_prf#2395,c_comment_prf#2396,c_address_prf#2397,c_mktsegment_prf#2398,c_phone_prf#2399] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#2410 AS o_shippriority_prf_5#2420, rid#2411 AS rid_5#2421, o_orderdate_prf#2412 AS o_orderdate_prf_5#2422, o_custkey_prf#2413 AS o_custkey_prf_5#2423, o_orderpriority_prf#2414 AS o_orderpriority_prf_5#2424, o_clerk_prf#2415 AS o_clerk_prf_5#2425, o_orderstatus_prf#2416 AS o_orderstatus_prf_5#2426, o_totalprice_prf#2417 AS o_totalprice_prf_5#2427, o_orderkey_prf#2418 AS o_orderkey_prf_5#2428, o_comment_prf#2419 AS o_comment_prf_5#2429]
               +- Relation[o_shippriority_prf#2410,rid#2411,o_orderdate_prf#2412,o_custkey_prf#2413,o_orderpriority_prf#2414,o_clerk_prf#2415,o_orderstatus_prf#2416,o_totalprice_prf#2417,o_orderkey_prf#2418,o_comment_prf#2419] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 39540ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
19/10/22 02:59:03 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:59:03 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2490L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 02:59:03 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2490L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2531]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#2515: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#2492 AS l_returnflag_prf_0#2511, l_orderkey_and_l_linenumber_prf#2493 AS l_orderkey_and_l_linenumber_prf_0#2512, l_comment_prf#2494 AS l_comment_prf_0#2513, l_linestatus_prf#2495 AS l_linestatus_prf_0#2514, rid#2496 AS rid_0#2515, l_shipmode_prf#2497 AS l_shipmode_prf_0#2516, l_shipinstruct_prf#2498 AS l_shipinstruct_prf_0#2517, l_quantity_prf#2499 AS l_quantity_prf_0#2518, l_receiptdate_prf#2500 AS l_receiptdate_prf_0#2519, l_linenumber_prf#2501 AS l_linenumber_prf_0#2520, l_tax_prf#2502 AS l_tax_prf_0#2521, l_shipdate_prf#2503 AS l_shipdate_prf_0#2522, l_extendedprice_prf#2504 AS l_extendedprice_prf_0#2523, l_partkey_prf#2505 AS l_partkey_prf_0#2524, l_discount_prf#2506 AS l_discount_prf_0#2525, l_partkey_and_l_suppkey_prf#2507 AS l_partkey_and_l_suppkey_prf_0#2526, l_commitdate_prf#2508 AS l_commitdate_prf_0#2527, l_suppkey_prf#2509 AS l_suppkey_prf_0#2528, l_orderkey_prf#2510 AS l_orderkey_prf_0#2529]
         :     :  :  +- Relation[l_returnflag_prf#2492,l_orderkey_and_l_linenumber_prf#2493,l_comment_prf#2494,l_linestatus_prf#2495,rid#2496,l_shipmode_prf#2497,l_shipinstruct_prf#2498,l_quantity_prf#2499,l_receiptdate_prf#2500,l_linenumber_prf#2501,l_tax_prf#2502,l_shipdate_prf#2503,l_extendedprice_prf#2504,l_partkey_prf#2505,l_discount_prf#2506,l_partkey_and_l_suppkey_prf#2507,l_commitdate_prf#2508,l_suppkey_prf#2509,l_orderkey_prf#2510] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2530]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2532 AS o_shippriority_prf_1#2542, rid#2533 AS rid_1#2543, o_orderdate_prf#2534 AS o_orderdate_prf_1#2544, o_custkey_prf#2535 AS o_custkey_prf_1#2545, o_orderpriority_prf#2536 AS o_orderpriority_prf_1#2546, o_clerk_prf#2537 AS o_clerk_prf_1#2547, o_orderstatus_prf#2538 AS o_orderstatus_prf_1#2548, o_totalprice_prf#2539 AS o_totalprice_prf_1#2549, o_orderkey_prf#2540 AS o_orderkey_prf_1#2550, o_comment_prf#2541 AS o_comment_prf_1#2551]
            +- Relation[o_shippriority_prf#2532,rid#2533,o_orderdate_prf#2534,o_custkey_prf#2535,o_orderpriority_prf#2536,o_clerk_prf#2537,o_orderstatus_prf#2538,o_totalprice_prf#2539,o_orderkey_prf#2540,o_comment_prf#2541] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 32221ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
19/10/22 02:59:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:59:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2585L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 02:59:35 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 02:59:35 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 02:59:35 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 02:59:35 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 02:59:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2585L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2609]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2599: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [p_comment_prf#2587 AS p_comment_prf_0#2597, p_name_prf#2588 AS p_name_prf_0#2598, rid#2589 AS rid_0#2599, p_type_prf#2590 AS p_type_prf_0#2600, p_retailprice_prf#2591 AS p_retailprice_prf_0#2601, p_mfgr_prf#2592 AS p_mfgr_prf_0#2602, p_container_prf#2593 AS p_container_prf_0#2603, p_brand_prf#2594 AS p_brand_prf_0#2604, p_size_prf#2595 AS p_size_prf_0#2605, p_partkey_prf#2596 AS p_partkey_prf_0#2606]
         :     :  :  :  +- Relation[p_comment_prf#2587,p_name_prf#2588,rid#2589,p_type_prf#2590,p_retailprice_prf#2591,p_mfgr_prf#2592,p_container_prf#2593,p_brand_prf#2594,p_size_prf#2595,p_partkey_prf#2596] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2607]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2608]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2610 AS l_returnflag_prf_1#2629, l_orderkey_and_l_linenumber_prf#2611 AS l_orderkey_and_l_linenumber_prf_1#2630, l_comment_prf#2612 AS l_comment_prf_1#2631, l_linestatus_prf#2613 AS l_linestatus_prf_1#2632, rid#2614 AS rid_1#2633, l_shipmode_prf#2615 AS l_shipmode_prf_1#2634, l_shipinstruct_prf#2616 AS l_shipinstruct_prf_1#2635, l_quantity_prf#2617 AS l_quantity_prf_1#2636, l_receiptdate_prf#2618 AS l_receiptdate_prf_1#2637, l_linenumber_prf#2619 AS l_linenumber_prf_1#2638, l_tax_prf#2620 AS l_tax_prf_1#2639, l_shipdate_prf#2621 AS l_shipdate_prf_1#2640, l_extendedprice_prf#2622 AS l_extendedprice_prf_1#2641, l_partkey_prf#2623 AS l_partkey_prf_1#2642, l_discount_prf#2624 AS l_discount_prf_1#2643, l_partkey_and_l_suppkey_prf#2625 AS l_partkey_and_l_suppkey_prf_1#2644, l_commitdate_prf#2626 AS l_commitdate_prf_1#2645, l_suppkey_prf#2627 AS l_suppkey_prf_1#2646, l_orderkey_prf#2628 AS l_orderkey_prf_1#2647]
            +- Relation[l_returnflag_prf#2610,l_orderkey_and_l_linenumber_prf#2611,l_comment_prf#2612,l_linestatus_prf#2613,rid#2614,l_shipmode_prf#2615,l_shipinstruct_prf#2616,l_quantity_prf#2617,l_receiptdate_prf#2618,l_linenumber_prf#2619,l_tax_prf#2620,l_shipdate_prf#2621,l_extendedprice_prf#2622,l_partkey_prf#2623,l_discount_prf#2624,l_partkey_and_l_suppkey_prf#2625,l_commitdate_prf#2626,l_suppkey_prf#2627,l_orderkey_prf#2628] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 368ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
19/10/22 02:59:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:59:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2684L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 02:59:35 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 02:59:35 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 02:59:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2684L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2707]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#2698: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#2686 AS p_comment_prf_0#2696, p_name_prf#2687 AS p_name_prf_0#2697, rid#2688 AS rid_0#2698, p_type_prf#2689 AS p_type_prf_0#2699, p_retailprice_prf#2690 AS p_retailprice_prf_0#2700, p_mfgr_prf#2691 AS p_mfgr_prf_0#2701, p_container_prf#2692 AS p_container_prf_0#2702, p_brand_prf#2693 AS p_brand_prf_0#2703, p_size_prf#2694 AS p_size_prf_0#2704, p_partkey_prf#2695 AS p_partkey_prf_0#2705]
         :     :  :  +- Relation[p_comment_prf#2686,p_name_prf#2687,rid#2688,p_type_prf#2689,p_retailprice_prf#2690,p_mfgr_prf#2691,p_container_prf#2692,p_brand_prf#2693,p_size_prf#2694,p_partkey_prf#2695] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2706]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2708 AS ps_partkey_and_ps_suppkey_prf_1#2715, rid#2709 AS rid_1#2716, ps_availqty_prf#2710 AS ps_availqty_prf_1#2717, ps_comment_prf#2711 AS ps_comment_prf_1#2718, ps_partkey_prf#2712 AS ps_partkey_prf_1#2719, ps_supplycost_prf#2713 AS ps_supplycost_prf_1#2720, ps_suppkey_prf#2714 AS ps_suppkey_prf_1#2721]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2708,rid#2709,ps_availqty_prf#2710,ps_comment_prf#2711,ps_partkey_prf#2712,ps_supplycost_prf#2713,ps_suppkey_prf#2714] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 389ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
19/10/22 02:59:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 02:59:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2767L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 02:59:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2767L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2769 AS l_returnflag_prf_0#2788, l_orderkey_and_l_linenumber_prf#2770 AS l_orderkey_and_l_linenumber_prf_0#2789, l_comment_prf#2771 AS l_comment_prf_0#2790, l_linestatus_prf#2772 AS l_linestatus_prf_0#2791, rid#2773 AS rid_0#2792, l_shipmode_prf#2774 AS l_shipmode_prf_0#2793, l_shipinstruct_prf#2775 AS l_shipinstruct_prf_0#2794, l_quantity_prf#2776 AS l_quantity_prf_0#2795, l_receiptdate_prf#2777 AS l_receiptdate_prf_0#2796, l_linenumber_prf#2778 AS l_linenumber_prf_0#2797, l_tax_prf#2779 AS l_tax_prf_0#2798, l_shipdate_prf#2780 AS l_shipdate_prf_0#2799, l_extendedprice_prf#2781 AS l_extendedprice_prf_0#2800, l_partkey_prf#2782 AS l_partkey_prf_0#2801, l_discount_prf#2783 AS l_discount_prf_0#2802, l_partkey_and_l_suppkey_prf#2784 AS l_partkey_and_l_suppkey_prf_0#2803, l_commitdate_prf#2785 AS l_commitdate_prf_0#2804, l_suppkey_prf#2786 AS l_suppkey_prf_0#2805, l_orderkey_prf#2787 AS l_orderkey_prf_0#2806]
         :  :  +- Relation[l_returnflag_prf#2769,l_orderkey_and_l_linenumber_prf#2770,l_comment_prf#2771,l_linestatus_prf#2772,rid#2773,l_shipmode_prf#2774,l_shipinstruct_prf#2775,l_quantity_prf#2776,l_receiptdate_prf#2777,l_linenumber_prf#2778,l_tax_prf#2779,l_shipdate_prf#2780,l_extendedprice_prf#2781,l_partkey_prf#2782,l_discount_prf#2783,l_partkey_and_l_suppkey_prf#2784,l_commitdate_prf#2785,l_suppkey_prf#2786,l_orderkey_prf#2787] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2827]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2826]
         :        :  +- Relation[l_returnflag_prf#2807,l_orderkey_and_l_linenumber_prf#2808,l_comment_prf#2809,l_linestatus_prf#2810,rid#2811,l_shipmode_prf#2812,l_shipinstruct_prf#2813,l_quantity_prf#2814,l_receiptdate_prf#2815,l_linenumber_prf#2816,l_tax_prf#2817,l_shipdate_prf#2818,l_extendedprice_prf#2819,l_partkey_prf#2820,l_discount_prf#2821,l_partkey_and_l_suppkey_prf#2822,l_commitdate_prf#2823,l_suppkey_prf#2824,l_orderkey_prf#2825] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2828 AS o_shippriority_prf_1#2838, rid#2829 AS rid_1#2839, o_orderdate_prf#2830 AS o_orderdate_prf_1#2840, o_custkey_prf#2831 AS o_custkey_prf_1#2841, o_orderpriority_prf#2832 AS o_orderpriority_prf_1#2842, o_clerk_prf#2833 AS o_clerk_prf_1#2843, o_orderstatus_prf#2834 AS o_orderstatus_prf_1#2844, o_totalprice_prf#2835 AS o_totalprice_prf_1#2845, o_orderkey_prf#2836 AS o_orderkey_prf_1#2846, o_comment_prf#2837 AS o_comment_prf_1#2847]
            +- Relation[o_shippriority_prf#2828,rid#2829,o_orderdate_prf#2830,o_custkey_prf#2831,o_orderpriority_prf#2832,o_clerk_prf#2833,o_orderstatus_prf#2834,o_totalprice_prf#2835,o_orderkey_prf#2836,o_comment_prf#2837] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 98775ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
19/10/22 03:01:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:01:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2884L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#808L = c_nationkey#293L)
               :     :- Project [n_nationkey#808L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#810L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#808L, n_regionkey#810L]
               :     :        +- Relation[n_nationkey#808L,n_name#809,n_regionkey#810L,n_comment#811] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 03:01:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:01:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:01:15 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:01:15 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2884L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#2907]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2898: string
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [p_comment_prf#2886 AS p_comment_prf_0#2896, p_name_prf#2887 AS p_name_prf_0#2897, rid#2888 AS rid_0#2898, p_type_prf#2889 AS p_type_prf_0#2899, p_retailprice_prf#2890 AS p_retailprice_prf_0#2900, p_mfgr_prf#2891 AS p_mfgr_prf_0#2901, p_container_prf#2892 AS p_container_prf_0#2902, p_brand_prf#2893 AS p_brand_prf_0#2903, p_size_prf#2894 AS p_size_prf_0#2904, p_partkey_prf#2895 AS p_partkey_prf_0#2905]
         :     :  :     :  :     :  :     :  :  +- Relation[p_comment_prf#2886,p_name_prf#2887,rid#2888,p_type_prf#2889,p_retailprice_prf#2890,p_mfgr_prf#2891,p_container_prf#2892,p_brand_prf#2893,p_size_prf#2894,p_partkey_prf#2895] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2906]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [l_returnflag_prf#2908 AS l_returnflag_prf_1#2927, l_orderkey_and_l_linenumber_prf#2909 AS l_orderkey_and_l_linenumber_prf_1#2928, l_comment_prf#2910 AS l_comment_prf_1#2929, l_linestatus_prf#2911 AS l_linestatus_prf_1#2930, rid#2912 AS rid_1#2931, l_shipmode_prf#2913 AS l_shipmode_prf_1#2932, l_shipinstruct_prf#2914 AS l_shipinstruct_prf_1#2933, l_quantity_prf#2915 AS l_quantity_prf_1#2934, l_receiptdate_prf#2916 AS l_receiptdate_prf_1#2935, l_linenumber_prf#2917 AS l_linenumber_prf_1#2936, l_tax_prf#2918 AS l_tax_prf_1#2937, l_shipdate_prf#2919 AS l_shipdate_prf_1#2938, l_extendedprice_prf#2920 AS l_extendedprice_prf_1#2939, l_partkey_prf#2921 AS l_partkey_prf_1#2940, l_discount_prf#2922 AS l_discount_prf_1#2941, l_partkey_and_l_suppkey_prf#2923 AS l_partkey_and_l_suppkey_prf_1#2942, l_commitdate_prf#2924 AS l_commitdate_prf_1#2943, l_suppkey_prf#2925 AS l_suppkey_prf_1#2944, l_orderkey_prf#2926 AS l_orderkey_prf_1#2945]
         :     :  :     :  :     :     +- Relation[l_returnflag_prf#2908,l_orderkey_and_l_linenumber_prf#2909,l_comment_prf#2910,l_linestatus_prf#2911,rid#2912,l_shipmode_prf#2913,l_shipinstruct_prf#2914,l_quantity_prf#2915,l_receiptdate_prf#2916,l_linenumber_prf#2917,l_tax_prf#2918,l_shipdate_prf#2919,l_extendedprice_prf#2920,l_partkey_prf#2921,l_discount_prf#2922,l_partkey_and_l_suppkey_prf#2923,l_commitdate_prf#2924,l_suppkey_prf#2925,l_orderkey_prf#2926] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [s_phone_prf#2947 AS s_phone_prf_2#2955, rid#2948 AS rid_2#2956, s_address_prf#2949 AS s_address_prf_2#2957, s_nationkey_prf#2950 AS s_nationkey_prf_2#2958, s_suppkey_prf#2951 AS s_suppkey_prf_2#2959, s_name_prf#2952 AS s_name_prf_2#2960, s_acctbal_prf#2953 AS s_acctbal_prf_2#2961, s_comment_prf#2954 AS s_comment_prf_2#2962]
         :     :  :     :     +- Relation[s_phone_prf#2947,rid#2948,s_address_prf#2949,s_nationkey_prf#2950,s_suppkey_prf#2951,s_name_prf#2952,s_acctbal_prf#2953,s_comment_prf#2954] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#2964 AS rid_3#2969, n_regionkey_prf#2965 AS n_regionkey_prf_3#2970, n_nationkey_prf#2966 AS n_nationkey_prf_3#2971, n_name_prf#2967 AS n_name_prf_3#2972, n_comment_prf#2968 AS n_comment_prf_3#2973]
         :     :     +- Relation[rid#2964,n_regionkey_prf#2965,n_nationkey_prf#2966,n_name_prf#2967,n_comment_prf#2968] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, 'rid_5, 'n_regionkey_prf_5, 'n_nationkey_prf_5, 'n_name_prf_5, 'n_comment_prf_5, 'rid_6, 'c_acctbal_prf_6, 'c_name_prf_6, 'c_nationkey_prf_6, 'c_custkey_prf_6, 'c_comment_prf_6, 'c_address_prf_6, 'c_mktsegment_prf_6, 'c_phone_prf_6, dexdecrypt('value_dec_key, value#1992) AS rid_7#3014]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, 'rid_5, 'n_regionkey_prf_5, 'n_nationkey_prf_5, 'n_name_prf_5, 'n_comment_prf_5, dexdecrypt('value_dec_key, value#1992) AS rid_6#2995]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, dexdecrypt('value_dec_key, value#1992) AS rid_5#2984]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#2982: string
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [r_regionkey_prf#2975 AS r_regionkey_prf_4#2979, r_name_prf#2976 AS r_name_prf_4#2980, r_comment_prf#2977 AS r_comment_prf_4#2981, rid#2978 AS rid_4#2982]
            :     :  :     :  :     :  :  +- Relation[r_regionkey_prf#2975,r_name_prf#2976,r_comment_prf#2977,rid#2978] JDBCRelation(region_prf) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#2983]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#2985 AS rid_5#2990, n_regionkey_prf#2986 AS n_regionkey_prf_5#2991, n_nationkey_prf#2987 AS n_nationkey_prf_5#2992, n_name_prf#2988 AS n_name_prf_5#2993, n_comment_prf#2989 AS n_comment_prf_5#2994]
            :     :  :     :     +- Relation[rid#2985,n_regionkey_prf#2986,n_nationkey_prf#2987,n_name_prf#2988,n_comment_prf#2989] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#2996 AS c_acctbal_prf_6#3005, rid#2997 AS rid_6#3006, c_name_prf#2998 AS c_name_prf_6#3007, c_nationkey_prf#2999 AS c_nationkey_prf_6#3008, c_custkey_prf#3000 AS c_custkey_prf_6#3009, c_comment_prf#3001 AS c_comment_prf_6#3010, c_address_prf#3002 AS c_address_prf_6#3011, c_mktsegment_prf#3003 AS c_mktsegment_prf_6#3012, c_phone_prf#3004 AS c_phone_prf_6#3013]
            :     :     +- Relation[c_acctbal_prf#2996,rid#2997,c_name_prf#2998,c_nationkey_prf#2999,c_custkey_prf#3000,c_comment_prf#3001,c_address_prf#3002,c_mktsegment_prf#3003,c_phone_prf#3004] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3015 AS o_shippriority_prf_7#3025, rid#3016 AS rid_7#3026, o_orderdate_prf#3017 AS o_orderdate_prf_7#3027, o_custkey_prf#3018 AS o_custkey_prf_7#3028, o_orderpriority_prf#3019 AS o_orderpriority_prf_7#3029, o_clerk_prf#3020 AS o_clerk_prf_7#3030, o_orderstatus_prf#3021 AS o_orderstatus_prf_7#3031, o_totalprice_prf#3022 AS o_totalprice_prf_7#3032, o_orderkey_prf#3023 AS o_orderkey_prf_7#3033, o_comment_prf#3024 AS o_comment_prf_7#3034]
               +- Relation[o_shippriority_prf#3015,rid#3016,o_orderdate_prf#3017,o_custkey_prf#3018,o_orderpriority_prf#3019,o_clerk_prf#3020,o_orderstatus_prf#3021,o_totalprice_prf#3022,o_orderkey_prf#3023,o_comment_prf#3024] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 98100ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
19/10/22 03:02:53 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:02:53 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3109L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:02:53 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:02:53 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3109L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 's_phone_prf_2, 's_address_prf_2, 's_nationkey_prf_2, 's_suppkey_prf_2, 's_name_prf_2, 's_acctbal_prf_2, 's_comment_prf_2, dexdecrypt('value_dec_key, value#1992) AS rid_4#3148]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#3131]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#3120]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#3118: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [r_regionkey_prf#3111 AS r_regionkey_prf_0#3115, r_name_prf#3112 AS r_name_prf_0#3116, r_comment_prf#3113 AS r_comment_prf_0#3117, rid#3114 AS rid_0#3118]
         :     :  :     :  :     :  :  +- Relation[r_regionkey_prf#3111,r_name_prf#3112,r_comment_prf#3113,rid#3114] JDBCRelation(region_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3119]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#3121 AS rid_1#3126, n_regionkey_prf#3122 AS n_regionkey_prf_1#3127, n_nationkey_prf#3123 AS n_nationkey_prf_1#3128, n_name_prf#3124 AS n_name_prf_1#3129, n_comment_prf#3125 AS n_comment_prf_1#3130]
         :     :  :     :     +- Relation[rid#3121,n_regionkey_prf#3122,n_nationkey_prf#3123,n_name_prf#3124,n_comment_prf#3125] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3132 AS s_phone_prf_2#3140, rid#3133 AS rid_2#3141, s_address_prf#3134 AS s_address_prf_2#3142, s_nationkey_prf#3135 AS s_nationkey_prf_2#3143, s_suppkey_prf#3136 AS s_suppkey_prf_2#3144, s_name_prf#3137 AS s_name_prf_2#3145, s_acctbal_prf#3138 AS s_acctbal_prf_2#3146, s_comment_prf#3139 AS s_comment_prf_2#3147]
         :     :     +- Relation[s_phone_prf#3132,rid#3133,s_address_prf#3134,s_nationkey_prf#3135,s_suppkey_prf#3136,s_name_prf#3137,s_acctbal_prf#3138,s_comment_prf#3139] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_3, 'p_name_prf_3, 'rid_3, 'p_type_prf_3, 'p_retailprice_prf_3, 'p_mfgr_prf_3, 'p_container_prf_3, 'p_brand_prf_3, 'p_size_prf_3, 'p_partkey_prf_3, dexdecrypt('value_dec_key, value#1992) AS rid_4#3170]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#3161: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [p_comment_prf#3149 AS p_comment_prf_3#3159, p_name_prf#3150 AS p_name_prf_3#3160, rid#3151 AS rid_3#3161, p_type_prf#3152 AS p_type_prf_3#3162, p_retailprice_prf#3153 AS p_retailprice_prf_3#3163, p_mfgr_prf#3154 AS p_mfgr_prf_3#3164, p_container_prf#3155 AS p_container_prf_3#3165, p_brand_prf#3156 AS p_brand_prf_3#3166, p_size_prf#3157 AS p_size_prf_3#3167, p_partkey_prf#3158 AS p_partkey_prf_3#3168]
            :     :  :  +- Relation[p_comment_prf#3149,p_name_prf#3150,rid#3151,p_type_prf#3152,p_retailprice_prf#3153,p_mfgr_prf#3154,p_container_prf#3155,p_brand_prf#3156,p_size_prf#3157,p_partkey_prf#3158] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3169]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#3171 AS ps_partkey_and_ps_suppkey_prf_4#3178, rid#3172 AS rid_4#3179, ps_availqty_prf#3173 AS ps_availqty_prf_4#3180, ps_comment_prf#3174 AS ps_comment_prf_4#3181, ps_partkey_prf#3175 AS ps_partkey_prf_4#3182, ps_supplycost_prf#3176 AS ps_supplycost_prf_4#3183, ps_suppkey_prf#3177 AS ps_suppkey_prf_4#3184]
               +- Relation[ps_partkey_and_ps_suppkey_prf#3171,rid#3172,ps_availqty_prf#3173,ps_comment_prf#3174,ps_partkey_prf#3175,ps_supplycost_prf#3176,ps_suppkey_prf#3177] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 2019ms

q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
19/10/22 03:02:55 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:02:55 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3228L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:02:55 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:02:55 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3228L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#3230 AS rid_0#3235, n_regionkey_prf#3231 AS n_regionkey_prf_0#3236, n_nationkey_prf#3232 AS n_nationkey_prf_0#3237, n_name_prf#3233 AS n_name_prf_0#3238, n_comment_prf#3234 AS n_comment_prf_0#3239]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#3230,n_regionkey_prf#3231,n_nationkey_prf#3232,n_name_prf#3233,n_comment_prf#3234] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#3246]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#3245]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#3240,n_regionkey_prf#3241,n_nationkey_prf#3242,n_name_prf#3243,n_comment_prf#3244] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [s_phone_prf#3247 AS s_phone_prf_1#3255, rid#3248 AS rid_1#3256, s_address_prf#3249 AS s_address_prf_1#3257, s_nationkey_prf#3250 AS s_nationkey_prf_1#3258, s_suppkey_prf#3251 AS s_suppkey_prf_1#3259, s_name_prf#3252 AS s_name_prf_1#3260, s_acctbal_prf#3253 AS s_acctbal_prf_1#3261, s_comment_prf#3254 AS s_comment_prf_1#3262]
         :  :  :  :  :  :  :  :     +- Relation[s_phone_prf#3247,rid#3248,s_address_prf#3249,s_nationkey_prf#3250,s_suppkey_prf#3251,s_name_prf#3252,s_acctbal_prf#3253,s_comment_prf#3254] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#3272]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#3271]
         :  :  :  :  :  :  :        :  +- Relation[s_phone_prf#3263,rid#3264,s_address_prf#3265,s_nationkey_prf#3266,s_suppkey_prf#3267,s_name_prf#3268,s_acctbal_prf#3269,s_comment_prf#3270] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [l_returnflag_prf#3273 AS l_returnflag_prf_2#3292, l_orderkey_and_l_linenumber_prf#3274 AS l_orderkey_and_l_linenumber_prf_2#3293, l_comment_prf#3275 AS l_comment_prf_2#3294, l_linestatus_prf#3276 AS l_linestatus_prf_2#3295, rid#3277 AS rid_2#3296, l_shipmode_prf#3278 AS l_shipmode_prf_2#3297, l_shipinstruct_prf#3279 AS l_shipinstruct_prf_2#3298, l_quantity_prf#3280 AS l_quantity_prf_2#3299, l_receiptdate_prf#3281 AS l_receiptdate_prf_2#3300, l_linenumber_prf#3282 AS l_linenumber_prf_2#3301, l_tax_prf#3283 AS l_tax_prf_2#3302, l_shipdate_prf#3284 AS l_shipdate_prf_2#3303, l_extendedprice_prf#3285 AS l_extendedprice_prf_2#3304, l_partkey_prf#3286 AS l_partkey_prf_2#3305, l_discount_prf#3287 AS l_discount_prf_2#3306, l_partkey_and_l_suppkey_prf#3288 AS l_partkey_and_l_suppkey_prf_2#3307, l_commitdate_prf#3289 AS l_commitdate_prf_2#3308, l_suppkey_prf#3290 AS l_suppkey_prf_2#3309, l_orderkey_prf#3291 AS l_orderkey_prf_2#3310]
         :  :  :  :  :  :     +- Relation[l_returnflag_prf#3273,l_orderkey_and_l_linenumber_prf#3274,l_comment_prf#3275,l_linestatus_prf#3276,rid#3277,l_shipmode_prf#3278,l_shipinstruct_prf#3279,l_quantity_prf#3280,l_receiptdate_prf#3281,l_linenumber_prf#3282,l_tax_prf#3283,l_shipdate_prf#3284,l_extendedprice_prf#3285,l_partkey_prf#3286,l_discount_prf#3287,l_partkey_and_l_suppkey_prf#3288,l_commitdate_prf#3289,l_suppkey_prf#3290,l_orderkey_prf#3291] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1992) AS rid_3#3331]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#3330]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#3311,l_orderkey_and_l_linenumber_prf#3312,l_comment_prf#3313,l_linestatus_prf#3314,rid#3315,l_shipmode_prf#3316,l_shipinstruct_prf#3317,l_quantity_prf#3318,l_receiptdate_prf#3319,l_linenumber_prf#3320,l_tax_prf#3321,l_shipdate_prf#3322,l_extendedprice_prf#3323,l_partkey_prf#3324,l_discount_prf#3325,l_partkey_and_l_suppkey_prf#3326,l_commitdate_prf#3327,l_suppkey_prf#3328,l_orderkey_prf#3329] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [p_comment_prf#3332 AS p_comment_prf_3#3342, p_name_prf#3333 AS p_name_prf_3#3343, rid#3334 AS rid_3#3344, p_type_prf#3335 AS p_type_prf_3#3345, p_retailprice_prf#3336 AS p_retailprice_prf_3#3346, p_mfgr_prf#3337 AS p_mfgr_prf_3#3347, p_container_prf#3338 AS p_container_prf_3#3348, p_brand_prf#3339 AS p_brand_prf_3#3349, p_size_prf#3340 AS p_size_prf_3#3350, p_partkey_prf#3341 AS p_partkey_prf_3#3351]
         :  :  :  :     +- Relation[p_comment_prf#3332,p_name_prf#3333,rid#3334,p_type_prf#3335,p_retailprice_prf#3336,p_mfgr_prf#3337,p_container_prf#3338,p_brand_prf#3339,p_size_prf#3340,p_partkey_prf#3341] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1992) AS rid_4#3372]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#3371]
         :  :  :        :  +- Relation[l_returnflag_prf#3352,l_orderkey_and_l_linenumber_prf#3353,l_comment_prf#3354,l_linestatus_prf#3355,rid#3356,l_shipmode_prf#3357,l_shipinstruct_prf#3358,l_quantity_prf#3359,l_receiptdate_prf#3360,l_linenumber_prf#3361,l_tax_prf#3362,l_shipdate_prf#3363,l_extendedprice_prf#3364,l_partkey_prf#3365,l_discount_prf#3366,l_partkey_and_l_suppkey_prf#3367,l_commitdate_prf#3368,l_suppkey_prf#3369,l_orderkey_prf#3370] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#3373 AS ps_partkey_and_ps_suppkey_prf_4#3380, rid#3374 AS rid_4#3381, ps_availqty_prf#3375 AS ps_availqty_prf_4#3382, ps_comment_prf#3376 AS ps_comment_prf_4#3383, ps_partkey_prf#3377 AS ps_partkey_prf_4#3384, ps_supplycost_prf#3378 AS ps_supplycost_prf_4#3385, ps_suppkey_prf#3379 AS ps_suppkey_prf_4#3386]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#3373,rid#3374,ps_availqty_prf#3375,ps_comment_prf#3376,ps_partkey_prf#3377,ps_supplycost_prf#3378,ps_suppkey_prf#3379] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1992) AS rid_5#3407]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#3406]
         :        :  +- Relation[l_returnflag_prf#3387,l_orderkey_and_l_linenumber_prf#3388,l_comment_prf#3389,l_linestatus_prf#3390,rid#3391,l_shipmode_prf#3392,l_shipinstruct_prf#3393,l_quantity_prf#3394,l_receiptdate_prf#3395,l_linenumber_prf#3396,l_tax_prf#3397,l_shipdate_prf#3398,l_extendedprice_prf#3399,l_partkey_prf#3400,l_discount_prf#3401,l_partkey_and_l_suppkey_prf#3402,l_commitdate_prf#3403,l_suppkey_prf#3404,l_orderkey_prf#3405] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3408 AS o_shippriority_prf_5#3418, rid#3409 AS rid_5#3419, o_orderdate_prf#3410 AS o_orderdate_prf_5#3420, o_custkey_prf#3411 AS o_custkey_prf_5#3421, o_orderpriority_prf#3412 AS o_orderpriority_prf_5#3422, o_clerk_prf#3413 AS o_clerk_prf_5#3423, o_orderstatus_prf#3414 AS o_orderstatus_prf_5#3424, o_totalprice_prf#3415 AS o_totalprice_prf_5#3425, o_orderkey_prf#3416 AS o_orderkey_prf_5#3426, o_comment_prf#3417 AS o_comment_prf_5#3427]
            +- Relation[o_shippriority_prf#3408,rid#3409,o_orderdate_prf#3410,o_custkey_prf#3411,o_orderpriority_prf#3412,o_clerk_prf#3413,o_orderstatus_prf#3414,o_totalprice_prf#3415,o_orderkey_prf#3416,o_comment_prf#3417] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 381931ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
19/10/22 03:09:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:09:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3493L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3493L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#3523]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#3506]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3500: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#3495 AS rid_0#3500, n_regionkey_prf#3496 AS n_regionkey_prf_0#3501, n_nationkey_prf#3497 AS n_nationkey_prf_0#3502, n_name_prf#3498 AS n_name_prf_0#3503, n_comment_prf#3499 AS n_comment_prf_0#3504]
         :     :  :     :  :  +- Relation[rid#3495,n_regionkey_prf#3496,n_nationkey_prf#3497,n_name_prf#3498,n_comment_prf#3499] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3505]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#3507 AS s_phone_prf_1#3515, rid#3508 AS rid_1#3516, s_address_prf#3509 AS s_address_prf_1#3517, s_nationkey_prf#3510 AS s_nationkey_prf_1#3518, s_suppkey_prf#3511 AS s_suppkey_prf_1#3519, s_name_prf#3512 AS s_name_prf_1#3520, s_acctbal_prf#3513 AS s_acctbal_prf_1#3521, s_comment_prf#3514 AS s_comment_prf_1#3522]
         :     :     +- Relation[s_phone_prf#3507,rid#3508,s_address_prf#3509,s_nationkey_prf#3510,s_suppkey_prf#3511,s_name_prf#3512,s_acctbal_prf#3513,s_comment_prf#3514] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#3524 AS ps_partkey_and_ps_suppkey_prf_2#3531, rid#3525 AS rid_2#3532, ps_availqty_prf#3526 AS ps_availqty_prf_2#3533, ps_comment_prf#3527 AS ps_comment_prf_2#3534, ps_partkey_prf#3528 AS ps_partkey_prf_2#3535, ps_supplycost_prf#3529 AS ps_supplycost_prf_2#3536, ps_suppkey_prf#3530 AS ps_suppkey_prf_2#3537]
            +- Relation[ps_partkey_and_ps_suppkey_prf#3524,rid#3525,ps_availqty_prf#3526,ps_comment_prf#3527,ps_partkey_prf#3528,ps_supplycost_prf#3529,ps_suppkey_prf#3530] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 801ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
19/10/22 03:09:17 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:09:17 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3563L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:17 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:17 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3563L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#1992) AS rid_3#3613]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#3607: string
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#3602 AS rid_2#3607, n_regionkey_prf#3603 AS n_regionkey_prf_2#3608, n_nationkey_prf#3604 AS n_nationkey_prf_2#3609, n_name_prf#3605 AS n_name_prf_2#3610, n_comment_prf#3606 AS n_comment_prf_2#3611]
         :  :     :  :  +- Relation[rid#3602,n_regionkey_prf#3603,n_nationkey_prf#3604,n_name_prf#3605,n_comment_prf#3606] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#3612]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [s_phone_prf#3614 AS s_phone_prf_3#3622, rid#3615 AS rid_3#3623, s_address_prf#3616 AS s_address_prf_3#3624, s_nationkey_prf#3617 AS s_nationkey_prf_3#3625, s_suppkey_prf#3618 AS s_suppkey_prf_3#3626, s_name_prf#3619 AS s_name_prf_3#3627, s_acctbal_prf#3620 AS s_acctbal_prf_3#3628, s_comment_prf#3621 AS s_comment_prf_3#3629]
         :     +- Relation[s_phone_prf#3614,rid#3615,s_address_prf#3616,s_nationkey_prf#3617,s_suppkey_prf#3618,s_name_prf#3619,s_acctbal_prf#3620,s_comment_prf#3621] JDBCRelation(supplier_prf) [numPartitions=1]
         +- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1992) AS rid_3#3601]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#3595: string
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [ps_partkey_and_ps_suppkey_prf#3587 AS ps_partkey_and_ps_suppkey_prf_1#3594, rid#3588 AS rid_1#3595, ps_availqty_prf#3589 AS ps_availqty_prf_1#3596, ps_comment_prf#3590 AS ps_comment_prf_1#3597, ps_partkey_prf#3591 AS ps_partkey_prf_1#3598, ps_supplycost_prf#3592 AS ps_supplycost_prf_1#3599, ps_suppkey_prf#3593 AS ps_suppkey_prf_1#3600]
               :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#3587,rid#3588,ps_availqty_prf#3589,ps_comment_prf#3590,ps_partkey_prf#3591,ps_supplycost_prf#3592,ps_suppkey_prf#3593] JDBCRelation(partsupp_prf) [numPartitions=1]
               :  +- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#3586]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3577: string
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [p_comment_prf#3565 AS p_comment_prf_0#3575, p_name_prf#3566 AS p_name_prf_0#3576, rid#3567 AS rid_0#3577, p_type_prf#3568 AS p_type_prf_0#3578, p_retailprice_prf#3569 AS p_retailprice_prf_0#3579, p_mfgr_prf#3570 AS p_mfgr_prf_0#3580, p_container_prf#3571 AS p_container_prf_0#3581, p_brand_prf#3572 AS p_brand_prf_0#3582, p_size_prf#3573 AS p_size_prf_0#3583, p_partkey_prf#3574 AS p_partkey_prf_0#3584]
               :        :  :  +- Relation[p_comment_prf#3565,p_name_prf#3566,rid#3567,p_type_prf#3568,p_retailprice_prf#3569,p_mfgr_prf#3570,p_container_prf#3571,p_brand_prf#3572,p_size_prf#3573,p_partkey_prf#3574] JDBCRelation(part_prf) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3585]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 22535ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
19/10/22 03:09:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:09:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3648L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 03:09:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#3648L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [l_returnflag_prf#3650 AS l_returnflag_prf_0#3669, l_orderkey_and_l_linenumber_prf#3651 AS l_orderkey_and_l_linenumber_prf_0#3670, l_comment_prf#3652 AS l_comment_prf_0#3671, l_linestatus_prf#3653 AS l_linestatus_prf_0#3672, rid#3654 AS rid_0#3673, l_shipmode_prf#3655 AS l_shipmode_prf_0#3674, l_shipinstruct_prf#3656 AS l_shipinstruct_prf_0#3675, l_quantity_prf#3657 AS l_quantity_prf_0#3676, l_receiptdate_prf#3658 AS l_receiptdate_prf_0#3677, l_linenumber_prf#3659 AS l_linenumber_prf_0#3678, l_tax_prf#3660 AS l_tax_prf_0#3679, l_shipdate_prf#3661 AS l_shipdate_prf_0#3680, l_extendedprice_prf#3662 AS l_extendedprice_prf_0#3681, l_partkey_prf#3663 AS l_partkey_prf_0#3682, l_discount_prf#3664 AS l_discount_prf_0#3683, l_partkey_and_l_suppkey_prf#3665 AS l_partkey_and_l_suppkey_prf_0#3684, l_commitdate_prf#3666 AS l_commitdate_prf_0#3685, l_suppkey_prf#3667 AS l_suppkey_prf_0#3686, l_orderkey_prf#3668 AS l_orderkey_prf_0#3687]
         +- Relation[l_returnflag_prf#3650,l_orderkey_and_l_linenumber_prf#3651,l_comment_prf#3652,l_linestatus_prf#3653,rid#3654,l_shipmode_prf#3655,l_shipinstruct_prf#3656,l_quantity_prf#3657,l_receiptdate_prf#3658,l_linenumber_prf#3659,l_tax_prf#3660,l_shipdate_prf#3661,l_extendedprice_prf#3662,l_partkey_prf#3663,l_discount_prf#3664,l_partkey_and_l_suppkey_prf#3665,l_commitdate_prf#3666,l_suppkey_prf#3667,l_orderkey_prf#3668] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1749ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
19/10/22 03:09:42 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:09:42 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3716L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:42 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 03:09:42 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3716L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1992) AS rid_4#3812]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#3811]
         :  :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3804,rid#3805,ps_availqty_prf#3806,ps_comment_prf#3807,ps_partkey_prf#3808,ps_supplycost_prf#3809,ps_suppkey_prf#3810] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1992) AS rid_3#3783]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#3782]
         :  :  :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#3775,rid#3776,ps_availqty_prf#3777,ps_comment_prf#3778,ps_partkey_prf#3779,ps_supplycost_prf#3780,ps_suppkey_prf#3781] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#3718 AS rid_0#3723, n_regionkey_prf#3719 AS n_regionkey_prf_0#3724, n_nationkey_prf#3720 AS n_nationkey_prf_0#3725, n_name_prf#3721 AS n_name_prf_0#3726, n_comment_prf#3722 AS n_comment_prf_0#3727]
         :  :  :     :     :  :  :  :  +- Relation[rid#3718,n_regionkey_prf#3719,n_nationkey_prf#3720,n_name_prf#3721,n_comment_prf#3722] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#3734]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#3733]
         :  :  :     :     :  :  :        :  +- Relation[rid#3728,n_regionkey_prf#3729,n_nationkey_prf#3730,n_name_prf#3731,n_comment_prf#3732] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [s_phone_prf#3735 AS s_phone_prf_1#3743, rid#3736 AS rid_1#3744, s_address_prf#3737 AS s_address_prf_1#3745, s_nationkey_prf#3738 AS s_nationkey_prf_1#3746, s_suppkey_prf#3739 AS s_suppkey_prf_1#3747, s_name_prf#3740 AS s_name_prf_1#3748, s_acctbal_prf#3741 AS s_acctbal_prf_1#3749, s_comment_prf#3742 AS s_comment_prf_1#3750]
         :  :  :     :     :  :     +- Relation[s_phone_prf#3735,rid#3736,s_address_prf#3737,s_nationkey_prf#3738,s_suppkey_prf#3739,s_name_prf#3740,s_acctbal_prf#3741,s_comment_prf#3742] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#3760]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#3759]
         :  :  :     :     :        :  +- Relation[s_phone_prf#3751,rid#3752,s_address_prf#3753,s_nationkey_prf#3754,s_suppkey_prf#3755,s_name_prf#3756,s_acctbal_prf#3757,s_comment_prf#3758] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [ps_partkey_and_ps_suppkey_prf#3761 AS ps_partkey_and_ps_suppkey_prf_2#3768, rid#3762 AS rid_2#3769, ps_availqty_prf#3763 AS ps_availqty_prf_2#3770, ps_comment_prf#3764 AS ps_comment_prf_2#3771, ps_partkey_prf#3765 AS ps_partkey_prf_2#3772, ps_supplycost_prf#3766 AS ps_supplycost_prf_2#3773, ps_suppkey_prf#3767 AS ps_suppkey_prf_2#3774]
         :  :  :     :        +- Relation[ps_partkey_and_ps_suppkey_prf#3761,rid#3762,ps_availqty_prf#3763,ps_comment_prf#3764,ps_partkey_prf#3765,ps_supplycost_prf#3766,ps_suppkey_prf#3767] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Project [p_comment_prf#3784 AS p_comment_prf_3#3794, p_name_prf#3785 AS p_name_prf_3#3795, rid#3786 AS rid_3#3796, p_type_prf#3787 AS p_type_prf_3#3797, p_retailprice_prf#3788 AS p_retailprice_prf_3#3798, p_mfgr_prf#3789 AS p_mfgr_prf_3#3799, p_container_prf#3790 AS p_container_prf_3#3800, p_brand_prf#3791 AS p_brand_prf_3#3801, p_size_prf#3792 AS p_size_prf_3#3802, p_partkey_prf#3793 AS p_partkey_prf_3#3803]
         :  :  :        +- Relation[p_comment_prf#3784,p_name_prf#3785,rid#3786,p_type_prf#3787,p_retailprice_prf#3788,p_mfgr_prf#3789,p_container_prf#3790,p_brand_prf#3791,p_size_prf#3792,p_partkey_prf#3793] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#3813 AS l_returnflag_prf_4#3832, l_orderkey_and_l_linenumber_prf#3814 AS l_orderkey_and_l_linenumber_prf_4#3833, l_comment_prf#3815 AS l_comment_prf_4#3834, l_linestatus_prf#3816 AS l_linestatus_prf_4#3835, rid#3817 AS rid_4#3836, l_shipmode_prf#3818 AS l_shipmode_prf_4#3837, l_shipinstruct_prf#3819 AS l_shipinstruct_prf_4#3838, l_quantity_prf#3820 AS l_quantity_prf_4#3839, l_receiptdate_prf#3821 AS l_receiptdate_prf_4#3840, l_linenumber_prf#3822 AS l_linenumber_prf_4#3841, l_tax_prf#3823 AS l_tax_prf_4#3842, l_shipdate_prf#3824 AS l_shipdate_prf_4#3843, l_extendedprice_prf#3825 AS l_extendedprice_prf_4#3844, l_partkey_prf#3826 AS l_partkey_prf_4#3845, l_discount_prf#3827 AS l_discount_prf_4#3846, l_partkey_and_l_suppkey_prf#3828 AS l_partkey_and_l_suppkey_prf_4#3847, l_commitdate_prf#3829 AS l_commitdate_prf_4#3848, l_suppkey_prf#3830 AS l_suppkey_prf_4#3849, l_orderkey_prf#3831 AS l_orderkey_prf_4#3850]
         :  :     +- Relation[l_returnflag_prf#3813,l_orderkey_and_l_linenumber_prf#3814,l_comment_prf#3815,l_linestatus_prf#3816,rid#3817,l_shipmode_prf#3818,l_shipinstruct_prf#3819,l_quantity_prf#3820,l_receiptdate_prf#3821,l_linenumber_prf#3822,l_tax_prf#3823,l_shipdate_prf#3824,l_extendedprice_prf#3825,l_partkey_prf#3826,l_discount_prf#3827,l_partkey_and_l_suppkey_prf#3828,l_commitdate_prf#3829,l_suppkey_prf#3830,l_orderkey_prf#3831] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#1992) AS rid_5#3871]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#3870]
         :        :  +- Relation[l_returnflag_prf#3851,l_orderkey_and_l_linenumber_prf#3852,l_comment_prf#3853,l_linestatus_prf#3854,rid#3855,l_shipmode_prf#3856,l_shipinstruct_prf#3857,l_quantity_prf#3858,l_receiptdate_prf#3859,l_linenumber_prf#3860,l_tax_prf#3861,l_shipdate_prf#3862,l_extendedprice_prf#3863,l_partkey_prf#3864,l_discount_prf#3865,l_partkey_and_l_suppkey_prf#3866,l_commitdate_prf#3867,l_suppkey_prf#3868,l_orderkey_prf#3869] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#3872 AS o_shippriority_prf_5#3882, rid#3873 AS rid_5#3883, o_orderdate_prf#3874 AS o_orderdate_prf_5#3884, o_custkey_prf#3875 AS o_custkey_prf_5#3885, o_orderpriority_prf#3876 AS o_orderpriority_prf_5#3886, o_clerk_prf#3877 AS o_clerk_prf_5#3887, o_orderstatus_prf#3878 AS o_orderstatus_prf_5#3888, o_totalprice_prf#3879 AS o_totalprice_prf_5#3889, o_orderkey_prf#3880 AS o_orderkey_prf_5#3890, o_comment_prf#3881 AS o_comment_prf_5#3891]
            +- Relation[o_shippriority_prf#3872,rid#3873,o_orderdate_prf#3874,o_custkey_prf#3875,o_orderpriority_prf#3876,o_clerk_prf#3877,o_orderstatus_prf#3878,o_totalprice_prf#3879,o_orderkey_prf#3880,o_comment_prf#3881] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 295168ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
19/10/22 03:14:37 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:14:37 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3957L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 03:14:37 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3957L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#3959 AS p_comment_prf_0#3969, p_name_prf#3960 AS p_name_prf_0#3970, rid#3961 AS rid_0#3971, p_type_prf#3962 AS p_type_prf_0#3972, p_retailprice_prf#3963 AS p_retailprice_prf_0#3973, p_mfgr_prf#3964 AS p_mfgr_prf_0#3974, p_container_prf#3965 AS p_container_prf_0#3975, p_brand_prf#3966 AS p_brand_prf_0#3976, p_size_prf#3967 AS p_size_prf_0#3977, p_partkey_prf#3968 AS p_partkey_prf_0#3978]
         :  :  +- Relation[p_comment_prf#3959,p_name_prf#3960,rid#3961,p_type_prf#3962,p_retailprice_prf#3963,p_mfgr_prf#3964,p_container_prf#3965,p_brand_prf#3966,p_size_prf#3967,p_partkey_prf#3968] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#3990]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3989]
         :        :  +- Relation[p_comment_prf#3979,p_name_prf#3980,rid#3981,p_type_prf#3982,p_retailprice_prf#3983,p_mfgr_prf#3984,p_container_prf#3985,p_brand_prf#3986,p_size_prf#3987,p_partkey_prf#3988] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3991 AS l_returnflag_prf_1#4010, l_orderkey_and_l_linenumber_prf#3992 AS l_orderkey_and_l_linenumber_prf_1#4011, l_comment_prf#3993 AS l_comment_prf_1#4012, l_linestatus_prf#3994 AS l_linestatus_prf_1#4013, rid#3995 AS rid_1#4014, l_shipmode_prf#3996 AS l_shipmode_prf_1#4015, l_shipinstruct_prf#3997 AS l_shipinstruct_prf_1#4016, l_quantity_prf#3998 AS l_quantity_prf_1#4017, l_receiptdate_prf#3999 AS l_receiptdate_prf_1#4018, l_linenumber_prf#4000 AS l_linenumber_prf_1#4019, l_tax_prf#4001 AS l_tax_prf_1#4020, l_shipdate_prf#4002 AS l_shipdate_prf_1#4021, l_extendedprice_prf#4003 AS l_extendedprice_prf_1#4022, l_partkey_prf#4004 AS l_partkey_prf_1#4023, l_discount_prf#4005 AS l_discount_prf_1#4024, l_partkey_and_l_suppkey_prf#4006 AS l_partkey_and_l_suppkey_prf_1#4025, l_commitdate_prf#4007 AS l_commitdate_prf_1#4026, l_suppkey_prf#4008 AS l_suppkey_prf_1#4027, l_orderkey_prf#4009 AS l_orderkey_prf_1#4028]
            +- Relation[l_returnflag_prf#3991,l_orderkey_and_l_linenumber_prf#3992,l_comment_prf#3993,l_linestatus_prf#3994,rid#3995,l_shipmode_prf#3996,l_shipinstruct_prf#3997,l_quantity_prf#3998,l_receiptdate_prf#3999,l_linenumber_prf#4000,l_tax_prf#4001,l_shipdate_prf#4002,l_extendedprice_prf#4003,l_partkey_prf#4004,l_discount_prf#4005,l_partkey_and_l_suppkey_prf#4006,l_commitdate_prf#4007,l_suppkey_prf#4008,l_orderkey_prf#4009] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 90802ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
19/10/22 03:16:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:16:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4065L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 03:16:08 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:16:08 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:16:08 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:16:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4065L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#4067 AS s_phone_prf_0#4075, rid#4068 AS rid_0#4076, s_address_prf#4069 AS s_address_prf_0#4077, s_nationkey_prf#4070 AS s_nationkey_prf_0#4078, s_suppkey_prf#4071 AS s_suppkey_prf_0#4079, s_name_prf#4072 AS s_name_prf_0#4080, s_acctbal_prf#4073 AS s_acctbal_prf_0#4081, s_comment_prf#4074 AS s_comment_prf_0#4082]
         :  :  +- Relation[s_phone_prf#4067,rid#4068,s_address_prf#4069,s_nationkey_prf#4070,s_suppkey_prf#4071,s_name_prf#4072,s_acctbal_prf#4073,s_comment_prf#4074] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#4092]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4091]
         :        :  +- Relation[s_phone_prf#4083,rid#4084,s_address_prf#4085,s_nationkey_prf#4086,s_suppkey_prf#4087,s_name_prf#4088,s_acctbal_prf#4089,s_comment_prf#4090] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4093 AS l_returnflag_prf_1#4112, l_orderkey_and_l_linenumber_prf#4094 AS l_orderkey_and_l_linenumber_prf_1#4113, l_comment_prf#4095 AS l_comment_prf_1#4114, l_linestatus_prf#4096 AS l_linestatus_prf_1#4115, rid#4097 AS rid_1#4116, l_shipmode_prf#4098 AS l_shipmode_prf_1#4117, l_shipinstruct_prf#4099 AS l_shipinstruct_prf_1#4118, l_quantity_prf#4100 AS l_quantity_prf_1#4119, l_receiptdate_prf#4101 AS l_receiptdate_prf_1#4120, l_linenumber_prf#4102 AS l_linenumber_prf_1#4121, l_tax_prf#4103 AS l_tax_prf_1#4122, l_shipdate_prf#4104 AS l_shipdate_prf_1#4123, l_extendedprice_prf#4105 AS l_extendedprice_prf_1#4124, l_partkey_prf#4106 AS l_partkey_prf_1#4125, l_discount_prf#4107 AS l_discount_prf_1#4126, l_partkey_and_l_suppkey_prf#4108 AS l_partkey_and_l_suppkey_prf_1#4127, l_commitdate_prf#4109 AS l_commitdate_prf_1#4128, l_suppkey_prf#4110 AS l_suppkey_prf_1#4129, l_orderkey_prf#4111 AS l_orderkey_prf_1#4130]
            +- Relation[l_returnflag_prf#4093,l_orderkey_and_l_linenumber_prf#4094,l_comment_prf#4095,l_linestatus_prf#4096,rid#4097,l_shipmode_prf#4098,l_shipinstruct_prf#4099,l_quantity_prf#4100,l_receiptdate_prf#4101,l_linenumber_prf#4102,l_tax_prf#4103,l_shipdate_prf#4104,l_extendedprice_prf#4105,l_partkey_prf#4106,l_discount_prf#4107,l_partkey_and_l_suppkey_prf#4108,l_commitdate_prf#4109,l_suppkey_prf#4110,l_orderkey_prf#4111] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 82577ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
19/10/22 03:17:30 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:17:30 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4162L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1764L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1764L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1762L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1762L, l_suppkey#1764L]
               :     :        +- Relation[l_orderkey#1762L,l_partkey#1763L,l_suppkey#1764L,l_linenumber#1765,l_quantity#1766,l_extendedprice#1767,l_discount#1768,l_tax#1769,l_returnflag#1770,l_linestatus#1771,l_commitdate#1772,l_receiptdate#1773,l_shipinstruct#1774,l_shipmode#1775,l_comment#1776,l_shipdate#1777] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/22 03:17:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:17:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:17:30 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 03:17:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:17:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:17:30 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 03:17:30 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4162L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, 'l_shipdate_prf_2, 'l_extendedprice_prf_2, 'l_partkey_prf_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, 'l_shipdate_prf_2, 'l_extendedprice_prf_2, 'l_partkey_prf_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#4244]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4234: string
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [o_shippriority_prf#4223 AS o_shippriority_prf_1#4233, rid#4224 AS rid_1#4234, o_orderdate_prf#4225 AS o_orderdate_prf_1#4235, o_custkey_prf#4226 AS o_custkey_prf_1#4236, o_orderpriority_prf#4227 AS o_orderpriority_prf_1#4237, o_clerk_prf#4228 AS o_clerk_prf_1#4238, o_orderstatus_prf#4229 AS o_orderstatus_prf_1#4239, o_totalprice_prf#4230 AS o_totalprice_prf_1#4240, o_orderkey_prf#4231 AS o_orderkey_prf_1#4241, o_comment_prf#4232 AS o_comment_prf_1#4242]
         :  :     :  :     :  :     :  :  +- Relation[o_shippriority_prf#4223,rid#4224,o_orderdate_prf#4225,o_custkey_prf#4226,o_orderpriority_prf#4227,o_clerk_prf#4228,o_orderstatus_prf#4229,o_totalprice_prf#4230,o_orderkey_prf#4231,o_comment_prf#4232] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4243]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [l_returnflag_prf#4245 AS l_returnflag_prf_2#4264, l_orderkey_and_l_linenumber_prf#4246 AS l_orderkey_and_l_linenumber_prf_2#4265, l_comment_prf#4247 AS l_comment_prf_2#4266, l_linestatus_prf#4248 AS l_linestatus_prf_2#4267, rid#4249 AS rid_2#4268, l_shipmode_prf#4250 AS l_shipmode_prf_2#4269, l_shipinstruct_prf#4251 AS l_shipinstruct_prf_2#4270, l_quantity_prf#4252 AS l_quantity_prf_2#4271, l_receiptdate_prf#4253 AS l_receiptdate_prf_2#4272, l_linenumber_prf#4254 AS l_linenumber_prf_2#4273, l_tax_prf#4255 AS l_tax_prf_2#4274, l_shipdate_prf#4256 AS l_shipdate_prf_2#4275, l_extendedprice_prf#4257 AS l_extendedprice_prf_2#4276, l_partkey_prf#4258 AS l_partkey_prf_2#4277, l_discount_prf#4259 AS l_discount_prf_2#4278, l_partkey_and_l_suppkey_prf#4260 AS l_partkey_and_l_suppkey_prf_2#4279, l_commitdate_prf#4261 AS l_commitdate_prf_2#4280, l_suppkey_prf#4262 AS l_suppkey_prf_2#4281, l_orderkey_prf#4263 AS l_orderkey_prf_2#4282]
         :  :     :  :     :     +- Relation[l_returnflag_prf#4245,l_orderkey_and_l_linenumber_prf#4246,l_comment_prf#4247,l_linestatus_prf#4248,rid#4249,l_shipmode_prf#4250,l_shipinstruct_prf#4251,l_quantity_prf#4252,l_receiptdate_prf#4253,l_linenumber_prf#4254,l_tax_prf#4255,l_shipdate_prf#4256,l_extendedprice_prf#4257,l_partkey_prf#4258,l_discount_prf#4259,l_partkey_and_l_suppkey_prf#4260,l_commitdate_prf#4261,l_suppkey_prf#4262,l_orderkey_prf#4263] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [s_phone_prf#4284 AS s_phone_prf_3#4292, rid#4285 AS rid_3#4293, s_address_prf#4286 AS s_address_prf_3#4294, s_nationkey_prf#4287 AS s_nationkey_prf_3#4295, s_suppkey_prf#4288 AS s_suppkey_prf_3#4296, s_name_prf#4289 AS s_name_prf_3#4297, s_acctbal_prf#4290 AS s_acctbal_prf_3#4298, s_comment_prf#4291 AS s_comment_prf_3#4299]
         :  :     :     +- Relation[s_phone_prf#4284,rid#4285,s_address_prf#4286,s_nationkey_prf#4287,s_suppkey_prf#4288,s_name_prf#4289,s_acctbal_prf#4290,s_comment_prf#4291] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#4301 AS rid_4#4306, n_regionkey_prf#4302 AS n_regionkey_prf_4#4307, n_nationkey_prf#4303 AS n_nationkey_prf_4#4308, n_name_prf#4304 AS n_name_prf_4#4309, n_comment_prf#4305 AS n_comment_prf_4#4310]
         :     :  +- Relation[rid#4301,n_regionkey_prf#4302,n_nationkey_prf#4303,n_name_prf#4304,n_comment_prf#4305] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#4311]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [l_returnflag_prf#4164 AS l_returnflag_prf_0#4183, l_orderkey_and_l_linenumber_prf#4165 AS l_orderkey_and_l_linenumber_prf_0#4184, l_comment_prf#4166 AS l_comment_prf_0#4185, l_linestatus_prf#4167 AS l_linestatus_prf_0#4186, rid#4168 AS rid_0#4187, l_shipmode_prf#4169 AS l_shipmode_prf_0#4188, l_shipinstruct_prf#4170 AS l_shipinstruct_prf_0#4189, l_quantity_prf#4171 AS l_quantity_prf_0#4190, l_receiptdate_prf#4172 AS l_receiptdate_prf_0#4191, l_linenumber_prf#4173 AS l_linenumber_prf_0#4192, l_tax_prf#4174 AS l_tax_prf_0#4193, l_shipdate_prf#4175 AS l_shipdate_prf_0#4194, l_extendedprice_prf#4176 AS l_extendedprice_prf_0#4195, l_partkey_prf#4177 AS l_partkey_prf_0#4196, l_discount_prf#4178 AS l_discount_prf_0#4197, l_partkey_and_l_suppkey_prf#4179 AS l_partkey_and_l_suppkey_prf_0#4198, l_commitdate_prf#4180 AS l_commitdate_prf_0#4199, l_suppkey_prf#4181 AS l_suppkey_prf_0#4200, l_orderkey_prf#4182 AS l_orderkey_prf_0#4201]
            :  +- Relation[l_returnflag_prf#4164,l_orderkey_and_l_linenumber_prf#4165,l_comment_prf#4166,l_linestatus_prf#4167,rid#4168,l_shipmode_prf#4169,l_shipinstruct_prf#4170,l_quantity_prf#4171,l_receiptdate_prf#4172,l_linenumber_prf#4173,l_tax_prf#4174,l_shipdate_prf#4175,l_extendedprice_prf#4176,l_partkey_prf#4177,l_discount_prf#4178,l_partkey_and_l_suppkey_prf#4179,l_commitdate_prf#4180,l_suppkey_prf#4181,l_orderkey_prf#4182] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#4222]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#4221]
                  :  +- Relation[l_returnflag_prf#4202,l_orderkey_and_l_linenumber_prf#4203,l_comment_prf#4204,l_linestatus_prf#4205,rid#4206,l_shipmode_prf#4207,l_shipinstruct_prf#4208,l_quantity_prf#4209,l_receiptdate_prf#4210,l_linenumber_prf#4211,l_tax_prf#4212,l_shipdate_prf#4213,l_extendedprice_prf#4214,l_partkey_prf#4215,l_discount_prf#4216,l_partkey_and_l_suppkey_prf#4217,l_commitdate_prf#4218,l_suppkey_prf#4219,l_orderkey_prf#4220] JDBCRelation(lineitem_prf) [numPartitions=1]
                  +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 368149ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
19/10/22 03:23:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:23:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4362L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 03:23:38 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 03:23:38 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 03:23:38 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 03:23:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4362L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1992) AS rid_2#4404]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#4383]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4374: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#4364 AS c_acctbal_prf_0#4373, rid#4365 AS rid_0#4374, c_name_prf#4366 AS c_name_prf_0#4375, c_nationkey_prf#4367 AS c_nationkey_prf_0#4376, c_custkey_prf#4368 AS c_custkey_prf_0#4377, c_comment_prf#4369 AS c_comment_prf_0#4378, c_address_prf#4370 AS c_address_prf_0#4379, c_mktsegment_prf#4371 AS c_mktsegment_prf_0#4380, c_phone_prf#4372 AS c_phone_prf_0#4381]
         :     :  :     :  :  +- Relation[c_acctbal_prf#4364,rid#4365,c_name_prf#4366,c_nationkey_prf#4367,c_custkey_prf#4368,c_comment_prf#4369,c_address_prf#4370,c_mktsegment_prf#4371,c_phone_prf#4372] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4382]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4384 AS o_shippriority_prf_1#4394, rid#4385 AS rid_1#4395, o_orderdate_prf#4386 AS o_orderdate_prf_1#4396, o_custkey_prf#4387 AS o_custkey_prf_1#4397, o_orderpriority_prf#4388 AS o_orderpriority_prf_1#4398, o_clerk_prf#4389 AS o_clerk_prf_1#4399, o_orderstatus_prf#4390 AS o_orderstatus_prf_1#4400, o_totalprice_prf#4391 AS o_totalprice_prf_1#4401, o_orderkey_prf#4392 AS o_orderkey_prf_1#4402, o_comment_prf#4393 AS o_comment_prf_1#4403]
         :     :     +- Relation[o_shippriority_prf#4384,rid#4385,o_orderdate_prf#4386,o_custkey_prf#4387,o_orderpriority_prf#4388,o_clerk_prf#4389,o_orderstatus_prf#4390,o_totalprice_prf#4391,o_orderkey_prf#4392,o_comment_prf#4393] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4405 AS l_returnflag_prf_2#4424, l_orderkey_and_l_linenumber_prf#4406 AS l_orderkey_and_l_linenumber_prf_2#4425, l_comment_prf#4407 AS l_comment_prf_2#4426, l_linestatus_prf#4408 AS l_linestatus_prf_2#4427, rid#4409 AS rid_2#4428, l_shipmode_prf#4410 AS l_shipmode_prf_2#4429, l_shipinstruct_prf#4411 AS l_shipinstruct_prf_2#4430, l_quantity_prf#4412 AS l_quantity_prf_2#4431, l_receiptdate_prf#4413 AS l_receiptdate_prf_2#4432, l_linenumber_prf#4414 AS l_linenumber_prf_2#4433, l_tax_prf#4415 AS l_tax_prf_2#4434, l_shipdate_prf#4416 AS l_shipdate_prf_2#4435, l_extendedprice_prf#4417 AS l_extendedprice_prf_2#4436, l_partkey_prf#4418 AS l_partkey_prf_2#4437, l_discount_prf#4419 AS l_discount_prf_2#4438, l_partkey_and_l_suppkey_prf#4420 AS l_partkey_and_l_suppkey_prf_2#4439, l_commitdate_prf#4421 AS l_commitdate_prf_2#4440, l_suppkey_prf#4422 AS l_suppkey_prf_2#4441, l_orderkey_prf#4423 AS l_orderkey_prf_2#4442]
            +- Relation[l_returnflag_prf#4405,l_orderkey_and_l_linenumber_prf#4406,l_comment_prf#4407,l_linestatus_prf#4408,rid#4409,l_shipmode_prf#4410,l_shipinstruct_prf#4411,l_quantity_prf#4412,l_receiptdate_prf#4413,l_linenumber_prf#4414,l_tax_prf#4415,l_shipdate_prf#4416,l_extendedprice_prf#4417,l_partkey_prf#4418,l_discount_prf#4419,l_partkey_and_l_suppkey_prf#4420,l_commitdate_prf#4421,l_suppkey_prf#4422,l_orderkey_prf#4423] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32949ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
19/10/22 03:24:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:24:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4486L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 03:24:11 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 03:24:11 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 03:24:11 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 03:24:11 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 03:24:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4486L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#4510]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#4500: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [p_comment_prf#4488 AS p_comment_prf_0#4498, p_name_prf#4489 AS p_name_prf_0#4499, rid#4490 AS rid_0#4500, p_type_prf#4491 AS p_type_prf_0#4501, p_retailprice_prf#4492 AS p_retailprice_prf_0#4502, p_mfgr_prf#4493 AS p_mfgr_prf_0#4503, p_container_prf#4494 AS p_container_prf_0#4504, p_brand_prf#4495 AS p_brand_prf_0#4505, p_size_prf#4496 AS p_size_prf_0#4506, p_partkey_prf#4497 AS p_partkey_prf_0#4507]
         :     :  :  :  +- Relation[p_comment_prf#4488,p_name_prf#4489,rid#4490,p_type_prf#4491,p_retailprice_prf#4492,p_mfgr_prf#4493,p_container_prf#4494,p_brand_prf#4495,p_size_prf#4496,p_partkey_prf#4497] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4508]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4509]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [l_returnflag_prf#4511 AS l_returnflag_prf_1#4530, l_orderkey_and_l_linenumber_prf#4512 AS l_orderkey_and_l_linenumber_prf_1#4531, l_comment_prf#4513 AS l_comment_prf_1#4532, l_linestatus_prf#4514 AS l_linestatus_prf_1#4533, rid#4515 AS rid_1#4534, l_shipmode_prf#4516 AS l_shipmode_prf_1#4535, l_shipinstruct_prf#4517 AS l_shipinstruct_prf_1#4536, l_quantity_prf#4518 AS l_quantity_prf_1#4537, l_receiptdate_prf#4519 AS l_receiptdate_prf_1#4538, l_linenumber_prf#4520 AS l_linenumber_prf_1#4539, l_tax_prf#4521 AS l_tax_prf_1#4540, l_shipdate_prf#4522 AS l_shipdate_prf_1#4541, l_extendedprice_prf#4523 AS l_extendedprice_prf_1#4542, l_partkey_prf#4524 AS l_partkey_prf_1#4543, l_discount_prf#4525 AS l_discount_prf_1#4544, l_partkey_and_l_suppkey_prf#4526 AS l_partkey_and_l_suppkey_prf_1#4545, l_commitdate_prf#4527 AS l_commitdate_prf_1#4546, l_suppkey_prf#4528 AS l_suppkey_prf_1#4547, l_orderkey_prf#4529 AS l_orderkey_prf_1#4548]
            :  :  +- Relation[l_returnflag_prf#4511,l_orderkey_and_l_linenumber_prf#4512,l_comment_prf#4513,l_linestatus_prf#4514,rid#4515,l_shipmode_prf#4516,l_shipinstruct_prf#4517,l_quantity_prf#4518,l_receiptdate_prf#4519,l_linenumber_prf#4520,l_tax_prf#4521,l_shipdate_prf#4522,l_extendedprice_prf#4523,l_partkey_prf#4524,l_discount_prf#4525,l_partkey_and_l_suppkey_prf#4526,l_commitdate_prf#4527,l_suppkey_prf#4528,l_orderkey_prf#4529] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4549]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4550]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#1988,value#1989] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 26347ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
19/10/22 03:24:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 03:24:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4584L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/22 03:24:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4584L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [o_shippriority_prf#4586 AS o_shippriority_prf_0#4596, rid#4587 AS rid_0#4597, o_orderdate_prf#4588 AS o_orderdate_prf_0#4598, o_custkey_prf#4589 AS o_custkey_prf_0#4599, o_orderpriority_prf#4590 AS o_orderpriority_prf_0#4600, o_clerk_prf#4591 AS o_clerk_prf_0#4601, o_orderstatus_prf#4592 AS o_orderstatus_prf_0#4602, o_totalprice_prf#4593 AS o_totalprice_prf_0#4603, o_orderkey_prf#4594 AS o_orderkey_prf_0#4604, o_comment_prf#4595 AS o_comment_prf_0#4605]
         :  :  +- Relation[o_shippriority_prf#4586,rid#4587,o_orderdate_prf#4588,o_custkey_prf#4589,o_orderpriority_prf#4590,o_clerk_prf#4591,o_orderstatus_prf#4592,o_totalprice_prf#4593,o_orderkey_prf#4594,o_comment_prf#4595] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1992) AS rid_1#4617]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#4616]
         :        :  +- Relation[o_shippriority_prf#4606,rid#4607,o_orderdate_prf#4608,o_custkey_prf#4609,o_orderpriority_prf#4610,o_clerk_prf#4611,o_orderstatus_prf#4612,o_totalprice_prf#4613,o_orderkey_prf#4614,o_comment_prf#4615] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1991,value#1992] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#4618 AS c_acctbal_prf_1#4627, rid#4619 AS rid_1#4628, c_name_prf#4620 AS c_name_prf_1#4629, c_nationkey_prf#4621 AS c_nationkey_prf_1#4630, c_custkey_prf#4622 AS c_custkey_prf_1#4631, c_comment_prf#4623 AS c_comment_prf_1#4632, c_address_prf#4624 AS c_address_prf_1#4633, c_mktsegment_prf#4625 AS c_mktsegment_prf_1#4634, c_phone_prf#4626 AS c_phone_prf_1#4635]
            +- Relation[c_acctbal_prf#4618,rid#4619,c_name_prf#4620,c_nationkey_prf#4621,c_custkey_prf#4622,c_comment_prf#4623,c_address_prf#4624,c_mktsegment_prf#4625,c_phone_prf#4626] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 50533ms
query=q1, count=6001215, duration=1749
query=q10, count=1478870, duration=179509
query=q11, count=31680, duration=801
query=q12, count=857401, duration=32221
query=q13, count=1550004, duration=50533
query=q14, count=6001215, duration=90802
query=q15, count=6001215, duration=82577
query=q16, count=15780, duration=389
query=q17, count=6088, duration=368
query=q18, count=6001215, duration=231547
query=q19, count=205, duration=26347
query=q2, count=3162, duration=2019
query=q20, count=324, duration=22535
query=q21a, count=119924, duration=368149
query=q22, count=50004, duration=45857
query=q3, count=1214743, duration=32949
query=q4, count=6001215, duration=98775
query=q7, count=9735, duration=39540
query=q8, count=8716, duration=98100
query=q9a, count=6001215, duration=381931
query=q9b, count=6001215, duration=295168
