19/10/22 01:06:02 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
baseLocation=/data/encrypted-spark/bench/data
baseDatagenFolder=/data/encrypted-spark/bench/datagen
Creating external tables at /data/encrypted-spark/bench/data/tpch/sf1_parquet
Creating external table part in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/part.
Discovering partitions for table part.
Creating external table supplier in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier.
Creating external table partsupp in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp.
Creating external table customer in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/customer.
Discovering partitions for table customer.
Creating external table orders in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/orders.
Discovering partitions for table orders.
Creating external table lineitem in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem.
Discovering partitions for table lineitem.
Creating external table nation in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/nation.
Creating external table region in database tpch_sf1_parquet using data stored in /data/encrypted-spark/bench/data/tpch/sf1_parquet/region.
The current database has been set to tpch_sf1_parquet.
Elapsed time: 7230ms
Table part has 25 partitions
Cannot VACUUM part
+----------------------------+-------------------------------------------------------------+-------+
|col_name                    |data_type                                                    |comment|
+----------------------------+-------------------------------------------------------------+-------+
|p_partkey                   |bigint                                                       |null   |
|p_name                      |string                                                       |null   |
|p_mfgr                      |string                                                       |null   |
|p_type                      |string                                                       |null   |
|p_size                      |int                                                          |null   |
|p_container                 |string                                                       |null   |
|p_retailprice               |decimal(12,2)                                                |null   |
|p_comment                   |string                                                       |null   |
|p_brand                     |string                                                       |null   |
|# Partition Information     |                                                             |       |
|# col_name                  |data_type                                                    |comment|
|p_brand                     |string                                                       |null   |
|                            |                                                             |       |
|# Detailed Table Information|                                                             |       |
|Database                    |tpch_sf1_parquet                                             |       |
|Table                       |part                                                         |       |
|Created Time                |Tue Oct 22 01:06:04 UTC 2019                                 |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                 |       |
|Created By                  |Spark 2.4.0                                                  |       |
|Type                        |EXTERNAL                                                     |       |
|Provider                    |parquet                                                      |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/part|       |
|Partition Provider          |Catalog                                                      |       |
+----------------------------+-------------------------------------------------------------+-------+


Table supplier has no partitions
Cannot VACUUM supplier
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|s_suppkey                   |bigint                                                           |null   |
|s_name                      |string                                                           |null   |
|s_address                   |string                                                           |null   |
|s_nationkey                 |bigint                                                           |null   |
|s_phone                     |string                                                           |null   |
|s_acctbal                   |decimal(12,2)                                                    |null   |
|s_comment                   |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |supplier                                                         |       |
|Created Time                |Tue Oct 22 01:06:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/supplier|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table partsupp has no partitions
Cannot VACUUM partsupp
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|ps_partkey                  |bigint                                                           |null   |
|ps_suppkey                  |bigint                                                           |null   |
|ps_availqty                 |int                                                              |null   |
|ps_supplycost               |decimal(12,2)                                                    |null   |
|ps_comment                  |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |partsupp                                                         |       |
|Created Time                |Tue Oct 22 01:06:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/partsupp|       |
+----------------------------+-----------------------------------------------------------------+-------+


Table customer has 5 partitions
Cannot VACUUM customer
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|c_custkey                   |bigint                                                           |null   |
|c_name                      |string                                                           |null   |
|c_address                   |string                                                           |null   |
|c_nationkey                 |bigint                                                           |null   |
|c_phone                     |string                                                           |null   |
|c_acctbal                   |decimal(12,2)                                                    |null   |
|c_comment                   |string                                                           |null   |
|c_mktsegment                |string                                                           |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|c_mktsegment                |string                                                           |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |customer                                                         |       |
|Created Time                |Tue Oct 22 01:06:05 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/customer|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table orders has 2406 partitions
Cannot VACUUM orders
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|o_orderkey                  |bigint                                                         |null   |
|o_custkey                   |bigint                                                         |null   |
|o_orderstatus               |string                                                         |null   |
|o_totalprice                |decimal(12,2)                                                  |null   |
|o_orderpriority             |string                                                         |null   |
|o_clerk                     |string                                                         |null   |
|o_shippriority              |int                                                            |null   |
|o_comment                   |string                                                         |null   |
|o_orderdate                 |date                                                           |null   |
|# Partition Information     |                                                               |       |
|# col_name                  |data_type                                                      |comment|
|o_orderdate                 |date                                                           |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |orders                                                         |       |
|Created Time                |Tue Oct 22 01:06:05 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/orders|       |
|Partition Provider          |Catalog                                                        |       |
+----------------------------+---------------------------------------------------------------+-------+


Table lineitem has 2526 partitions
Cannot VACUUM lineitem
+----------------------------+-----------------------------------------------------------------+-------+
|col_name                    |data_type                                                        |comment|
+----------------------------+-----------------------------------------------------------------+-------+
|l_orderkey                  |bigint                                                           |null   |
|l_partkey                   |bigint                                                           |null   |
|l_suppkey                   |bigint                                                           |null   |
|l_linenumber                |int                                                              |null   |
|l_quantity                  |decimal(12,2)                                                    |null   |
|l_extendedprice             |decimal(12,2)                                                    |null   |
|l_discount                  |decimal(12,2)                                                    |null   |
|l_tax                       |decimal(12,2)                                                    |null   |
|l_returnflag                |string                                                           |null   |
|l_linestatus                |string                                                           |null   |
|l_commitdate                |string                                                           |null   |
|l_receiptdate               |string                                                           |null   |
|l_shipinstruct              |string                                                           |null   |
|l_shipmode                  |string                                                           |null   |
|l_comment                   |string                                                           |null   |
|l_shipdate                  |date                                                             |null   |
|# Partition Information     |                                                                 |       |
|# col_name                  |data_type                                                        |comment|
|l_shipdate                  |date                                                             |null   |
|                            |                                                                 |       |
|# Detailed Table Information|                                                                 |       |
|Database                    |tpch_sf1_parquet                                                 |       |
|Table                       |lineitem                                                         |       |
|Created Time                |Tue Oct 22 01:06:08 UTC 2019                                     |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                     |       |
|Created By                  |Spark 2.4.0                                                      |       |
|Type                        |EXTERNAL                                                         |       |
|Provider                    |parquet                                                          |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/lineitem|       |
|Partition Provider          |Catalog                                                          |       |
+----------------------------+-----------------------------------------------------------------+-------+


Table nation has no partitions
Cannot VACUUM nation
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|n_nationkey                 |bigint                                                         |null   |
|n_name                      |string                                                         |null   |
|n_regionkey                 |bigint                                                         |null   |
|n_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |nation                                                         |       |
|Created Time                |Tue Oct 22 01:06:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/nation|       |
+----------------------------+---------------------------------------------------------------+-------+


Table region has no partitions
Cannot VACUUM region
+----------------------------+---------------------------------------------------------------+-------+
|col_name                    |data_type                                                      |comment|
+----------------------------+---------------------------------------------------------------+-------+
|r_regionkey                 |bigint                                                         |null   |
|r_name                      |string                                                         |null   |
|r_comment                   |string                                                         |null   |
|                            |                                                               |       |
|# Detailed Table Information|                                                               |       |
|Database                    |tpch_sf1_parquet                                               |       |
|Table                       |region                                                         |       |
|Created Time                |Tue Oct 22 01:06:10 UTC 2019                                   |       |
|Last Access                 |Wed Dec 31 23:59:59 UTC 1969                                   |       |
|Created By                  |Spark 2.4.0                                                    |       |
|Type                        |EXTERNAL                                                       |       |
|Provider                    |parquet                                                        |       |
|Location                    |file:///data/encrypted-spark/bench/data/tpch/sf1_parquet/region|       |
+----------------------------+---------------------------------------------------------------+-------+



q9a=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
19/10/22 01:06:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:06:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#1945L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :  +- Join Inner, (l_partkey#307L = p_partkey#360L)
         :     :     :- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 01:06:11 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:06:11 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:06:11 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:06:11 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:06:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:06:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:06:12 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:06:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:06:12 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:06:12 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#1945L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_2))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :  :  :  :  :  :- 'Join NaturalJoin(Inner)
         :  :  :  :  :  :  :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :  :  :  :  :  :  :- Project [rid#1947 AS rid_0#1952, n_regionkey_prf#1948 AS n_regionkey_prf_0#1953, n_nationkey_prf#1949 AS n_nationkey_prf_0#1954, n_name_prf#1950 AS n_name_prf_0#1955, n_comment_prf#1951 AS n_comment_prf_0#1956]
         :  :  :  :  :  :  :  :  :  :  +- Relation[rid#1947,n_regionkey_prf#1948,n_nationkey_prf#1949,n_name_prf#1950,n_comment_prf#1951] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#1965]
         :  :  :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :  :  :  :  :  :  :        :- 'Project ['rid AS rid_0#1962]
         :  :  :  :  :  :  :  :  :        :  +- Relation[rid#1957,n_regionkey_prf#1958,n_nationkey_prf#1959,n_name_prf#1960,n_comment_prf#1961] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :  :  :  :  :  :  :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  :  :  +- Project [s_phone_prf#1966 AS s_phone_prf_1#1974, rid#1967 AS rid_1#1975, s_address_prf#1968 AS s_address_prf_1#1976, s_nationkey_prf#1969 AS s_nationkey_prf_1#1977, s_suppkey_prf#1970 AS s_suppkey_prf_1#1978, s_name_prf#1971 AS s_name_prf_1#1979, s_acctbal_prf#1972 AS s_acctbal_prf_1#1980, s_comment_prf#1973 AS s_comment_prf_1#1981]
         :  :  :  :  :  :  :  :     +- Relation[s_phone_prf#1966,rid#1967,s_address_prf#1968,s_nationkey_prf#1969,s_suppkey_prf#1970,s_name_prf#1971,s_acctbal_prf#1972,s_comment_prf#1973] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#1991]
         :  :  :  :  :  :  :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :  :  :  :  :  :  :        :- 'Project ['rid AS rid_1#1990]
         :  :  :  :  :  :  :        :  +- Relation[s_phone_prf#1982,rid#1983,s_address_prf#1984,s_nationkey_prf#1985,s_suppkey_prf#1986,s_name_prf#1987,s_acctbal_prf#1988,s_comment_prf#1989] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :  :  :  :  :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  :  :  +- Project [l_returnflag_prf#1992 AS l_returnflag_prf_2#2011, l_orderkey_and_l_linenumber_prf#1993 AS l_orderkey_and_l_linenumber_prf_2#2012, l_comment_prf#1994 AS l_comment_prf_2#2013, l_linestatus_prf#1995 AS l_linestatus_prf_2#2014, rid#1996 AS rid_2#2015, l_shipmode_prf#1997 AS l_shipmode_prf_2#2016, l_shipinstruct_prf#1998 AS l_shipinstruct_prf_2#2017, l_quantity_prf#1999 AS l_quantity_prf_2#2018, l_receiptdate_prf#2000 AS l_receiptdate_prf_2#2019, l_linenumber_prf#2001 AS l_linenumber_prf_2#2020, l_tax_prf#2002 AS l_tax_prf_2#2021, l_shipdate_prf#2003 AS l_shipdate_prf_2#2022, l_extendedprice_prf#2004 AS l_extendedprice_prf_2#2023, l_partkey_prf#2005 AS l_partkey_prf_2#2024, l_discount_prf#2006 AS l_discount_prf_2#2025, l_partkey_and_l_suppkey_prf#2007 AS l_partkey_and_l_suppkey_prf_2#2026, l_commitdate_prf#2008 AS l_commitdate_prf_2#2027, l_suppkey_prf#2009 AS l_suppkey_prf_2#2028, l_orderkey_prf#2010 AS l_orderkey_prf_2#2029]
         :  :  :  :  :  :     +- Relation[l_returnflag_prf#1992,l_orderkey_and_l_linenumber_prf#1993,l_comment_prf#1994,l_linestatus_prf#1995,rid#1996,l_shipmode_prf#1997,l_shipinstruct_prf#1998,l_quantity_prf#1999,l_receiptdate_prf#2000,l_linenumber_prf#2001,l_tax_prf#2002,l_shipdate_prf#2003,l_extendedprice_prf#2004,l_partkey_prf#2005,l_discount_prf#2006,l_partkey_and_l_suppkey_prf#2007,l_commitdate_prf#2008,l_suppkey_prf#2009,l_orderkey_prf#2010] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1964) AS rid_3#2050]
         :  :  :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey~part~p_partkey, 'rid_2
         :  :  :  :  :        :- 'Project ['rid AS rid_2#2049]
         :  :  :  :  :        :  +- Relation[l_returnflag_prf#2030,l_orderkey_and_l_linenumber_prf#2031,l_comment_prf#2032,l_linestatus_prf#2033,rid#2034,l_shipmode_prf#2035,l_shipinstruct_prf#2036,l_quantity_prf#2037,l_receiptdate_prf#2038,l_linenumber_prf#2039,l_tax_prf#2040,l_shipdate_prf#2041,l_extendedprice_prf#2042,l_partkey_prf#2043,l_discount_prf#2044,l_partkey_and_l_suppkey_prf#2045,l_commitdate_prf#2046,l_suppkey_prf#2047,l_orderkey_prf#2048] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :  :  :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  :  +- Project [p_comment_prf#2051 AS p_comment_prf_3#2061, p_name_prf#2052 AS p_name_prf_3#2062, rid#2053 AS rid_3#2063, p_type_prf#2054 AS p_type_prf_3#2064, p_retailprice_prf#2055 AS p_retailprice_prf_3#2065, p_mfgr_prf#2056 AS p_mfgr_prf_3#2066, p_container_prf#2057 AS p_container_prf_3#2067, p_brand_prf#2058 AS p_brand_prf_3#2068, p_size_prf#2059 AS p_size_prf_3#2069, p_partkey_prf#2060 AS p_partkey_prf_3#2070]
         :  :  :  :     +- Relation[p_comment_prf#2051,p_name_prf#2052,rid#2053,p_type_prf#2054,p_retailprice_prf#2055,p_mfgr_prf#2056,p_container_prf#2057,p_brand_prf#2058,p_size_prf#2059,p_partkey_prf#2060] JDBCRelation(part_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1964) AS rid_4#2091]
         :  :  :     +- 'DexRidCorrelatedJoin lineitem~l_partkey_and_l_suppkey~partsupp~ps_partkey_and_ps_suppkey, 'rid_2
         :  :  :        :- 'Project ['rid AS rid_2#2090]
         :  :  :        :  +- Relation[l_returnflag_prf#2071,l_orderkey_and_l_linenumber_prf#2072,l_comment_prf#2073,l_linestatus_prf#2074,rid#2075,l_shipmode_prf#2076,l_shipinstruct_prf#2077,l_quantity_prf#2078,l_receiptdate_prf#2079,l_linenumber_prf#2080,l_tax_prf#2081,l_shipdate_prf#2082,l_extendedprice_prf#2083,l_partkey_prf#2084,l_discount_prf#2085,l_partkey_and_l_suppkey_prf#2086,l_commitdate_prf#2087,l_suppkey_prf#2088,l_orderkey_prf#2089] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [ps_partkey_and_ps_suppkey_prf#2092 AS ps_partkey_and_ps_suppkey_prf_4#2099, rid#2093 AS rid_4#2100, ps_availqty_prf#2094 AS ps_availqty_prf_4#2101, ps_comment_prf#2095 AS ps_comment_prf_4#2102, ps_partkey_prf#2096 AS ps_partkey_prf_4#2103, ps_supplycost_prf#2097 AS ps_supplycost_prf_4#2104, ps_suppkey_prf#2098 AS ps_suppkey_prf_4#2105]
         :  :     +- Relation[ps_partkey_and_ps_suppkey_prf#2092,rid#2093,ps_availqty_prf#2094,ps_comment_prf#2095,ps_partkey_prf#2096,ps_supplycost_prf#2097,ps_suppkey_prf#2098] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  +- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1964) AS rid_5#2126]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :        :- 'Project ['rid AS rid_2#2125]
         :        :  +- Relation[l_returnflag_prf#2106,l_orderkey_and_l_linenumber_prf#2107,l_comment_prf#2108,l_linestatus_prf#2109,rid#2110,l_shipmode_prf#2111,l_shipinstruct_prf#2112,l_quantity_prf#2113,l_receiptdate_prf#2114,l_linenumber_prf#2115,l_tax_prf#2116,l_shipdate_prf#2117,l_extendedprice_prf#2118,l_partkey_prf#2119,l_discount_prf#2120,l_partkey_and_l_suppkey_prf#2121,l_commitdate_prf#2122,l_suppkey_prf#2123,l_orderkey_prf#2124] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2127 AS o_shippriority_prf_5#2137, rid#2128 AS rid_5#2138, o_orderdate_prf#2129 AS o_orderdate_prf_5#2139, o_custkey_prf#2130 AS o_custkey_prf_5#2140, o_orderpriority_prf#2131 AS o_orderpriority_prf_5#2141, o_clerk_prf#2132 AS o_clerk_prf_5#2142, o_orderstatus_prf#2133 AS o_orderstatus_prf_5#2143, o_totalprice_prf#2134 AS o_totalprice_prf_5#2144, o_orderkey_prf#2135 AS o_orderkey_prf_5#2145, o_comment_prf#2136 AS o_comment_prf_5#2146]
            +- Relation[o_shippriority_prf#2127,rid#2128,o_orderdate_prf#2129,o_custkey_prf#2130,o_orderpriority_prf#2131,o_clerk_prf#2132,o_orderstatus_prf#2133,o_totalprice_prf#2134,o_orderkey_prf#2135,o_comment_prf#2136] JDBCRelation(orders_prf) [numPartitions=1]

19/10/22 01:06:12 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
DexCorr$ result size=6001215
Elapsed time: 383530ms

q14=

select
  p_type, l_extendedprice, l_discount
from
  lineitem, part
where
  l_partkey = p_partkey
        
19/10/22 01:12:35 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:12:35 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2212L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:12:35 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2212L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [p_comment_prf#2214 AS p_comment_prf_0#2224, p_name_prf#2215 AS p_name_prf_0#2225, rid#2216 AS rid_0#2226, p_type_prf#2217 AS p_type_prf_0#2227, p_retailprice_prf#2218 AS p_retailprice_prf_0#2228, p_mfgr_prf#2219 AS p_mfgr_prf_0#2229, p_container_prf#2220 AS p_container_prf_0#2230, p_brand_prf#2221 AS p_brand_prf_0#2231, p_size_prf#2222 AS p_size_prf_0#2232, p_partkey_prf#2223 AS p_partkey_prf_0#2233]
         :  :  +- Relation[p_comment_prf#2214,p_name_prf#2215,rid#2216,p_type_prf#2217,p_retailprice_prf#2218,p_mfgr_prf#2219,p_container_prf#2220,p_brand_prf#2221,p_size_prf#2222,p_partkey_prf#2223] JDBCRelation(part_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#2245]
         :     +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2244]
         :        :  +- Relation[p_comment_prf#2234,p_name_prf#2235,rid#2236,p_type_prf#2237,p_retailprice_prf#2238,p_mfgr_prf#2239,p_container_prf#2240,p_brand_prf#2241,p_size_prf#2242,p_partkey_prf#2243] JDBCRelation(part_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#2246 AS l_returnflag_prf_1#2265, l_orderkey_and_l_linenumber_prf#2247 AS l_orderkey_and_l_linenumber_prf_1#2266, l_comment_prf#2248 AS l_comment_prf_1#2267, l_linestatus_prf#2249 AS l_linestatus_prf_1#2268, rid#2250 AS rid_1#2269, l_shipmode_prf#2251 AS l_shipmode_prf_1#2270, l_shipinstruct_prf#2252 AS l_shipinstruct_prf_1#2271, l_quantity_prf#2253 AS l_quantity_prf_1#2272, l_receiptdate_prf#2254 AS l_receiptdate_prf_1#2273, l_linenumber_prf#2255 AS l_linenumber_prf_1#2274, l_tax_prf#2256 AS l_tax_prf_1#2275, l_shipdate_prf#2257 AS l_shipdate_prf_1#2276, l_extendedprice_prf#2258 AS l_extendedprice_prf_1#2277, l_partkey_prf#2259 AS l_partkey_prf_1#2278, l_discount_prf#2260 AS l_discount_prf_1#2279, l_partkey_and_l_suppkey_prf#2261 AS l_partkey_and_l_suppkey_prf_1#2280, l_commitdate_prf#2262 AS l_commitdate_prf_1#2281, l_suppkey_prf#2263 AS l_suppkey_prf_1#2282, l_orderkey_prf#2264 AS l_orderkey_prf_1#2283]
            +- Relation[l_returnflag_prf#2246,l_orderkey_and_l_linenumber_prf#2247,l_comment_prf#2248,l_linestatus_prf#2249,rid#2250,l_shipmode_prf#2251,l_shipinstruct_prf#2252,l_quantity_prf#2253,l_receiptdate_prf#2254,l_linenumber_prf#2255,l_tax_prf#2256,l_shipdate_prf#2257,l_extendedprice_prf#2258,l_partkey_prf#2259,l_discount_prf#2260,l_partkey_and_l_suppkey_prf#2261,l_commitdate_prf#2262,l_suppkey_prf#2263,l_orderkey_prf#2264] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 90690ms

q11=

select
  ps_partkey, ps_supplycost, ps_availqty
from
  partsupp, supplier, nation
where
  ps_suppkey = s_suppkey
  and s_nationkey = n_nationkey
  and n_name = 'GERMANY'
        
19/10/22 01:14:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:14:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2319L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Filter (n_name#109 = GERMANY)
         :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2319L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#2351]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#2334]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#2326: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [rid#2321 AS rid_0#2326, n_regionkey_prf#2322 AS n_regionkey_prf_0#2327, n_nationkey_prf#2323 AS n_nationkey_prf_0#2328, n_name_prf#2324 AS n_name_prf_0#2329, n_comment_prf#2325 AS n_comment_prf_0#2330]
         :     :  :     :  :  +- Relation[rid#2321,n_regionkey_prf#2322,n_nationkey_prf#2323,n_name_prf#2324,n_comment_prf#2325] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2333]
         :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
         :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#2335 AS s_phone_prf_1#2343, rid#2336 AS rid_1#2344, s_address_prf#2337 AS s_address_prf_1#2345, s_nationkey_prf#2338 AS s_nationkey_prf_1#2346, s_suppkey_prf#2339 AS s_suppkey_prf_1#2347, s_name_prf#2340 AS s_name_prf_1#2348, s_acctbal_prf#2341 AS s_acctbal_prf_1#2349, s_comment_prf#2342 AS s_comment_prf_1#2350]
         :     :     +- Relation[s_phone_prf#2335,rid#2336,s_address_prf#2337,s_nationkey_prf#2338,s_suppkey_prf#2339,s_name_prf#2340,s_acctbal_prf#2341,s_comment_prf#2342] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#2352 AS ps_partkey_and_ps_suppkey_prf_2#2359, rid#2353 AS rid_2#2360, ps_availqty_prf#2354 AS ps_availqty_prf_2#2361, ps_comment_prf#2355 AS ps_comment_prf_2#2362, ps_partkey_prf#2356 AS ps_partkey_prf_2#2363, ps_supplycost_prf#2357 AS ps_supplycost_prf_2#2364, ps_suppkey_prf#2358 AS ps_suppkey_prf_2#2365]
            +- Relation[ps_partkey_and_ps_suppkey_prf#2352,rid#2353,ps_availqty_prf#2354,ps_comment_prf#2355,ps_partkey_prf#2356,ps_supplycost_prf#2357,ps_suppkey_prf#2358] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=31680
Elapsed time: 851ms

q9b=

select
  n_name as nation, o_orderdate, l_extendedprice, l_discount, ps_supplycost, l_quantity
from
  part, supplier, lineitem, partsupp, orders, nation
where
  s_suppkey = l_suppkey
  and ps_suppkey = l_suppkey and ps_partkey = l_partkey
  and p_partkey = l_partkey
  and o_orderkey = l_orderkey
  and s_nationkey = n_nationkey
        
19/10/22 01:14:06 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:14:06 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2395L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, ((l_partkey#307L = ps_partkey#32L) && (l_suppkey#308L = ps_suppkey#33L))
         :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :  +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :     :     :- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :  +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :     :     :     :- Project [s_suppkey#18L]
         :     :     :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :     :     :- Project [n_nationkey#108L]
         :     :     :     :     :  +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :     :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     :     :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :     :     :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         :     :     +- Project [p_partkey#360L]
         :     :        +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:14:06 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2395L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_4))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1964) AS rid_4#2491]
         :  :  :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey_and_ps_suppkey~lineitem~l_partkey_and_l_suppkey, 'rid_2
         :  :  :  :     :- 'Project ['rid AS rid_2#2490]
         :  :  :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2483,rid#2484,ps_availqty_prf#2485,ps_comment_prf#2486,ps_partkey_prf#2487,ps_supplycost_prf#2488,ps_suppkey_prf#2489] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :  +- 'Join NaturalJoin(Inner)
         :  :  :     :- 'Join UsingJoin(Inner,List(rid_2))
         :  :  :     :  :- 'Project ['rid_2, dexdecrypt('value_dec_key, value#1964) AS rid_3#2462]
         :  :  :     :  :  +- 'DexRidCorrelatedJoin partsupp~ps_partkey~part~p_partkey, 'rid_2
         :  :  :     :  :     :- 'Project ['rid AS rid_2#2461]
         :  :  :     :  :     :  +- Relation[ps_partkey_and_ps_suppkey_prf#2454,rid#2455,ps_availqty_prf#2456,ps_comment_prf#2457,ps_partkey_prf#2458,ps_supplycost_prf#2459,ps_suppkey_prf#2460] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :  +- 'Join NaturalJoin(Inner)
         :  :  :     :     :- 'Join UsingJoin(Inner,List(rid_1))
         :  :  :     :     :  :- 'Join NaturalJoin(Inner)
         :  :  :     :     :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :     :     :  :  :  :- Project [rid#2397 AS rid_0#2402, n_regionkey_prf#2398 AS n_regionkey_prf_0#2403, n_nationkey_prf#2399 AS n_nationkey_prf_0#2404, n_name_prf#2400 AS n_name_prf_0#2405, n_comment_prf#2401 AS n_comment_prf_0#2406]
         :  :  :     :     :  :  :  :  +- Relation[rid#2397,n_regionkey_prf#2398,n_nationkey_prf#2399,n_name_prf#2400,n_comment_prf#2401] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :     :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#2413]
         :  :  :     :     :  :  :     +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_0
         :  :  :     :     :  :  :        :- 'Project ['rid AS rid_0#2412]
         :  :  :     :     :  :  :        :  +- Relation[rid#2407,n_regionkey_prf#2408,n_nationkey_prf#2409,n_name_prf#2410,n_comment_prf#2411] JDBCRelation(nation_prf) [numPartitions=1]
         :  :  :     :     :  :  :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     :  :  +- Project [s_phone_prf#2414 AS s_phone_prf_1#2422, rid#2415 AS rid_1#2423, s_address_prf#2416 AS s_address_prf_1#2424, s_nationkey_prf#2417 AS s_nationkey_prf_1#2425, s_suppkey_prf#2418 AS s_suppkey_prf_1#2426, s_name_prf#2419 AS s_name_prf_1#2427, s_acctbal_prf#2420 AS s_acctbal_prf_1#2428, s_comment_prf#2421 AS s_comment_prf_1#2429]
         :  :  :     :     :  :     +- Relation[s_phone_prf#2414,rid#2415,s_address_prf#2416,s_nationkey_prf#2417,s_suppkey_prf#2418,s_name_prf#2419,s_acctbal_prf#2420,s_comment_prf#2421] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     :     :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#2439]
         :  :  :     :     :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_1
         :  :  :     :     :        :- 'Project ['rid AS rid_1#2438]
         :  :  :     :     :        :  +- Relation[s_phone_prf#2430,rid#2431,s_address_prf#2432,s_nationkey_prf#2433,s_suppkey_prf#2434,s_name_prf#2435,s_acctbal_prf#2436,s_comment_prf#2437] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :  :     :     :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  :     :     +- Project [ps_partkey_and_ps_suppkey_prf#2440 AS ps_partkey_and_ps_suppkey_prf_2#2447, rid#2441 AS rid_2#2448, ps_availqty_prf#2442 AS ps_availqty_prf_2#2449, ps_comment_prf#2443 AS ps_comment_prf_2#2450, ps_partkey_prf#2444 AS ps_partkey_prf_2#2451, ps_supplycost_prf#2445 AS ps_supplycost_prf_2#2452, ps_suppkey_prf#2446 AS ps_suppkey_prf_2#2453]
         :  :  :     :        +- Relation[ps_partkey_and_ps_suppkey_prf#2440,rid#2441,ps_availqty_prf#2442,ps_comment_prf#2443,ps_partkey_prf#2444,ps_supplycost_prf#2445,ps_suppkey_prf#2446] JDBCRelation(partsupp_prf) [numPartitions=1]
         :  :  :     +- Project [p_comment_prf#2463 AS p_comment_prf_3#2473, p_name_prf#2464 AS p_name_prf_3#2474, rid#2465 AS rid_3#2475, p_type_prf#2466 AS p_type_prf_3#2476, p_retailprice_prf#2467 AS p_retailprice_prf_3#2477, p_mfgr_prf#2468 AS p_mfgr_prf_3#2478, p_container_prf#2469 AS p_container_prf_3#2479, p_brand_prf#2470 AS p_brand_prf_3#2480, p_size_prf#2471 AS p_size_prf_3#2481, p_partkey_prf#2472 AS p_partkey_prf_3#2482]
         :  :  :        +- Relation[p_comment_prf#2463,p_name_prf#2464,rid#2465,p_type_prf#2466,p_retailprice_prf#2467,p_mfgr_prf#2468,p_container_prf#2469,p_brand_prf#2470,p_size_prf#2471,p_partkey_prf#2472] JDBCRelation(part_prf) [numPartitions=1]
         :  :  +- Project [l_returnflag_prf#2492 AS l_returnflag_prf_4#2511, l_orderkey_and_l_linenumber_prf#2493 AS l_orderkey_and_l_linenumber_prf_4#2512, l_comment_prf#2494 AS l_comment_prf_4#2513, l_linestatus_prf#2495 AS l_linestatus_prf_4#2514, rid#2496 AS rid_4#2515, l_shipmode_prf#2497 AS l_shipmode_prf_4#2516, l_shipinstruct_prf#2498 AS l_shipinstruct_prf_4#2517, l_quantity_prf#2499 AS l_quantity_prf_4#2518, l_receiptdate_prf#2500 AS l_receiptdate_prf_4#2519, l_linenumber_prf#2501 AS l_linenumber_prf_4#2520, l_tax_prf#2502 AS l_tax_prf_4#2521, l_shipdate_prf#2503 AS l_shipdate_prf_4#2522, l_extendedprice_prf#2504 AS l_extendedprice_prf_4#2523, l_partkey_prf#2505 AS l_partkey_prf_4#2524, l_discount_prf#2506 AS l_discount_prf_4#2525, l_partkey_and_l_suppkey_prf#2507 AS l_partkey_and_l_suppkey_prf_4#2526, l_commitdate_prf#2508 AS l_commitdate_prf_4#2527, l_suppkey_prf#2509 AS l_suppkey_prf_4#2528, l_orderkey_prf#2510 AS l_orderkey_prf_4#2529]
         :  :     +- Relation[l_returnflag_prf#2492,l_orderkey_and_l_linenumber_prf#2493,l_comment_prf#2494,l_linestatus_prf#2495,rid#2496,l_shipmode_prf#2497,l_shipinstruct_prf#2498,l_quantity_prf#2499,l_receiptdate_prf#2500,l_linenumber_prf#2501,l_tax_prf#2502,l_shipdate_prf#2503,l_extendedprice_prf#2504,l_partkey_prf#2505,l_discount_prf#2506,l_partkey_and_l_suppkey_prf#2507,l_commitdate_prf#2508,l_suppkey_prf#2509,l_orderkey_prf#2510] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_4, dexdecrypt('value_dec_key, value#1964) AS rid_5#2550]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_4
         :        :- 'Project ['rid AS rid_4#2549]
         :        :  +- Relation[l_returnflag_prf#2530,l_orderkey_and_l_linenumber_prf#2531,l_comment_prf#2532,l_linestatus_prf#2533,rid#2534,l_shipmode_prf#2535,l_shipinstruct_prf#2536,l_quantity_prf#2537,l_receiptdate_prf#2538,l_linenumber_prf#2539,l_tax_prf#2540,l_shipdate_prf#2541,l_extendedprice_prf#2542,l_partkey_prf#2543,l_discount_prf#2544,l_partkey_and_l_suppkey_prf#2545,l_commitdate_prf#2546,l_suppkey_prf#2547,l_orderkey_prf#2548] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2551 AS o_shippriority_prf_5#2561, rid#2552 AS rid_5#2562, o_orderdate_prf#2553 AS o_orderdate_prf_5#2563, o_custkey_prf#2554 AS o_custkey_prf_5#2564, o_orderpriority_prf#2555 AS o_orderpriority_prf_5#2565, o_clerk_prf#2556 AS o_clerk_prf_5#2566, o_orderstatus_prf#2557 AS o_orderstatus_prf_5#2567, o_totalprice_prf#2558 AS o_totalprice_prf_5#2568, o_orderkey_prf#2559 AS o_orderkey_prf_5#2569, o_comment_prf#2560 AS o_comment_prf_5#2570]
            +- Relation[o_shippriority_prf#2551,rid#2552,o_orderdate_prf#2553,o_custkey_prf#2554,o_orderpriority_prf#2555,o_clerk_prf#2556,o_orderstatus_prf#2557,o_totalprice_prf#2558,o_orderkey_prf#2559,o_comment_prf#2560] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 293253ms

q4=

select
  *
from
  lineitem, orders
where
  l_orderkey = o_orderkey
        
19/10/22 01:19:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:19:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2658L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 01:19:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2658L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [l_returnflag_prf#2660 AS l_returnflag_prf_0#2679, l_orderkey_and_l_linenumber_prf#2661 AS l_orderkey_and_l_linenumber_prf_0#2680, l_comment_prf#2662 AS l_comment_prf_0#2681, l_linestatus_prf#2663 AS l_linestatus_prf_0#2682, rid#2664 AS rid_0#2683, l_shipmode_prf#2665 AS l_shipmode_prf_0#2684, l_shipinstruct_prf#2666 AS l_shipinstruct_prf_0#2685, l_quantity_prf#2667 AS l_quantity_prf_0#2686, l_receiptdate_prf#2668 AS l_receiptdate_prf_0#2687, l_linenumber_prf#2669 AS l_linenumber_prf_0#2688, l_tax_prf#2670 AS l_tax_prf_0#2689, l_shipdate_prf#2671 AS l_shipdate_prf_0#2690, l_extendedprice_prf#2672 AS l_extendedprice_prf_0#2691, l_partkey_prf#2673 AS l_partkey_prf_0#2692, l_discount_prf#2674 AS l_discount_prf_0#2693, l_partkey_and_l_suppkey_prf#2675 AS l_partkey_and_l_suppkey_prf_0#2694, l_commitdate_prf#2676 AS l_commitdate_prf_0#2695, l_suppkey_prf#2677 AS l_suppkey_prf_0#2696, l_orderkey_prf#2678 AS l_orderkey_prf_0#2697]
         :  :  +- Relation[l_returnflag_prf#2660,l_orderkey_and_l_linenumber_prf#2661,l_comment_prf#2662,l_linestatus_prf#2663,rid#2664,l_shipmode_prf#2665,l_shipinstruct_prf#2666,l_quantity_prf#2667,l_receiptdate_prf#2668,l_linenumber_prf#2669,l_tax_prf#2670,l_shipdate_prf#2671,l_extendedprice_prf#2672,l_partkey_prf#2673,l_discount_prf#2674,l_partkey_and_l_suppkey_prf#2675,l_commitdate_prf#2676,l_suppkey_prf#2677,l_orderkey_prf#2678] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#2718]
         :     +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#2717]
         :        :  +- Relation[l_returnflag_prf#2698,l_orderkey_and_l_linenumber_prf#2699,l_comment_prf#2700,l_linestatus_prf#2701,rid#2702,l_shipmode_prf#2703,l_shipinstruct_prf#2704,l_quantity_prf#2705,l_receiptdate_prf#2706,l_linenumber_prf#2707,l_tax_prf#2708,l_shipdate_prf#2709,l_extendedprice_prf#2710,l_partkey_prf#2711,l_discount_prf#2712,l_partkey_and_l_suppkey_prf#2713,l_commitdate_prf#2714,l_suppkey_prf#2715,l_orderkey_prf#2716] JDBCRelation(lineitem_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#2719 AS o_shippriority_prf_1#2729, rid#2720 AS rid_1#2730, o_orderdate_prf#2721 AS o_orderdate_prf_1#2731, o_custkey_prf#2722 AS o_custkey_prf_1#2732, o_orderpriority_prf#2723 AS o_orderpriority_prf_1#2733, o_clerk_prf#2724 AS o_clerk_prf_1#2734, o_orderstatus_prf#2725 AS o_orderstatus_prf_1#2735, o_totalprice_prf#2726 AS o_totalprice_prf_1#2736, o_orderkey_prf#2727 AS o_orderkey_prf_1#2737, o_comment_prf#2728 AS o_comment_prf_1#2738]
            +- Relation[o_shippriority_prf#2719,rid#2720,o_orderdate_prf#2721,o_custkey_prf#2722,o_orderpriority_prf#2723,o_clerk_prf#2724,o_orderstatus_prf#2725,o_totalprice_prf#2726,o_orderkey_prf#2727,o_comment_prf#2728] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 98722ms

q1=

select
  l_returnflag,
  l_linestatus
from
  lineitem
        
19/10/22 01:20:38 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:20:38 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2773L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:20:38 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
Aggregate [count(1) AS count#2773L]
+- Project
   +- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- Project [l_returnflag_prf#2775 AS l_returnflag_prf_0#2794, l_orderkey_and_l_linenumber_prf#2776 AS l_orderkey_and_l_linenumber_prf_0#2795, l_comment_prf#2777 AS l_comment_prf_0#2796, l_linestatus_prf#2778 AS l_linestatus_prf_0#2797, rid#2779 AS rid_0#2798, l_shipmode_prf#2780 AS l_shipmode_prf_0#2799, l_shipinstruct_prf#2781 AS l_shipinstruct_prf_0#2800, l_quantity_prf#2782 AS l_quantity_prf_0#2801, l_receiptdate_prf#2783 AS l_receiptdate_prf_0#2802, l_linenumber_prf#2784 AS l_linenumber_prf_0#2803, l_tax_prf#2785 AS l_tax_prf_0#2804, l_shipdate_prf#2786 AS l_shipdate_prf_0#2805, l_extendedprice_prf#2787 AS l_extendedprice_prf_0#2806, l_partkey_prf#2788 AS l_partkey_prf_0#2807, l_discount_prf#2789 AS l_discount_prf_0#2808, l_partkey_and_l_suppkey_prf#2790 AS l_partkey_and_l_suppkey_prf_0#2809, l_commitdate_prf#2791 AS l_commitdate_prf_0#2810, l_suppkey_prf#2792 AS l_suppkey_prf_0#2811, l_orderkey_prf#2793 AS l_orderkey_prf_0#2812]
         +- Relation[l_returnflag_prf#2775,l_orderkey_and_l_linenumber_prf#2776,l_comment_prf#2777,l_linestatus_prf#2778,rid#2779,l_shipmode_prf#2780,l_shipinstruct_prf#2781,l_quantity_prf#2782,l_receiptdate_prf#2783,l_linenumber_prf#2784,l_tax_prf#2785,l_shipdate_prf#2786,l_extendedprice_prf#2787,l_partkey_prf#2788,l_discount_prf#2789,l_partkey_and_l_suppkey_prf#2790,l_commitdate_prf#2791,l_suppkey_prf#2792,l_orderkey_prf#2793] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 1770ms

q19=

select
 l_extendedprice, l_discount
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#12'
  and p_container = 'SM CASE'
  and l_shipmode = 'AIR'
  and l_shipinstruct = 'DELIVER IN PERSON'
        
19/10/22 01:20:40 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:20:40 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2837L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#12) && (p_container#365 = SM CASE))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Filter ((l_shipmode#319 = AIR) && (l_shipinstruct#318 = DELIVER IN PERSON))
               +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:20:40 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:20:40 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:20:40 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:20:40 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:20:40 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2837L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#2861]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#2851: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [p_comment_prf#2839 AS p_comment_prf_0#2849, p_name_prf#2840 AS p_name_prf_0#2850, rid#2841 AS rid_0#2851, p_type_prf#2842 AS p_type_prf_0#2852, p_retailprice_prf#2843 AS p_retailprice_prf_0#2853, p_mfgr_prf#2844 AS p_mfgr_prf_0#2854, p_container_prf#2845 AS p_container_prf_0#2855, p_brand_prf#2846 AS p_brand_prf_0#2856, p_size_prf#2847 AS p_size_prf_0#2857, p_partkey_prf#2848 AS p_partkey_prf_0#2858]
         :     :  :  :  +- Relation[p_comment_prf#2839,p_name_prf#2840,rid#2841,p_type_prf#2842,p_retailprice_prf#2843,p_mfgr_prf#2844,p_container_prf#2845,p_brand_prf#2846,p_size_prf#2847,p_partkey_prf#2848] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2859]
         :     :  :     +- DexRidFilter part~p_brand~Brand#12
         :     :  :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#2860]
         :     :     +- DexRidFilter part~p_container~SM CASE
         :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join UsingJoin(LeftSemi,List(rid_1))
            :- 'Join UsingJoin(LeftSemi,List(rid_1))
            :  :- Project [l_returnflag_prf#2862 AS l_returnflag_prf_1#2881, l_orderkey_and_l_linenumber_prf#2863 AS l_orderkey_and_l_linenumber_prf_1#2882, l_comment_prf#2864 AS l_comment_prf_1#2883, l_linestatus_prf#2865 AS l_linestatus_prf_1#2884, rid#2866 AS rid_1#2885, l_shipmode_prf#2867 AS l_shipmode_prf_1#2886, l_shipinstruct_prf#2868 AS l_shipinstruct_prf_1#2887, l_quantity_prf#2869 AS l_quantity_prf_1#2888, l_receiptdate_prf#2870 AS l_receiptdate_prf_1#2889, l_linenumber_prf#2871 AS l_linenumber_prf_1#2890, l_tax_prf#2872 AS l_tax_prf_1#2891, l_shipdate_prf#2873 AS l_shipdate_prf_1#2892, l_extendedprice_prf#2874 AS l_extendedprice_prf_1#2893, l_partkey_prf#2875 AS l_partkey_prf_1#2894, l_discount_prf#2876 AS l_discount_prf_1#2895, l_partkey_and_l_suppkey_prf#2877 AS l_partkey_and_l_suppkey_prf_1#2896, l_commitdate_prf#2878 AS l_commitdate_prf_1#2897, l_suppkey_prf#2879 AS l_suppkey_prf_1#2898, l_orderkey_prf#2880 AS l_orderkey_prf_1#2899]
            :  :  +- Relation[l_returnflag_prf#2862,l_orderkey_and_l_linenumber_prf#2863,l_comment_prf#2864,l_linestatus_prf#2865,rid#2866,l_shipmode_prf#2867,l_shipinstruct_prf#2868,l_quantity_prf#2869,l_receiptdate_prf#2870,l_linenumber_prf#2871,l_tax_prf#2872,l_shipdate_prf#2873,l_extendedprice_prf#2874,l_partkey_prf#2875,l_discount_prf#2876,l_partkey_and_l_suppkey_prf#2877,l_commitdate_prf#2878,l_suppkey_prf#2879,l_orderkey_prf#2880] JDBCRelation(lineitem_prf) [numPartitions=1]
            :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2900]
            :     +- DexRidFilter lineitem~l_shipmode~AIR
            :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
            +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#2901]
               +- DexRidFilter lineitem~l_shipinstruct~DELIVER IN PERSON
                  +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]

DexCorr$ result size=205
Elapsed time: 26385ms

q22=

select
  c_phone, c_acctbal
from
  customer
where not exists (
  select *
  from orders
  where o_custkey = c_custkey
)
        
19/10/22 01:21:07 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:21:07 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#2936L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightAnti, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/22 01:21:07 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#2936L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftAnti)
         :- Project [c_acctbal_prf#2970 AS c_acctbal_prf_1#2979, rid#2971 AS rid_1#2980, c_name_prf#2972 AS c_name_prf_1#2981, c_nationkey_prf#2973 AS c_nationkey_prf_1#2982, c_custkey_prf#2974 AS c_custkey_prf_1#2983, c_comment_prf#2975 AS c_comment_prf_1#2984, c_address_prf#2976 AS c_address_prf_1#2985, c_mktsegment_prf#2977 AS c_mktsegment_prf_1#2986, c_phone_prf#2978 AS c_phone_prf_1#2987]
         :  +- Relation[c_acctbal_prf#2970,rid#2971,c_name_prf#2972,c_nationkey_prf#2973,c_custkey_prf#2974,c_comment_prf#2975,c_address_prf#2976,c_mktsegment_prf#2977,c_phone_prf#2978] JDBCRelation(customer_prf) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [o_shippriority_prf#2938 AS o_shippriority_prf_0#2948, rid#2939 AS rid_0#2949, o_orderdate_prf#2940 AS o_orderdate_prf_0#2950, o_custkey_prf#2941 AS o_custkey_prf_0#2951, o_orderpriority_prf#2942 AS o_orderpriority_prf_0#2952, o_clerk_prf#2943 AS o_clerk_prf_0#2953, o_orderstatus_prf#2944 AS o_orderstatus_prf_0#2954, o_totalprice_prf#2945 AS o_totalprice_prf_0#2955, o_orderkey_prf#2946 AS o_orderkey_prf_0#2956, o_comment_prf#2947 AS o_comment_prf_0#2957]
            :  +- Relation[o_shippriority_prf#2938,rid#2939,o_orderdate_prf#2940,o_custkey_prf#2941,o_orderpriority_prf#2942,o_clerk_prf#2943,o_orderstatus_prf#2944,o_totalprice_prf#2945,o_orderkey_prf#2946,o_comment_prf#2947] JDBCRelation(orders_prf) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#2969]
               +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
                  :- 'Project ['rid AS rid_0#2968]
                  :  +- Relation[o_shippriority_prf#2958,rid#2959,o_orderdate_prf#2960,o_custkey_prf#2961,o_orderpriority_prf#2962,o_clerk_prf#2963,o_orderstatus_prf#2964,o_totalprice_prf#2965,o_orderkey_prf#2966,o_comment_prf#2967] JDBCRelation(orders_prf) [numPartitions=1]
                  +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=50004
Elapsed time: 45853ms

q10=

select
  c_custkey, c_name, l_extendedprice, l_discount, c_acctbal, n_name, c_address, c_phone, c_comment
from
  customer, orders, lineitem, nation
where
  c_custkey = o_custkey
  and l_orderkey = o_orderkey
  and l_returnflag = 'R'
  and c_nationkey = n_nationkey
        
19/10/22 01:21:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:21:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3009L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (c_nationkey#293L = n_nationkey#108L)
         :- Project [c_nationkey#293L]
         :  +- Join Inner, (o_custkey#343L = c_custkey#290L)
         :     :- Project [o_custkey#343L]
         :     :  +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :     :     :- Project [l_orderkey#306L]
         :     :     :  +- Filter (l_returnflag#314 = R)
         :     :     :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [o_orderkey#342L, o_custkey#343L]
         :     :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         :     +- Project [c_custkey#290L, c_nationkey#293L]
         :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         +- Project [n_nationkey#108L]
            +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/22 01:21:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:21:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:21:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3009L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 15 more fields]
         :  +- 'DexRidCorrelatedJoin customer~c_nationkey~nation~n_nationkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, ... 6 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3050]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#3034: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [l_returnflag_prf#3011 AS l_returnflag_prf_0#3030, l_orderkey_and_l_linenumber_prf#3012 AS l_orderkey_and_l_linenumber_prf_0#3031, l_comment_prf#3013 AS l_comment_prf_0#3032, l_linestatus_prf#3014 AS l_linestatus_prf_0#3033, rid#3015 AS rid_0#3034, l_shipmode_prf#3016 AS l_shipmode_prf_0#3035, l_shipinstruct_prf#3017 AS l_shipinstruct_prf_0#3036, l_quantity_prf#3018 AS l_quantity_prf_0#3037, l_receiptdate_prf#3019 AS l_receiptdate_prf_0#3038, l_linenumber_prf#3020 AS l_linenumber_prf_0#3039, l_tax_prf#3021 AS l_tax_prf_0#3040, l_shipdate_prf#3022 AS l_shipdate_prf_0#3041, l_extendedprice_prf#3023 AS l_extendedprice_prf_0#3042, l_partkey_prf#3024 AS l_partkey_prf_0#3043, l_discount_prf#3025 AS l_discount_prf_0#3044, l_partkey_and_l_suppkey_prf#3026 AS l_partkey_and_l_suppkey_prf_0#3045, l_commitdate_prf#3027 AS l_commitdate_prf_0#3046, l_suppkey_prf#3028 AS l_suppkey_prf_0#3047, l_orderkey_prf#3029 AS l_orderkey_prf_0#3048]
         :     :  :     :  :     :  :  +- Relation[l_returnflag_prf#3011,l_orderkey_and_l_linenumber_prf#3012,l_comment_prf#3013,l_linestatus_prf#3014,rid#3015,l_shipmode_prf#3016,l_shipinstruct_prf#3017,l_quantity_prf#3018,l_receiptdate_prf#3019,l_linenumber_prf#3020,l_tax_prf#3021,l_shipdate_prf#3022,l_extendedprice_prf#3023,l_partkey_prf#3024,l_discount_prf#3025,l_partkey_and_l_suppkey_prf#3026,l_commitdate_prf#3027,l_suppkey_prf#3028,l_orderkey_prf#3029] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3049]
         :     :  :     :  :     :     +- DexRidFilter lineitem~l_returnflag~R
         :     :  :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [o_shippriority_prf#3051 AS o_shippriority_prf_1#3061, rid#3052 AS rid_1#3062, o_orderdate_prf#3053 AS o_orderdate_prf_1#3063, o_custkey_prf#3054 AS o_custkey_prf_1#3064, o_orderpriority_prf#3055 AS o_orderpriority_prf_1#3065, o_clerk_prf#3056 AS o_clerk_prf_1#3066, o_orderstatus_prf#3057 AS o_orderstatus_prf_1#3067, o_totalprice_prf#3058 AS o_totalprice_prf_1#3068, o_orderkey_prf#3059 AS o_orderkey_prf_1#3069, o_comment_prf#3060 AS o_comment_prf_1#3070]
         :     :  :     :     +- Relation[o_shippriority_prf#3051,rid#3052,o_orderdate_prf#3053,o_custkey_prf#3054,o_orderpriority_prf#3055,o_clerk_prf#3056,o_orderstatus_prf#3057,o_totalprice_prf#3058,o_orderkey_prf#3059,o_comment_prf#3060] JDBCRelation(orders_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [c_acctbal_prf#3072 AS c_acctbal_prf_2#3081, rid#3073 AS rid_2#3082, c_name_prf#3074 AS c_name_prf_2#3083, c_nationkey_prf#3075 AS c_nationkey_prf_2#3084, c_custkey_prf#3076 AS c_custkey_prf_2#3085, c_comment_prf#3077 AS c_comment_prf_2#3086, c_address_prf#3078 AS c_address_prf_2#3087, c_mktsegment_prf#3079 AS c_mktsegment_prf_2#3088, c_phone_prf#3080 AS c_phone_prf_2#3089]
         :     :     +- Relation[c_acctbal_prf#3072,rid#3073,c_name_prf#3074,c_nationkey_prf#3075,c_custkey_prf#3076,c_comment_prf#3077,c_address_prf#3078,c_mktsegment_prf#3079,c_phone_prf#3080] JDBCRelation(customer_prf) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [rid#3091 AS rid_3#3096, n_regionkey_prf#3092 AS n_regionkey_prf_3#3097, n_nationkey_prf#3093 AS n_nationkey_prf_3#3098, n_name_prf#3094 AS n_name_prf_3#3099, n_comment_prf#3095 AS n_comment_prf_3#3100]
            +- Relation[rid#3091,n_regionkey_prf#3092,n_nationkey_prf#3093,n_name_prf#3094,n_comment_prf#3095] JDBCRelation(nation_prf) [numPartitions=1]

DexCorr$ result size=1478870
Elapsed time: 179409ms

q7=

select
  n1.n_name as supp_nation,
  n2.n_name as cust_nation,
  l_shipdate,
  l_extendedprice,
  l_discount
from
  supplier,
  lineitem,
  orders,
  customer,
  nation n1,
  nation n2
where
  s_suppkey = l_suppkey
  and o_orderkey = l_orderkey
  and c_custkey = o_custkey
  and s_nationkey = n1.n_nationkey
  and c_nationkey = n2.n_nationkey
  and (
    n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY'
  )
        
19/10/22 01:24:52 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:24:52 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3152L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :     :- Project [s_suppkey#18L]
         :     :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :     :- Project [n_nationkey#108L]
         :     :     :  +- Filter (n_name#109 = FRANCE)
         :     :     :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [l_orderkey#306L, l_suppkey#308L]
         :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#610L = c_nationkey#293L)
               :     :- Project [n_nationkey#610L]
               :     :  +- Filter (n_name#611 = GERMANY)
               :     :     +- Relation[n_nationkey#610L,n_name#611,n_regionkey#612L,n_comment#613] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:24:52 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:24:52 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3152L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, ... 9 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, 'rid_1, 's_phone_prf_1, 's_address_prf_1, 's_nationkey_prf_1, 's_suppkey_prf_1, 's_name_prf_1, 's_acctbal_prf_1, 's_comment_prf_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#3182]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['rid_0, 'n_regionkey_prf_0, 'n_nationkey_prf_0, 'n_name_prf_0, 'n_comment_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3165]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_0#3159: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [rid#3154 AS rid_0#3159, n_regionkey_prf#3155 AS n_regionkey_prf_0#3160, n_nationkey_prf#3156 AS n_nationkey_prf_0#3161, n_name_prf#3157 AS n_name_prf_0#3162, n_comment_prf#3158 AS n_comment_prf_0#3163]
         :     :  :     :  :     :  :  +- Relation[rid#3154,n_regionkey_prf#3155,n_nationkey_prf#3156,n_name_prf#3157,n_comment_prf#3158] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3164]
         :     :  :     :  :     :     +- DexRidFilter nation~n_name~FRANCE
         :     :  :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [s_phone_prf#3166 AS s_phone_prf_1#3174, rid#3167 AS rid_1#3175, s_address_prf#3168 AS s_address_prf_1#3176, s_nationkey_prf#3169 AS s_nationkey_prf_1#3177, s_suppkey_prf#3170 AS s_suppkey_prf_1#3178, s_name_prf#3171 AS s_name_prf_1#3179, s_acctbal_prf#3172 AS s_acctbal_prf_1#3180, s_comment_prf#3173 AS s_comment_prf_1#3181]
         :     :  :     :     +- Relation[s_phone_prf#3166,rid#3167,s_address_prf#3168,s_nationkey_prf#3169,s_suppkey_prf#3170,s_name_prf#3171,s_acctbal_prf#3172,s_comment_prf#3173] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [l_returnflag_prf#3183 AS l_returnflag_prf_2#3202, l_orderkey_and_l_linenumber_prf#3184 AS l_orderkey_and_l_linenumber_prf_2#3203, l_comment_prf#3185 AS l_comment_prf_2#3204, l_linestatus_prf#3186 AS l_linestatus_prf_2#3205, rid#3187 AS rid_2#3206, l_shipmode_prf#3188 AS l_shipmode_prf_2#3207, l_shipinstruct_prf#3189 AS l_shipinstruct_prf_2#3208, l_quantity_prf#3190 AS l_quantity_prf_2#3209, l_receiptdate_prf#3191 AS l_receiptdate_prf_2#3210, l_linenumber_prf#3192 AS l_linenumber_prf_2#3211, l_tax_prf#3193 AS l_tax_prf_2#3212, l_shipdate_prf#3194 AS l_shipdate_prf_2#3213, l_extendedprice_prf#3195 AS l_extendedprice_prf_2#3214, l_partkey_prf#3196 AS l_partkey_prf_2#3215, l_discount_prf#3197 AS l_discount_prf_2#3216, l_partkey_and_l_suppkey_prf#3198 AS l_partkey_and_l_suppkey_prf_2#3217, l_commitdate_prf#3199 AS l_commitdate_prf_2#3218, l_suppkey_prf#3200 AS l_suppkey_prf_2#3219, l_orderkey_prf#3201 AS l_orderkey_prf_2#3220]
         :     :     +- Relation[l_returnflag_prf#3183,l_orderkey_and_l_linenumber_prf#3184,l_comment_prf#3185,l_linestatus_prf#3186,rid#3187,l_shipmode_prf#3188,l_shipinstruct_prf#3189,l_quantity_prf#3190,l_receiptdate_prf#3191,l_linenumber_prf#3192,l_tax_prf#3193,l_shipdate_prf#3194,l_extendedprice_prf#3195,l_partkey_prf#3196,l_discount_prf#3197,l_partkey_and_l_suppkey_prf#3198,l_commitdate_prf#3199,l_suppkey_prf#3200,l_orderkey_prf#3201] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['rid_3, 'n_regionkey_prf_3, 'n_nationkey_prf_3, 'n_name_prf_3, 'n_comment_prf_3, 'rid_4, 'c_acctbal_prf_4, 'c_name_prf_4, 'c_nationkey_prf_4, 'c_custkey_prf_4, 'c_comment_prf_4, 'c_address_prf_4, 'c_mktsegment_prf_4, 'c_phone_prf_4, dexdecrypt('value_dec_key, value#1964) AS rid_5#3252]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_4
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['rid_3, 'n_regionkey_prf_3, 'n_nationkey_prf_3, 'n_name_prf_3, 'n_comment_prf_3, dexdecrypt('value_dec_key, value#1964) AS rid_4#3233]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, rid_3#3227: string
            :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :     :  :- Project [rid#3222 AS rid_3#3227, n_regionkey_prf#3223 AS n_regionkey_prf_3#3228, n_nationkey_prf#3224 AS n_nationkey_prf_3#3229, n_name_prf#3225 AS n_name_prf_3#3230, n_comment_prf#3226 AS n_comment_prf_3#3231]
            :     :  :     :  :  +- Relation[rid#3222,n_regionkey_prf#3223,n_nationkey_prf#3224,n_name_prf#3225,n_comment_prf#3226] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#3232]
            :     :  :     :     +- DexRidFilter nation~n_name~GERMANY
            :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3234 AS c_acctbal_prf_4#3243, rid#3235 AS rid_4#3244, c_name_prf#3236 AS c_name_prf_4#3245, c_nationkey_prf#3237 AS c_nationkey_prf_4#3246, c_custkey_prf#3238 AS c_custkey_prf_4#3247, c_comment_prf#3239 AS c_comment_prf_4#3248, c_address_prf#3240 AS c_address_prf_4#3249, c_mktsegment_prf#3241 AS c_mktsegment_prf_4#3250, c_phone_prf#3242 AS c_phone_prf_4#3251]
            :     :     +- Relation[c_acctbal_prf#3234,rid#3235,c_name_prf#3236,c_nationkey_prf#3237,c_custkey_prf#3238,c_comment_prf#3239,c_address_prf#3240,c_mktsegment_prf#3241,c_phone_prf#3242] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3253 AS o_shippriority_prf_5#3263, rid#3254 AS rid_5#3264, o_orderdate_prf#3255 AS o_orderdate_prf_5#3265, o_custkey_prf#3256 AS o_custkey_prf_5#3266, o_orderpriority_prf#3257 AS o_orderpriority_prf_5#3267, o_clerk_prf#3258 AS o_clerk_prf_5#3268, o_orderstatus_prf#3259 AS o_orderstatus_prf_5#3269, o_totalprice_prf#3260 AS o_totalprice_prf_5#3270, o_orderkey_prf#3261 AS o_orderkey_prf_5#3271, o_comment_prf#3262 AS o_comment_prf_5#3272]
               +- Relation[o_shippriority_prf#3253,rid#3254,o_orderdate_prf#3255,o_custkey_prf#3256,o_orderpriority_prf#3257,o_clerk_prf#3258,o_orderstatus_prf#3259,o_totalprice_prf#3260,o_orderkey_prf#3261,o_comment_prf#3262] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=9735
Elapsed time: 39381ms

q17=

select
  l_extendedprice
from
  lineitem, part
where
  p_partkey = l_partkey
  and p_brand = 'Brand#23'
  and p_container = 'MED BOX'
        
19/10/22 01:25:31 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:25:31 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3333L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :- Project [p_partkey#360L]
         :  +- Filter ((p_brand#368 = Brand#23) && (p_container#365 = MED BOX))
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [l_partkey#307L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:25:31 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:25:31 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:25:31 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:25:31 WARN DexPlanner: InMemoryFileIndex=part
19/10/22 01:25:31 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3333L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3357]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3347: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :  :- Project [p_comment_prf#3335 AS p_comment_prf_0#3345, p_name_prf#3336 AS p_name_prf_0#3346, rid#3337 AS rid_0#3347, p_type_prf#3338 AS p_type_prf_0#3348, p_retailprice_prf#3339 AS p_retailprice_prf_0#3349, p_mfgr_prf#3340 AS p_mfgr_prf_0#3350, p_container_prf#3341 AS p_container_prf_0#3351, p_brand_prf#3342 AS p_brand_prf_0#3352, p_size_prf#3343 AS p_size_prf_0#3353, p_partkey_prf#3344 AS p_partkey_prf_0#3354]
         :     :  :  :  +- Relation[p_comment_prf#3335,p_name_prf#3336,rid#3337,p_type_prf#3338,p_retailprice_prf#3339,p_mfgr_prf#3340,p_container_prf#3341,p_brand_prf#3342,p_size_prf#3343,p_partkey_prf#3344] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3355]
         :     :  :     +- DexRidFilter part~p_brand~Brand#23
         :     :  :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3356]
         :     :     +- DexRidFilter part~p_container~MED BOX
         :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3358 AS l_returnflag_prf_1#3377, l_orderkey_and_l_linenumber_prf#3359 AS l_orderkey_and_l_linenumber_prf_1#3378, l_comment_prf#3360 AS l_comment_prf_1#3379, l_linestatus_prf#3361 AS l_linestatus_prf_1#3380, rid#3362 AS rid_1#3381, l_shipmode_prf#3363 AS l_shipmode_prf_1#3382, l_shipinstruct_prf#3364 AS l_shipinstruct_prf_1#3383, l_quantity_prf#3365 AS l_quantity_prf_1#3384, l_receiptdate_prf#3366 AS l_receiptdate_prf_1#3385, l_linenumber_prf#3367 AS l_linenumber_prf_1#3386, l_tax_prf#3368 AS l_tax_prf_1#3387, l_shipdate_prf#3369 AS l_shipdate_prf_1#3388, l_extendedprice_prf#3370 AS l_extendedprice_prf_1#3389, l_partkey_prf#3371 AS l_partkey_prf_1#3390, l_discount_prf#3372 AS l_discount_prf_1#3391, l_partkey_and_l_suppkey_prf#3373 AS l_partkey_and_l_suppkey_prf_1#3392, l_commitdate_prf#3374 AS l_commitdate_prf_1#3393, l_suppkey_prf#3375 AS l_suppkey_prf_1#3394, l_orderkey_prf#3376 AS l_orderkey_prf_1#3395]
            +- Relation[l_returnflag_prf#3358,l_orderkey_and_l_linenumber_prf#3359,l_comment_prf#3360,l_linestatus_prf#3361,rid#3362,l_shipmode_prf#3363,l_shipinstruct_prf#3364,l_quantity_prf#3365,l_receiptdate_prf#3366,l_linenumber_prf#3367,l_tax_prf#3368,l_shipdate_prf#3369,l_extendedprice_prf#3370,l_partkey_prf#3371,l_discount_prf#3372,l_partkey_and_l_suppkey_prf#3373,l_commitdate_prf#3374,l_suppkey_prf#3375,l_orderkey_prf#3376] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6088
Elapsed time: 360ms

q8=

select
  o_orderdate as o_year, l_extendedprice, l_discount, n2.n_name as nation
from
  part, supplier, lineitem, orders, customer, nation n1, nation n2, region
where
  p_partkey = l_partkey
  and s_suppkey = l_suppkey
  and l_orderkey = o_orderkey
  and o_custkey = c_custkey
  and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA'
  and s_nationkey = n2.n_nationkey
  and p_type = 'ECONOMY ANODIZED STEEL'
        
19/10/22 01:25:32 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:25:32 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3432L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
         :     :- Project [l_orderkey#306L, s_nationkey#21L]
         :     :  +- Join Inner, (l_suppkey#308L = s_suppkey#18L)
         :     :     :- Project [l_orderkey#306L, l_suppkey#308L]
         :     :     :  +- Join Inner, (p_partkey#360L = l_partkey#307L)
         :     :     :     :- Project [p_partkey#360L]
         :     :     :     :  +- Filter (p_type#363 = ECONOMY ANODIZED STEEL)
         :     :     :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     :     :     +- Project [l_orderkey#306L, l_partkey#307L, l_suppkey#308L]
         :     :     :        +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         :     :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :     :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         :     +- Project [n_nationkey#108L]
         :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (c_custkey#290L = o_custkey#343L)
               :- Project [c_custkey#290L]
               :  +- Join Inner, (n_nationkey#808L = c_nationkey#293L)
               :     :- Project [n_nationkey#808L]
               :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#810L)
               :     :     :- Project [r_regionkey#116L]
               :     :     :  +- Filter (r_name#117 = AMERICA)
               :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
               :     :     +- Project [n_nationkey#808L, n_regionkey#810L]
               :     :        +- Relation[n_nationkey#808L,n_name#809,n_regionkey#810L,n_comment#811] parquet
               :     +- Project [c_custkey#290L, c_nationkey#293L]
               :        +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
               +- Project [o_orderkey#342L, o_custkey#343L]
                  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:25:32 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:25:32 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3432L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 19 more fields]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 14 more fields]
         :     :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_2
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, 'rid_1, 'l_returnflag_prf_1, 'l_orderkey_and_l_linenumber_prf_1, 'l_comment_prf_1, 'l_linestatus_prf_1, 'l_shipmode_prf_1, 'l_shipinstruct_prf_1, 'l_quantity_prf_1, 'l_receiptdate_prf_1, 'l_linenumber_prf_1, 'l_tax_prf_1, 'l_shipdate_prf_1, 'l_extendedprice_prf_1, 'l_partkey_prf_1, ... 6 more fields]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_1
         :     :  :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :     :  :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3455]
         :     :  :     :  :     :  :  +- 'DexRidCorrelatedJoin part~p_partkey~lineitem~l_partkey, rid_0#3446: string
         :     :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :     :  :- Project [p_comment_prf#3434 AS p_comment_prf_0#3444, p_name_prf#3435 AS p_name_prf_0#3445, rid#3436 AS rid_0#3446, p_type_prf#3437 AS p_type_prf_0#3447, p_retailprice_prf#3438 AS p_retailprice_prf_0#3448, p_mfgr_prf#3439 AS p_mfgr_prf_0#3449, p_container_prf#3440 AS p_container_prf_0#3450, p_brand_prf#3441 AS p_brand_prf_0#3451, p_size_prf#3442 AS p_size_prf_0#3452, p_partkey_prf#3443 AS p_partkey_prf_0#3453]
         :     :  :     :  :     :  :     :  :  +- Relation[p_comment_prf#3434,p_name_prf#3435,rid#3436,p_type_prf#3437,p_retailprice_prf#3438,p_mfgr_prf#3439,p_container_prf#3440,p_brand_prf#3441,p_size_prf#3442,p_partkey_prf#3443] JDBCRelation(part_prf) [numPartitions=1]
         :     :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#3454]
         :     :  :     :  :     :  :     :     +- DexRidFilter part~p_type~ECONOMY ANODIZED STEEL
         :     :  :     :  :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  :     :  +- Project [l_returnflag_prf#3456 AS l_returnflag_prf_1#3475, l_orderkey_and_l_linenumber_prf#3457 AS l_orderkey_and_l_linenumber_prf_1#3476, l_comment_prf#3458 AS l_comment_prf_1#3477, l_linestatus_prf#3459 AS l_linestatus_prf_1#3478, rid#3460 AS rid_1#3479, l_shipmode_prf#3461 AS l_shipmode_prf_1#3480, l_shipinstruct_prf#3462 AS l_shipinstruct_prf_1#3481, l_quantity_prf#3463 AS l_quantity_prf_1#3482, l_receiptdate_prf#3464 AS l_receiptdate_prf_1#3483, l_linenumber_prf#3465 AS l_linenumber_prf_1#3484, l_tax_prf#3466 AS l_tax_prf_1#3485, l_shipdate_prf#3467 AS l_shipdate_prf_1#3486, l_extendedprice_prf#3468 AS l_extendedprice_prf_1#3487, l_partkey_prf#3469 AS l_partkey_prf_1#3488, l_discount_prf#3470 AS l_discount_prf_1#3489, l_partkey_and_l_suppkey_prf#3471 AS l_partkey_and_l_suppkey_prf_1#3490, l_commitdate_prf#3472 AS l_commitdate_prf_1#3491, l_suppkey_prf#3473 AS l_suppkey_prf_1#3492, l_orderkey_prf#3474 AS l_orderkey_prf_1#3493]
         :     :  :     :  :     :     +- Relation[l_returnflag_prf#3456,l_orderkey_and_l_linenumber_prf#3457,l_comment_prf#3458,l_linestatus_prf#3459,rid#3460,l_shipmode_prf#3461,l_shipinstruct_prf#3462,l_quantity_prf#3463,l_receiptdate_prf#3464,l_linenumber_prf#3465,l_tax_prf#3466,l_shipdate_prf#3467,l_extendedprice_prf#3468,l_partkey_prf#3469,l_discount_prf#3470,l_partkey_and_l_suppkey_prf#3471,l_commitdate_prf#3472,l_suppkey_prf#3473,l_orderkey_prf#3474] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [s_phone_prf#3495 AS s_phone_prf_2#3503, rid#3496 AS rid_2#3504, s_address_prf#3497 AS s_address_prf_2#3505, s_nationkey_prf#3498 AS s_nationkey_prf_2#3506, s_suppkey_prf#3499 AS s_suppkey_prf_2#3507, s_name_prf#3500 AS s_name_prf_2#3508, s_acctbal_prf#3501 AS s_acctbal_prf_2#3509, s_comment_prf#3502 AS s_comment_prf_2#3510]
         :     :  :     :     +- Relation[s_phone_prf#3495,rid#3496,s_address_prf#3497,s_nationkey_prf#3498,s_suppkey_prf#3499,s_name_prf#3500,s_acctbal_prf#3501,s_comment_prf#3502] JDBCRelation(supplier_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [rid#3512 AS rid_3#3517, n_regionkey_prf#3513 AS n_regionkey_prf_3#3518, n_nationkey_prf#3514 AS n_nationkey_prf_3#3519, n_name_prf#3515 AS n_name_prf_3#3520, n_comment_prf#3516 AS n_comment_prf_3#3521]
         :     :     +- Relation[rid#3512,n_regionkey_prf#3513,n_nationkey_prf#3514,n_name_prf#3515,n_comment_prf#3516] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, 'rid_5, 'n_regionkey_prf_5, 'n_nationkey_prf_5, 'n_name_prf_5, 'n_comment_prf_5, 'rid_6, 'c_acctbal_prf_6, 'c_name_prf_6, 'c_nationkey_prf_6, 'c_custkey_prf_6, 'c_comment_prf_6, 'c_address_prf_6, 'c_mktsegment_prf_6, 'c_phone_prf_6, dexdecrypt('value_dec_key, value#1964) AS rid_7#3562]
            :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_6
            :     :- 'Join NaturalJoin(Inner)
            :     :  :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, 'rid_5, 'n_regionkey_prf_5, 'n_nationkey_prf_5, 'n_name_prf_5, 'n_comment_prf_5, dexdecrypt('value_dec_key, value#1964) AS rid_6#3543]
            :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~customer~c_nationkey, 'rid_5
            :     :  :     :- 'Join NaturalJoin(Inner)
            :     :  :     :  :- 'Project ['r_regionkey_prf_4, 'r_name_prf_4, 'r_comment_prf_4, 'rid_4, dexdecrypt('value_dec_key, value#1964) AS rid_5#3532]
            :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_4#3530: string
            :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_4))
            :     :  :     :  :     :  :- Project [r_regionkey_prf#3523 AS r_regionkey_prf_4#3527, r_name_prf#3524 AS r_name_prf_4#3528, r_comment_prf#3525 AS r_comment_prf_4#3529, rid#3526 AS rid_4#3530]
            :     :  :     :  :     :  :  +- Relation[r_regionkey_prf#3523,r_name_prf#3524,r_comment_prf#3525,rid#3526] JDBCRelation(region_prf) [numPartitions=1]
            :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#3531]
            :     :  :     :  :     :     +- DexRidFilter region~r_name~AMERICA
            :     :  :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
            :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  :     :  +- Project [rid#3533 AS rid_5#3538, n_regionkey_prf#3534 AS n_regionkey_prf_5#3539, n_nationkey_prf#3535 AS n_nationkey_prf_5#3540, n_name_prf#3536 AS n_name_prf_5#3541, n_comment_prf#3537 AS n_comment_prf_5#3542]
            :     :  :     :     +- Relation[rid#3533,n_regionkey_prf#3534,n_nationkey_prf#3535,n_name_prf#3536,n_comment_prf#3537] JDBCRelation(nation_prf) [numPartitions=1]
            :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
            :     :  +- Project [c_acctbal_prf#3544 AS c_acctbal_prf_6#3553, rid#3545 AS rid_6#3554, c_name_prf#3546 AS c_name_prf_6#3555, c_nationkey_prf#3547 AS c_nationkey_prf_6#3556, c_custkey_prf#3548 AS c_custkey_prf_6#3557, c_comment_prf#3549 AS c_comment_prf_6#3558, c_address_prf#3550 AS c_address_prf_6#3559, c_mktsegment_prf#3551 AS c_mktsegment_prf_6#3560, c_phone_prf#3552 AS c_phone_prf_6#3561]
            :     :     +- Relation[c_acctbal_prf#3544,rid#3545,c_name_prf#3546,c_nationkey_prf#3547,c_custkey_prf#3548,c_comment_prf#3549,c_address_prf#3550,c_mktsegment_prf#3551,c_phone_prf#3552] JDBCRelation(customer_prf) [numPartitions=1]
            :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [o_shippriority_prf#3563 AS o_shippriority_prf_7#3573, rid#3564 AS rid_7#3574, o_orderdate_prf#3565 AS o_orderdate_prf_7#3575, o_custkey_prf#3566 AS o_custkey_prf_7#3576, o_orderpriority_prf#3567 AS o_orderpriority_prf_7#3577, o_clerk_prf#3568 AS o_clerk_prf_7#3578, o_orderstatus_prf#3569 AS o_orderstatus_prf_7#3579, o_totalprice_prf#3570 AS o_totalprice_prf_7#3580, o_orderkey_prf#3571 AS o_orderkey_prf_7#3581, o_comment_prf#3572 AS o_comment_prf_7#3582]
               +- Relation[o_shippriority_prf#3563,rid#3564,o_orderdate_prf#3565,o_custkey_prf#3566,o_orderpriority_prf#3567,o_clerk_prf#3568,o_orderstatus_prf#3569,o_totalprice_prf#3570,o_orderkey_prf#3571,o_comment_prf#3572] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=8716
Elapsed time: 97109ms

q18=

select
  c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, l_quantity
from
  customer, orders, lineitem
where
  c_custkey = o_custkey and o_orderkey = l_orderkey
        
19/10/22 01:27:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:27:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3662L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:27:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3662L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_1))
         :  :- 'Join NaturalJoin(Inner)
         :  :  :- 'Join UsingJoin(Inner,List(rid_0))
         :  :  :  :- Project [c_acctbal_prf#3664 AS c_acctbal_prf_0#3673, rid#3665 AS rid_0#3674, c_name_prf#3666 AS c_name_prf_0#3675, c_nationkey_prf#3667 AS c_nationkey_prf_0#3676, c_custkey_prf#3668 AS c_custkey_prf_0#3677, c_comment_prf#3669 AS c_comment_prf_0#3678, c_address_prf#3670 AS c_address_prf_0#3679, c_mktsegment_prf#3671 AS c_mktsegment_prf_0#3680, c_phone_prf#3672 AS c_phone_prf_0#3681]
         :  :  :  :  +- Relation[c_acctbal_prf#3664,rid#3665,c_name_prf#3666,c_nationkey_prf#3667,c_custkey_prf#3668,c_comment_prf#3669,c_address_prf#3670,c_mktsegment_prf#3671,c_phone_prf#3672] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3692]
         :  :  :     +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, 'rid_0
         :  :  :        :- 'Project ['rid AS rid_0#3691]
         :  :  :        :  +- Relation[c_acctbal_prf#3682,rid#3683,c_name_prf#3684,c_nationkey_prf#3685,c_custkey_prf#3686,c_comment_prf#3687,c_address_prf#3688,c_mktsegment_prf#3689,c_phone_prf#3690] JDBCRelation(customer_prf) [numPartitions=1]
         :  :  :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :  +- Project [o_shippriority_prf#3693 AS o_shippriority_prf_1#3703, rid#3694 AS rid_1#3704, o_orderdate_prf#3695 AS o_orderdate_prf_1#3705, o_custkey_prf#3696 AS o_custkey_prf_1#3706, o_orderpriority_prf#3697 AS o_orderpriority_prf_1#3707, o_clerk_prf#3698 AS o_clerk_prf_1#3708, o_orderstatus_prf#3699 AS o_orderstatus_prf_1#3709, o_totalprice_prf#3700 AS o_totalprice_prf_1#3710, o_orderkey_prf#3701 AS o_orderkey_prf_1#3711, o_comment_prf#3702 AS o_comment_prf_1#3712]
         :  :     +- Relation[o_shippriority_prf#3693,rid#3694,o_orderdate_prf#3695,o_custkey_prf#3696,o_orderpriority_prf#3697,o_clerk_prf#3698,o_orderstatus_prf#3699,o_totalprice_prf#3700,o_orderkey_prf#3701,o_comment_prf#3702] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#3724]
         :     +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :        :- 'Project ['rid AS rid_1#3723]
         :        :  +- Relation[o_shippriority_prf#3713,rid#3714,o_orderdate_prf#3715,o_custkey_prf#3716,o_orderpriority_prf#3717,o_clerk_prf#3718,o_orderstatus_prf#3719,o_totalprice_prf#3720,o_orderkey_prf#3721,o_comment_prf#3722] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3725 AS l_returnflag_prf_2#3744, l_orderkey_and_l_linenumber_prf#3726 AS l_orderkey_and_l_linenumber_prf_2#3745, l_comment_prf#3727 AS l_comment_prf_2#3746, l_linestatus_prf#3728 AS l_linestatus_prf_2#3747, rid#3729 AS rid_2#3748, l_shipmode_prf#3730 AS l_shipmode_prf_2#3749, l_shipinstruct_prf#3731 AS l_shipinstruct_prf_2#3750, l_quantity_prf#3732 AS l_quantity_prf_2#3751, l_receiptdate_prf#3733 AS l_receiptdate_prf_2#3752, l_linenumber_prf#3734 AS l_linenumber_prf_2#3753, l_tax_prf#3735 AS l_tax_prf_2#3754, l_shipdate_prf#3736 AS l_shipdate_prf_2#3755, l_extendedprice_prf#3737 AS l_extendedprice_prf_2#3756, l_partkey_prf#3738 AS l_partkey_prf_2#3757, l_discount_prf#3739 AS l_discount_prf_2#3758, l_partkey_and_l_suppkey_prf#3740 AS l_partkey_and_l_suppkey_prf_2#3759, l_commitdate_prf#3741 AS l_commitdate_prf_2#3760, l_suppkey_prf#3742 AS l_suppkey_prf_2#3761, l_orderkey_prf#3743 AS l_orderkey_prf_2#3762]
            +- Relation[l_returnflag_prf#3725,l_orderkey_and_l_linenumber_prf#3726,l_comment_prf#3727,l_linestatus_prf#3728,rid#3729,l_shipmode_prf#3730,l_shipinstruct_prf#3731,l_quantity_prf#3732,l_receiptdate_prf#3733,l_linenumber_prf#3734,l_tax_prf#3735,l_shipdate_prf#3736,l_extendedprice_prf#3737,l_partkey_prf#3738,l_discount_prf#3739,l_partkey_and_l_suppkey_prf#3740,l_commitdate_prf#3741,l_suppkey_prf#3742,l_orderkey_prf#3743] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 231743ms

q15=

select
  s_suppkey, s_name, s_address, s_phone
from
  supplier, lineitem
where
  s_suppkey = l_suppkey
        
19/10/22 01:31:00 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:31:00 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3808L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = l_suppkey#308L)
         :- Project [s_suppkey#18L]
         :  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [l_suppkey#308L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:31:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:31:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:31:00 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:31:00 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3808L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [s_phone_prf#3810 AS s_phone_prf_0#3818, rid#3811 AS rid_0#3819, s_address_prf#3812 AS s_address_prf_0#3820, s_nationkey_prf#3813 AS s_nationkey_prf_0#3821, s_suppkey_prf#3814 AS s_suppkey_prf_0#3822, s_name_prf#3815 AS s_name_prf_0#3823, s_acctbal_prf#3816 AS s_acctbal_prf_0#3824, s_comment_prf#3817 AS s_comment_prf_0#3825]
         :  :  +- Relation[s_phone_prf#3810,rid#3811,s_address_prf#3812,s_nationkey_prf#3813,s_suppkey_prf#3814,s_name_prf#3815,s_acctbal_prf#3816,s_comment_prf#3817] JDBCRelation(supplier_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3835]
         :     +- 'DexRidCorrelatedJoin supplier~s_suppkey~lineitem~l_suppkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3834]
         :        :  +- Relation[s_phone_prf#3826,rid#3827,s_address_prf#3828,s_nationkey_prf#3829,s_suppkey_prf#3830,s_name_prf#3831,s_acctbal_prf#3832,s_comment_prf#3833] JDBCRelation(supplier_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#3836 AS l_returnflag_prf_1#3855, l_orderkey_and_l_linenumber_prf#3837 AS l_orderkey_and_l_linenumber_prf_1#3856, l_comment_prf#3838 AS l_comment_prf_1#3857, l_linestatus_prf#3839 AS l_linestatus_prf_1#3858, rid#3840 AS rid_1#3859, l_shipmode_prf#3841 AS l_shipmode_prf_1#3860, l_shipinstruct_prf#3842 AS l_shipinstruct_prf_1#3861, l_quantity_prf#3843 AS l_quantity_prf_1#3862, l_receiptdate_prf#3844 AS l_receiptdate_prf_1#3863, l_linenumber_prf#3845 AS l_linenumber_prf_1#3864, l_tax_prf#3846 AS l_tax_prf_1#3865, l_shipdate_prf#3847 AS l_shipdate_prf_1#3866, l_extendedprice_prf#3848 AS l_extendedprice_prf_1#3867, l_partkey_prf#3849 AS l_partkey_prf_1#3868, l_discount_prf#3850 AS l_discount_prf_1#3869, l_partkey_and_l_suppkey_prf#3851 AS l_partkey_and_l_suppkey_prf_1#3870, l_commitdate_prf#3852 AS l_commitdate_prf_1#3871, l_suppkey_prf#3853 AS l_suppkey_prf_1#3872, l_orderkey_prf#3854 AS l_orderkey_prf_1#3873]
            +- Relation[l_returnflag_prf#3836,l_orderkey_and_l_linenumber_prf#3837,l_comment_prf#3838,l_linestatus_prf#3839,rid#3840,l_shipmode_prf#3841,l_shipinstruct_prf#3842,l_quantity_prf#3843,l_receiptdate_prf#3844,l_linenumber_prf#3845,l_tax_prf#3846,l_shipdate_prf#3847,l_extendedprice_prf#3848,l_partkey_prf#3849,l_discount_prf#3850,l_partkey_and_l_suppkey_prf#3851,l_commitdate_prf#3852,l_suppkey_prf#3853,l_orderkey_prf#3854] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=6001215
Elapsed time: 82493ms

q13=

select
  o_orderkey
from
  customer left outer join orders on c_custkey = o_custkey
        
19/10/22 01:32:23 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:32:23 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3905L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightOuter, (o_custkey#343L = c_custkey#290L)
         :- Project [o_custkey#343L]
         :  +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [c_custkey#290L]
            +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet

19/10/22 01:32:23 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3905L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(RightOuter)
         :- 'Join UsingJoin(Inner,List(rid_0))
         :  :- Project [o_shippriority_prf#3907 AS o_shippriority_prf_0#3917, rid#3908 AS rid_0#3918, o_orderdate_prf#3909 AS o_orderdate_prf_0#3919, o_custkey_prf#3910 AS o_custkey_prf_0#3920, o_orderpriority_prf#3911 AS o_orderpriority_prf_0#3921, o_clerk_prf#3912 AS o_clerk_prf_0#3922, o_orderstatus_prf#3913 AS o_orderstatus_prf_0#3923, o_totalprice_prf#3914 AS o_totalprice_prf_0#3924, o_orderkey_prf#3915 AS o_orderkey_prf_0#3925, o_comment_prf#3916 AS o_comment_prf_0#3926]
         :  :  +- Relation[o_shippriority_prf#3907,rid#3908,o_orderdate_prf#3909,o_custkey_prf#3910,o_orderpriority_prf#3911,o_clerk_prf#3912,o_orderstatus_prf#3913,o_totalprice_prf#3914,o_orderkey_prf#3915,o_comment_prf#3916] JDBCRelation(orders_prf) [numPartitions=1]
         :  +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#3938]
         :     +- 'DexRidCorrelatedJoin orders~o_custkey~customer~c_custkey, 'rid_0
         :        :- 'Project ['rid AS rid_0#3937]
         :        :  +- Relation[o_shippriority_prf#3927,rid#3928,o_orderdate_prf#3929,o_custkey_prf#3930,o_orderpriority_prf#3931,o_clerk_prf#3932,o_orderstatus_prf#3933,o_totalprice_prf#3934,o_orderkey_prf#3935,o_comment_prf#3936] JDBCRelation(orders_prf) [numPartitions=1]
         :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [c_acctbal_prf#3939 AS c_acctbal_prf_1#3948, rid#3940 AS rid_1#3949, c_name_prf#3941 AS c_name_prf_1#3950, c_nationkey_prf#3942 AS c_nationkey_prf_1#3951, c_custkey_prf#3943 AS c_custkey_prf_1#3952, c_comment_prf#3944 AS c_comment_prf_1#3953, c_address_prf#3945 AS c_address_prf_1#3954, c_mktsegment_prf#3946 AS c_mktsegment_prf_1#3955, c_phone_prf#3947 AS c_phone_prf_1#3956]
            +- Relation[c_acctbal_prf#3939,rid#3940,c_name_prf#3941,c_nationkey_prf#3942,c_custkey_prf#3943,c_comment_prf#3944,c_address_prf#3945,c_mktsegment_prf#3946,c_phone_prf#3947] JDBCRelation(customer_prf) [numPartitions=1]

DexCorr$ result size=1550004
Elapsed time: 50766ms

q20=

select
  s_name, s_address
from
  supplier, nation
where s_suppkey in (
  select ps_suppkey
  from partsupp
  where ps_partkey in (
    select p_partkey
    from part
    where p_size = 15
  )
) and s_nationkey = n_nationkey
  and n_name = 'CANADA'
        
19/10/22 01:33:14 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:33:14 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#3981L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (ps_suppkey#33L = s_suppkey#18L)
         :- Project [ps_suppkey#33L]
         :  +- Join RightSemi, (p_partkey#360L = ps_partkey#32L)
         :     :- Project [p_partkey#360L]
         :     :  +- Filter (p_size#364 = 15)
         :     :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         :     +- Project [ps_partkey#32L, ps_suppkey#33L]
         :        +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet
         +- Project [s_suppkey#18L]
            +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
               :- Project [n_nationkey#108L]
               :  +- Filter (n_name#109 = CANADA)
               :     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
               +- Project [s_suppkey#18L, s_nationkey#21L]
                  +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet

19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:33:14 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:33:14 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#3981L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['rid_2, 'n_regionkey_prf_2, 'n_nationkey_prf_2, 'n_name_prf_2, 'n_comment_prf_2, dexdecrypt('value_dec_key, value#1964) AS rid_3#4031]
         :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, rid_2#4025: string
         :  :     :- 'Join UsingJoin(LeftSemi,List(rid_2))
         :  :     :  :- Project [rid#4020 AS rid_2#4025, n_regionkey_prf#4021 AS n_regionkey_prf_2#4026, n_nationkey_prf#4022 AS n_nationkey_prf_2#4027, n_name_prf#4023 AS n_name_prf_2#4028, n_comment_prf#4024 AS n_comment_prf_2#4029]
         :  :     :  :  +- Relation[rid#4020,n_regionkey_prf#4021,n_nationkey_prf#4022,n_name_prf#4023,n_comment_prf#4024] JDBCRelation(nation_prf) [numPartitions=1]
         :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_2#4030]
         :  :     :     +- DexRidFilter nation~n_name~CANADA
         :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- Project [s_phone_prf#4032 AS s_phone_prf_3#4040, rid#4033 AS rid_3#4041, s_address_prf#4034 AS s_address_prf_3#4042, s_nationkey_prf#4035 AS s_nationkey_prf_3#4043, s_suppkey_prf#4036 AS s_suppkey_prf_3#4044, s_name_prf#4037 AS s_name_prf_3#4045, s_acctbal_prf#4038 AS s_acctbal_prf_3#4046, s_comment_prf#4039 AS s_comment_prf_3#4047]
         :     +- Relation[s_phone_prf#4032,rid#4033,s_address_prf#4034,s_nationkey_prf#4035,s_suppkey_prf#4036,s_name_prf#4037,s_acctbal_prf#4038,s_comment_prf#4039] JDBCRelation(supplier_prf) [numPartitions=1]
         +- 'Project ['ps_partkey_and_ps_suppkey_prf_1, 'rid_1, 'ps_availqty_prf_1, 'ps_comment_prf_1, 'ps_partkey_prf_1, 'ps_supplycost_prf_1, 'ps_suppkey_prf_1, dexdecrypt('value_dec_key, value#1964) AS rid_3#4019]
            +- 'DexRidCorrelatedJoin partsupp~ps_suppkey~supplier~s_suppkey, rid_1#4013: string
               :- 'Join NaturalJoin(LeftSemi)
               :  :- Project [ps_partkey_and_ps_suppkey_prf#4005 AS ps_partkey_and_ps_suppkey_prf_1#4012, rid#4006 AS rid_1#4013, ps_availqty_prf#4007 AS ps_availqty_prf_1#4014, ps_comment_prf#4008 AS ps_comment_prf_1#4015, ps_partkey_prf#4009 AS ps_partkey_prf_1#4016, ps_supplycost_prf#4010 AS ps_supplycost_prf_1#4017, ps_suppkey_prf#4011 AS ps_suppkey_prf_1#4018]
               :  :  +- Relation[ps_partkey_and_ps_suppkey_prf#4005,rid#4006,ps_availqty_prf#4007,ps_comment_prf#4008,ps_partkey_prf#4009,ps_supplycost_prf#4010,ps_suppkey_prf#4011] JDBCRelation(partsupp_prf) [numPartitions=1]
               :  +- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#4004]
               :     +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#3995: string
               :        :- 'Join UsingJoin(LeftSemi,List(rid_0))
               :        :  :- Project [p_comment_prf#3983 AS p_comment_prf_0#3993, p_name_prf#3984 AS p_name_prf_0#3994, rid#3985 AS rid_0#3995, p_type_prf#3986 AS p_type_prf_0#3996, p_retailprice_prf#3987 AS p_retailprice_prf_0#3997, p_mfgr_prf#3988 AS p_mfgr_prf_0#3998, p_container_prf#3989 AS p_container_prf_0#3999, p_brand_prf#3990 AS p_brand_prf_0#4000, p_size_prf#3991 AS p_size_prf_0#4001, p_partkey_prf#3992 AS p_partkey_prf_0#4002]
               :        :  :  +- Relation[p_comment_prf#3983,p_name_prf#3984,rid#3985,p_type_prf#3986,p_retailprice_prf#3987,p_mfgr_prf#3988,p_container_prf#3989,p_brand_prf#3990,p_size_prf#3991,p_partkey_prf#3992] JDBCRelation(part_prf) [numPartitions=1]
               :        :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4003]
               :        :     +- DexRidFilter part~p_size~15
               :        :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
               :        +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
               +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=324
Elapsed time: 22694ms

q12=

select
  l_shipmode
from
  orders,
  lineitem
where
  o_orderkey = l_orderkey
  and l_shipmode = 'MAIL'
        
19/10/22 01:33:36 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:33:36 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4065L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Filter (l_shipmode#319 = MAIL)
         :     +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet

19/10/22 01:33:36 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4065L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['l_returnflag_prf_0, 'l_orderkey_and_l_linenumber_prf_0, 'l_comment_prf_0, 'l_linestatus_prf_0, 'rid_0, 'l_shipmode_prf_0, 'l_shipinstruct_prf_0, 'l_quantity_prf_0, 'l_receiptdate_prf_0, 'l_linenumber_prf_0, 'l_tax_prf_0, 'l_shipdate_prf_0, 'l_extendedprice_prf_0, 'l_partkey_prf_0, 'l_discount_prf_0, 'l_partkey_and_l_suppkey_prf_0, 'l_commitdate_prf_0, 'l_suppkey_prf_0, 'l_orderkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#4106]
         :  +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, rid_0#4090: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [l_returnflag_prf#4067 AS l_returnflag_prf_0#4086, l_orderkey_and_l_linenumber_prf#4068 AS l_orderkey_and_l_linenumber_prf_0#4087, l_comment_prf#4069 AS l_comment_prf_0#4088, l_linestatus_prf#4070 AS l_linestatus_prf_0#4089, rid#4071 AS rid_0#4090, l_shipmode_prf#4072 AS l_shipmode_prf_0#4091, l_shipinstruct_prf#4073 AS l_shipinstruct_prf_0#4092, l_quantity_prf#4074 AS l_quantity_prf_0#4093, l_receiptdate_prf#4075 AS l_receiptdate_prf_0#4094, l_linenumber_prf#4076 AS l_linenumber_prf_0#4095, l_tax_prf#4077 AS l_tax_prf_0#4096, l_shipdate_prf#4078 AS l_shipdate_prf_0#4097, l_extendedprice_prf#4079 AS l_extendedprice_prf_0#4098, l_partkey_prf#4080 AS l_partkey_prf_0#4099, l_discount_prf#4081 AS l_discount_prf_0#4100, l_partkey_and_l_suppkey_prf#4082 AS l_partkey_and_l_suppkey_prf_0#4101, l_commitdate_prf#4083 AS l_commitdate_prf_0#4102, l_suppkey_prf#4084 AS l_suppkey_prf_0#4103, l_orderkey_prf#4085 AS l_orderkey_prf_0#4104]
         :     :  :  +- Relation[l_returnflag_prf#4067,l_orderkey_and_l_linenumber_prf#4068,l_comment_prf#4069,l_linestatus_prf#4070,rid#4071,l_shipmode_prf#4072,l_shipinstruct_prf#4073,l_quantity_prf#4074,l_receiptdate_prf#4075,l_linenumber_prf#4076,l_tax_prf#4077,l_shipdate_prf#4078,l_extendedprice_prf#4079,l_partkey_prf#4080,l_discount_prf#4081,l_partkey_and_l_suppkey_prf#4082,l_commitdate_prf#4083,l_suppkey_prf#4084,l_orderkey_prf#4085] JDBCRelation(lineitem_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4105]
         :     :     +- DexRidFilter lineitem~l_shipmode~MAIL
         :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [o_shippriority_prf#4107 AS o_shippriority_prf_1#4117, rid#4108 AS rid_1#4118, o_orderdate_prf#4109 AS o_orderdate_prf_1#4119, o_custkey_prf#4110 AS o_custkey_prf_1#4120, o_orderpriority_prf#4111 AS o_orderpriority_prf_1#4121, o_clerk_prf#4112 AS o_clerk_prf_1#4122, o_orderstatus_prf#4113 AS o_orderstatus_prf_1#4123, o_totalprice_prf#4114 AS o_totalprice_prf_1#4124, o_orderkey_prf#4115 AS o_orderkey_prf_1#4125, o_comment_prf#4116 AS o_comment_prf_1#4126]
            +- Relation[o_shippriority_prf#4107,rid#4108,o_orderdate_prf#4109,o_custkey_prf#4110,o_orderpriority_prf#4111,o_clerk_prf#4112,o_orderstatus_prf#4113,o_totalprice_prf#4114,o_orderkey_prf#4115,o_comment_prf#4116] JDBCRelation(orders_prf) [numPartitions=1]

DexCorr$ result size=857401
Elapsed time: 32137ms

q16=

select
  p_brand, p_type, p_size, ps_suppkey
from
  partsupp, part
where
  p_partkey = ps_partkey
  and p_size = 49
        
19/10/22 01:34:08 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:34:08 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4163L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (p_partkey#360L = ps_partkey#32L)
         :- Project [p_partkey#360L]
         :  +- Filter (p_size#364 = 49)
         :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
         +- Project [ps_partkey#32L]
            +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 01:34:08 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:34:08 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:34:08 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4163L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['p_comment_prf_0, 'p_name_prf_0, 'rid_0, 'p_type_prf_0, 'p_retailprice_prf_0, 'p_mfgr_prf_0, 'p_container_prf_0, 'p_brand_prf_0, 'p_size_prf_0, 'p_partkey_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#4186]
         :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_0#4177: string
         :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :- Project [p_comment_prf#4165 AS p_comment_prf_0#4175, p_name_prf#4166 AS p_name_prf_0#4176, rid#4167 AS rid_0#4177, p_type_prf#4168 AS p_type_prf_0#4178, p_retailprice_prf#4169 AS p_retailprice_prf_0#4179, p_mfgr_prf#4170 AS p_mfgr_prf_0#4180, p_container_prf#4171 AS p_container_prf_0#4181, p_brand_prf#4172 AS p_brand_prf_0#4182, p_size_prf#4173 AS p_size_prf_0#4183, p_partkey_prf#4174 AS p_partkey_prf_0#4184]
         :     :  :  +- Relation[p_comment_prf#4165,p_name_prf#4166,rid#4167,p_type_prf#4168,p_retailprice_prf#4169,p_mfgr_prf#4170,p_container_prf#4171,p_brand_prf#4172,p_size_prf#4173,p_partkey_prf#4174] JDBCRelation(part_prf) [numPartitions=1]
         :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4185]
         :     :     +- DexRidFilter part~p_size~49
         :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [ps_partkey_and_ps_suppkey_prf#4187 AS ps_partkey_and_ps_suppkey_prf_1#4194, rid#4188 AS rid_1#4195, ps_availqty_prf#4189 AS ps_availqty_prf_1#4196, ps_comment_prf#4190 AS ps_comment_prf_1#4197, ps_partkey_prf#4191 AS ps_partkey_prf_1#4198, ps_supplycost_prf#4192 AS ps_supplycost_prf_1#4199, ps_suppkey_prf#4193 AS ps_suppkey_prf_1#4200]
            +- Relation[ps_partkey_and_ps_suppkey_prf#4187,rid#4188,ps_availqty_prf#4189,ps_comment_prf#4190,ps_partkey_prf#4191,ps_supplycost_prf#4192,ps_suppkey_prf#4193] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=15780
Elapsed time: 387ms

q2=

select
  ps_supplycost
from
  part,
  partsupp,
  supplier,
  nation,
  region
where
  p_partkey = ps_partkey
  and s_suppkey = ps_suppkey
  and s_nationkey = n_nationkey
  and n_regionkey = r_regionkey
  and r_name = 'EUROPE'
  and p_size = 15
        
19/10/22 01:34:09 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:34:09 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4222L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (s_suppkey#18L = ps_suppkey#33L)
         :- Project [s_suppkey#18L]
         :  +- Join Inner, (n_nationkey#108L = s_nationkey#21L)
         :     :- Project [n_nationkey#108L]
         :     :  +- Join Inner, (r_regionkey#116L = n_regionkey#110L)
         :     :     :- Project [r_regionkey#116L]
         :     :     :  +- Filter (r_name#117 = EUROPE)
         :     :     :     +- Relation[r_regionkey#116L,r_name#117,r_comment#118] parquet
         :     :     +- Project [n_nationkey#108L, n_regionkey#110L]
         :     :        +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet
         :     +- Project [s_suppkey#18L, s_nationkey#21L]
         :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
         +- Project [ps_suppkey#33L]
            +- Join Inner, (p_partkey#360L = ps_partkey#32L)
               :- Project [p_partkey#360L]
               :  +- Filter (p_size#364 = 15)
               :     +- Relation[p_partkey#360L,p_name#361,p_mfgr#362,p_type#363,p_size#364,p_container#365,p_retailprice#366,p_comment#367,p_brand#368] parquet
               +- Project [ps_partkey#32L, ps_suppkey#33L]
                  +- Relation[ps_partkey#32L,ps_suppkey#33L,ps_availqty#34,ps_supplycost#35,ps_comment#36] parquet

19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=region
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:34:09 WARN DexPlanner: InMemoryFileIndex=partsupp
19/10/22 01:34:09 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4222L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, 'rid_2, 's_phone_prf_2, 's_address_prf_2, 's_nationkey_prf_2, 's_suppkey_prf_2, 's_name_prf_2, 's_acctbal_prf_2, 's_comment_prf_2, dexdecrypt('value_dec_key, value#1964) AS rid_4#4261]
         :  +- 'DexRidCorrelatedJoin supplier~s_suppkey~partsupp~ps_suppkey, 'rid_2
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, 'rid_1, 'n_regionkey_prf_1, 'n_nationkey_prf_1, 'n_name_prf_1, 'n_comment_prf_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#4244]
         :     :  :  +- 'DexRidCorrelatedJoin nation~n_nationkey~supplier~s_nationkey, 'rid_1
         :     :  :     :- 'Join NaturalJoin(Inner)
         :     :  :     :  :- 'Project ['r_regionkey_prf_0, 'r_name_prf_0, 'r_comment_prf_0, 'rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#4233]
         :     :  :     :  :  +- 'DexRidCorrelatedJoin region~r_regionkey~nation~n_regionkey, rid_0#4231: string
         :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :     :  :- Project [r_regionkey_prf#4224 AS r_regionkey_prf_0#4228, r_name_prf#4225 AS r_name_prf_0#4229, r_comment_prf#4226 AS r_comment_prf_0#4230, rid#4227 AS rid_0#4231]
         :     :  :     :  :     :  :  +- Relation[r_regionkey_prf#4224,r_name_prf#4225,r_comment_prf#4226,rid#4227] JDBCRelation(region_prf) [numPartitions=1]
         :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4232]
         :     :  :     :  :     :     +- DexRidFilter region~r_name~EUROPE
         :     :  :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  :     :  +- Project [rid#4234 AS rid_1#4239, n_regionkey_prf#4235 AS n_regionkey_prf_1#4240, n_nationkey_prf#4236 AS n_nationkey_prf_1#4241, n_name_prf#4237 AS n_name_prf_1#4242, n_comment_prf#4238 AS n_comment_prf_1#4243]
         :     :  :     :     +- Relation[rid#4234,n_regionkey_prf#4235,n_nationkey_prf#4236,n_name_prf#4237,n_comment_prf#4238] JDBCRelation(nation_prf) [numPartitions=1]
         :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [s_phone_prf#4245 AS s_phone_prf_2#4253, rid#4246 AS rid_2#4254, s_address_prf#4247 AS s_address_prf_2#4255, s_nationkey_prf#4248 AS s_nationkey_prf_2#4256, s_suppkey_prf#4249 AS s_suppkey_prf_2#4257, s_name_prf#4250 AS s_name_prf_2#4258, s_acctbal_prf#4251 AS s_acctbal_prf_2#4259, s_comment_prf#4252 AS s_comment_prf_2#4260]
         :     :     +- Relation[s_phone_prf#4245,rid#4246,s_address_prf#4247,s_nationkey_prf#4248,s_suppkey_prf#4249,s_name_prf#4250,s_acctbal_prf#4251,s_comment_prf#4252] JDBCRelation(supplier_prf) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- 'Join NaturalJoin(Inner)
            :- 'Project ['p_comment_prf_3, 'p_name_prf_3, 'rid_3, 'p_type_prf_3, 'p_retailprice_prf_3, 'p_mfgr_prf_3, 'p_container_prf_3, 'p_brand_prf_3, 'p_size_prf_3, 'p_partkey_prf_3, dexdecrypt('value_dec_key, value#1964) AS rid_4#4283]
            :  +- 'DexRidCorrelatedJoin part~p_partkey~partsupp~ps_partkey, rid_3#4274: string
            :     :- 'Join UsingJoin(LeftSemi,List(rid_3))
            :     :  :- Project [p_comment_prf#4262 AS p_comment_prf_3#4272, p_name_prf#4263 AS p_name_prf_3#4273, rid#4264 AS rid_3#4274, p_type_prf#4265 AS p_type_prf_3#4275, p_retailprice_prf#4266 AS p_retailprice_prf_3#4276, p_mfgr_prf#4267 AS p_mfgr_prf_3#4277, p_container_prf#4268 AS p_container_prf_3#4278, p_brand_prf#4269 AS p_brand_prf_3#4279, p_size_prf#4270 AS p_size_prf_3#4280, p_partkey_prf#4271 AS p_partkey_prf_3#4281]
            :     :  :  +- Relation[p_comment_prf#4262,p_name_prf#4263,rid#4264,p_type_prf#4265,p_retailprice_prf#4266,p_mfgr_prf#4267,p_container_prf#4268,p_brand_prf#4269,p_size_prf#4270,p_partkey_prf#4271] JDBCRelation(part_prf) [numPartitions=1]
            :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_3#4282]
            :     :     +- DexRidFilter part~p_size~15
            :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
            :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
            +- Project [ps_partkey_and_ps_suppkey_prf#4284 AS ps_partkey_and_ps_suppkey_prf_4#4291, rid#4285 AS rid_4#4292, ps_availqty_prf#4286 AS ps_availqty_prf_4#4293, ps_comment_prf#4287 AS ps_comment_prf_4#4294, ps_partkey_prf#4288 AS ps_partkey_prf_4#4295, ps_supplycost_prf#4289 AS ps_supplycost_prf_4#4296, ps_suppkey_prf#4290 AS ps_suppkey_prf_4#4297]
               +- Relation[ps_partkey_and_ps_suppkey_prf#4284,rid#4285,ps_availqty_prf#4286,ps_comment_prf#4287,ps_partkey_prf#4288,ps_supplycost_prf#4289,ps_suppkey_prf#4290] JDBCRelation(partsupp_prf) [numPartitions=1]

DexCorr$ result size=3162
Elapsed time: 1999ms

q3=

select
  l_orderkey,
  l_extendedprice,
  l_discount
  o_orderdate,
  o_shippriority
from
  customer,
  orders,
  lineitem
where
  c_mktsegment = 'BUILDING'
  and c_custkey = o_custkey
  and l_orderkey = o_orderkey
        
19/10/22 01:34:11 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:34:11 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4340L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join Inner, (o_orderkey#342L = l_orderkey#306L)
         :- Project [o_orderkey#342L]
         :  +- Join Inner, (c_custkey#290L = o_custkey#343L)
         :     :- Project [c_custkey#290L]
         :     :  +- Filter (c_mktsegment#297 = BUILDING)
         :     :     +- Relation[c_custkey#290L,c_name#291,c_address#292,c_nationkey#293L,c_phone#294,c_acctbal#295,c_comment#296,c_mktsegment#297] parquet
         :     +- Project [o_orderkey#342L, o_custkey#343L]
         :        +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
         +- Project [l_orderkey#306L]
            +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet

19/10/22 01:34:11 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 01:34:11 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 01:34:11 WARN DexPlanner: InMemoryFileIndex=customer
19/10/22 01:34:11 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4340L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(Inner)
         :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, 'rid_1, 'o_shippriority_prf_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#4382]
         :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, 'rid_1
         :     :- 'Join NaturalJoin(Inner)
         :     :  :- 'Project ['c_acctbal_prf_0, 'rid_0, 'c_name_prf_0, 'c_nationkey_prf_0, 'c_custkey_prf_0, 'c_comment_prf_0, 'c_address_prf_0, 'c_mktsegment_prf_0, 'c_phone_prf_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#4361]
         :     :  :  +- 'DexRidCorrelatedJoin customer~c_custkey~orders~o_custkey, rid_0#4352: string
         :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_0))
         :     :  :     :  :- Project [c_acctbal_prf#4342 AS c_acctbal_prf_0#4351, rid#4343 AS rid_0#4352, c_name_prf#4344 AS c_name_prf_0#4353, c_nationkey_prf#4345 AS c_nationkey_prf_0#4354, c_custkey_prf#4346 AS c_custkey_prf_0#4355, c_comment_prf#4347 AS c_comment_prf_0#4356, c_address_prf#4348 AS c_address_prf_0#4357, c_mktsegment_prf#4349 AS c_mktsegment_prf_0#4358, c_phone_prf#4350 AS c_phone_prf_0#4359]
         :     :  :     :  :  +- Relation[c_acctbal_prf#4342,rid#4343,c_name_prf#4344,c_nationkey_prf#4345,c_custkey_prf#4346,c_comment_prf#4347,c_address_prf#4348,c_mktsegment_prf#4349,c_phone_prf#4350] JDBCRelation(customer_prf) [numPartitions=1]
         :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_0#4360]
         :     :  :     :     +- DexRidFilter customer~c_mktsegment~BUILDING
         :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :     :  +- Project [o_shippriority_prf#4362 AS o_shippriority_prf_1#4372, rid#4363 AS rid_1#4373, o_orderdate_prf#4364 AS o_orderdate_prf_1#4374, o_custkey_prf#4365 AS o_custkey_prf_1#4375, o_orderpriority_prf#4366 AS o_orderpriority_prf_1#4376, o_clerk_prf#4367 AS o_clerk_prf_1#4377, o_orderstatus_prf#4368 AS o_orderstatus_prf_1#4378, o_totalprice_prf#4369 AS o_totalprice_prf_1#4379, o_orderkey_prf#4370 AS o_orderkey_prf_1#4380, o_comment_prf#4371 AS o_comment_prf_1#4381]
         :     :     +- Relation[o_shippriority_prf#4362,rid#4363,o_orderdate_prf#4364,o_custkey_prf#4365,o_orderpriority_prf#4366,o_clerk_prf#4367,o_orderstatus_prf#4368,o_totalprice_prf#4369,o_orderkey_prf#4370,o_comment_prf#4371] JDBCRelation(orders_prf) [numPartitions=1]
         :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         +- Project [l_returnflag_prf#4383 AS l_returnflag_prf_2#4402, l_orderkey_and_l_linenumber_prf#4384 AS l_orderkey_and_l_linenumber_prf_2#4403, l_comment_prf#4385 AS l_comment_prf_2#4404, l_linestatus_prf#4386 AS l_linestatus_prf_2#4405, rid#4387 AS rid_2#4406, l_shipmode_prf#4388 AS l_shipmode_prf_2#4407, l_shipinstruct_prf#4389 AS l_shipinstruct_prf_2#4408, l_quantity_prf#4390 AS l_quantity_prf_2#4409, l_receiptdate_prf#4391 AS l_receiptdate_prf_2#4410, l_linenumber_prf#4392 AS l_linenumber_prf_2#4411, l_tax_prf#4393 AS l_tax_prf_2#4412, l_shipdate_prf#4394 AS l_shipdate_prf_2#4413, l_extendedprice_prf#4395 AS l_extendedprice_prf_2#4414, l_partkey_prf#4396 AS l_partkey_prf_2#4415, l_discount_prf#4397 AS l_discount_prf_2#4416, l_partkey_and_l_suppkey_prf#4398 AS l_partkey_and_l_suppkey_prf_2#4417, l_commitdate_prf#4399 AS l_commitdate_prf_2#4418, l_suppkey_prf#4400 AS l_suppkey_prf_2#4419, l_orderkey_prf#4401 AS l_orderkey_prf_2#4420]
            +- Relation[l_returnflag_prf#4383,l_orderkey_and_l_linenumber_prf#4384,l_comment_prf#4385,l_linestatus_prf#4386,rid#4387,l_shipmode_prf#4388,l_shipinstruct_prf#4389,l_quantity_prf#4390,l_receiptdate_prf#4391,l_linenumber_prf#4392,l_tax_prf#4393,l_shipdate_prf#4394,l_extendedprice_prf#4395,l_partkey_prf#4396,l_discount_prf#4397,l_partkey_and_l_suppkey_prf#4398,l_commitdate_prf#4399,l_suppkey_prf#4400,l_orderkey_prf#4401] JDBCRelation(lineitem_prf) [numPartitions=1]

DexCorr$ result size=1214743
Elapsed time: 32912ms

q21a=

select
  s_name
from
  supplier, lineitem l1, orders, nation
where
  s_suppkey = l1.l_suppkey
  and o_orderkey = l1.l_orderkey
  and o_orderstatus = 'F'
  and exists (
    select *
    from
      lineitem l2
    where
      l2.l_orderkey = l1.l_orderkey
  )
  and s_nationkey = n_nationkey
  and n_name = 'SAUDI ARABIA'
        
19/10/22 01:34:44 WARN DexPlanner: dexPlan=DexCorrelationPlan
19/10/22 01:34:44 WARN DexPlanner$TranslateDexQuery: == To be translated == 
Aggregate [count(1) AS count#4463L]
+- DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
   +- Project
      +- Join RightSemi, (l_orderkey#306L = o_orderkey#342L)
         :- Project [l_orderkey#306L]
         :  +- Relation[l_orderkey#306L,l_partkey#307L,l_suppkey#308L,l_linenumber#309,l_quantity#310,l_extendedprice#311,l_discount#312,l_tax#313,l_returnflag#314,l_linestatus#315,l_commitdate#316,l_receiptdate#317,l_shipinstruct#318,l_shipmode#319,l_comment#320,l_shipdate#321] parquet
         +- Project [o_orderkey#342L]
            +- Join Inner, (s_nationkey#21L = n_nationkey#108L)
               :- Project [o_orderkey#342L, s_nationkey#21L]
               :  +- Join Inner, (l_suppkey#1764L = s_suppkey#18L)
               :     :- Project [o_orderkey#342L, l_suppkey#1764L]
               :     :  +- Join Inner, (o_orderkey#342L = l_orderkey#1762L)
               :     :     :- Project [o_orderkey#342L]
               :     :     :  +- Filter (o_orderstatus#344 = F)
               :     :     :     +- Relation[o_orderkey#342L,o_custkey#343L,o_orderstatus#344,o_totalprice#345,o_orderpriority#346,o_clerk#347,o_shippriority#348,o_comment#349,o_orderdate#350] parquet
               :     :     +- Project [l_orderkey#1762L, l_suppkey#1764L]
               :     :        +- Relation[l_orderkey#1762L,l_partkey#1763L,l_suppkey#1764L,l_linenumber#1765,l_quantity#1766,l_extendedprice#1767,l_discount#1768,l_tax#1769,l_returnflag#1770,l_linestatus#1771,l_commitdate#1772,l_receiptdate#1773,l_shipinstruct#1774,l_shipmode#1775,l_comment#1776,l_shipdate#1777] parquet
               :     +- Project [s_suppkey#18L, s_nationkey#21L]
               :        +- Relation[s_suppkey#18L,s_name#19,s_address#20,s_nationkey#21L,s_phone#22,s_acctbal#23,s_comment#24] parquet
               +- Project [n_nationkey#108L]
                  +- Filter (n_name#109 = SAUDI ARABIA)
                     +- Relation[n_nationkey#108L,n_name#109,n_regionkey#110L,n_comment#111] parquet

19/10/22 01:34:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:34:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:34:44 WARN DexPlanner: InMemoryFileIndex=supplier
19/10/22 01:34:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:34:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:34:44 WARN DexPlanner: InMemoryFileIndex=nation
19/10/22 01:34:44 WARN DexPlanner$ConvertDexPlanToSQL: == To be converted to sql ==
'Aggregate [count(1) AS count#4463L]
+- 'Project
   +- 'DexCorrelationPlan {ps_partkey_and_ps_suppkey, l_orderkey_and_l_linenumber, l_partkey_and_l_suppkey}
      +- 'Join NaturalJoin(LeftSemi)
         :- 'Join NaturalJoin(Inner)
         :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, 'l_shipdate_prf_2, 'l_extendedprice_prf_2, 'l_partkey_prf_2, ... 14 more fields]
         :  :  +- 'DexRidCorrelatedJoin supplier~s_nationkey~nation~n_nationkey, 'rid_3
         :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, 'rid_2, 'l_returnflag_prf_2, 'l_orderkey_and_l_linenumber_prf_2, 'l_comment_prf_2, 'l_linestatus_prf_2, 'l_shipmode_prf_2, 'l_shipinstruct_prf_2, 'l_quantity_prf_2, 'l_receiptdate_prf_2, 'l_linenumber_prf_2, 'l_tax_prf_2, 'l_shipdate_prf_2, 'l_extendedprice_prf_2, 'l_partkey_prf_2, ... 6 more fields]
         :  :     :  :  +- 'DexRidCorrelatedJoin lineitem~l_suppkey~supplier~s_suppkey, 'rid_2
         :  :     :  :     :- 'Join NaturalJoin(Inner)
         :  :     :  :     :  :- 'Project ['o_shippriority_prf_1, 'rid_1, 'o_orderdate_prf_1, 'o_custkey_prf_1, 'o_orderpriority_prf_1, 'o_clerk_prf_1, 'o_orderstatus_prf_1, 'o_totalprice_prf_1, 'o_orderkey_prf_1, 'o_comment_prf_1, dexdecrypt('value_dec_key, value#1964) AS rid_2#4545]
         :  :     :  :     :  :  +- 'DexRidCorrelatedJoin orders~o_orderkey~lineitem~l_orderkey, rid_1#4535: string
         :  :     :  :     :  :     :- 'Join UsingJoin(LeftSemi,List(rid_1))
         :  :     :  :     :  :     :  :- Project [o_shippriority_prf#4524 AS o_shippriority_prf_1#4534, rid#4525 AS rid_1#4535, o_orderdate_prf#4526 AS o_orderdate_prf_1#4536, o_custkey_prf#4527 AS o_custkey_prf_1#4537, o_orderpriority_prf#4528 AS o_orderpriority_prf_1#4538, o_clerk_prf#4529 AS o_clerk_prf_1#4539, o_orderstatus_prf#4530 AS o_orderstatus_prf_1#4540, o_totalprice_prf#4531 AS o_totalprice_prf_1#4541, o_orderkey_prf#4532 AS o_orderkey_prf_1#4542, o_comment_prf#4533 AS o_comment_prf_1#4543]
         :  :     :  :     :  :     :  :  +- Relation[o_shippriority_prf#4524,rid#4525,o_orderdate_prf#4526,o_custkey_prf#4527,o_orderpriority_prf#4528,o_clerk_prf#4529,o_orderstatus_prf#4530,o_totalprice_prf#4531,o_orderkey_prf#4532,o_comment_prf#4533] JDBCRelation(orders_prf) [numPartitions=1]
         :  :     :  :     :  :     :  +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_1#4544]
         :  :     :  :     :  :     :     +- DexRidFilter orders~o_orderstatus~F
         :  :     :  :     :  :     :        +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         :  :     :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  :     :  +- Project [l_returnflag_prf#4546 AS l_returnflag_prf_2#4565, l_orderkey_and_l_linenumber_prf#4547 AS l_orderkey_and_l_linenumber_prf_2#4566, l_comment_prf#4548 AS l_comment_prf_2#4567, l_linestatus_prf#4549 AS l_linestatus_prf_2#4568, rid#4550 AS rid_2#4569, l_shipmode_prf#4551 AS l_shipmode_prf_2#4570, l_shipinstruct_prf#4552 AS l_shipinstruct_prf_2#4571, l_quantity_prf#4553 AS l_quantity_prf_2#4572, l_receiptdate_prf#4554 AS l_receiptdate_prf_2#4573, l_linenumber_prf#4555 AS l_linenumber_prf_2#4574, l_tax_prf#4556 AS l_tax_prf_2#4575, l_shipdate_prf#4557 AS l_shipdate_prf_2#4576, l_extendedprice_prf#4558 AS l_extendedprice_prf_2#4577, l_partkey_prf#4559 AS l_partkey_prf_2#4578, l_discount_prf#4560 AS l_discount_prf_2#4579, l_partkey_and_l_suppkey_prf#4561 AS l_partkey_and_l_suppkey_prf_2#4580, l_commitdate_prf#4562 AS l_commitdate_prf_2#4581, l_suppkey_prf#4563 AS l_suppkey_prf_2#4582, l_orderkey_prf#4564 AS l_orderkey_prf_2#4583]
         :  :     :  :     :     +- Relation[l_returnflag_prf#4546,l_orderkey_and_l_linenumber_prf#4547,l_comment_prf#4548,l_linestatus_prf#4549,rid#4550,l_shipmode_prf#4551,l_shipinstruct_prf#4552,l_quantity_prf#4553,l_receiptdate_prf#4554,l_linenumber_prf#4555,l_tax_prf#4556,l_shipdate_prf#4557,l_extendedprice_prf#4558,l_partkey_prf#4559,l_discount_prf#4560,l_partkey_and_l_suppkey_prf#4561,l_commitdate_prf#4562,l_suppkey_prf#4563,l_orderkey_prf#4564] JDBCRelation(lineitem_prf) [numPartitions=1]
         :  :     :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  :     :  +- Project [s_phone_prf#4585 AS s_phone_prf_3#4593, rid#4586 AS rid_3#4594, s_address_prf#4587 AS s_address_prf_3#4595, s_nationkey_prf#4588 AS s_nationkey_prf_3#4596, s_suppkey_prf#4589 AS s_suppkey_prf_3#4597, s_name_prf#4590 AS s_name_prf_3#4598, s_acctbal_prf#4591 AS s_acctbal_prf_3#4599, s_comment_prf#4592 AS s_comment_prf_3#4600]
         :  :     :     +- Relation[s_phone_prf#4585,rid#4586,s_address_prf#4587,s_nationkey_prf#4588,s_suppkey_prf#4589,s_name_prf#4590,s_acctbal_prf#4591,s_comment_prf#4592] JDBCRelation(supplier_prf) [numPartitions=1]
         :  :     +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]
         :  +- 'Join UsingJoin(LeftSemi,List(rid_4))
         :     :- Project [rid#4602 AS rid_4#4607, n_regionkey_prf#4603 AS n_regionkey_prf_4#4608, n_nationkey_prf#4604 AS n_nationkey_prf_4#4609, n_name_prf#4605 AS n_name_prf_4#4610, n_comment_prf#4606 AS n_comment_prf_4#4611]
         :     :  +- Relation[rid#4602,n_regionkey_prf#4603,n_nationkey_prf#4604,n_name_prf#4605,n_comment_prf#4606] JDBCRelation(nation_prf) [numPartitions=1]
         :     +- 'Project [dexdecrypt('value_dec_key, 'value) AS rid_4#4612]
         :        +- DexRidFilter nation~n_name~SAUDI ARABIA
         :           +- Relation[label#2331,value#2332] JDBCRelation(t_filter) [numPartitions=1]
         +- 'Join UsingJoin(Inner,List(rid_0))
            :- Project [l_returnflag_prf#4465 AS l_returnflag_prf_0#4484, l_orderkey_and_l_linenumber_prf#4466 AS l_orderkey_and_l_linenumber_prf_0#4485, l_comment_prf#4467 AS l_comment_prf_0#4486, l_linestatus_prf#4468 AS l_linestatus_prf_0#4487, rid#4469 AS rid_0#4488, l_shipmode_prf#4470 AS l_shipmode_prf_0#4489, l_shipinstruct_prf#4471 AS l_shipinstruct_prf_0#4490, l_quantity_prf#4472 AS l_quantity_prf_0#4491, l_receiptdate_prf#4473 AS l_receiptdate_prf_0#4492, l_linenumber_prf#4474 AS l_linenumber_prf_0#4493, l_tax_prf#4475 AS l_tax_prf_0#4494, l_shipdate_prf#4476 AS l_shipdate_prf_0#4495, l_extendedprice_prf#4477 AS l_extendedprice_prf_0#4496, l_partkey_prf#4478 AS l_partkey_prf_0#4497, l_discount_prf#4479 AS l_discount_prf_0#4498, l_partkey_and_l_suppkey_prf#4480 AS l_partkey_and_l_suppkey_prf_0#4499, l_commitdate_prf#4481 AS l_commitdate_prf_0#4500, l_suppkey_prf#4482 AS l_suppkey_prf_0#4501, l_orderkey_prf#4483 AS l_orderkey_prf_0#4502]
            :  +- Relation[l_returnflag_prf#4465,l_orderkey_and_l_linenumber_prf#4466,l_comment_prf#4467,l_linestatus_prf#4468,rid#4469,l_shipmode_prf#4470,l_shipinstruct_prf#4471,l_quantity_prf#4472,l_receiptdate_prf#4473,l_linenumber_prf#4474,l_tax_prf#4475,l_shipdate_prf#4476,l_extendedprice_prf#4477,l_partkey_prf#4478,l_discount_prf#4479,l_partkey_and_l_suppkey_prf#4480,l_commitdate_prf#4481,l_suppkey_prf#4482,l_orderkey_prf#4483] JDBCRelation(lineitem_prf) [numPartitions=1]
            +- 'Project ['rid_0, dexdecrypt('value_dec_key, value#1964) AS rid_1#4523]
               +- 'DexRidCorrelatedJoin lineitem~l_orderkey~orders~o_orderkey, 'rid_0
                  :- 'Project ['rid AS rid_0#4522]
                  :  +- Relation[l_returnflag_prf#4503,l_orderkey_and_l_linenumber_prf#4504,l_comment_prf#4505,l_linestatus_prf#4506,rid#4507,l_shipmode_prf#4508,l_shipinstruct_prf#4509,l_quantity_prf#4510,l_receiptdate_prf#4511,l_linenumber_prf#4512,l_tax_prf#4513,l_shipdate_prf#4514,l_extendedprice_prf#4515,l_partkey_prf#4516,l_discount_prf#4517,l_partkey_and_l_suppkey_prf#4518,l_commitdate_prf#4519,l_suppkey_prf#4520,l_orderkey_prf#4521] JDBCRelation(lineitem_prf) [numPartitions=1]
                  +- Relation[label#1963,value#1964] JDBCRelation(t_correlated_join) [numPartitions=1]

DexCorr$ result size=119924
Elapsed time: 370137ms
query=q1, count=6001215, duration=1770
query=q10, count=1478870, duration=179409
query=q11, count=31680, duration=851
query=q12, count=857401, duration=32137
query=q13, count=1550004, duration=50766
query=q14, count=6001215, duration=90690
query=q15, count=6001215, duration=82493
query=q16, count=15780, duration=387
query=q17, count=6088, duration=360
query=q18, count=6001215, duration=231743
query=q19, count=205, duration=26385
query=q2, count=3162, duration=1999
query=q20, count=324, duration=22694
query=q21a, count=119924, duration=370137
query=q22, count=50004, duration=45853
query=q3, count=1214743, duration=32912
query=q4, count=6001215, duration=98722
query=q7, count=9735, duration=39381
query=q8, count=8716, duration=97109
query=q9a, count=6001215, duration=383530
query=q9b, count=6001215, duration=293253
